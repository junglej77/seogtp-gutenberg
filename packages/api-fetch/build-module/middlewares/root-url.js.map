{"version":3,"names":["namespaceAndEndpointMiddleware","createRootURLMiddleware","rootURL","options","next","optionsWithPath","url","path","apiRoot","indexOf","replace"],"sources":["@wordpress/api-fetch/src/middlewares/root-url.js"],"sourcesContent":["/**\r\n * Internal dependencies\r\n */\r\nimport namespaceAndEndpointMiddleware from './namespace-endpoint';\r\n\r\n/**\r\n * @param {string} rootURL\r\n * @return {import('../types').APIFetchMiddleware} Root URL middleware.\r\n */\r\nconst createRootURLMiddleware = ( rootURL ) => ( options, next ) => {\r\n\treturn namespaceAndEndpointMiddleware( options, ( optionsWithPath ) => {\r\n\t\tlet url = optionsWithPath.url;\r\n\t\tlet path = optionsWithPath.path;\r\n\t\tlet apiRoot;\r\n\r\n\t\tif ( typeof path === 'string' ) {\r\n\t\t\tapiRoot = rootURL;\r\n\r\n\t\t\tif ( -1 !== rootURL.indexOf( '?' ) ) {\r\n\t\t\t\tpath = path.replace( '?', '&' );\r\n\t\t\t}\r\n\r\n\t\t\tpath = path.replace( /^\\//, '' );\r\n\r\n\t\t\t// API root may already include query parameter prefix if site is\r\n\t\t\t// configured to use plain permalinks.\r\n\t\t\tif (\r\n\t\t\t\t'string' === typeof apiRoot &&\r\n\t\t\t\t-1 !== apiRoot.indexOf( '?' )\r\n\t\t\t) {\r\n\t\t\t\tpath = path.replace( '?', '&' );\r\n\t\t\t}\r\n\r\n\t\t\turl = apiRoot + path;\r\n\t\t}\r\n\r\n\t\treturn next( {\r\n\t\t\t...optionsWithPath,\r\n\t\t\turl,\r\n\t\t} );\r\n\t} );\r\n};\r\n\r\nexport default createRootURLMiddleware;\r\n"],"mappings":"AAAA;AACA;AACA;AACA,OAAOA,8BAA8B,MAAM,sBAAsB;;AAEjE;AACA;AACA;AACA;AACA,MAAMC,uBAAuB,GAAKC,OAAO,IAAM,CAAEC,OAAO,EAAEC,IAAI,KAAM;EACnE,OAAOJ,8BAA8B,CAAEG,OAAO,EAAIE,eAAe,IAAM;IACtE,IAAIC,GAAG,GAAGD,eAAe,CAACC,GAAG;IAC7B,IAAIC,IAAI,GAAGF,eAAe,CAACE,IAAI;IAC/B,IAAIC,OAAO;IAEX,IAAK,OAAOD,IAAI,KAAK,QAAQ,EAAG;MAC/BC,OAAO,GAAGN,OAAO;MAEjB,IAAK,CAAC,CAAC,KAAKA,OAAO,CAACO,OAAO,CAAE,GAAI,CAAC,EAAG;QACpCF,IAAI,GAAGA,IAAI,CAACG,OAAO,CAAE,GAAG,EAAE,GAAI,CAAC;MAChC;MAEAH,IAAI,GAAGA,IAAI,CAACG,OAAO,CAAE,KAAK,EAAE,EAAG,CAAC;;MAEhC;MACA;MACA,IACC,QAAQ,KAAK,OAAOF,OAAO,IAC3B,CAAC,CAAC,KAAKA,OAAO,CAACC,OAAO,CAAE,GAAI,CAAC,EAC5B;QACDF,IAAI,GAAGA,IAAI,CAACG,OAAO,CAAE,GAAG,EAAE,GAAI,CAAC;MAChC;MAEAJ,GAAG,GAAGE,OAAO,GAAGD,IAAI;IACrB;IAEA,OAAOH,IAAI,CAAE;MACZ,GAAGC,eAAe;MAClBC;IACD,CAAE,CAAC;EACJ,CAAE,CAAC;AACJ,CAAC;AAED,eAAeL,uBAAuB","ignoreList":[]}