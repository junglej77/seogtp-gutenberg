{"version":3,"names":["unregisterBlockType","useDispatch","useSelect","useEffect","store","editorStore","blockDirectoryStore","AutoBlockUninstaller","uninstallBlockType","shouldRemoveBlockTypes","select","isAutosavingPost","isSavingPost","unusedBlockTypes","getUnusedBlockTypes","length","forEach","blockType","name"],"sources":["@wordpress/block-directory/src/components/auto-block-uninstaller/index.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { unregisterBlockType } from '@wordpress/blocks';\r\nimport { useDispatch, useSelect } from '@wordpress/data';\r\nimport { useEffect } from '@wordpress/element';\r\nimport { store as editorStore } from '@wordpress/editor';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { store as blockDirectoryStore } from '../../store';\r\n\r\nexport default function AutoBlockUninstaller() {\r\n\tconst { uninstallBlockType } = useDispatch( blockDirectoryStore );\r\n\r\n\tconst shouldRemoveBlockTypes = useSelect( ( select ) => {\r\n\t\tconst { isAutosavingPost, isSavingPost } = select( editorStore );\r\n\t\treturn isSavingPost() && ! isAutosavingPost();\r\n\t}, [] );\r\n\r\n\tconst unusedBlockTypes = useSelect(\r\n\t\t( select ) => select( blockDirectoryStore ).getUnusedBlockTypes(),\r\n\t\t[]\r\n\t);\r\n\r\n\tuseEffect( () => {\r\n\t\tif ( shouldRemoveBlockTypes && unusedBlockTypes.length ) {\r\n\t\t\tunusedBlockTypes.forEach( ( blockType ) => {\r\n\t\t\t\tuninstallBlockType( blockType );\r\n\t\t\t\tunregisterBlockType( blockType.name );\r\n\t\t\t} );\r\n\t\t}\r\n\t}, [ shouldRemoveBlockTypes ] );\r\n\r\n\treturn null;\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,mBAAmB,QAAQ,mBAAmB;AACvD,SAASC,WAAW,EAAEC,SAAS,QAAQ,iBAAiB;AACxD,SAASC,SAAS,QAAQ,oBAAoB;AAC9C,SAASC,KAAK,IAAIC,WAAW,QAAQ,mBAAmB;;AAExD;AACA;AACA;AACA,SAASD,KAAK,IAAIE,mBAAmB,QAAQ,aAAa;AAE1D,eAAe,SAASC,oBAAoBA,CAAA,EAAG;EAC9C,MAAM;IAAEC;EAAmB,CAAC,GAAGP,WAAW,CAAEK,mBAAoB,CAAC;EAEjE,MAAMG,sBAAsB,GAAGP,SAAS,CAAIQ,MAAM,IAAM;IACvD,MAAM;MAAEC,gBAAgB;MAAEC;IAAa,CAAC,GAAGF,MAAM,CAAEL,WAAY,CAAC;IAChE,OAAOO,YAAY,CAAC,CAAC,IAAI,CAAED,gBAAgB,CAAC,CAAC;EAC9C,CAAC,EAAE,EAAG,CAAC;EAEP,MAAME,gBAAgB,GAAGX,SAAS,CAC/BQ,MAAM,IAAMA,MAAM,CAAEJ,mBAAoB,CAAC,CAACQ,mBAAmB,CAAC,CAAC,EACjE,EACD,CAAC;EAEDX,SAAS,CAAE,MAAM;IAChB,IAAKM,sBAAsB,IAAII,gBAAgB,CAACE,MAAM,EAAG;MACxDF,gBAAgB,CAACG,OAAO,CAAIC,SAAS,IAAM;QAC1CT,kBAAkB,CAAES,SAAU,CAAC;QAC/BjB,mBAAmB,CAAEiB,SAAS,CAACC,IAAK,CAAC;MACtC,CAAE,CAAC;IACJ;EACD,CAAC,EAAE,CAAET,sBAAsB,CAAG,CAAC;EAE/B,OAAO,IAAI;AACZ","ignoreList":[]}