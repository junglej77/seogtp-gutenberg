{"version":3,"names":["Text","TouchableWithoutFeedback","Linking","Alert","Platform","default","VideoPlayer","View","Icon","withPreferredColorScheme","__","audio","warning","requestImageFailedRetryDialog","requestImageUploadCancelDialog","getProtocol","useState","styles","parseAudioUrl","useEditorColorScheme","jsx","_jsx","jsxs","_jsxs","isIOS","OS","Player","isUploadInProgress","isUploadFailed","attributes","isSelected","id","src","paused","setPaused","onPressListen","player","presentFullscreenPlayer","canOpenURL","then","supported","alert","openURL","catch","containerStyle","container","containerDark","iconStyle","icon","iconDark","iconDisabledStyle","iconDisabled","iconDisabledDark","isDisabled","finalIconStyle","iconContainerStyle","iconContainer","iconContainerDark","titleContainerStyle","titleContainer","titleContainerIOS","titleContainerAndroid","titleStyle","title","titleDark","uploadFailedStyle","uploadFailed","uploadFailedDark","subtitleStyle","subtitle","subtitleDark","finalSubtitleStyle","buttonBackgroundStyle","buttonBackground","buttonBackgroundDark","extension","result","getSubtitleValue","onAudioUploadCancelDialog","accessible","disabled","onPress","children","style","size","subtitleContainer","errorIcon","accessibilityLabel","accessibilityRole","accessibilityHint","buttonText","source","uri","ref","controls","ignoreSilentSwitch","onFullscreenPlayerWillPresent","onFullscreenPlayerDidDismiss"],"sources":["@wordpress/block-editor/src/components/audio-player/index.native.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport {\r\n\tText,\r\n\tTouchableWithoutFeedback,\r\n\tLinking,\r\n\tAlert,\r\n\tPlatform,\r\n} from 'react-native';\r\nimport { default as VideoPlayer } from 'react-native-video';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { View } from '@wordpress/primitives';\r\nimport { Icon } from '@wordpress/components';\r\nimport { withPreferredColorScheme } from '@wordpress/compose';\r\nimport { __ } from '@wordpress/i18n';\r\nimport { audio, warning } from '@wordpress/icons';\r\nimport {\r\n\trequestImageFailedRetryDialog,\r\n\trequestImageUploadCancelDialog,\r\n} from '@wordpress/react-native-bridge';\r\nimport { getProtocol } from '@wordpress/url';\r\nimport { useState } from '@wordpress/element';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport styles from './styles.scss';\r\nimport { parseAudioUrl } from './audio-url-parser.native';\r\nimport { useEditorColorScheme } from '../global-styles/use-global-styles-context';\r\n\r\nconst isIOS = Platform.OS === 'ios';\r\n\r\nfunction Player( {\r\n\tisUploadInProgress,\r\n\tisUploadFailed,\r\n\tattributes,\r\n\tisSelected,\r\n} ) {\r\n\tconst { id, src } = attributes;\r\n\tconst [ paused, setPaused ] = useState( true );\r\n\r\n\tconst onPressListen = () => {\r\n\t\tif ( src ) {\r\n\t\t\tif ( isIOS && this.player ) {\r\n\t\t\t\tthis.player.presentFullscreenPlayer();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tLinking.canOpenURL( src )\r\n\t\t\t\t.then( ( supported ) => {\r\n\t\t\t\t\tif ( ! supported ) {\r\n\t\t\t\t\t\tAlert.alert(\r\n\t\t\t\t\t\t\t__( 'Problem opening the audio' ),\r\n\t\t\t\t\t\t\t__( 'No application can handle this request.' )\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn Linking.openURL( src );\r\n\t\t\t\t\t}\r\n\t\t\t\t} )\r\n\t\t\t\t.catch( () => {\r\n\t\t\t\t\tAlert.alert(\r\n\t\t\t\t\t\t__( 'Problem opening the audio' ),\r\n\t\t\t\t\t\t__( 'An unknown error occurred. Please try again.' )\r\n\t\t\t\t\t);\r\n\t\t\t\t} );\r\n\t\t}\r\n\t};\r\n\r\n\tconst containerStyle = useEditorColorScheme(\r\n\t\tstyles.container,\r\n\t\tstyles.containerDark\r\n\t);\r\n\r\n\tconst iconStyle = useEditorColorScheme( styles.icon, styles.iconDark );\r\n\r\n\tconst iconDisabledStyle = useEditorColorScheme(\r\n\t\tstyles.iconDisabled,\r\n\t\tstyles.iconDisabledDark\r\n\t);\r\n\r\n\tconst isDisabled = isUploadFailed || isUploadInProgress;\r\n\r\n\tconst finalIconStyle = {\r\n\t\t...iconStyle,\r\n\t\t...( isDisabled && iconDisabledStyle ),\r\n\t};\r\n\r\n\tconst iconContainerStyle = useEditorColorScheme(\r\n\t\tstyles.iconContainer,\r\n\t\tstyles.iconContainerDark\r\n\t);\r\n\r\n\tconst titleContainerStyle = {\r\n\t\t...styles.titleContainer,\r\n\t\t...( isIOS ? styles.titleContainerIOS : styles.titleContainerAndroid ),\r\n\t};\r\n\r\n\tconst titleStyle = useEditorColorScheme( styles.title, styles.titleDark );\r\n\r\n\tconst uploadFailedStyle = useEditorColorScheme(\r\n\t\tstyles.uploadFailed,\r\n\t\tstyles.uploadFailedDark\r\n\t);\r\n\r\n\tconst subtitleStyle = useEditorColorScheme(\r\n\t\tstyles.subtitle,\r\n\t\tstyles.subtitleDark\r\n\t);\r\n\r\n\tconst finalSubtitleStyle = {\r\n\t\t...subtitleStyle,\r\n\t\t...( isUploadFailed && uploadFailedStyle ),\r\n\t};\r\n\r\n\tconst buttonBackgroundStyle = useEditorColorScheme(\r\n\t\tstyles.buttonBackground,\r\n\t\tstyles.buttonBackgroundDark\r\n\t);\r\n\r\n\tlet title = '';\r\n\tlet extension = '';\r\n\r\n\tif ( src ) {\r\n\t\tconst result = parseAudioUrl( src );\r\n\t\textension = result.extension;\r\n\t\ttitle = result.title;\r\n\t}\r\n\r\n\tconst getSubtitleValue = () => {\r\n\t\tif ( isUploadInProgress ) {\r\n\t\t\treturn __( 'Uploadingâ€¦' );\r\n\t\t}\r\n\t\tif ( isUploadFailed ) {\r\n\t\t\treturn __( 'Failed to insert audio file. Please tap for options.' );\r\n\t\t}\r\n\t\treturn (\r\n\t\t\textension +\r\n\t\t\t// translators: displays audio file extension. e.g. MP3 audio file\r\n\t\t\t__( 'audio file' )\r\n\t\t);\r\n\t};\r\n\r\n\tfunction onAudioUploadCancelDialog() {\r\n\t\tif ( isUploadInProgress ) {\r\n\t\t\trequestImageUploadCancelDialog( id );\r\n\t\t} else if ( id && getProtocol( src ) === 'file:' ) {\r\n\t\t\trequestImageFailedRetryDialog( id );\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<TouchableWithoutFeedback\r\n\t\t\taccessible={ ! isSelected }\r\n\t\t\tdisabled={ ! isSelected }\r\n\t\t\tonPress={ onAudioUploadCancelDialog }\r\n\t\t>\r\n\t\t\t<View style={ containerStyle }>\r\n\t\t\t\t<View style={ iconContainerStyle }>\r\n\t\t\t\t\t<Icon icon={ audio } style={ finalIconStyle } size={ 24 } />\r\n\t\t\t\t</View>\r\n\t\t\t\t<View style={ titleContainerStyle }>\r\n\t\t\t\t\t<Text style={ titleStyle }>{ title }</Text>\r\n\t\t\t\t\t<View style={ styles.subtitleContainer }>\r\n\t\t\t\t\t\t{ isUploadFailed && (\r\n\t\t\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t\t\ticon={ warning }\r\n\t\t\t\t\t\t\t\tstyle={ {\r\n\t\t\t\t\t\t\t\t\t...styles.errorIcon,\r\n\t\t\t\t\t\t\t\t\t...uploadFailedStyle,\r\n\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t\tsize={ 16 }\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t<Text style={ finalSubtitleStyle }>\r\n\t\t\t\t\t\t\t{ getSubtitleValue() }\r\n\t\t\t\t\t\t</Text>\r\n\t\t\t\t\t</View>\r\n\t\t\t\t</View>\r\n\t\t\t\t{ ! isDisabled && (\r\n\t\t\t\t\t<TouchableWithoutFeedback\r\n\t\t\t\t\t\taccessibilityLabel={ __( 'Audio Player' ) }\r\n\t\t\t\t\t\taccessibilityRole=\"button\"\r\n\t\t\t\t\t\taccessibilityHint={ __(\r\n\t\t\t\t\t\t\t'Double tap to listen the audio file'\r\n\t\t\t\t\t\t) }\r\n\t\t\t\t\t\tonPress={ onPressListen }\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<View style={ buttonBackgroundStyle }>\r\n\t\t\t\t\t\t\t<Text style={ styles.buttonText }>\r\n\t\t\t\t\t\t\t\t{ __( 'OPEN' ) }\r\n\t\t\t\t\t\t\t</Text>\r\n\t\t\t\t\t\t</View>\r\n\t\t\t\t\t</TouchableWithoutFeedback>\r\n\t\t\t\t) }\r\n\t\t\t\t{ isIOS && (\r\n\t\t\t\t\t<VideoPlayer\r\n\t\t\t\t\t\tsource={ { uri: src } }\r\n\t\t\t\t\t\tpaused={ paused }\r\n\t\t\t\t\t\tref={ ( ref ) => {\r\n\t\t\t\t\t\t\tthis.player = ref;\r\n\t\t\t\t\t\t} }\r\n\t\t\t\t\t\tcontrols={ false }\r\n\t\t\t\t\t\tignoreSilentSwitch=\"ignore\"\r\n\t\t\t\t\t\tonFullscreenPlayerWillPresent={ () => {\r\n\t\t\t\t\t\t\tsetPaused( false );\r\n\t\t\t\t\t\t} }\r\n\t\t\t\t\t\tonFullscreenPlayerDidDismiss={ () => {\r\n\t\t\t\t\t\t\tsetPaused( true );\r\n\t\t\t\t\t\t} }\r\n\t\t\t\t\t/>\r\n\t\t\t\t) }\r\n\t\t\t</View>\r\n\t\t</TouchableWithoutFeedback>\r\n\t);\r\n}\r\n\r\nexport default withPreferredColorScheme( Player );\r\n"],"mappings":"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","ignoreList":[]}