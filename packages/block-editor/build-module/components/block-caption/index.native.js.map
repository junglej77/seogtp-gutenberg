{"version":3,"names":["View","Caption","RichText","compose","withDispatch","withSelect","hasBlockSupport","styles","store","blockEditorStore","jsx","_jsx","BlockCaption","accessible","accessibilityLabelCreator","onBlur","onChange","onFocus","isSelected","shouldDisplay","text","insertBlocksAfter","style","container","padding","children","value","select","clientId","getBlockAttributes","getSelectedBlockClientId","getBlockName","getBlockRootClientId","caption","isBlockSelected","parentId","parentBlockName","hideCaption","isEmpty","dispatch","updateBlockAttributes"],"sources":["@wordpress/block-editor/src/components/block-caption/index.native.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport { View } from 'react-native';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { Caption, RichText } from '@wordpress/block-editor';\r\nimport { compose } from '@wordpress/compose';\r\nimport { withDispatch, withSelect } from '@wordpress/data';\r\nimport { hasBlockSupport } from '@wordpress/blocks';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport styles from './styles.scss';\r\nimport { store as blockEditorStore } from '../../store';\r\n\r\nconst BlockCaption = ( {\r\n\taccessible,\r\n\taccessibilityLabelCreator,\r\n\tonBlur,\r\n\tonChange,\r\n\tonFocus,\r\n\tisSelected,\r\n\tshouldDisplay,\r\n\ttext,\r\n\tinsertBlocksAfter,\r\n} ) => (\r\n\t<View style={ [ styles.container, shouldDisplay && styles.padding ] }>\r\n\t\t<Caption\r\n\t\t\taccessibilityLabelCreator={ accessibilityLabelCreator }\r\n\t\t\taccessible={ accessible }\r\n\t\t\tisSelected={ isSelected }\r\n\t\t\tonBlur={ onBlur }\r\n\t\t\tonChange={ onChange }\r\n\t\t\tonFocus={ onFocus }\r\n\t\t\tshouldDisplay={ shouldDisplay }\r\n\t\t\tvalue={ text }\r\n\t\t\tinsertBlocksAfter={ insertBlocksAfter }\r\n\t\t/>\r\n\t</View>\r\n);\r\n\r\nexport default compose( [\r\n\twithSelect( ( select, { clientId } ) => {\r\n\t\tconst {\r\n\t\t\tgetBlockAttributes,\r\n\t\t\tgetSelectedBlockClientId,\r\n\t\t\tgetBlockName,\r\n\t\t\tgetBlockRootClientId,\r\n\t\t} = select( blockEditorStore );\r\n\t\tconst { caption } = getBlockAttributes( clientId ) || {};\r\n\t\tconst isBlockSelected = getSelectedBlockClientId() === clientId;\r\n\r\n\t\t// Detect whether the block is an inner block by checking if it has a parent block.\r\n\t\t// getBlockRootClientId() will return an empty string for all top-level blocks.\r\n\t\t// If the block is an inner block, its parent may explicitly hide child block controls.\r\n\t\t// See: https://github.com/wordpress-mobile/gutenberg-mobile/pull/4256\r\n\t\tconst parentId = getBlockRootClientId( clientId );\r\n\t\tconst parentBlockName = getBlockName( parentId );\r\n\r\n\t\tconst hideCaption = hasBlockSupport(\r\n\t\t\tparentBlockName,\r\n\t\t\t'__experimentalHideChildBlockControls',\r\n\t\t\tfalse\r\n\t\t);\r\n\r\n\t\t// We'll render the caption so that the soft keyboard is not forced to close on Android\r\n\t\t// but still hide it by setting its display style to none. See wordpress-mobile/gutenberg-mobile#1221\r\n\t\tconst shouldDisplay =\r\n\t\t\t! hideCaption &&\r\n\t\t\t( ! RichText.isEmpty( caption ) > 0 || isBlockSelected );\r\n\r\n\t\treturn {\r\n\t\t\tshouldDisplay,\r\n\t\t\ttext: caption,\r\n\t\t};\r\n\t} ),\r\n\twithDispatch( ( dispatch, { clientId } ) => {\r\n\t\tconst { updateBlockAttributes } = dispatch( blockEditorStore );\r\n\t\treturn {\r\n\t\t\tonChange: ( caption ) => {\r\n\t\t\t\tupdateBlockAttributes( clientId, { caption } );\r\n\t\t\t},\r\n\t\t};\r\n\t} ),\r\n] )( BlockCaption );\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,IAAI,QAAQ,cAAc;;AAEnC;AACA;AACA;AACA,SAASC,OAAO,EAAEC,QAAQ,QAAQ,yBAAyB;AAC3D,SAASC,OAAO,QAAQ,oBAAoB;AAC5C,SAASC,YAAY,EAAEC,UAAU,QAAQ,iBAAiB;AAC1D,SAASC,eAAe,QAAQ,mBAAmB;;AAEnD;AACA;AACA;AACA,OAAOC,MAAM,MAAM,eAAe;AAClC,SAASC,KAAK,IAAIC,gBAAgB,QAAQ,aAAa;AAAC,SAAAC,GAAA,IAAAC,IAAA;AAExD,MAAMC,YAAY,GAAGA,CAAE;EACtBC,UAAU;EACVC,yBAAyB;EACzBC,MAAM;EACNC,QAAQ;EACRC,OAAO;EACPC,UAAU;EACVC,aAAa;EACbC,IAAI;EACJC;AACD,CAAC,kBACAV,IAAA,CAACX,IAAI;EAACsB,KAAK,EAAG,CAAEf,MAAM,CAACgB,SAAS,EAAEJ,aAAa,IAAIZ,MAAM,CAACiB,OAAO,CAAI;EAAAC,QAAA,eACpEd,IAAA,CAACV,OAAO;IACPa,yBAAyB,EAAGA,yBAA2B;IACvDD,UAAU,EAAGA,UAAY;IACzBK,UAAU,EAAGA,UAAY;IACzBH,MAAM,EAAGA,MAAQ;IACjBC,QAAQ,EAAGA,QAAU;IACrBC,OAAO,EAAGA,OAAS;IACnBE,aAAa,EAAGA,aAAe;IAC/BO,KAAK,EAAGN,IAAM;IACdC,iBAAiB,EAAGA;EAAmB,CACvC;AAAC,CACG,CACN;AAED,eAAelB,OAAO,CAAE,CACvBE,UAAU,CAAE,CAAEsB,MAAM,EAAE;EAAEC;AAAS,CAAC,KAAM;EACvC,MAAM;IACLC,kBAAkB;IAClBC,wBAAwB;IACxBC,YAAY;IACZC;EACD,CAAC,GAAGL,MAAM,CAAElB,gBAAiB,CAAC;EAC9B,MAAM;IAAEwB;EAAQ,CAAC,GAAGJ,kBAAkB,CAAED,QAAS,CAAC,IAAI,CAAC,CAAC;EACxD,MAAMM,eAAe,GAAGJ,wBAAwB,CAAC,CAAC,KAAKF,QAAQ;;EAE/D;EACA;EACA;EACA;EACA,MAAMO,QAAQ,GAAGH,oBAAoB,CAAEJ,QAAS,CAAC;EACjD,MAAMQ,eAAe,GAAGL,YAAY,CAAEI,QAAS,CAAC;EAEhD,MAAME,WAAW,GAAG/B,eAAe,CAClC8B,eAAe,EACf,sCAAsC,EACtC,KACD,CAAC;;EAED;EACA;EACA,MAAMjB,aAAa,GAClB,CAAEkB,WAAW,KACX,CAAEnC,QAAQ,CAACoC,OAAO,CAAEL,OAAQ,CAAC,GAAG,CAAC,IAAIC,eAAe,CAAE;EAEzD,OAAO;IACNf,aAAa;IACbC,IAAI,EAAEa;EACP,CAAC;AACF,CAAE,CAAC,EACH7B,YAAY,CAAE,CAAEmC,QAAQ,EAAE;EAAEX;AAAS,CAAC,KAAM;EAC3C,MAAM;IAAEY;EAAsB,CAAC,GAAGD,QAAQ,CAAE9B,gBAAiB,CAAC;EAC9D,OAAO;IACNO,QAAQ,EAAIiB,OAAO,IAAM;MACxBO,qBAAqB,CAAEZ,QAAQ,EAAE;QAAEK;MAAQ,CAAE,CAAC;IAC/C;EACD,CAAC;AACF,CAAE,CAAC,CACF,CAAC,CAAErB,YAAa,CAAC","ignoreList":[]}