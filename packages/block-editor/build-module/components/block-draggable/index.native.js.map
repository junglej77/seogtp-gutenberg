{"version":3,"names":["AccessibilityInfo","useSafeAreaInsets","useSafeAreaFrame","Animated","runOnJS","runOnUI","useAnimatedStyle","useSharedValue","withDelay","withTiming","ZoomInEasyDown","Draggable","DraggableTrigger","select","useSelect","useDispatch","useCallback","useEffect","useRef","useState","Platform","getBlockType","generateHapticFeedback","RCTAztecView","useScrollWhenDragging","DraggableChip","store","blockEditorStore","DroppingInsertionPoint","useBlockDropZone","styles","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","CHIP_OFFSET_TO_TOUCH_POSITION","BLOCK_OPACITY_ANIMATION_CONFIG","duration","BLOCK_OPACITY_ANIMATION_DELAY","DEFAULT_LONG_PRESS_MIN_DURATION","DEFAULT_IOS_LONG_PRESS_MIN_DURATION","BlockDraggableWrapper","children","isRTL","draggedBlockIcon","setDraggedBlockIcon","selectBlock","startDraggingBlocks","stopDraggingBlocks","left","right","width","safeAreaOffset","contentWidth","scroll","offsetY","chip","x","y","height","currentYPosition","isDragging","startScrolling","scrollOnDragOver","stopScrolling","draggingScrollHandler","scrollHandler","event","contentOffset","value","onBlockDragOverWorklet","onBlockDragEnd","onBlockDrop","targetBlockIndex","setDraggedBlockIconByClientId","clientId","blockName","getBlockName","blockIcon","icon","onStartDragging","position","stopDragging","onStopDragging","srcRootClientId","srcClientIds","type","undefined","onChipLayout","nativeEvent","layout","startDragging","id","dragPosition","updateDragging","chipDynamicStyles","chipOffset","translateX","transform","translateY","chipStyles","exitingAnimation","currentHeight","currentWidth","animations","scale","initialValues","onDragStart","onDragOver","onDragEnd","testID","onScroll","View","onLayout","style","pointerEvents","entering","exiting","useIsScreenReaderEnabled","isScreenReaderEnabled","setIsScreenReaderEnabled","mounted","changeListener","addEventListener","enabled","then","screenReaderEnabled","remove","useIsEditingText","isEditingText","setIsEditingText","InputState","isFocused","onFocusChangeAztec","addFocusChangeListener","removeFocusChangeListener","BlockDraggable","draggingClientId","wasBeingDragged","draggingAnimation","opacity","startDraggingBlock","stopDraggingBlock","isDraggable","isBeingDragged","isBlockSelected","_select","getBlockRootClientId","getTemplateLock","isBlockBeingDragged","getSelectedBlockClientId","rootClientId","templateLock","selectedBlockClientId","current","onLongPressDraggable","blurCurrentFocusedElement","animatedWrapperStyles","wrapperStyles","canDragBlock","minDuration","ios","android","onLongPress"],"sources":["@wordpress/block-editor/src/components/block-draggable/index.native.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport { AccessibilityInfo } from 'react-native';\r\nimport {\r\n\tuseSafeAreaInsets,\r\n\tuseSafeAreaFrame,\r\n} from 'react-native-safe-area-context';\r\nimport Animated, {\r\n\trunOnJS,\r\n\trunOnUI,\r\n\tuseAnimatedStyle,\r\n\tuseSharedValue,\r\n\twithDelay,\r\n\twithTiming,\r\n\tZoomInEasyDown,\r\n} from 'react-native-reanimated';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { Draggable, DraggableTrigger } from '@wordpress/components';\r\nimport { select, useSelect, useDispatch } from '@wordpress/data';\r\nimport {\r\n\tuseCallback,\r\n\tuseEffect,\r\n\tuseRef,\r\n\tuseState,\r\n\tPlatform,\r\n} from '@wordpress/element';\r\nimport { getBlockType } from '@wordpress/blocks';\r\nimport { generateHapticFeedback } from '@wordpress/react-native-bridge';\r\nimport RCTAztecView from '@wordpress/react-native-aztec';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport useScrollWhenDragging from './use-scroll-when-dragging';\r\nimport DraggableChip from './draggable-chip';\r\nimport { store as blockEditorStore } from '../../store';\r\nimport DroppingInsertionPoint from './dropping-insertion-point';\r\nimport useBlockDropZone from '../use-block-drop-zone';\r\nimport styles from './style.scss';\r\n\r\nconst CHIP_OFFSET_TO_TOUCH_POSITION = 32;\r\nconst BLOCK_OPACITY_ANIMATION_CONFIG = { duration: 350 };\r\nconst BLOCK_OPACITY_ANIMATION_DELAY = 250;\r\nconst DEFAULT_LONG_PRESS_MIN_DURATION = 500;\r\nconst DEFAULT_IOS_LONG_PRESS_MIN_DURATION =\r\n\tDEFAULT_LONG_PRESS_MIN_DURATION - 50;\r\n\r\n/**\r\n * Block draggable wrapper component\r\n *\r\n * This component handles all the interactions for dragging blocks.\r\n * It relies on the block list and its context for dragging, hence it\r\n * should be rendered between the `BlockListProvider` component and the\r\n * block list rendering. It also requires listening to scroll events,\r\n * therefore for this purpose, it returns the `onScroll` event handler\r\n * that should be attached to the list that renders the blocks.\r\n *\r\n *\r\n * @param {Object}      props          Component props.\r\n * @param {JSX.Element} props.children Children to be rendered.\r\n * @param {boolean}     props.isRTL    Check if current locale is RTL.\r\n *\r\n * @return {Function} Render function that passes `onScroll` event handler.\r\n */\r\nconst BlockDraggableWrapper = ( { children, isRTL } ) => {\r\n\tconst [ draggedBlockIcon, setDraggedBlockIcon ] = useState();\r\n\r\n\tconst { selectBlock, startDraggingBlocks, stopDraggingBlocks } =\r\n\t\tuseDispatch( blockEditorStore );\r\n\r\n\tconst { left, right } = useSafeAreaInsets();\r\n\tconst { width } = useSafeAreaFrame();\r\n\tconst safeAreaOffset = left + right;\r\n\tconst contentWidth = width - safeAreaOffset;\r\n\r\n\tconst scroll = {\r\n\t\toffsetY: useSharedValue( 0 ),\r\n\t};\r\n\tconst chip = {\r\n\t\tx: useSharedValue( 0 ),\r\n\t\ty: useSharedValue( 0 ),\r\n\t\twidth: useSharedValue( 0 ),\r\n\t\theight: useSharedValue( 0 ),\r\n\t};\r\n\tconst currentYPosition = useSharedValue( 0 );\r\n\tconst isDragging = useSharedValue( false );\r\n\r\n\tconst [\r\n\t\tstartScrolling,\r\n\t\tscrollOnDragOver,\r\n\t\tstopScrolling,\r\n\t\tdraggingScrollHandler,\r\n\t] = useScrollWhenDragging();\r\n\r\n\tconst scrollHandler = ( event ) => {\r\n\t\t'worklet';\r\n\t\tconst { contentOffset } = event;\r\n\t\tscroll.offsetY.value = contentOffset.y;\r\n\r\n\t\tdraggingScrollHandler( event );\r\n\t};\r\n\r\n\tconst {\r\n\t\tonBlockDragOverWorklet,\r\n\t\tonBlockDragEnd,\r\n\t\tonBlockDrop,\r\n\t\ttargetBlockIndex,\r\n\t} = useBlockDropZone();\r\n\r\n\t// Stop dragging blocks if the block draggable is unmounted.\r\n\tuseEffect( () => {\r\n\t\treturn () => {\r\n\t\t\tif ( isDragging.value ) {\r\n\t\t\t\tstopDraggingBlocks();\r\n\t\t\t}\r\n\t\t};\r\n\t}, [] );\r\n\r\n\tconst setDraggedBlockIconByClientId = ( clientId ) => {\r\n\t\tconst blockName = select( blockEditorStore ).getBlockName( clientId );\r\n\t\tconst blockIcon = getBlockType( blockName )?.icon;\r\n\t\tif ( blockIcon ) {\r\n\t\t\tsetDraggedBlockIcon( blockIcon );\r\n\t\t}\r\n\t};\r\n\r\n\tconst onStartDragging = ( { clientId, position } ) => {\r\n\t\tif ( clientId ) {\r\n\t\t\tstartDraggingBlocks( [ clientId ] );\r\n\t\t\tsetDraggedBlockIconByClientId( clientId );\r\n\t\t\trunOnUI( startScrolling )( position.y );\r\n\t\t\tgenerateHapticFeedback();\r\n\t\t} else {\r\n\t\t\t// We stop dragging if no block is found.\r\n\t\t\trunOnUI( stopDragging )();\r\n\t\t}\r\n\t};\r\n\r\n\tconst onStopDragging = ( { clientId } ) => {\r\n\t\tif ( clientId ) {\r\n\t\t\tonBlockDrop( {\r\n\t\t\t\t// Dropping is only allowed at root level\r\n\t\t\t\tsrcRootClientId: '',\r\n\t\t\t\tsrcClientIds: [ clientId ],\r\n\t\t\t\ttype: 'block',\r\n\t\t\t} );\r\n\t\t\tselectBlock( clientId );\r\n\t\t\tsetDraggedBlockIcon( undefined );\r\n\t\t}\r\n\t\tonBlockDragEnd();\r\n\t\tstopDraggingBlocks();\r\n\t};\r\n\r\n\tconst onChipLayout = ( { nativeEvent: { layout } } ) => {\r\n\t\tif ( layout.width > 0 ) {\r\n\t\t\tchip.width.value = layout.width;\r\n\t\t}\r\n\t\tif ( layout.height > 0 ) {\r\n\t\t\tchip.height.value = layout.height;\r\n\t\t}\r\n\t};\r\n\r\n\tconst startDragging = ( { x, y, id } ) => {\r\n\t\t'worklet';\r\n\t\tconst dragPosition = { x, y };\r\n\t\tchip.x.value = dragPosition.x;\r\n\t\tchip.y.value = dragPosition.y;\r\n\t\tcurrentYPosition.value = dragPosition.y;\r\n\r\n\t\tisDragging.value = true;\r\n\r\n\t\trunOnJS( onStartDragging )( { clientId: id, position: dragPosition } );\r\n\t};\r\n\r\n\tconst updateDragging = ( { x, y } ) => {\r\n\t\t'worklet';\r\n\t\tconst dragPosition = { x, y };\r\n\t\tchip.x.value = dragPosition.x;\r\n\t\tchip.y.value = dragPosition.y;\r\n\t\tcurrentYPosition.value = dragPosition.y;\r\n\r\n\t\tonBlockDragOverWorklet( { x, y: y + scroll.offsetY.value } );\r\n\r\n\t\t// Update scrolling velocity\r\n\t\tscrollOnDragOver( dragPosition.y );\r\n\t};\r\n\r\n\tconst stopDragging = ( { id } ) => {\r\n\t\t'worklet';\r\n\t\tisDragging.value = false;\r\n\r\n\t\tstopScrolling();\r\n\t\trunOnJS( onStopDragging )( { clientId: id } );\r\n\t};\r\n\r\n\tconst chipDynamicStyles = useAnimatedStyle( () => {\r\n\t\tconst chipOffset = chip.width.value / 2;\r\n\t\tconst translateX = ! isRTL\r\n\t\t\t? chip.x.value - chipOffset\r\n\t\t\t: -( contentWidth - ( chip.x.value + chipOffset ) );\r\n\r\n\t\treturn {\r\n\t\t\ttransform: [\r\n\t\t\t\t{\r\n\t\t\t\t\ttranslateX,\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttranslateY:\r\n\t\t\t\t\t\tchip.y.value -\r\n\t\t\t\t\t\tchip.height.value -\r\n\t\t\t\t\t\tCHIP_OFFSET_TO_TOUCH_POSITION,\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t};\r\n\t} );\r\n\tconst chipStyles = [\r\n\t\tchipDynamicStyles,\r\n\t\tstyles[ 'draggable-chip__wrapper' ],\r\n\t];\r\n\r\n\tconst exitingAnimation = ( { currentHeight, currentWidth } ) => {\r\n\t\t'worklet';\r\n\t\tconst translateX = ! isRTL ? 0 : currentWidth * -1;\r\n\t\tconst duration = 150;\r\n\t\tconst animations = {\r\n\t\t\ttransform: [\r\n\t\t\t\t{\r\n\t\t\t\t\ttranslateY: withTiming( currentHeight, {\r\n\t\t\t\t\t\tduration,\r\n\t\t\t\t\t} ),\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttranslateX: withTiming( translateX, {\r\n\t\t\t\t\t\tduration,\r\n\t\t\t\t\t} ),\r\n\t\t\t\t},\r\n\t\t\t\t{ scale: withTiming( 0, { duration } ) },\r\n\t\t\t],\r\n\t\t};\r\n\t\tconst initialValues = {\r\n\t\t\ttransform: [ { translateY: 0 }, { translateX }, { scale: 1 } ],\r\n\t\t};\r\n\t\treturn {\r\n\t\t\tinitialValues,\r\n\t\t\tanimations,\r\n\t\t};\r\n\t};\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<DroppingInsertionPoint\r\n\t\t\t\tscroll={ scroll }\r\n\t\t\t\tcurrentYPosition={ currentYPosition }\r\n\t\t\t\tisDragging={ isDragging }\r\n\t\t\t\ttargetBlockIndex={ targetBlockIndex }\r\n\t\t\t/>\r\n\t\t\t<Draggable\r\n\t\t\t\tonDragStart={ startDragging }\r\n\t\t\t\tonDragOver={ updateDragging }\r\n\t\t\t\tonDragEnd={ stopDragging }\r\n\t\t\t\ttestID=\"block-draggable-wrapper\"\r\n\t\t\t>\r\n\t\t\t\t{ children( { onScroll: scrollHandler } ) }\r\n\t\t\t</Draggable>\r\n\t\t\t<Animated.View\r\n\t\t\t\tonLayout={ onChipLayout }\r\n\t\t\t\tstyle={ chipStyles }\r\n\t\t\t\tpointerEvents=\"none\"\r\n\t\t\t>\r\n\t\t\t\t{ draggedBlockIcon && (\r\n\t\t\t\t\t<Animated.View\r\n\t\t\t\t\t\tentering={ ZoomInEasyDown.duration( 200 ) }\r\n\t\t\t\t\t\texiting={ exitingAnimation }\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<DraggableChip icon={ draggedBlockIcon } />\r\n\t\t\t\t\t</Animated.View>\r\n\t\t\t\t) }\r\n\t\t\t</Animated.View>\r\n\t\t</>\r\n\t);\r\n};\r\n\r\nfunction useIsScreenReaderEnabled() {\r\n\tconst [ isScreenReaderEnabled, setIsScreenReaderEnabled ] =\r\n\t\tuseState( false );\r\n\r\n\tuseEffect( () => {\r\n\t\tlet mounted = true;\r\n\r\n\t\tconst changeListener = AccessibilityInfo.addEventListener(\r\n\t\t\t'screenReaderChanged',\r\n\t\t\t( enabled ) => setIsScreenReaderEnabled( enabled )\r\n\t\t);\r\n\r\n\t\tAccessibilityInfo.isScreenReaderEnabled().then(\r\n\t\t\t( screenReaderEnabled ) => {\r\n\t\t\t\tif ( mounted && screenReaderEnabled ) {\r\n\t\t\t\t\tsetIsScreenReaderEnabled( screenReaderEnabled );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\treturn () => {\r\n\t\t\tmounted = false;\r\n\r\n\t\t\tchangeListener.remove();\r\n\t\t};\r\n\t}, [] );\r\n\r\n\treturn isScreenReaderEnabled;\r\n}\r\n\r\nfunction useIsEditingText() {\r\n\tconst [ isEditingText, setIsEditingText ] = useState( () =>\r\n\t\tRCTAztecView.InputState.isFocused()\r\n\t);\r\n\r\n\tuseEffect( () => {\r\n\t\tconst onFocusChangeAztec = ( { isFocused } ) => {\r\n\t\t\tsetIsEditingText( isFocused );\r\n\t\t};\r\n\r\n\t\tRCTAztecView.InputState.addFocusChangeListener( onFocusChangeAztec );\r\n\r\n\t\treturn () => {\r\n\t\t\tRCTAztecView.InputState.removeFocusChangeListener(\r\n\t\t\t\tonFocusChangeAztec\r\n\t\t\t);\r\n\t\t};\r\n\t}, [] );\r\n\r\n\treturn isEditingText;\r\n}\r\n\r\n/**\r\n * Block draggable component\r\n *\r\n * This component serves for animating the block when it is being dragged.\r\n * Hence, it should be wrapped around the rendering of a block.\r\n *\r\n * @param {Object}      props                    Component props.\r\n * @param {JSX.Element} props.children           Children to be rendered.\r\n * @param {string}      props.clientId           Client id of the block.\r\n * @param {string}      [props.draggingClientId] Client id to use for dragging. If not defined, the value from `clientId` will be used.\r\n * @param {boolean}     [props.enabled]          Enables the draggable trigger.\r\n * @param {string}      [props.testID]           Id used for querying the long-press gesture handler in tests.\r\n *\r\n * @return {Function} Render function which includes the parameter `isDraggable` to determine if the block can be dragged.\r\n */\r\nconst BlockDraggable = ( {\r\n\tclientId,\r\n\tchildren,\r\n\tdraggingClientId,\r\n\tenabled = true,\r\n\ttestID,\r\n} ) => {\r\n\tconst wasBeingDragged = useRef( false );\r\n\tconst isEditingText = useIsEditingText();\r\n\tconst isScreenReaderEnabled = useIsScreenReaderEnabled();\r\n\r\n\tconst draggingAnimation = {\r\n\t\topacity: useSharedValue( 1 ),\r\n\t};\r\n\r\n\tconst startDraggingBlock = () => {\r\n\t\tdraggingAnimation.opacity.value = withTiming(\r\n\t\t\t0.4,\r\n\t\t\tBLOCK_OPACITY_ANIMATION_CONFIG\r\n\t\t);\r\n\t};\r\n\r\n\tconst stopDraggingBlock = () => {\r\n\t\tdraggingAnimation.opacity.value = withDelay(\r\n\t\t\tBLOCK_OPACITY_ANIMATION_DELAY,\r\n\t\t\twithTiming( 1, BLOCK_OPACITY_ANIMATION_CONFIG )\r\n\t\t);\r\n\t};\r\n\r\n\tconst { isDraggable, isBeingDragged, isBlockSelected } = useSelect(\r\n\t\t( _select ) => {\r\n\t\t\tconst {\r\n\t\t\t\tgetBlockRootClientId,\r\n\t\t\t\tgetTemplateLock,\r\n\t\t\t\tisBlockBeingDragged,\r\n\t\t\t\tgetSelectedBlockClientId,\r\n\t\t\t} = _select( blockEditorStore );\r\n\t\t\tconst rootClientId = getBlockRootClientId( clientId );\r\n\t\t\tconst templateLock = rootClientId\r\n\t\t\t\t? getTemplateLock( rootClientId )\r\n\t\t\t\t: null;\r\n\t\t\tconst selectedBlockClientId = getSelectedBlockClientId();\r\n\r\n\t\t\treturn {\r\n\t\t\t\tisBeingDragged: isBlockBeingDragged( clientId ),\r\n\t\t\t\tisDraggable: 'all' !== templateLock,\r\n\t\t\t\tisBlockSelected:\r\n\t\t\t\t\tselectedBlockClientId && selectedBlockClientId === clientId,\r\n\t\t\t};\r\n\t\t},\r\n\t\t[ clientId ]\r\n\t);\r\n\r\n\tuseEffect( () => {\r\n\t\tif ( isBeingDragged !== wasBeingDragged.current ) {\r\n\t\t\tif ( isBeingDragged ) {\r\n\t\t\t\tstartDraggingBlock();\r\n\t\t\t} else {\r\n\t\t\t\tstopDraggingBlock();\r\n\t\t\t}\r\n\t\t}\r\n\t\twasBeingDragged.current = isBeingDragged;\r\n\t}, [ isBeingDragged ] );\r\n\r\n\tconst onLongPressDraggable = useCallback( () => {\r\n\t\t// Ensure that no text input is focused when starting the dragging gesture in order to prevent conflicts with text editing.\r\n\t\tRCTAztecView.InputState.blurCurrentFocusedElement();\r\n\t}, [] );\r\n\r\n\tconst animatedWrapperStyles = useAnimatedStyle( () => {\r\n\t\treturn {\r\n\t\t\topacity: draggingAnimation.opacity.value,\r\n\t\t};\r\n\t} );\r\n\tconst wrapperStyles = [\r\n\t\tanimatedWrapperStyles,\r\n\t\tstyles[ 'draggable-wrapper__container' ],\r\n\t];\r\n\r\n\tconst canDragBlock =\r\n\t\tenabled &&\r\n\t\t! isScreenReaderEnabled &&\r\n\t\t( ! isBlockSelected || ! isEditingText );\r\n\r\n\tif ( ! isDraggable ) {\r\n\t\treturn children( { isDraggable: false } );\r\n\t}\r\n\r\n\treturn (\r\n\t\t<DraggableTrigger\r\n\t\t\tid={ draggingClientId || clientId }\r\n\t\t\tenabled={ enabled && canDragBlock }\r\n\t\t\tminDuration={ Platform.select( {\r\n\t\t\t\t// On iOS, using a lower min duration than the default\r\n\t\t\t\t// value prevents the long-press gesture from being\r\n\t\t\t\t// triggered in underneath elements. This is required to\r\n\t\t\t\t// prevent enabling text editing when dragging is available.\r\n\t\t\t\tios: canDragBlock\r\n\t\t\t\t\t? DEFAULT_IOS_LONG_PRESS_MIN_DURATION\r\n\t\t\t\t\t: DEFAULT_LONG_PRESS_MIN_DURATION,\r\n\t\t\t\tandroid: DEFAULT_LONG_PRESS_MIN_DURATION,\r\n\t\t\t} ) }\r\n\t\t\tonLongPress={ onLongPressDraggable }\r\n\t\t\ttestID={ testID }\r\n\t\t>\r\n\t\t\t<Animated.View style={ wrapperStyles }>\r\n\t\t\t\t{ children( { isDraggable: true } ) }\r\n\t\t\t</Animated.View>\r\n\t\t</DraggableTrigger>\r\n\t);\r\n};\r\n\r\nexport { BlockDraggableWrapper };\r\nexport default BlockDraggable;\r\n"],"mappings":"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","ignoreList":[]}