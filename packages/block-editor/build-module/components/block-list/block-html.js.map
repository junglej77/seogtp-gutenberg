{"version":3,"names":["TextareaAutosize","useEffect","useState","useSelect","useDispatch","getBlockAttributes","getBlockContent","getBlockType","getSaveContent","validateBlock","store","blockEditorStore","jsx","_jsx","BlockHTML","clientId","html","setHtml","block","select","getBlock","updateBlock","onChange","blockType","name","attributes","content","isValid","originalContent","className","value","onBlur","event","target"],"sources":["@wordpress/block-editor/src/components/block-list/block-html.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport TextareaAutosize from 'react-autosize-textarea';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { useEffect, useState } from '@wordpress/element';\r\nimport { useSelect, useDispatch } from '@wordpress/data';\r\nimport {\r\n\tgetBlockAttributes,\r\n\tgetBlockContent,\r\n\tgetBlockType,\r\n\tgetSaveContent,\r\n\tvalidateBlock,\r\n} from '@wordpress/blocks';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { store as blockEditorStore } from '../../store';\r\n\r\nfunction BlockHTML( { clientId } ) {\r\n\tconst [ html, setHtml ] = useState( '' );\r\n\tconst block = useSelect(\r\n\t\t( select ) => select( blockEditorStore ).getBlock( clientId ),\r\n\t\t[ clientId ]\r\n\t);\r\n\tconst { updateBlock } = useDispatch( blockEditorStore );\r\n\tconst onChange = () => {\r\n\t\tconst blockType = getBlockType( block.name );\r\n\r\n\t\tif ( ! blockType ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst attributes = getBlockAttributes(\r\n\t\t\tblockType,\r\n\t\t\thtml,\r\n\t\t\tblock.attributes\r\n\t\t);\r\n\r\n\t\t// If html is empty  we reset the block to the default HTML and mark it as valid to avoid triggering an error\r\n\t\tconst content = html ? html : getSaveContent( blockType, attributes );\r\n\t\tconst [ isValid ] = html\r\n\t\t\t? validateBlock( {\r\n\t\t\t\t\t...block,\r\n\t\t\t\t\tattributes,\r\n\t\t\t\t\toriginalContent: content,\r\n\t\t\t  } )\r\n\t\t\t: [ true ];\r\n\r\n\t\tupdateBlock( clientId, {\r\n\t\t\tattributes,\r\n\t\t\toriginalContent: content,\r\n\t\t\tisValid,\r\n\t\t} );\r\n\r\n\t\t// Ensure the state is updated if we reset so it displays the default content.\r\n\t\tif ( ! html ) {\r\n\t\t\tsetHtml( content );\r\n\t\t}\r\n\t};\r\n\r\n\tuseEffect( () => {\r\n\t\tsetHtml( getBlockContent( block ) );\r\n\t}, [ block ] );\r\n\r\n\treturn (\r\n\t\t<TextareaAutosize\r\n\t\t\tclassName=\"block-editor-block-list__block-html-textarea\"\r\n\t\t\tvalue={ html }\r\n\t\t\tonBlur={ onChange }\r\n\t\t\tonChange={ ( event ) => setHtml( event.target.value ) }\r\n\t\t/>\r\n\t);\r\n}\r\n\r\nexport default BlockHTML;\r\n"],"mappings":"AAAA;AACA;AACA;AACA,OAAOA,gBAAgB,MAAM,yBAAyB;;AAEtD;AACA;AACA;AACA,SAASC,SAAS,EAAEC,QAAQ,QAAQ,oBAAoB;AACxD,SAASC,SAAS,EAAEC,WAAW,QAAQ,iBAAiB;AACxD,SACCC,kBAAkB,EAClBC,eAAe,EACfC,YAAY,EACZC,cAAc,EACdC,aAAa,QACP,mBAAmB;;AAE1B;AACA;AACA;AACA,SAASC,KAAK,IAAIC,gBAAgB,QAAQ,aAAa;AAAC,SAAAC,GAAA,IAAAC,IAAA;AAExD,SAASC,SAASA,CAAE;EAAEC;AAAS,CAAC,EAAG;EAClC,MAAM,CAAEC,IAAI,EAAEC,OAAO,CAAE,GAAGf,QAAQ,CAAE,EAAG,CAAC;EACxC,MAAMgB,KAAK,GAAGf,SAAS,CACpBgB,MAAM,IAAMA,MAAM,CAAER,gBAAiB,CAAC,CAACS,QAAQ,CAAEL,QAAS,CAAC,EAC7D,CAAEA,QAAQ,CACX,CAAC;EACD,MAAM;IAAEM;EAAY,CAAC,GAAGjB,WAAW,CAAEO,gBAAiB,CAAC;EACvD,MAAMW,QAAQ,GAAGA,CAAA,KAAM;IACtB,MAAMC,SAAS,GAAGhB,YAAY,CAAEW,KAAK,CAACM,IAAK,CAAC;IAE5C,IAAK,CAAED,SAAS,EAAG;MAClB;IACD;IAEA,MAAME,UAAU,GAAGpB,kBAAkB,CACpCkB,SAAS,EACTP,IAAI,EACJE,KAAK,CAACO,UACP,CAAC;;IAED;IACA,MAAMC,OAAO,GAAGV,IAAI,GAAGA,IAAI,GAAGR,cAAc,CAAEe,SAAS,EAAEE,UAAW,CAAC;IACrE,MAAM,CAAEE,OAAO,CAAE,GAAGX,IAAI,GACrBP,aAAa,CAAE;MACf,GAAGS,KAAK;MACRO,UAAU;MACVG,eAAe,EAAEF;IACjB,CAAE,CAAC,GACH,CAAE,IAAI,CAAE;IAEXL,WAAW,CAAEN,QAAQ,EAAE;MACtBU,UAAU;MACVG,eAAe,EAAEF,OAAO;MACxBC;IACD,CAAE,CAAC;;IAEH;IACA,IAAK,CAAEX,IAAI,EAAG;MACbC,OAAO,CAAES,OAAQ,CAAC;IACnB;EACD,CAAC;EAEDzB,SAAS,CAAE,MAAM;IAChBgB,OAAO,CAAEX,eAAe,CAAEY,KAAM,CAAE,CAAC;EACpC,CAAC,EAAE,CAAEA,KAAK,CAAG,CAAC;EAEd,oBACCL,IAAA,CAACb,gBAAgB;IAChB6B,SAAS,EAAC,8CAA8C;IACxDC,KAAK,EAAGd,IAAM;IACde,MAAM,EAAGT,QAAU;IACnBA,QAAQ,EAAKU,KAAK,IAAMf,OAAO,CAAEe,KAAK,CAACC,MAAM,CAACH,KAAM;EAAG,CACvD,CAAC;AAEJ;AAEA,eAAehB,SAAS","ignoreList":[]}