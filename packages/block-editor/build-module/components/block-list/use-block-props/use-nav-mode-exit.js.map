{"version":3,"names":["useSelect","useDispatch","useRefEffect","store","blockEditorStore","useNavModeExit","clientId","isNavigationMode","isBlockSelected","setNavigationMode","selectBlock","node","onMouseDown","event","defaultPrevented","preventDefault","addEventListener","removeEventListener"],"sources":["@wordpress/block-editor/src/components/block-list/use-block-props/use-nav-mode-exit.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useSelect, useDispatch } from '@wordpress/data';\r\nimport { useRefEffect } from '@wordpress/compose';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { store as blockEditorStore } from '../../../store';\r\n\r\n/**\r\n * Allows navigation mode to be exited by clicking in the selected block.\r\n *\r\n * @param {string} clientId Block client ID.\r\n */\r\nexport function useNavModeExit( clientId ) {\r\n\tconst { isNavigationMode, isBlockSelected } = useSelect( blockEditorStore );\r\n\tconst { setNavigationMode, selectBlock } = useDispatch( blockEditorStore );\r\n\treturn useRefEffect(\r\n\t\t( node ) => {\r\n\t\t\tfunction onMouseDown( event ) {\r\n\t\t\t\t// Don't select a block if it's already handled by a child\r\n\t\t\t\t// block.\r\n\t\t\t\tif ( isNavigationMode() && ! event.defaultPrevented ) {\r\n\t\t\t\t\t// Prevent focus from moving to the block.\r\n\t\t\t\t\tevent.preventDefault();\r\n\r\n\t\t\t\t\t// When clicking on a selected block, exit navigation mode.\r\n\t\t\t\t\tif ( isBlockSelected( clientId ) ) {\r\n\t\t\t\t\t\tsetNavigationMode( false );\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tselectBlock( clientId );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tnode.addEventListener( 'mousedown', onMouseDown );\r\n\r\n\t\t\treturn () => {\r\n\t\t\t\tnode.removeEventListener( 'mousedown', onMouseDown );\r\n\t\t\t};\r\n\t\t},\r\n\t\t[ clientId, isNavigationMode, isBlockSelected, setNavigationMode ]\r\n\t);\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,SAAS,EAAEC,WAAW,QAAQ,iBAAiB;AACxD,SAASC,YAAY,QAAQ,oBAAoB;;AAEjD;AACA;AACA;AACA,SAASC,KAAK,IAAIC,gBAAgB,QAAQ,gBAAgB;;AAE1D;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,cAAcA,CAAEC,QAAQ,EAAG;EAC1C,MAAM;IAAEC,gBAAgB;IAAEC;EAAgB,CAAC,GAAGR,SAAS,CAAEI,gBAAiB,CAAC;EAC3E,MAAM;IAAEK,iBAAiB;IAAEC;EAAY,CAAC,GAAGT,WAAW,CAAEG,gBAAiB,CAAC;EAC1E,OAAOF,YAAY,CAChBS,IAAI,IAAM;IACX,SAASC,WAAWA,CAAEC,KAAK,EAAG;MAC7B;MACA;MACA,IAAKN,gBAAgB,CAAC,CAAC,IAAI,CAAEM,KAAK,CAACC,gBAAgB,EAAG;QACrD;QACAD,KAAK,CAACE,cAAc,CAAC,CAAC;;QAEtB;QACA,IAAKP,eAAe,CAAEF,QAAS,CAAC,EAAG;UAClCG,iBAAiB,CAAE,KAAM,CAAC;QAC3B,CAAC,MAAM;UACNC,WAAW,CAAEJ,QAAS,CAAC;QACxB;MACD;IACD;IAEAK,IAAI,CAACK,gBAAgB,CAAE,WAAW,EAAEJ,WAAY,CAAC;IAEjD,OAAO,MAAM;MACZD,IAAI,CAACM,mBAAmB,CAAE,WAAW,EAAEL,WAAY,CAAC;IACrD,CAAC;EACF,CAAC,EACD,CAAEN,QAAQ,EAAEC,gBAAgB,EAAEC,eAAe,EAAEC,iBAAiB,CACjE,CAAC;AACF","ignoreList":[]}