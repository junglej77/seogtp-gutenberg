{"version":3,"names":["useSelect","useDispatch","useRefEffect","store","blockEditorStore","jsx","_jsx","useBlockSelectionClearer","getSettings","hasSelectedBlock","hasMultiSelection","clearSelectedBlock","clearBlockSelection","isEnabled","node","onMouseDown","event","target","addEventListener","removeEventListener","BlockSelectionClearer","props","ref"],"sources":["@wordpress/block-editor/src/components/block-selection-clearer/index.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useSelect, useDispatch } from '@wordpress/data';\r\nimport { useRefEffect } from '@wordpress/compose';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { store as blockEditorStore } from '../../store';\r\n\r\n/**\r\n * Pass the returned ref callback to an element that should clear block\r\n * selection. Selection will only be cleared if the element is clicked directly,\r\n * not if a child element is clicked.\r\n *\r\n * @return {import('react').RefCallback} Ref callback.\r\n */\r\nexport function useBlockSelectionClearer() {\r\n\tconst { getSettings, hasSelectedBlock, hasMultiSelection } =\r\n\t\tuseSelect( blockEditorStore );\r\n\tconst { clearSelectedBlock } = useDispatch( blockEditorStore );\r\n\tconst { clearBlockSelection: isEnabled } = getSettings();\r\n\r\n\treturn useRefEffect(\r\n\t\t( node ) => {\r\n\t\t\tif ( ! isEnabled ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tfunction onMouseDown( event ) {\r\n\t\t\t\tif ( ! hasSelectedBlock() && ! hasMultiSelection() ) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Only handle clicks on the element, not the children.\r\n\t\t\t\tif ( event.target !== node ) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tclearSelectedBlock();\r\n\t\t\t}\r\n\r\n\t\t\tnode.addEventListener( 'mousedown', onMouseDown );\r\n\r\n\t\t\treturn () => {\r\n\t\t\t\tnode.removeEventListener( 'mousedown', onMouseDown );\r\n\t\t\t};\r\n\t\t},\r\n\t\t[ hasSelectedBlock, hasMultiSelection, clearSelectedBlock, isEnabled ]\r\n\t);\r\n}\r\n\r\nexport default function BlockSelectionClearer( props ) {\r\n\treturn <div ref={ useBlockSelectionClearer() } { ...props } />;\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,SAAS,EAAEC,WAAW,QAAQ,iBAAiB;AACxD,SAASC,YAAY,QAAQ,oBAAoB;;AAEjD;AACA;AACA;AACA,SAASC,KAAK,IAAIC,gBAAgB,QAAQ,aAAa;;AAEvD;AACA;AACA;AACA;AACA;AACA;AACA;AANA,SAAAC,GAAA,IAAAC,IAAA;AAOA,OAAO,SAASC,wBAAwBA,CAAA,EAAG;EAC1C,MAAM;IAAEC,WAAW;IAAEC,gBAAgB;IAAEC;EAAkB,CAAC,GACzDV,SAAS,CAAEI,gBAAiB,CAAC;EAC9B,MAAM;IAAEO;EAAmB,CAAC,GAAGV,WAAW,CAAEG,gBAAiB,CAAC;EAC9D,MAAM;IAAEQ,mBAAmB,EAAEC;EAAU,CAAC,GAAGL,WAAW,CAAC,CAAC;EAExD,OAAON,YAAY,CAChBY,IAAI,IAAM;IACX,IAAK,CAAED,SAAS,EAAG;MAClB;IACD;IAEA,SAASE,WAAWA,CAAEC,KAAK,EAAG;MAC7B,IAAK,CAAEP,gBAAgB,CAAC,CAAC,IAAI,CAAEC,iBAAiB,CAAC,CAAC,EAAG;QACpD;MACD;;MAEA;MACA,IAAKM,KAAK,CAACC,MAAM,KAAKH,IAAI,EAAG;QAC5B;MACD;MAEAH,kBAAkB,CAAC,CAAC;IACrB;IAEAG,IAAI,CAACI,gBAAgB,CAAE,WAAW,EAAEH,WAAY,CAAC;IAEjD,OAAO,MAAM;MACZD,IAAI,CAACK,mBAAmB,CAAE,WAAW,EAAEJ,WAAY,CAAC;IACrD,CAAC;EACF,CAAC,EACD,CAAEN,gBAAgB,EAAEC,iBAAiB,EAAEC,kBAAkB,EAAEE,SAAS,CACrE,CAAC;AACF;AAEA,eAAe,SAASO,qBAAqBA,CAAEC,KAAK,EAAG;EACtD,oBAAOf,IAAA;IAAKgB,GAAG,EAAGf,wBAAwB,CAAC,CAAG;IAAA,GAAMc;EAAK,CAAI,CAAC;AAC/D","ignoreList":[]}