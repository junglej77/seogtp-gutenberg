{"version":3,"names":["__","MenuGroup","MenuItem","getBlockMenuDefaultClassName","switchToBlockType","useState","useMemo","BlockIcon","PreviewBlockPopover","BlockVariationTransformations","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","useGroupedTransforms","possibleBlockTransformations","priorityContentTranformationBlocks","transformations","priorityTextTranformsNames","Object","keys","groupedPossibleTransforms","reduce","accumulator","item","name","includes","priorityTextTransformations","push","restTransformations","length","singleQuote","pop","sort","currentName","nextName","BlockTransformationsMenu","className","possibleBlockVariationTransformations","onSelect","onSelectVariation","blocks","hoveredTransformItemName","setHoveredTransformItemName","hasBothContentTransformations","restTransformItems","RestTransformationItems","children","label","map","BlockTranformationItem","icon","title","isDisabled","onClick","event","preventDefault","disabled","onMouseLeave","onMouseEnter","showColors"],"sources":["@wordpress/block-editor/src/components/block-switcher/block-transformations-menu.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { __ } from '@wordpress/i18n';\r\nimport { MenuGroup, MenuItem } from '@wordpress/components';\r\nimport {\r\n\tgetBlockMenuDefaultClassName,\r\n\tswitchToBlockType,\r\n} from '@wordpress/blocks';\r\nimport { useState, useMemo } from '@wordpress/element';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport BlockIcon from '../block-icon';\r\nimport PreviewBlockPopover from './preview-block-popover';\r\nimport BlockVariationTransformations from './block-variation-transformations';\r\n\r\n/**\r\n * Helper hook to group transformations to display them in a specific order in the UI.\r\n * For now we group only priority content driven transformations(ex. paragraph -> heading).\r\n *\r\n * Later on we could also group 'layout' transformations(ex. paragraph -> group) and\r\n * display them in different sections.\r\n *\r\n * @param {Object[]} possibleBlockTransformations The available block transformations.\r\n * @return {Record<string, Object[]>} The grouped block transformations.\r\n */\r\nfunction useGroupedTransforms( possibleBlockTransformations ) {\r\n\tconst priorityContentTranformationBlocks = {\r\n\t\t'core/paragraph': 1,\r\n\t\t'core/heading': 2,\r\n\t\t'core/list': 3,\r\n\t\t'core/quote': 4,\r\n\t};\r\n\tconst transformations = useMemo( () => {\r\n\t\tconst priorityTextTranformsNames = Object.keys(\r\n\t\t\tpriorityContentTranformationBlocks\r\n\t\t);\r\n\t\tconst groupedPossibleTransforms = possibleBlockTransformations.reduce(\r\n\t\t\t( accumulator, item ) => {\r\n\t\t\t\tconst { name } = item;\r\n\t\t\t\tif ( priorityTextTranformsNames.includes( name ) ) {\r\n\t\t\t\t\taccumulator.priorityTextTransformations.push( item );\r\n\t\t\t\t} else {\r\n\t\t\t\t\taccumulator.restTransformations.push( item );\r\n\t\t\t\t}\r\n\t\t\t\treturn accumulator;\r\n\t\t\t},\r\n\t\t\t{ priorityTextTransformations: [], restTransformations: [] }\r\n\t\t);\r\n\t\t/**\r\n\t\t * If there is only one priority text transformation and it's a Quote,\r\n\t\t * is should move to the rest transformations. This is because Quote can\r\n\t\t * be a container for any block type, so in multi-block selection it will\r\n\t\t * always be suggested, even for non-text blocks.\r\n\t\t */\r\n\t\tif (\r\n\t\t\tgroupedPossibleTransforms.priorityTextTransformations.length ===\r\n\t\t\t\t1 &&\r\n\t\t\tgroupedPossibleTransforms.priorityTextTransformations[ 0 ].name ===\r\n\t\t\t\t'core/quote'\r\n\t\t) {\r\n\t\t\tconst singleQuote =\r\n\t\t\t\tgroupedPossibleTransforms.priorityTextTransformations.pop();\r\n\t\t\tgroupedPossibleTransforms.restTransformations.push( singleQuote );\r\n\t\t}\r\n\t\treturn groupedPossibleTransforms;\r\n\t}, [ possibleBlockTransformations ] );\r\n\r\n\t// Order the priority text transformations.\r\n\ttransformations.priorityTextTransformations.sort(\r\n\t\t( { name: currentName }, { name: nextName } ) => {\r\n\t\t\treturn priorityContentTranformationBlocks[ currentName ] <\r\n\t\t\t\tpriorityContentTranformationBlocks[ nextName ]\r\n\t\t\t\t? -1\r\n\t\t\t\t: 1;\r\n\t\t}\r\n\t);\r\n\treturn transformations;\r\n}\r\n\r\nconst BlockTransformationsMenu = ( {\r\n\tclassName,\r\n\tpossibleBlockTransformations,\r\n\tpossibleBlockVariationTransformations,\r\n\tonSelect,\r\n\tonSelectVariation,\r\n\tblocks,\r\n} ) => {\r\n\tconst [ hoveredTransformItemName, setHoveredTransformItemName ] =\r\n\t\tuseState();\r\n\r\n\tconst { priorityTextTransformations, restTransformations } =\r\n\t\tuseGroupedTransforms( possibleBlockTransformations );\r\n\t// We have to check if both content transformations(priority and rest) are set\r\n\t// in order to create a separate MenuGroup for them.\r\n\tconst hasBothContentTransformations =\r\n\t\tpriorityTextTransformations.length && restTransformations.length;\r\n\tconst restTransformItems = !! restTransformations.length && (\r\n\t\t<RestTransformationItems\r\n\t\t\trestTransformations={ restTransformations }\r\n\t\t\tonSelect={ onSelect }\r\n\t\t\tsetHoveredTransformItemName={ setHoveredTransformItemName }\r\n\t\t/>\r\n\t);\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<MenuGroup label={ __( 'Transform to' ) } className={ className }>\r\n\t\t\t\t{ hoveredTransformItemName && (\r\n\t\t\t\t\t<PreviewBlockPopover\r\n\t\t\t\t\t\tblocks={ switchToBlockType(\r\n\t\t\t\t\t\t\tblocks,\r\n\t\t\t\t\t\t\thoveredTransformItemName\r\n\t\t\t\t\t\t) }\r\n\t\t\t\t\t/>\r\n\t\t\t\t) }\r\n\t\t\t\t{ !! possibleBlockVariationTransformations?.length && (\r\n\t\t\t\t\t<BlockVariationTransformations\r\n\t\t\t\t\t\ttransformations={\r\n\t\t\t\t\t\t\tpossibleBlockVariationTransformations\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tblocks={ blocks }\r\n\t\t\t\t\t\tonSelect={ onSelectVariation }\r\n\t\t\t\t\t/>\r\n\t\t\t\t) }\r\n\t\t\t\t{ priorityTextTransformations.map( ( item ) => (\r\n\t\t\t\t\t<BlockTranformationItem\r\n\t\t\t\t\t\tkey={ item.name }\r\n\t\t\t\t\t\titem={ item }\r\n\t\t\t\t\t\tonSelect={ onSelect }\r\n\t\t\t\t\t\tsetHoveredTransformItemName={\r\n\t\t\t\t\t\t\tsetHoveredTransformItemName\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t/>\r\n\t\t\t\t) ) }\r\n\t\t\t\t{ ! hasBothContentTransformations && restTransformItems }\r\n\t\t\t</MenuGroup>\r\n\t\t\t{ !! hasBothContentTransformations && (\r\n\t\t\t\t<MenuGroup className={ className }>\r\n\t\t\t\t\t{ restTransformItems }\r\n\t\t\t\t</MenuGroup>\r\n\t\t\t) }\r\n\t\t</>\r\n\t);\r\n};\r\n\r\nfunction RestTransformationItems( {\r\n\trestTransformations,\r\n\tonSelect,\r\n\tsetHoveredTransformItemName,\r\n} ) {\r\n\treturn restTransformations.map( ( item ) => (\r\n\t\t<BlockTranformationItem\r\n\t\t\tkey={ item.name }\r\n\t\t\titem={ item }\r\n\t\t\tonSelect={ onSelect }\r\n\t\t\tsetHoveredTransformItemName={ setHoveredTransformItemName }\r\n\t\t/>\r\n\t) );\r\n}\r\n\r\nfunction BlockTranformationItem( {\r\n\titem,\r\n\tonSelect,\r\n\tsetHoveredTransformItemName,\r\n} ) {\r\n\tconst { name, icon, title, isDisabled } = item;\r\n\treturn (\r\n\t\t<MenuItem\r\n\t\t\tclassName={ getBlockMenuDefaultClassName( name ) }\r\n\t\t\tonClick={ ( event ) => {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\tonSelect( name );\r\n\t\t\t} }\r\n\t\t\tdisabled={ isDisabled }\r\n\t\t\tonMouseLeave={ () => setHoveredTransformItemName( null ) }\r\n\t\t\tonMouseEnter={ () => setHoveredTransformItemName( name ) }\r\n\t\t>\r\n\t\t\t<BlockIcon icon={ icon } showColors />\r\n\t\t\t{ title }\r\n\t\t</MenuItem>\r\n\t);\r\n}\r\n\r\nexport default BlockTransformationsMenu;\r\n"],"mappings":"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","ignoreList":[]}