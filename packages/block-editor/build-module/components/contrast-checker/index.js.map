{"version":3,"names":["a11yPlugin","namesPlugin","colord","extend","__","sprintf","Notice","speak","jsx","_jsx","ContrastChecker","backgroundColor","fallbackBackgroundColor","fallbackTextColor","fallbackLinkColor","fontSize","isLargeText","textColor","linkColor","enableAlphaChecker","currentBackgroundColor","currentTextColor","currentLinkColor","textColors","color","description","colordBackgroundColor","backgroundColorHasTransparency","alpha","backgroundColorBrightness","brightness","isReadableOptions","level","size","message","speakMessage","item","colordTextColor","isColordTextReadable","isReadable","textHasTransparency","className","children","spokenMessage","status","isDismissible"],"sources":["@wordpress/block-editor/src/components/contrast-checker/index.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport a11yPlugin from 'colord/plugins/a11y';\r\nimport namesPlugin from 'colord/plugins/names';\r\nimport { colord, extend } from 'colord';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { __, sprintf } from '@wordpress/i18n';\r\nimport { Notice } from '@wordpress/components';\r\nimport { speak } from '@wordpress/a11y';\r\n\r\nextend( [ namesPlugin, a11yPlugin ] );\r\n\r\nfunction ContrastChecker( {\r\n\tbackgroundColor,\r\n\tfallbackBackgroundColor,\r\n\tfallbackTextColor,\r\n\tfallbackLinkColor,\r\n\tfontSize, // Font size value in pixels.\r\n\tisLargeText,\r\n\ttextColor,\r\n\tlinkColor,\r\n\tenableAlphaChecker = false,\r\n} ) {\r\n\tconst currentBackgroundColor = backgroundColor || fallbackBackgroundColor;\r\n\r\n\t// Must have a background color.\r\n\tif ( ! currentBackgroundColor ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconst currentTextColor = textColor || fallbackTextColor;\r\n\tconst currentLinkColor = linkColor || fallbackLinkColor;\r\n\r\n\t// Must have at least one text color.\r\n\tif ( ! currentTextColor && ! currentLinkColor ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconst textColors = [\r\n\t\t{\r\n\t\t\tcolor: currentTextColor,\r\n\t\t\tdescription: __( 'text color' ),\r\n\t\t},\r\n\t\t{\r\n\t\t\tcolor: currentLinkColor,\r\n\t\t\tdescription: __( 'link color' ),\r\n\t\t},\r\n\t];\r\n\tconst colordBackgroundColor = colord( currentBackgroundColor );\r\n\tconst backgroundColorHasTransparency = colordBackgroundColor.alpha() < 1;\r\n\tconst backgroundColorBrightness = colordBackgroundColor.brightness();\r\n\tconst isReadableOptions = {\r\n\t\tlevel: 'AA',\r\n\t\tsize:\r\n\t\t\tisLargeText || ( isLargeText !== false && fontSize >= 24 )\r\n\t\t\t\t? 'large'\r\n\t\t\t\t: 'small',\r\n\t};\r\n\r\n\tlet message = '';\r\n\tlet speakMessage = '';\r\n\tfor ( const item of textColors ) {\r\n\t\t// If there is no color, go no further.\r\n\t\tif ( ! item.color ) {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tconst colordTextColor = colord( item.color );\r\n\t\tconst isColordTextReadable = colordTextColor.isReadable(\r\n\t\t\tcolordBackgroundColor,\r\n\t\t\tisReadableOptions\r\n\t\t);\r\n\t\tconst textHasTransparency = colordTextColor.alpha() < 1;\r\n\r\n\t\t// If the contrast is not readable.\r\n\t\tif ( ! isColordTextReadable ) {\r\n\t\t\t// Don't show the message if the background or text is transparent.\r\n\t\t\tif ( backgroundColorHasTransparency || textHasTransparency ) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tmessage =\r\n\t\t\t\tbackgroundColorBrightness < colordTextColor.brightness()\r\n\t\t\t\t\t? sprintf(\r\n\t\t\t\t\t\t\t// translators: %s is a type of text color, e.g., \"text color\" or \"link color\".\r\n\t\t\t\t\t\t\t__(\r\n\t\t\t\t\t\t\t\t'This color combination may be hard for people to read. Try using a darker background color and/or a brighter %s.'\r\n\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\titem.description\r\n\t\t\t\t\t  )\r\n\t\t\t\t\t: sprintf(\r\n\t\t\t\t\t\t\t// translators: %s is a type of text color, e.g., \"text color\" or \"link color\".\r\n\t\t\t\t\t\t\t__(\r\n\t\t\t\t\t\t\t\t'This color combination may be hard for people to read. Try using a brighter background color and/or a darker %s.'\r\n\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\titem.description\r\n\t\t\t\t\t  );\r\n\t\t\tspeakMessage = __(\r\n\t\t\t\t'This color combination may be hard for people to read.'\r\n\t\t\t);\r\n\t\t\t// Break from the loop when we have a contrast warning.\r\n\t\t\t// These messages take priority over the transparency warning.\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\t// If there is no contrast warning and the text is transparent,\r\n\t\t// show the transparent warning if alpha check is enabled.\r\n\t\tif ( textHasTransparency && enableAlphaChecker ) {\r\n\t\t\tmessage = __( 'Transparent text may be hard for people to read.' );\r\n\t\t\tspeakMessage = __(\r\n\t\t\t\t'Transparent text may be hard for people to read.'\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tif ( ! message ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\t// Note: The `Notice` component can speak messages via its `spokenMessage`\r\n\t// prop, but the contrast checker requires granular control over when the\r\n\t// announcements are made. Notably, the message will be re-announced if a\r\n\t// new color combination is selected and the contrast is still insufficient.\r\n\tspeak( speakMessage );\r\n\r\n\treturn (\r\n\t\t<div className=\"block-editor-contrast-checker\">\r\n\t\t\t<Notice\r\n\t\t\t\tspokenMessage={ null }\r\n\t\t\t\tstatus=\"warning\"\r\n\t\t\t\tisDismissible={ false }\r\n\t\t\t>\r\n\t\t\t\t{ message }\r\n\t\t\t</Notice>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\n/**\r\n * @see https://github.com/WordPress/gutenberg/blob/HEAD/packages/block-editor/src/components/contrast-checker/README.md\r\n */\r\nexport default ContrastChecker;\r\n"],"mappings":"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","ignoreList":[]}