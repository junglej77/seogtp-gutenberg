{"version":3,"names":["Animated","Easing","View","Platform","ToolbarButton","ToolbarGroup","useEffect","useState","useRef","withSelect","withDispatch","compose","__","styles","NavigateUpSVG","BlockSelectionButton","store","blockEditorStore","jsx","_jsx","jsxs","_jsxs","EASE_IN_DURATION","EASE_OUT_DURATION","TRANSLATION_RANGE","FloatingToolbar","selectedClientId","parentId","showFloatingToolbar","onNavigateUp","isRTL","opacity","Value","current","previousSelection","setPreviousSelection","timing","toValue","duration","easing","ease","useNativeDriver","start","clientId","translationRange","OS","translation","interpolate","inputRange","outputRange","animationStyle","transform","translateY","previousSelectedClientId","previousSelectedParentId","showPrevious","blockSelectionButtonClientId","showNavUpButton","style","floatingToolbar","pointerEvents","children","passedStyle","toolbar","title","onClick","icon","pipe","select","getSelectedBlockClientId","getBlockHierarchyRootClientId","getBlockRootClientId","getBlockCount","getSettings","rootBlockId","dispatch","selectBlock","initialPosition"],"sources":["@wordpress/block-editor/src/components/floating-toolbar/index.native.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport { Animated, Easing, View, Platform } from 'react-native';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { ToolbarButton, ToolbarGroup } from '@wordpress/components';\r\nimport { useEffect, useState, useRef } from '@wordpress/element';\r\nimport { withSelect, withDispatch } from '@wordpress/data';\r\nimport { compose } from '@wordpress/compose';\r\nimport { __ } from '@wordpress/i18n';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport styles from './styles.scss';\r\nimport NavigateUpSVG from './nav-up-icon';\r\nimport BlockSelectionButton from '../block-list/block-selection-button.native';\r\nimport { store as blockEditorStore } from '../../store';\r\n\r\nconst EASE_IN_DURATION = 250;\r\nconst EASE_OUT_DURATION = 80;\r\nconst TRANSLATION_RANGE = 8;\r\n\r\nconst FloatingToolbar = ( {\r\n\tselectedClientId,\r\n\tparentId,\r\n\tshowFloatingToolbar,\r\n\tonNavigateUp,\r\n\tisRTL,\r\n} ) => {\r\n\tconst opacity = useRef( new Animated.Value( 0 ) ).current;\r\n\t// Sustain old selection for proper block selection button rendering when exit animation is ongoing.\r\n\tconst [ previousSelection, setPreviousSelection ] = useState( {} );\r\n\r\n\tuseEffect( () => {\r\n\t\tAnimated.timing( opacity, {\r\n\t\t\ttoValue: showFloatingToolbar ? 1 : 0,\r\n\t\t\tduration: showFloatingToolbar\r\n\t\t\t\t? EASE_IN_DURATION\r\n\t\t\t\t: EASE_OUT_DURATION,\r\n\t\t\teasing: Easing.ease,\r\n\t\t\tuseNativeDriver: true,\r\n\t\t} ).start();\r\n\t}, [ showFloatingToolbar ] );\r\n\r\n\tuseEffect( () => {\r\n\t\tif ( showFloatingToolbar ) {\r\n\t\t\tsetPreviousSelection( { clientId: selectedClientId, parentId } );\r\n\t\t}\r\n\t}, [ selectedClientId ] );\r\n\r\n\tconst translationRange =\r\n\t\t( Platform.OS === 'android' ? -1 : 1 ) * TRANSLATION_RANGE;\r\n\r\n\tconst translation = opacity.interpolate( {\r\n\t\tinputRange: [ 0, 1 ],\r\n\t\toutputRange: [ translationRange, 0 ],\r\n\t} );\r\n\r\n\tconst animationStyle = {\r\n\t\topacity,\r\n\t\ttransform: [ { translateY: translation } ],\r\n\t};\r\n\r\n\tconst {\r\n\t\tclientId: previousSelectedClientId,\r\n\t\tparentId: previousSelectedParentId,\r\n\t} = previousSelection;\r\n\r\n\tconst showPrevious = previousSelectedClientId && ! showFloatingToolbar;\r\n\tconst blockSelectionButtonClientId = showPrevious\r\n\t\t? previousSelectedClientId\r\n\t\t: selectedClientId;\r\n\tconst showNavUpButton =\r\n\t\t!! parentId || ( showPrevious && !! previousSelectedParentId );\r\n\r\n\treturn (\r\n\t\t!! opacity && (\r\n\t\t\t<Animated.View\r\n\t\t\t\tstyle={ [ styles.floatingToolbar, animationStyle ] }\r\n\t\t\t\tpointerEvents={ showFloatingToolbar ? 'auto' : 'none' }\r\n\t\t\t>\r\n\t\t\t\t{ showNavUpButton && (\r\n\t\t\t\t\t<ToolbarGroup passedStyle={ styles.toolbar }>\r\n\t\t\t\t\t\t<ToolbarButton\r\n\t\t\t\t\t\t\ttitle={ __( 'Navigate Up' ) }\r\n\t\t\t\t\t\t\tonClick={\r\n\t\t\t\t\t\t\t\t! showPrevious &&\r\n\t\t\t\t\t\t\t\t( () => onNavigateUp( parentId ) )\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ticon={ <NavigateUpSVG isRTL={ isRTL } /> }\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<View style={ styles.pipe } />\r\n\t\t\t\t\t</ToolbarGroup>\r\n\t\t\t\t) }\r\n\t\t\t\t<BlockSelectionButton\r\n\t\t\t\t\tclientId={ blockSelectionButtonClientId }\r\n\t\t\t\t/>\r\n\t\t\t</Animated.View>\r\n\t\t)\r\n\t);\r\n};\r\n\r\nexport default compose( [\r\n\twithSelect( ( select ) => {\r\n\t\tconst {\r\n\t\t\tgetSelectedBlockClientId,\r\n\t\t\tgetBlockHierarchyRootClientId,\r\n\t\t\tgetBlockRootClientId,\r\n\t\t\tgetBlockCount,\r\n\t\t\tgetSettings,\r\n\t\t} = select( blockEditorStore );\r\n\r\n\t\tconst selectedClientId = getSelectedBlockClientId();\r\n\r\n\t\tif ( ! selectedClientId ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst rootBlockId = getBlockHierarchyRootClientId( selectedClientId );\r\n\r\n\t\treturn {\r\n\t\t\tselectedClientId,\r\n\t\t\tshowFloatingToolbar: !! getBlockCount( rootBlockId ),\r\n\t\t\tparentId: getBlockRootClientId( selectedClientId ),\r\n\t\t\tisRTL: getSettings().isRTL,\r\n\t\t};\r\n\t} ),\r\n\twithDispatch( ( dispatch ) => {\r\n\t\tconst { selectBlock } = dispatch( blockEditorStore );\r\n\r\n\t\treturn {\r\n\t\t\tonNavigateUp( clientId, initialPosition ) {\r\n\t\t\t\tselectBlock( clientId, initialPosition );\r\n\t\t\t},\r\n\t\t};\r\n\t} ),\r\n] )( FloatingToolbar );\r\n"],"mappings":"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","ignoreList":[]}