{"version":3,"names":["ResizableBox","useState","useEffect","useBlockElement","BlockPopoverCover","getComputedCSS","getGridTracks","getClosestTrack","jsx","_jsx","GridItemResizer","clientId","bounds","onChange","parentLayout","blockElement","rootBlockElement","parentElement","isManualPlacement","GridItemResizerInner","isManualGrid","window","__experimentalEnableGridInteractivity","resizeDirection","setResizeDirection","enableSide","setEnableSide","top","bottom","left","right","observer","ResizeObserver","blockClientRect","getBoundingClientRect","rootBlockClientRect","observe","disconnect","justification","alignment","styles","display","justifyContent","alignItems","className","__unstablePopoverSlot","additionalStyles","children","size","width","height","enable","bottomLeft","bottomRight","topLeft","topRight","boundsByDirection","onPointerDown","target","pointerId","setPointerCapture","onResizeStart","event","direction","onResizeStop","boxElement","columnGap","parseFloat","rowGap","gridColumnTracks","gridRowTracks","rect","DOMRect","offsetLeft","offsetTop","offsetWidth","offsetHeight","columnStart","rowStart","columnEnd","rowEnd","columnSpan","rowSpan","undefined"],"sources":["@wordpress/block-editor/src/components/grid/grid-item-resizer.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { ResizableBox } from '@wordpress/components';\r\nimport { useState, useEffect } from '@wordpress/element';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { useBlockElement } from '../block-list/use-block-props/use-block-refs';\r\nimport BlockPopoverCover from '../block-popover/cover';\r\nimport { getComputedCSS, getGridTracks, getClosestTrack } from './utils';\r\n\r\nexport function GridItemResizer( {\r\n\tclientId,\r\n\tbounds,\r\n\tonChange,\r\n\tparentLayout,\r\n} ) {\r\n\tconst blockElement = useBlockElement( clientId );\r\n\tconst rootBlockElement = blockElement?.parentElement;\r\n\tconst { isManualPlacement } = parentLayout;\r\n\r\n\tif ( ! blockElement || ! rootBlockElement ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<GridItemResizerInner\r\n\t\t\tclientId={ clientId }\r\n\t\t\tbounds={ bounds }\r\n\t\t\tblockElement={ blockElement }\r\n\t\t\trootBlockElement={ rootBlockElement }\r\n\t\t\tonChange={ onChange }\r\n\t\t\tisManualGrid={\r\n\t\t\t\tisManualPlacement &&\r\n\t\t\t\twindow.__experimentalEnableGridInteractivity\r\n\t\t\t}\r\n\t\t/>\r\n\t);\r\n}\r\n\r\nfunction GridItemResizerInner( {\r\n\tclientId,\r\n\tbounds,\r\n\tblockElement,\r\n\trootBlockElement,\r\n\tonChange,\r\n\tisManualGrid,\r\n} ) {\r\n\tconst [ resizeDirection, setResizeDirection ] = useState( null );\r\n\tconst [ enableSide, setEnableSide ] = useState( {\r\n\t\ttop: false,\r\n\t\tbottom: false,\r\n\t\tleft: false,\r\n\t\tright: false,\r\n\t} );\r\n\r\n\tuseEffect( () => {\r\n\t\tconst observer = new window.ResizeObserver( () => {\r\n\t\t\tconst blockClientRect = blockElement.getBoundingClientRect();\r\n\t\t\tconst rootBlockClientRect =\r\n\t\t\t\trootBlockElement.getBoundingClientRect();\r\n\t\t\tsetEnableSide( {\r\n\t\t\t\ttop: blockClientRect.top > rootBlockClientRect.top,\r\n\t\t\t\tbottom: blockClientRect.bottom < rootBlockClientRect.bottom,\r\n\t\t\t\tleft: blockClientRect.left > rootBlockClientRect.left,\r\n\t\t\t\tright: blockClientRect.right < rootBlockClientRect.right,\r\n\t\t\t} );\r\n\t\t} );\r\n\t\tobserver.observe( blockElement );\r\n\t\treturn () => observer.disconnect();\r\n\t}, [ blockElement, rootBlockElement ] );\r\n\r\n\tconst justification = {\r\n\t\tright: 'flex-start',\r\n\t\tleft: 'flex-end',\r\n\t};\r\n\r\n\tconst alignment = {\r\n\t\ttop: 'flex-end',\r\n\t\tbottom: 'flex-start',\r\n\t};\r\n\r\n\tconst styles = {\r\n\t\tdisplay: 'flex',\r\n\t\tjustifyContent: 'center',\r\n\t\talignItems: 'center',\r\n\t\t...( justification[ resizeDirection ] && {\r\n\t\t\tjustifyContent: justification[ resizeDirection ],\r\n\t\t} ),\r\n\t\t...( alignment[ resizeDirection ] && {\r\n\t\t\talignItems: alignment[ resizeDirection ],\r\n\t\t} ),\r\n\t};\r\n\r\n\treturn (\r\n\t\t<BlockPopoverCover\r\n\t\t\tclassName=\"block-editor-grid-item-resizer\"\r\n\t\t\tclientId={ clientId }\r\n\t\t\t__unstablePopoverSlot=\"__unstable-block-tools-after\"\r\n\t\t\tadditionalStyles={ styles }\r\n\t\t>\r\n\t\t\t<ResizableBox\r\n\t\t\t\tclassName=\"block-editor-grid-item-resizer__box\"\r\n\t\t\t\tsize={ {\r\n\t\t\t\t\twidth: '100%',\r\n\t\t\t\t\theight: '100%',\r\n\t\t\t\t} }\r\n\t\t\t\tenable={ {\r\n\t\t\t\t\tbottom: enableSide.bottom,\r\n\t\t\t\t\tbottomLeft: false,\r\n\t\t\t\t\tbottomRight: false,\r\n\t\t\t\t\tleft: enableSide.left,\r\n\t\t\t\t\tright: enableSide.right,\r\n\t\t\t\t\ttop: enableSide.top,\r\n\t\t\t\t\ttopLeft: false,\r\n\t\t\t\t\ttopRight: false,\r\n\t\t\t\t} }\r\n\t\t\t\tbounds={ bounds }\r\n\t\t\t\tboundsByDirection\r\n\t\t\t\tonPointerDown={ ( { target, pointerId } ) => {\r\n\t\t\t\t\t/*\r\n\t\t\t\t\t * Captures the pointer to avoid hiccups while dragging over objects\r\n\t\t\t\t\t * like iframes and ensures that the event to end the drag is\r\n\t\t\t\t\t * captured by the target (resize handle) whether or not itâ€™s under\r\n\t\t\t\t\t * the pointer.\r\n\t\t\t\t\t */\r\n\t\t\t\t\ttarget.setPointerCapture( pointerId );\r\n\t\t\t\t} }\r\n\t\t\t\tonResizeStart={ ( event, direction ) => {\r\n\t\t\t\t\t/*\r\n\t\t\t\t\t * The container justification and alignment need to be set\r\n\t\t\t\t\t * according to the direction the resizer is being dragged in,\r\n\t\t\t\t\t * so that it resizes in the right direction.\r\n\t\t\t\t\t */\r\n\t\t\t\t\tsetResizeDirection( direction );\r\n\t\t\t\t} }\r\n\t\t\t\tonResizeStop={ ( event, direction, boxElement ) => {\r\n\t\t\t\t\tconst columnGap = parseFloat(\r\n\t\t\t\t\t\tgetComputedCSS( rootBlockElement, 'column-gap' )\r\n\t\t\t\t\t);\r\n\t\t\t\t\tconst rowGap = parseFloat(\r\n\t\t\t\t\t\tgetComputedCSS( rootBlockElement, 'row-gap' )\r\n\t\t\t\t\t);\r\n\t\t\t\t\tconst gridColumnTracks = getGridTracks(\r\n\t\t\t\t\t\tgetComputedCSS(\r\n\t\t\t\t\t\t\trootBlockElement,\r\n\t\t\t\t\t\t\t'grid-template-columns'\r\n\t\t\t\t\t\t),\r\n\t\t\t\t\t\tcolumnGap\r\n\t\t\t\t\t);\r\n\t\t\t\t\tconst gridRowTracks = getGridTracks(\r\n\t\t\t\t\t\tgetComputedCSS(\r\n\t\t\t\t\t\t\trootBlockElement,\r\n\t\t\t\t\t\t\t'grid-template-rows'\r\n\t\t\t\t\t\t),\r\n\t\t\t\t\t\trowGap\r\n\t\t\t\t\t);\r\n\t\t\t\t\tconst rect = new window.DOMRect(\r\n\t\t\t\t\t\tblockElement.offsetLeft + boxElement.offsetLeft,\r\n\t\t\t\t\t\tblockElement.offsetTop + boxElement.offsetTop,\r\n\t\t\t\t\t\tboxElement.offsetWidth,\r\n\t\t\t\t\t\tboxElement.offsetHeight\r\n\t\t\t\t\t);\r\n\t\t\t\t\tconst columnStart =\r\n\t\t\t\t\t\tgetClosestTrack( gridColumnTracks, rect.left ) + 1;\r\n\t\t\t\t\tconst rowStart =\r\n\t\t\t\t\t\tgetClosestTrack( gridRowTracks, rect.top ) + 1;\r\n\t\t\t\t\tconst columnEnd =\r\n\t\t\t\t\t\tgetClosestTrack( gridColumnTracks, rect.right, 'end' ) +\r\n\t\t\t\t\t\t1;\r\n\t\t\t\t\tconst rowEnd =\r\n\t\t\t\t\t\tgetClosestTrack( gridRowTracks, rect.bottom, 'end' ) +\r\n\t\t\t\t\t\t1;\r\n\t\t\t\t\tonChange( {\r\n\t\t\t\t\t\tcolumnSpan: columnEnd - columnStart + 1,\r\n\t\t\t\t\t\trowSpan: rowEnd - rowStart + 1,\r\n\t\t\t\t\t\tcolumnStart: isManualGrid ? columnStart : undefined,\r\n\t\t\t\t\t\trowStart: isManualGrid ? rowStart : undefined,\r\n\t\t\t\t\t} );\r\n\t\t\t\t} }\r\n\t\t\t/>\r\n\t\t</BlockPopoverCover>\r\n\t);\r\n}\r\n"],"mappings":"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","ignoreList":[]}