{"version":3,"names":["clsx","useState","useEffect","forwardRef","useMemo","useSelect","useDispatch","__experimentalUseDropZone","useDropZone","useBlockElement","BlockPopoverCover","range","GridRect","getGridInfo","store","blockEditorStore","useGetNumberOfBlocksBeforeCell","ButtonBlockAppender","unlock","jsx","_jsx","GridVisualizer","clientId","contentRef","parentLayout","isDistractionFree","select","getSettings","gridElement","isManualGrid","isManualPlacement","window","__experimentalEnableGridInteractivity","GridVisualizerGrid","gridClientId","ref","gridInfo","setGridInfo","isDroppingAllowed","setIsDroppingAllowed","observers","element","children","observer","ResizeObserver","observe","push","disconnect","onGlobalDrag","onGlobalDragEnd","document","addEventListener","removeEventListener","className","__unstablePopoverSlot","style","ManualGridVisualizer","Array","from","length","numItems","_","i","GridVisualizerCell","color","currentColor","highlightedRect","setHighlightedRect","gridItemStyles","getBlockOrder","getBlockStyles","blockOrder","occupiedRects","rects","Object","values","_style$layout","columnStart","rowStart","columnSpan","rowSpan","layout","numRows","map","row","numColumns","column","_highlightedRect$cont","isCellOccupied","some","rect","contains","isHighlighted","GridVisualizerDropZone","GridVisualizerAppender","boxShadow","useGridVisualizerDropZone","getBlockAttributes","getBlockRootClientId","canInsertBlockType","getBlockName","updateBlockAttributes","moveBlocksToPosition","__unstableMarkNextChangeAsNotPersistent","getNumberOfBlocksBeforeCell","useDropZoneWithValidation","validateDrag","srcClientId","blockName","attributes","isInBounds","containsRect","onDragEnter","onDragLeave","prevHighlightedRect","onDrop","rootClientId","onSelect","block","getDraggedBlockClientIds"],"sources":["@wordpress/block-editor/src/components/grid/grid-visualizer.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport clsx from 'clsx';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { useState, useEffect, forwardRef, useMemo } from '@wordpress/element';\r\nimport { useSelect, useDispatch } from '@wordpress/data';\r\nimport { __experimentalUseDropZone as useDropZone } from '@wordpress/compose';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { useBlockElement } from '../block-list/use-block-props/use-block-refs';\r\nimport BlockPopoverCover from '../block-popover/cover';\r\nimport { range, GridRect, getGridInfo } from './utils';\r\nimport { store as blockEditorStore } from '../../store';\r\nimport { useGetNumberOfBlocksBeforeCell } from './use-get-number-of-blocks-before-cell';\r\nimport ButtonBlockAppender from '../button-block-appender';\r\nimport { unlock } from '../../lock-unlock';\r\n\r\nexport function GridVisualizer( { clientId, contentRef, parentLayout } ) {\r\n\tconst isDistractionFree = useSelect(\r\n\t\t( select ) =>\r\n\t\t\tselect( blockEditorStore ).getSettings().isDistractionFree,\r\n\t\t[]\r\n\t);\r\n\tconst gridElement = useBlockElement( clientId );\r\n\r\n\tif ( isDistractionFree || ! gridElement ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconst isManualGrid =\r\n\t\tparentLayout?.isManualPlacement &&\r\n\t\twindow.__experimentalEnableGridInteractivity;\r\n\treturn (\r\n\t\t<GridVisualizerGrid\r\n\t\t\tgridClientId={ clientId }\r\n\t\t\tgridElement={ gridElement }\r\n\t\t\tisManualGrid={ isManualGrid }\r\n\t\t\tref={ contentRef }\r\n\t\t/>\r\n\t);\r\n}\r\n\r\nconst GridVisualizerGrid = forwardRef(\r\n\t( { gridClientId, gridElement, isManualGrid }, ref ) => {\r\n\t\tconst [ gridInfo, setGridInfo ] = useState( () =>\r\n\t\t\tgetGridInfo( gridElement )\r\n\t\t);\r\n\t\tconst [ isDroppingAllowed, setIsDroppingAllowed ] = useState( false );\r\n\r\n\t\tuseEffect( () => {\r\n\t\t\tconst observers = [];\r\n\t\t\tfor ( const element of [ gridElement, ...gridElement.children ] ) {\r\n\t\t\t\tconst observer = new window.ResizeObserver( () => {\r\n\t\t\t\t\tsetGridInfo( getGridInfo( gridElement ) );\r\n\t\t\t\t} );\r\n\t\t\t\tobserver.observe( element );\r\n\t\t\t\tobservers.push( observer );\r\n\t\t\t}\r\n\t\t\treturn () => {\r\n\t\t\t\tfor ( const observer of observers ) {\r\n\t\t\t\t\tobserver.disconnect();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}, [ gridElement ] );\r\n\r\n\t\tuseEffect( () => {\r\n\t\t\tfunction onGlobalDrag() {\r\n\t\t\t\tsetIsDroppingAllowed( true );\r\n\t\t\t}\r\n\t\t\tfunction onGlobalDragEnd() {\r\n\t\t\t\tsetIsDroppingAllowed( false );\r\n\t\t\t}\r\n\t\t\tdocument.addEventListener( 'drag', onGlobalDrag );\r\n\t\t\tdocument.addEventListener( 'dragend', onGlobalDragEnd );\r\n\t\t\treturn () => {\r\n\t\t\t\tdocument.removeEventListener( 'drag', onGlobalDrag );\r\n\t\t\t\tdocument.removeEventListener( 'dragend', onGlobalDragEnd );\r\n\t\t\t};\r\n\t\t}, [] );\r\n\r\n\t\treturn (\r\n\t\t\t<BlockPopoverCover\r\n\t\t\t\tclassName={ clsx( 'block-editor-grid-visualizer', {\r\n\t\t\t\t\t'is-dropping-allowed': isDroppingAllowed,\r\n\t\t\t\t} ) }\r\n\t\t\t\tclientId={ gridClientId }\r\n\t\t\t\t__unstablePopoverSlot=\"__unstable-block-tools-after\"\r\n\t\t\t>\r\n\t\t\t\t<div\r\n\t\t\t\t\tref={ ref }\r\n\t\t\t\t\tclassName=\"block-editor-grid-visualizer__grid\"\r\n\t\t\t\t\tstyle={ gridInfo.style }\r\n\t\t\t\t>\r\n\t\t\t\t\t{ isManualGrid ? (\r\n\t\t\t\t\t\t<ManualGridVisualizer\r\n\t\t\t\t\t\t\tgridClientId={ gridClientId }\r\n\t\t\t\t\t\t\tgridInfo={ gridInfo }\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\tArray.from( { length: gridInfo.numItems }, ( _, i ) => (\r\n\t\t\t\t\t\t\t<GridVisualizerCell\r\n\t\t\t\t\t\t\t\tkey={ i }\r\n\t\t\t\t\t\t\t\tcolor={ gridInfo.currentColor }\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t) )\r\n\t\t\t\t\t) }\r\n\t\t\t\t</div>\r\n\t\t\t</BlockPopoverCover>\r\n\t\t);\r\n\t}\r\n);\r\n\r\nfunction ManualGridVisualizer( { gridClientId, gridInfo } ) {\r\n\tconst [ highlightedRect, setHighlightedRect ] = useState( null );\r\n\r\n\tconst gridItemStyles = useSelect(\r\n\t\t( select ) => {\r\n\t\t\tconst { getBlockOrder, getBlockStyles } = unlock(\r\n\t\t\t\tselect( blockEditorStore )\r\n\t\t\t);\r\n\t\t\tconst blockOrder = getBlockOrder( gridClientId );\r\n\t\t\treturn getBlockStyles( blockOrder );\r\n\t\t},\r\n\t\t[ gridClientId ]\r\n\t);\r\n\tconst occupiedRects = useMemo( () => {\r\n\t\tconst rects = [];\r\n\t\tfor ( const style of Object.values( gridItemStyles ) ) {\r\n\t\t\tconst {\r\n\t\t\t\tcolumnStart,\r\n\t\t\t\trowStart,\r\n\t\t\t\tcolumnSpan = 1,\r\n\t\t\t\trowSpan = 1,\r\n\t\t\t} = style?.layout ?? {};\r\n\t\t\tif ( ! columnStart || ! rowStart ) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\trects.push(\r\n\t\t\t\tnew GridRect( {\r\n\t\t\t\t\tcolumnStart,\r\n\t\t\t\t\trowStart,\r\n\t\t\t\t\tcolumnSpan,\r\n\t\t\t\t\trowSpan,\r\n\t\t\t\t} )\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn rects;\r\n\t}, [ gridItemStyles ] );\r\n\r\n\treturn range( 1, gridInfo.numRows ).map( ( row ) =>\r\n\t\trange( 1, gridInfo.numColumns ).map( ( column ) => {\r\n\t\t\tconst isCellOccupied = occupiedRects.some( ( rect ) =>\r\n\t\t\t\trect.contains( column, row )\r\n\t\t\t);\r\n\t\t\tconst isHighlighted =\r\n\t\t\t\thighlightedRect?.contains( column, row ) ?? false;\r\n\t\t\treturn (\r\n\t\t\t\t<GridVisualizerCell\r\n\t\t\t\t\tkey={ `${ row }-${ column }` }\r\n\t\t\t\t\tcolor={ gridInfo.currentColor }\r\n\t\t\t\t\tclassName={ isHighlighted && 'is-highlighted' }\r\n\t\t\t\t>\r\n\t\t\t\t\t{ isCellOccupied ? (\r\n\t\t\t\t\t\t<GridVisualizerDropZone\r\n\t\t\t\t\t\t\tcolumn={ column }\r\n\t\t\t\t\t\t\trow={ row }\r\n\t\t\t\t\t\t\tgridClientId={ gridClientId }\r\n\t\t\t\t\t\t\tgridInfo={ gridInfo }\r\n\t\t\t\t\t\t\tsetHighlightedRect={ setHighlightedRect }\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<GridVisualizerAppender\r\n\t\t\t\t\t\t\tcolumn={ column }\r\n\t\t\t\t\t\t\trow={ row }\r\n\t\t\t\t\t\t\tgridClientId={ gridClientId }\r\n\t\t\t\t\t\t\tgridInfo={ gridInfo }\r\n\t\t\t\t\t\t\tsetHighlightedRect={ setHighlightedRect }\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t) }\r\n\t\t\t\t</GridVisualizerCell>\r\n\t\t\t);\r\n\t\t} )\r\n\t);\r\n}\r\n\r\nfunction GridVisualizerCell( { color, children, className } ) {\r\n\treturn (\r\n\t\t<div\r\n\t\t\tclassName={ clsx(\r\n\t\t\t\t'block-editor-grid-visualizer__cell',\r\n\t\t\t\tclassName\r\n\t\t\t) }\r\n\t\t\tstyle={ {\r\n\t\t\t\tboxShadow: `inset 0 0 0 1px color-mix(in srgb, ${ color } 20%, #0000)`,\r\n\t\t\t\tcolor,\r\n\t\t\t} }\r\n\t\t>\r\n\t\t\t{ children }\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nfunction useGridVisualizerDropZone(\r\n\tcolumn,\r\n\trow,\r\n\tgridClientId,\r\n\tgridInfo,\r\n\tsetHighlightedRect\r\n) {\r\n\tconst {\r\n\t\tgetBlockAttributes,\r\n\t\tgetBlockRootClientId,\r\n\t\tcanInsertBlockType,\r\n\t\tgetBlockName,\r\n\t} = useSelect( blockEditorStore );\r\n\tconst {\r\n\t\tupdateBlockAttributes,\r\n\t\tmoveBlocksToPosition,\r\n\t\t__unstableMarkNextChangeAsNotPersistent,\r\n\t} = useDispatch( blockEditorStore );\r\n\r\n\tconst getNumberOfBlocksBeforeCell = useGetNumberOfBlocksBeforeCell(\r\n\t\tgridClientId,\r\n\t\tgridInfo.numColumns\r\n\t);\r\n\r\n\treturn useDropZoneWithValidation( {\r\n\t\tvalidateDrag( srcClientId ) {\r\n\t\t\tconst blockName = getBlockName( srcClientId );\r\n\t\t\tif ( ! canInsertBlockType( blockName, gridClientId ) ) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tconst attributes = getBlockAttributes( srcClientId );\r\n\t\t\tconst rect = new GridRect( {\r\n\t\t\t\tcolumnStart: column,\r\n\t\t\t\trowStart: row,\r\n\t\t\t\tcolumnSpan: attributes.style?.layout?.columnSpan,\r\n\t\t\t\trowSpan: attributes.style?.layout?.rowSpan,\r\n\t\t\t} );\r\n\t\t\tconst isInBounds = new GridRect( {\r\n\t\t\t\tcolumnSpan: gridInfo.numColumns,\r\n\t\t\t\trowSpan: gridInfo.numRows,\r\n\t\t\t} ).containsRect( rect );\r\n\t\t\treturn isInBounds;\r\n\t\t},\r\n\t\tonDragEnter( srcClientId ) {\r\n\t\t\tconst attributes = getBlockAttributes( srcClientId );\r\n\t\t\tsetHighlightedRect(\r\n\t\t\t\tnew GridRect( {\r\n\t\t\t\t\tcolumnStart: column,\r\n\t\t\t\t\trowStart: row,\r\n\t\t\t\t\tcolumnSpan: attributes.style?.layout?.columnSpan,\r\n\t\t\t\t\trowSpan: attributes.style?.layout?.rowSpan,\r\n\t\t\t\t} )\r\n\t\t\t);\r\n\t\t},\r\n\t\tonDragLeave() {\r\n\t\t\t// onDragEnter can be called before onDragLeave if the user moves\r\n\t\t\t// their mouse quickly, so only clear the highlight if it was set\r\n\t\t\t// by this cell.\r\n\t\t\tsetHighlightedRect( ( prevHighlightedRect ) =>\r\n\t\t\t\tprevHighlightedRect?.columnStart === column &&\r\n\t\t\t\tprevHighlightedRect?.rowStart === row\r\n\t\t\t\t\t? null\r\n\t\t\t\t\t: prevHighlightedRect\r\n\t\t\t);\r\n\t\t},\r\n\t\tonDrop( srcClientId ) {\r\n\t\t\tsetHighlightedRect( null );\r\n\t\t\tconst attributes = getBlockAttributes( srcClientId );\r\n\t\t\tupdateBlockAttributes( srcClientId, {\r\n\t\t\t\tstyle: {\r\n\t\t\t\t\t...attributes.style,\r\n\t\t\t\t\tlayout: {\r\n\t\t\t\t\t\t...attributes.style?.layout,\r\n\t\t\t\t\t\tcolumnStart: column,\r\n\t\t\t\t\t\trowStart: row,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t} );\r\n\t\t\t__unstableMarkNextChangeAsNotPersistent();\r\n\t\t\tmoveBlocksToPosition(\r\n\t\t\t\t[ srcClientId ],\r\n\t\t\t\tgetBlockRootClientId( srcClientId ),\r\n\t\t\t\tgridClientId,\r\n\t\t\t\tgetNumberOfBlocksBeforeCell( column, row )\r\n\t\t\t);\r\n\t\t},\r\n\t} );\r\n}\r\n\r\nfunction GridVisualizerDropZone( {\r\n\tcolumn,\r\n\trow,\r\n\tgridClientId,\r\n\tgridInfo,\r\n\tsetHighlightedRect,\r\n} ) {\r\n\treturn (\r\n\t\t<div\r\n\t\t\tclassName=\"block-editor-grid-visualizer__drop-zone\"\r\n\t\t\tref={ useGridVisualizerDropZone(\r\n\t\t\t\tcolumn,\r\n\t\t\t\trow,\r\n\t\t\t\tgridClientId,\r\n\t\t\t\tgridInfo,\r\n\t\t\t\tsetHighlightedRect\r\n\t\t\t) }\r\n\t\t/>\r\n\t);\r\n}\r\n\r\nfunction GridVisualizerAppender( {\r\n\tcolumn,\r\n\trow,\r\n\tgridClientId,\r\n\tgridInfo,\r\n\tsetHighlightedRect,\r\n} ) {\r\n\tconst {\r\n\t\tupdateBlockAttributes,\r\n\t\tmoveBlocksToPosition,\r\n\t\t__unstableMarkNextChangeAsNotPersistent,\r\n\t} = useDispatch( blockEditorStore );\r\n\r\n\tconst getNumberOfBlocksBeforeCell = useGetNumberOfBlocksBeforeCell(\r\n\t\tgridClientId,\r\n\t\tgridInfo.numColumns\r\n\t);\r\n\r\n\treturn (\r\n\t\t<ButtonBlockAppender\r\n\t\t\trootClientId={ gridClientId }\r\n\t\t\tclassName=\"block-editor-grid-visualizer__appender\"\r\n\t\t\tref={ useGridVisualizerDropZone(\r\n\t\t\t\tcolumn,\r\n\t\t\t\trow,\r\n\t\t\t\tgridClientId,\r\n\t\t\t\tgridInfo,\r\n\t\t\t\tsetHighlightedRect\r\n\t\t\t) }\r\n\t\t\tstyle={ {\r\n\t\t\t\tcolor: gridInfo.currentColor,\r\n\t\t\t} }\r\n\t\t\tonSelect={ ( block ) => {\r\n\t\t\t\tif ( ! block ) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tupdateBlockAttributes( block.clientId, {\r\n\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\tlayout: {\r\n\t\t\t\t\t\t\tcolumnStart: column,\r\n\t\t\t\t\t\t\trowStart: row,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t} );\r\n\t\t\t\t__unstableMarkNextChangeAsNotPersistent();\r\n\t\t\t\tmoveBlocksToPosition(\r\n\t\t\t\t\t[ block.clientId ],\r\n\t\t\t\t\tgridClientId,\r\n\t\t\t\t\tgridClientId,\r\n\t\t\t\t\tgetNumberOfBlocksBeforeCell( column, row )\r\n\t\t\t\t);\r\n\t\t\t} }\r\n\t\t/>\r\n\t);\r\n}\r\n\r\nfunction useDropZoneWithValidation( {\r\n\tvalidateDrag,\r\n\tonDragEnter,\r\n\tonDragLeave,\r\n\tonDrop,\r\n} ) {\r\n\tconst { getDraggedBlockClientIds } = useSelect( blockEditorStore );\r\n\treturn useDropZone( {\r\n\t\tonDragEnter() {\r\n\t\t\tconst [ srcClientId ] = getDraggedBlockClientIds();\r\n\t\t\tif ( srcClientId && validateDrag( srcClientId ) ) {\r\n\t\t\t\tonDragEnter( srcClientId );\r\n\t\t\t}\r\n\t\t},\r\n\t\tonDragLeave() {\r\n\t\t\tonDragLeave();\r\n\t\t},\r\n\t\tonDrop() {\r\n\t\t\tconst [ srcClientId ] = getDraggedBlockClientIds();\r\n\t\t\tif ( srcClientId && validateDrag( srcClientId ) ) {\r\n\t\t\t\tonDrop( srcClientId );\r\n\t\t\t}\r\n\t\t},\r\n\t} );\r\n}\r\n"],"mappings":"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","ignoreList":[]}