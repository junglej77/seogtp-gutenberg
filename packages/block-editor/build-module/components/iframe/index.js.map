{"version":3,"names":["clsx","useState","createPortal","forwardRef","useMemo","useEffect","useRef","__","useResizeObserver","useMergeRefs","useRefEffect","useDisabled","__experimentalStyleProvider","StyleProvider","useSelect","useBlockSelectionClearer","useWritingFlow","getCompatibilityStyles","store","blockEditorStore","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","bubbleEvent","event","Constructor","frame","init","key","contentDocument","defaultView","MouseEvent","rect","getBoundingClientRect","clientX","left","clientY","top","newEvent","type","defaultPrevented","preventDefault","cancelled","dispatchEvent","useBubbleEvents","iframeDocument","frameElement","html","documentElement","eventTypes","handlers","name","prototype","Object","getPrototypeOf","constructorName","constructor","window","addEventListener","removeEventListener","Iframe","contentRef","children","tabIndex","scale","frameSize","readonly","forwardedRef","ref","title","props","resolvedAssets","isPreviewMode","select","getSettings","settings","__unstableResolvedAssets","__unstableIsPreviewMode","styles","scripts","setIframeDocument","prevContainerWidthRef","bodyClasses","setBodyClasses","clearerRef","before","writingFlowRef","after","contentResizeListener","height","contentHeight","containerResizeListener","width","containerWidth","setRef","node","_load","iFrameDocument","preventFileDropDefault","onLoad","ownerDocument","classList","add","Array","from","body","filter","startsWith","dir","compatStyle","getElementById","id","head","appendChild","cloneNode","console","warn","iframeWindowInnerHeight","setIframeWindowInnerHeight","iframeResizeRef","nodeWindow","innerHeight","onResize","windowInnerWidth","setWindowInnerWidth","windowResizeRef","innerWidth","isZoomedOut","current","disabledRef","isDisabled","bodyRef","src","cleanup","_src","URL","createObjectURL","Blob","revokeObjectURL","maxWidth","style","setProperty","Math","min","remove","removeProperty","shouldRenderFocusCaptureElements","iframe","onKeyDown","currentTarget","target","stopPropagation","nativeEvent","KeyboardEvent","className","document","IframeIfReady","isInitialised","__internalIsInitialized"],"sources":["@wordpress/block-editor/src/components/iframe/index.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport clsx from 'clsx';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport {\r\n\tuseState,\r\n\tcreatePortal,\r\n\tforwardRef,\r\n\tuseMemo,\r\n\tuseEffect,\r\n\tuseRef,\r\n} from '@wordpress/element';\r\nimport { __ } from '@wordpress/i18n';\r\nimport {\r\n\tuseResizeObserver,\r\n\tuseMergeRefs,\r\n\tuseRefEffect,\r\n\tuseDisabled,\r\n} from '@wordpress/compose';\r\nimport { __experimentalStyleProvider as StyleProvider } from '@wordpress/components';\r\nimport { useSelect } from '@wordpress/data';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { useBlockSelectionClearer } from '../block-selection-clearer';\r\nimport { useWritingFlow } from '../writing-flow';\r\nimport { getCompatibilityStyles } from './get-compatibility-styles';\r\nimport { store as blockEditorStore } from '../../store';\r\n\r\nfunction bubbleEvent( event, Constructor, frame ) {\r\n\tconst init = {};\r\n\r\n\tfor ( const key in event ) {\r\n\t\tinit[ key ] = event[ key ];\r\n\t}\r\n\r\n\t// Check if the event is a MouseEvent generated within the iframe.\r\n\t// If so, adjust the coordinates to be relative to the position of\r\n\t// the iframe. This ensures that components such as Draggable\r\n\t// receive coordinates relative to the window, instead of relative\r\n\t// to the iframe. Without this, the Draggable event handler would\r\n\t// result in components \"jumping\" position as soon as the user\r\n\t// drags over the iframe.\r\n\tif ( event instanceof frame.contentDocument.defaultView.MouseEvent ) {\r\n\t\tconst rect = frame.getBoundingClientRect();\r\n\t\tinit.clientX += rect.left;\r\n\t\tinit.clientY += rect.top;\r\n\t}\r\n\r\n\tconst newEvent = new Constructor( event.type, init );\r\n\tif ( init.defaultPrevented ) {\r\n\t\tnewEvent.preventDefault();\r\n\t}\r\n\tconst cancelled = ! frame.dispatchEvent( newEvent );\r\n\r\n\tif ( cancelled ) {\r\n\t\tevent.preventDefault();\r\n\t}\r\n}\r\n\r\n/**\r\n * Bubbles some event types (keydown, keypress, and dragover) to parent document\r\n * document to ensure that the keyboard shortcuts and drag and drop work.\r\n *\r\n * Ideally, we should remove event bubbling in the future. Keyboard shortcuts\r\n * should be context dependent, e.g. actions on blocks like Cmd+A should not\r\n * work globally outside the block editor.\r\n *\r\n * @param {Document} iframeDocument Document to attach listeners to.\r\n */\r\nfunction useBubbleEvents( iframeDocument ) {\r\n\treturn useRefEffect( () => {\r\n\t\tconst { defaultView } = iframeDocument;\r\n\t\tif ( ! defaultView ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst { frameElement } = defaultView;\r\n\t\tconst html = iframeDocument.documentElement;\r\n\t\tconst eventTypes = [ 'dragover', 'mousemove' ];\r\n\t\tconst handlers = {};\r\n\t\tfor ( const name of eventTypes ) {\r\n\t\t\thandlers[ name ] = ( event ) => {\r\n\t\t\t\tconst prototype = Object.getPrototypeOf( event );\r\n\t\t\t\tconst constructorName = prototype.constructor.name;\r\n\t\t\t\tconst Constructor = window[ constructorName ];\r\n\t\t\t\tbubbleEvent( event, Constructor, frameElement );\r\n\t\t\t};\r\n\t\t\thtml.addEventListener( name, handlers[ name ] );\r\n\t\t}\r\n\r\n\t\treturn () => {\r\n\t\t\tfor ( const name of eventTypes ) {\r\n\t\t\t\thtml.removeEventListener( name, handlers[ name ] );\r\n\t\t\t}\r\n\t\t};\r\n\t} );\r\n}\r\n\r\nfunction Iframe( {\r\n\tcontentRef,\r\n\tchildren,\r\n\ttabIndex = 0,\r\n\tscale = 1,\r\n\tframeSize = 0,\r\n\treadonly,\r\n\tforwardedRef: ref,\r\n\ttitle = __( 'Editor canvas' ),\r\n\t...props\r\n} ) {\r\n\tconst { resolvedAssets, isPreviewMode } = useSelect( ( select ) => {\r\n\t\tconst { getSettings } = select( blockEditorStore );\r\n\t\tconst settings = getSettings();\r\n\t\treturn {\r\n\t\t\tresolvedAssets: settings.__unstableResolvedAssets,\r\n\t\t\tisPreviewMode: settings.__unstableIsPreviewMode,\r\n\t\t};\r\n\t}, [] );\r\n\tconst { styles = '', scripts = '' } = resolvedAssets;\r\n\tconst [ iframeDocument, setIframeDocument ] = useState();\r\n\tconst prevContainerWidthRef = useRef();\r\n\tconst [ bodyClasses, setBodyClasses ] = useState( [] );\r\n\tconst clearerRef = useBlockSelectionClearer();\r\n\tconst [ before, writingFlowRef, after ] = useWritingFlow();\r\n\tconst [ contentResizeListener, { height: contentHeight } ] =\r\n\t\tuseResizeObserver();\r\n\tconst [ containerResizeListener, { width: containerWidth } ] =\r\n\t\tuseResizeObserver();\r\n\r\n\tconst setRef = useRefEffect( ( node ) => {\r\n\t\tnode._load = () => {\r\n\t\t\tsetIframeDocument( node.contentDocument );\r\n\t\t};\r\n\t\tlet iFrameDocument;\r\n\t\t// Prevent the default browser action for files dropped outside of dropzones.\r\n\t\tfunction preventFileDropDefault( event ) {\r\n\t\t\tevent.preventDefault();\r\n\t\t}\r\n\t\tfunction onLoad() {\r\n\t\t\tconst { contentDocument, ownerDocument } = node;\r\n\t\t\tconst { documentElement } = contentDocument;\r\n\t\t\tiFrameDocument = contentDocument;\r\n\r\n\t\t\tdocumentElement.classList.add( 'block-editor-iframe__html' );\r\n\r\n\t\t\tclearerRef( documentElement );\r\n\r\n\t\t\t// Ideally ALL classes that are added through get_body_class should\r\n\t\t\t// be added in the editor too, which we'll somehow have to get from\r\n\t\t\t// the server in the future (which will run the PHP filters).\r\n\t\t\tsetBodyClasses(\r\n\t\t\t\tArray.from( ownerDocument.body.classList ).filter(\r\n\t\t\t\t\t( name ) =>\r\n\t\t\t\t\t\tname.startsWith( 'admin-color-' ) ||\r\n\t\t\t\t\t\tname.startsWith( 'post-type-' ) ||\r\n\t\t\t\t\t\tname === 'wp-embed-responsive'\r\n\t\t\t\t)\r\n\t\t\t);\r\n\r\n\t\t\tcontentDocument.dir = ownerDocument.dir;\r\n\r\n\t\t\tfor ( const compatStyle of getCompatibilityStyles() ) {\r\n\t\t\t\tif ( contentDocument.getElementById( compatStyle.id ) ) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcontentDocument.head.appendChild(\r\n\t\t\t\t\tcompatStyle.cloneNode( true )\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif ( ! isPreviewMode ) {\r\n\t\t\t\t\t// eslint-disable-next-line no-console\r\n\t\t\t\t\tconsole.warn(\r\n\t\t\t\t\t\t`${ compatStyle.id } was added to the iframe incorrectly. Please use block.json or enqueue_block_assets to add styles to the iframe.`,\r\n\t\t\t\t\t\tcompatStyle\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tiFrameDocument.addEventListener(\r\n\t\t\t\t'dragover',\r\n\t\t\t\tpreventFileDropDefault,\r\n\t\t\t\tfalse\r\n\t\t\t);\r\n\t\t\tiFrameDocument.addEventListener(\r\n\t\t\t\t'drop',\r\n\t\t\t\tpreventFileDropDefault,\r\n\t\t\t\tfalse\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tnode.addEventListener( 'load', onLoad );\r\n\r\n\t\treturn () => {\r\n\t\t\tdelete node._load;\r\n\t\t\tnode.removeEventListener( 'load', onLoad );\r\n\t\t\tiFrameDocument?.removeEventListener(\r\n\t\t\t\t'dragover',\r\n\t\t\t\tpreventFileDropDefault\r\n\t\t\t);\r\n\t\t\tiFrameDocument?.removeEventListener(\r\n\t\t\t\t'drop',\r\n\t\t\t\tpreventFileDropDefault\r\n\t\t\t);\r\n\t\t};\r\n\t}, [] );\r\n\r\n\tconst [ iframeWindowInnerHeight, setIframeWindowInnerHeight ] = useState();\r\n\r\n\tconst iframeResizeRef = useRefEffect( ( node ) => {\r\n\t\tconst nodeWindow = node.ownerDocument.defaultView;\r\n\r\n\t\tsetIframeWindowInnerHeight( nodeWindow.innerHeight );\r\n\t\tconst onResize = () => {\r\n\t\t\tsetIframeWindowInnerHeight( nodeWindow.innerHeight );\r\n\t\t};\r\n\t\tnodeWindow.addEventListener( 'resize', onResize );\r\n\t\treturn () => {\r\n\t\t\tnodeWindow.removeEventListener( 'resize', onResize );\r\n\t\t};\r\n\t}, [] );\r\n\r\n\tconst [ windowInnerWidth, setWindowInnerWidth ] = useState();\r\n\r\n\tconst windowResizeRef = useRefEffect( ( node ) => {\r\n\t\tconst nodeWindow = node.ownerDocument.defaultView;\r\n\r\n\t\tsetWindowInnerWidth( nodeWindow.innerWidth );\r\n\t\tconst onResize = () => {\r\n\t\t\tsetWindowInnerWidth( nodeWindow.innerWidth );\r\n\t\t};\r\n\t\tnodeWindow.addEventListener( 'resize', onResize );\r\n\t\treturn () => {\r\n\t\t\tnodeWindow.removeEventListener( 'resize', onResize );\r\n\t\t};\r\n\t}, [] );\r\n\r\n\tconst isZoomedOut = scale !== 1;\r\n\r\n\tuseEffect( () => {\r\n\t\tif ( ! isZoomedOut ) {\r\n\t\t\tprevContainerWidthRef.current = containerWidth;\r\n\t\t}\r\n\t}, [ containerWidth, isZoomedOut ] );\r\n\r\n\tconst disabledRef = useDisabled( { isDisabled: ! readonly } );\r\n\tconst bodyRef = useMergeRefs( [\r\n\t\tuseBubbleEvents( iframeDocument ),\r\n\t\tcontentRef,\r\n\t\tclearerRef,\r\n\t\twritingFlowRef,\r\n\t\tdisabledRef,\r\n\t\t// Avoid resize listeners when not needed, these will trigger\r\n\t\t// unnecessary re-renders when animating the iframe width, or when\r\n\t\t// expanding preview iframes.\r\n\t\tisZoomedOut ? iframeResizeRef : null,\r\n\t] );\r\n\r\n\t// Correct doctype is required to enable rendering in standards\r\n\t// mode. Also preload the styles to avoid a flash of unstyled\r\n\t// content.\r\n\tconst html = `<!doctype html>\r\n<html>\r\n\t<head>\r\n\t\t<meta charset=\"utf-8\">\r\n\t\t<script>window.frameElement._load()</script>\r\n\t\t<style>\r\n\t\t\thtml{\r\n\t\t\t\theight: auto !important;\r\n\t\t\t\tmin-height: 100%;\r\n\t\t\t}\r\n\t\t\t/* Lowest specificity to not override global styles */\r\n\t\t\t:where(body) {\r\n\t\t\t\tmargin: 0;\r\n\t\t\t\t/* Default background color in case zoom out mode background\r\n\t\t\t\tcolors the html element */\r\n\t\t\t\tbackground-color: white;\r\n\t\t\t}\r\n\t\t</style>\r\n\t\t${ styles }\r\n\t\t${ scripts }\r\n\t</head>\r\n\t<body>\r\n\t\t<script>document.currentScript.parentElement.remove()</script>\r\n\t</body>\r\n</html>`;\r\n\r\n\tconst [ src, cleanup ] = useMemo( () => {\r\n\t\tconst _src = URL.createObjectURL(\r\n\t\t\tnew window.Blob( [ html ], { type: 'text/html' } )\r\n\t\t);\r\n\t\treturn [ _src, () => URL.revokeObjectURL( _src ) ];\r\n\t}, [ html ] );\r\n\r\n\tuseEffect( () => cleanup, [ cleanup ] );\r\n\r\n\tuseEffect( () => {\r\n\t\tif ( ! iframeDocument || ! isZoomedOut ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tiframeDocument.documentElement.classList.add( 'is-zoomed-out' );\r\n\r\n\t\tconst maxWidth = 750;\r\n\t\tiframeDocument.documentElement.style.setProperty(\r\n\t\t\t'--wp-block-editor-iframe-zoom-out-scale',\r\n\t\t\tscale === 'default'\r\n\t\t\t\t? Math.min( containerWidth, maxWidth ) /\r\n\t\t\t\t\t\tprevContainerWidthRef.current\r\n\t\t\t\t: scale\r\n\t\t);\r\n\t\tiframeDocument.documentElement.style.setProperty(\r\n\t\t\t'--wp-block-editor-iframe-zoom-out-frame-size',\r\n\t\t\ttypeof frameSize === 'number' ? `${ frameSize }px` : frameSize\r\n\t\t);\r\n\t\tiframeDocument.documentElement.style.setProperty(\r\n\t\t\t'--wp-block-editor-iframe-zoom-out-content-height',\r\n\t\t\t`${ contentHeight }px`\r\n\t\t);\r\n\t\tiframeDocument.documentElement.style.setProperty(\r\n\t\t\t'--wp-block-editor-iframe-zoom-out-inner-height',\r\n\t\t\t`${ iframeWindowInnerHeight }px`\r\n\t\t);\r\n\t\tiframeDocument.documentElement.style.setProperty(\r\n\t\t\t'--wp-block-editor-iframe-zoom-out-container-width',\r\n\t\t\t`${ containerWidth }px`\r\n\t\t);\r\n\t\tiframeDocument.documentElement.style.setProperty(\r\n\t\t\t'--wp-block-editor-iframe-zoom-out-prev-container-width',\r\n\t\t\t`${ prevContainerWidthRef.current }px`\r\n\t\t);\r\n\r\n\t\treturn () => {\r\n\t\t\tiframeDocument.documentElement.classList.remove( 'is-zoomed-out' );\r\n\r\n\t\t\tiframeDocument.documentElement.style.removeProperty(\r\n\t\t\t\t'--wp-block-editor-iframe-zoom-out-scale'\r\n\t\t\t);\r\n\t\t\tiframeDocument.documentElement.style.removeProperty(\r\n\t\t\t\t'--wp-block-editor-iframe-zoom-out-frame-size'\r\n\t\t\t);\r\n\t\t\tiframeDocument.documentElement.style.removeProperty(\r\n\t\t\t\t'--wp-block-editor-iframe-zoom-out-content-height'\r\n\t\t\t);\r\n\t\t\tiframeDocument.documentElement.style.removeProperty(\r\n\t\t\t\t'--wp-block-editor-iframe-zoom-out-inner-height'\r\n\t\t\t);\r\n\t\t\tiframeDocument.documentElement.style.removeProperty(\r\n\t\t\t\t'--wp-block-editor-iframe-zoom-out-container-width'\r\n\t\t\t);\r\n\t\t\tiframeDocument.documentElement.style.removeProperty(\r\n\t\t\t\t'--wp-block-editor-iframe-zoom-out-prev-container-width'\r\n\t\t\t);\r\n\t\t};\r\n\t}, [\r\n\t\tscale,\r\n\t\tframeSize,\r\n\t\tiframeDocument,\r\n\t\tiframeWindowInnerHeight,\r\n\t\tcontentHeight,\r\n\t\tcontainerWidth,\r\n\t\twindowInnerWidth,\r\n\t\tisZoomedOut,\r\n\t] );\r\n\r\n\t// Make sure to not render the before and after focusable div elements in view\r\n\t// mode. They're only needed to capture focus in edit mode.\r\n\tconst shouldRenderFocusCaptureElements = tabIndex >= 0 && ! isPreviewMode;\r\n\r\n\tconst iframe = (\r\n\t\t<>\r\n\t\t\t{ shouldRenderFocusCaptureElements && before }\r\n\t\t\t{ /* eslint-disable-next-line jsx-a11y/no-noninteractive-element-interactions */ }\r\n\t\t\t<iframe\r\n\t\t\t\t{ ...props }\r\n\t\t\t\tstyle={ {\r\n\t\t\t\t\t...props.style,\r\n\t\t\t\t\theight: props.style?.height,\r\n\t\t\t\t} }\r\n\t\t\t\tref={ useMergeRefs( [ ref, setRef ] ) }\r\n\t\t\t\ttabIndex={ tabIndex }\r\n\t\t\t\t// Correct doctype is required to enable rendering in standards\r\n\t\t\t\t// mode. Also preload the styles to avoid a flash of unstyled\r\n\t\t\t\t// content.\r\n\t\t\t\tsrc={ src }\r\n\t\t\t\ttitle={ title }\r\n\t\t\t\tonKeyDown={ ( event ) => {\r\n\t\t\t\t\tif ( props.onKeyDown ) {\r\n\t\t\t\t\t\tprops.onKeyDown( event );\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// If the event originates from inside the iframe, it means\r\n\t\t\t\t\t// it bubbled through the portal, but only with React\r\n\t\t\t\t\t// events. We need to to bubble native events as well,\r\n\t\t\t\t\t// though by doing so we also trigger another React event,\r\n\t\t\t\t\t// so we need to stop the propagation of this event to avoid\r\n\t\t\t\t\t// duplication.\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tevent.currentTarget.ownerDocument !==\r\n\t\t\t\t\t\tevent.target.ownerDocument\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\t// We should only stop propagation of the React event,\r\n\t\t\t\t\t\t// the native event should further bubble inside the\r\n\t\t\t\t\t\t// iframe to the document and window.\r\n\t\t\t\t\t\t// Alternatively, we could consider redispatching the\r\n\t\t\t\t\t\t// native event in the iframe.\r\n\t\t\t\t\t\tconst { stopPropagation } = event.nativeEvent;\r\n\t\t\t\t\t\tevent.nativeEvent.stopPropagation = () => {};\r\n\t\t\t\t\t\tevent.stopPropagation();\r\n\t\t\t\t\t\tevent.nativeEvent.stopPropagation = stopPropagation;\r\n\t\t\t\t\t\tbubbleEvent(\r\n\t\t\t\t\t\t\tevent,\r\n\t\t\t\t\t\t\twindow.KeyboardEvent,\r\n\t\t\t\t\t\t\tevent.currentTarget\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t} }\r\n\t\t\t>\r\n\t\t\t\t{ iframeDocument &&\r\n\t\t\t\t\tcreatePortal(\r\n\t\t\t\t\t\t// We want to prevent React events from bubbling throught the iframe\r\n\t\t\t\t\t\t// we bubble these manually.\r\n\t\t\t\t\t\t/* eslint-disable-next-line jsx-a11y/no-noninteractive-element-interactions */\r\n\t\t\t\t\t\t<body\r\n\t\t\t\t\t\t\tref={ bodyRef }\r\n\t\t\t\t\t\t\tclassName={ clsx(\r\n\t\t\t\t\t\t\t\t'block-editor-iframe__body',\r\n\t\t\t\t\t\t\t\t'editor-styles-wrapper',\r\n\t\t\t\t\t\t\t\t...bodyClasses\r\n\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{ contentResizeListener }\r\n\t\t\t\t\t\t\t<StyleProvider document={ iframeDocument }>\r\n\t\t\t\t\t\t\t\t{ children }\r\n\t\t\t\t\t\t\t</StyleProvider>\r\n\t\t\t\t\t\t</body>,\r\n\t\t\t\t\t\tiframeDocument.documentElement\r\n\t\t\t\t\t) }\r\n\t\t\t</iframe>\r\n\t\t\t{ shouldRenderFocusCaptureElements && after }\r\n\t\t</>\r\n\t);\r\n\r\n\treturn (\r\n\t\t<div className=\"block-editor-iframe__container\" ref={ windowResizeRef }>\r\n\t\t\t{ containerResizeListener }\r\n\t\t\t<div\r\n\t\t\t\tclassName={ clsx(\r\n\t\t\t\t\t'block-editor-iframe__scale-container',\r\n\t\t\t\t\tisZoomedOut && 'is-zoomed-out'\r\n\t\t\t\t) }\r\n\t\t\t\tstyle={ {\r\n\t\t\t\t\t'--wp-block-editor-iframe-zoom-out-container-width':\r\n\t\t\t\t\t\tisZoomedOut && `${ containerWidth }px`,\r\n\t\t\t\t\t'--wp-block-editor-iframe-zoom-out-prev-container-width':\r\n\t\t\t\t\t\tisZoomedOut && `${ prevContainerWidthRef.current }px`,\r\n\t\t\t\t} }\r\n\t\t\t>\r\n\t\t\t\t{ iframe }\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nfunction IframeIfReady( props, ref ) {\r\n\tconst isInitialised = useSelect(\r\n\t\t( select ) =>\r\n\t\t\tselect( blockEditorStore ).getSettings().__internalIsInitialized,\r\n\t\t[]\r\n\t);\r\n\r\n\t// We shouldn't render the iframe until the editor settings are initialised.\r\n\t// The initial settings are needed to get the styles for the srcDoc, which\r\n\t// cannot be changed after the iframe is mounted. srcDoc is used to to set\r\n\t// the initial iframe HTML, which is required to avoid a flash of unstyled\r\n\t// content.\r\n\tif ( ! isInitialised ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\treturn <Iframe { ...props } forwardedRef={ ref } />;\r\n}\r\n\r\nexport default forwardRef( IframeIfReady );\r\n"],"mappings":"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","ignoreList":[]}