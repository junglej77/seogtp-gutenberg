{"version":3,"names":["useMemo","useEffect","useRef","useState","_n","sprintf","useDebounce","__experimentalHeading","Heading","speak","BlockPatternsList","useInsertionPoint","usePatternsState","InserterListbox","searchItems","BlockPatternsPaging","usePatternsPaging","INSERTER_PATTERN_TYPES","allPatternsCategory","myPatternsCategory","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","PatternsListHeader","filterValue","filteredBlockPatternsLength","level","lineHeight","className","children","PatternList","searchValue","selectedCategory","patternCategories","rootClientId","container","debouncedSpeak","destinationRootClientId","onInsertBlocks","shouldFocusBlock","patterns","onClickPattern","registeredPatternCategories","map","patternCategory","name","filteredBlockPatterns","filteredPatterns","filter","pattern","type","user","hasKnownCategory","categories","some","category","includes","length","count","resultsFoundMessage","pagingProps","previousSearchValue","setPreviousSearchValue","changePage","hasItems","ref","shownPatterns","categoryPatternsAsyncList","blockPatterns","categoryPatterns","isDraggable"],"sources":["@wordpress/block-editor/src/components/inserter/block-patterns-explorer/pattern-list.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useMemo, useEffect, useRef, useState } from '@wordpress/element';\r\nimport { _n, sprintf } from '@wordpress/i18n';\r\nimport { useDebounce } from '@wordpress/compose';\r\nimport { __experimentalHeading as Heading } from '@wordpress/components';\r\nimport { speak } from '@wordpress/a11y';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport BlockPatternsList from '../../block-patterns-list';\r\nimport useInsertionPoint from '../hooks/use-insertion-point';\r\nimport usePatternsState from '../hooks/use-patterns-state';\r\nimport InserterListbox from '../../inserter-listbox';\r\nimport { searchItems } from '../search-items';\r\nimport BlockPatternsPaging from '../../block-patterns-paging';\r\nimport usePatternsPaging from '../hooks/use-patterns-paging';\r\nimport {\r\n\tINSERTER_PATTERN_TYPES,\r\n\tallPatternsCategory,\r\n\tmyPatternsCategory,\r\n} from '../block-patterns-tab/utils';\r\n\r\nfunction PatternsListHeader( { filterValue, filteredBlockPatternsLength } ) {\r\n\tif ( ! filterValue ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Heading\r\n\t\t\tlevel={ 2 }\r\n\t\t\tlineHeight=\"48px\"\r\n\t\t\tclassName=\"block-editor-block-patterns-explorer__search-results-count\"\r\n\t\t>\r\n\t\t\t{ sprintf(\r\n\t\t\t\t/* translators: %d: number of patterns. */\r\n\t\t\t\t_n(\r\n\t\t\t\t\t'%d pattern found',\r\n\t\t\t\t\t'%d patterns found',\r\n\t\t\t\t\tfilteredBlockPatternsLength\r\n\t\t\t\t),\r\n\t\t\t\tfilteredBlockPatternsLength\r\n\t\t\t) }\r\n\t\t</Heading>\r\n\t);\r\n}\r\n\r\nfunction PatternList( {\r\n\tsearchValue,\r\n\tselectedCategory,\r\n\tpatternCategories,\r\n\trootClientId,\r\n} ) {\r\n\tconst container = useRef();\r\n\tconst debouncedSpeak = useDebounce( speak, 500 );\r\n\tconst [ destinationRootClientId, onInsertBlocks ] = useInsertionPoint( {\r\n\t\trootClientId,\r\n\t\tshouldFocusBlock: true,\r\n\t} );\r\n\tconst [ patterns, , onClickPattern ] = usePatternsState(\r\n\t\tonInsertBlocks,\r\n\t\tdestinationRootClientId,\r\n\t\tselectedCategory\r\n\t);\r\n\r\n\tconst registeredPatternCategories = useMemo(\r\n\t\t() =>\r\n\t\t\tpatternCategories.map(\r\n\t\t\t\t( patternCategory ) => patternCategory.name\r\n\t\t\t),\r\n\t\t[ patternCategories ]\r\n\t);\r\n\r\n\tconst filteredBlockPatterns = useMemo( () => {\r\n\t\tconst filteredPatterns = patterns.filter( ( pattern ) => {\r\n\t\t\tif ( selectedCategory === allPatternsCategory.name ) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif (\r\n\t\t\t\tselectedCategory === myPatternsCategory.name &&\r\n\t\t\t\tpattern.type === INSERTER_PATTERN_TYPES.user\r\n\t\t\t) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif ( selectedCategory === 'uncategorized' ) {\r\n\t\t\t\tconst hasKnownCategory = pattern.categories.some(\r\n\t\t\t\t\t( category ) =>\r\n\t\t\t\t\t\tregisteredPatternCategories.includes( category )\r\n\t\t\t\t);\r\n\r\n\t\t\t\treturn ! pattern.categories?.length || ! hasKnownCategory;\r\n\t\t\t}\r\n\r\n\t\t\treturn pattern.categories?.includes( selectedCategory );\r\n\t\t} );\r\n\r\n\t\tif ( ! searchValue ) {\r\n\t\t\treturn filteredPatterns;\r\n\t\t}\r\n\r\n\t\treturn searchItems( filteredPatterns, searchValue );\r\n\t}, [\r\n\t\tsearchValue,\r\n\t\tpatterns,\r\n\t\tselectedCategory,\r\n\t\tregisteredPatternCategories,\r\n\t] );\r\n\r\n\t// Announce search results on change.\r\n\tuseEffect( () => {\r\n\t\tif ( ! searchValue ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst count = filteredBlockPatterns.length;\r\n\t\tconst resultsFoundMessage = sprintf(\r\n\t\t\t/* translators: %d: number of results. */\r\n\t\t\t_n( '%d result found.', '%d results found.', count ),\r\n\t\t\tcount\r\n\t\t);\r\n\t\tdebouncedSpeak( resultsFoundMessage );\r\n\t}, [ searchValue, debouncedSpeak, filteredBlockPatterns.length ] );\r\n\r\n\tconst pagingProps = usePatternsPaging(\r\n\t\tfilteredBlockPatterns,\r\n\t\tselectedCategory,\r\n\t\tcontainer\r\n\t);\r\n\r\n\t// Reset page when search value changes.\r\n\tconst [ previousSearchValue, setPreviousSearchValue ] =\r\n\t\tuseState( searchValue );\r\n\tif ( searchValue !== previousSearchValue ) {\r\n\t\tsetPreviousSearchValue( searchValue );\r\n\t\tpagingProps.changePage( 1 );\r\n\t}\r\n\r\n\tconst hasItems = !! filteredBlockPatterns?.length;\r\n\treturn (\r\n\t\t<div\r\n\t\t\tclassName=\"block-editor-block-patterns-explorer__list\"\r\n\t\t\tref={ container }\r\n\t\t>\r\n\t\t\t<PatternsListHeader\r\n\t\t\t\tfilterValue={ searchValue }\r\n\t\t\t\tfilteredBlockPatternsLength={ filteredBlockPatterns.length }\r\n\t\t\t/>\r\n\r\n\t\t\t<InserterListbox>\r\n\t\t\t\t{ hasItems && (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<BlockPatternsList\r\n\t\t\t\t\t\t\tshownPatterns={\r\n\t\t\t\t\t\t\t\tpagingProps.categoryPatternsAsyncList\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tblockPatterns={ pagingProps.categoryPatterns }\r\n\t\t\t\t\t\t\tonClickPattern={ onClickPattern }\r\n\t\t\t\t\t\t\tisDraggable={ false }\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<BlockPatternsPaging { ...pagingProps } />\r\n\t\t\t\t\t</>\r\n\t\t\t\t) }\r\n\t\t\t</InserterListbox>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport default PatternList;\r\n"],"mappings":"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","ignoreList":[]}