{"version":3,"names":["useMemo","useState","useCallback","useRef","useEffect","__","__experimentalHStack","HStack","__experimentalVStack","VStack","__experimentalHeading","Heading","__experimentalText","Text","FlexBlock","useSelect","usePatternsState","BlockPatternsList","usePatternsPaging","PatternsFilter","usePatternCategories","isPatternFiltered","allPatternsCategory","myPatternsCategory","INSERTER_PATTERN_TYPES","store","blockEditorStore","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","noop","PatternCategoryPreviews","rootClientId","onInsert","onHover","category","showTitlesAsTooltip","isZoomOutMode","select","__unstableGetEditorMode","allPatterns","onClickPattern","name","patternSyncFilter","setPatternSyncFilter","patternSourceFilter","setPatternSourceFilter","availableCategories","scrollContainerRef","currentCategoryPatterns","filter","pattern","type","user","categories","some","catName","c","includes","pagingProps","changePage","onSetPatternSyncFilter","value","onSetPatternSourceFilter","children","spacing","className","size","level","as","label","length","variant","ref","shownPatterns","categoryPatternsAsyncList","blockPatterns","categoryPatterns","orientation","isDraggable","patternFilter"],"sources":["@wordpress/block-editor/src/components/inserter/block-patterns-tab/pattern-category-previews.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport {\r\n\tuseMemo,\r\n\tuseState,\r\n\tuseCallback,\r\n\tuseRef,\r\n\tuseEffect,\r\n} from '@wordpress/element';\r\nimport { __ } from '@wordpress/i18n';\r\n\r\nimport {\r\n\t__experimentalHStack as HStack,\r\n\t__experimentalVStack as VStack,\r\n\t__experimentalHeading as Heading,\r\n\t__experimentalText as Text,\r\n\tFlexBlock,\r\n} from '@wordpress/components';\r\nimport { useSelect } from '@wordpress/data';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport usePatternsState from '../hooks/use-patterns-state';\r\nimport BlockPatternsList from '../../block-patterns-list';\r\nimport usePatternsPaging from '../hooks/use-patterns-paging';\r\nimport { PatternsFilter } from './patterns-filter';\r\nimport { usePatternCategories } from './use-pattern-categories';\r\nimport {\r\n\tisPatternFiltered,\r\n\tallPatternsCategory,\r\n\tmyPatternsCategory,\r\n\tINSERTER_PATTERN_TYPES,\r\n} from './utils';\r\nimport { store as blockEditorStore } from '../../../store';\r\n\r\nconst noop = () => {};\r\n\r\nexport function PatternCategoryPreviews( {\r\n\trootClientId,\r\n\tonInsert,\r\n\tonHover = noop,\r\n\tcategory,\r\n\tshowTitlesAsTooltip,\r\n} ) {\r\n\tconst isZoomOutMode = useSelect(\r\n\t\t( select ) =>\r\n\t\t\tselect( blockEditorStore ).__unstableGetEditorMode() === 'zoom-out',\r\n\t\t[]\r\n\t);\r\n\tconst [ allPatterns, , onClickPattern ] = usePatternsState(\r\n\t\tonInsert,\r\n\t\trootClientId,\r\n\t\tcategory?.name\r\n\t);\r\n\tconst [ patternSyncFilter, setPatternSyncFilter ] = useState( 'all' );\r\n\tconst [ patternSourceFilter, setPatternSourceFilter ] = useState( 'all' );\r\n\r\n\tconst availableCategories = usePatternCategories(\r\n\t\trootClientId,\r\n\t\tpatternSourceFilter\r\n\t);\r\n\tconst scrollContainerRef = useRef();\r\n\tconst currentCategoryPatterns = useMemo(\r\n\t\t() =>\r\n\t\t\tallPatterns.filter( ( pattern ) => {\r\n\t\t\t\tif (\r\n\t\t\t\t\tisPatternFiltered(\r\n\t\t\t\t\t\tpattern,\r\n\t\t\t\t\t\tpatternSourceFilter,\r\n\t\t\t\t\t\tpatternSyncFilter\r\n\t\t\t\t\t)\r\n\t\t\t\t) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( category.name === allPatternsCategory.name ) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (\r\n\t\t\t\t\tcategory.name === myPatternsCategory.name &&\r\n\t\t\t\t\tpattern.type === INSERTER_PATTERN_TYPES.user\r\n\t\t\t\t) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( category.name === 'uncategorized' ) {\r\n\t\t\t\t\t// The uncategorized category should show all the patterns without any category...\r\n\t\t\t\t\tif ( ! pattern.categories ) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// ...or with no available category.\r\n\t\t\t\t\treturn ! pattern.categories.some( ( catName ) =>\r\n\t\t\t\t\t\tavailableCategories.some( ( c ) => c.name === catName )\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn pattern.categories?.includes( category.name );\r\n\t\t\t} ),\r\n\t\t[\r\n\t\t\tallPatterns,\r\n\t\t\tavailableCategories,\r\n\t\t\tcategory.name,\r\n\t\t\tpatternSourceFilter,\r\n\t\t\tpatternSyncFilter,\r\n\t\t]\r\n\t);\r\n\r\n\tconst pagingProps = usePatternsPaging(\r\n\t\tcurrentCategoryPatterns,\r\n\t\tcategory,\r\n\t\tscrollContainerRef\r\n\t);\r\n\tconst { changePage } = pagingProps;\r\n\r\n\t// Hide block pattern preview on unmount.\r\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\tuseEffect( () => () => onHover( null ), [] );\r\n\r\n\tconst onSetPatternSyncFilter = useCallback(\r\n\t\t( value ) => {\r\n\t\t\tsetPatternSyncFilter( value );\r\n\t\t\tchangePage( 1 );\r\n\t\t},\r\n\t\t[ setPatternSyncFilter, changePage ]\r\n\t);\r\n\tconst onSetPatternSourceFilter = useCallback(\r\n\t\t( value ) => {\r\n\t\t\tsetPatternSourceFilter( value );\r\n\t\t\tchangePage( 1 );\r\n\t\t},\r\n\t\t[ setPatternSourceFilter, changePage ]\r\n\t);\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<VStack\r\n\t\t\t\tspacing={ 2 }\r\n\t\t\t\tclassName=\"block-editor-inserter__patterns-category-panel-header\"\r\n\t\t\t>\r\n\t\t\t\t<HStack>\r\n\t\t\t\t\t<FlexBlock>\r\n\t\t\t\t\t\t<Heading\r\n\t\t\t\t\t\t\tclassName=\"block-editor-inserter__patterns-category-panel-title\"\r\n\t\t\t\t\t\t\tsize={ 13 }\r\n\t\t\t\t\t\t\tlevel={ 4 }\r\n\t\t\t\t\t\t\tas=\"div\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{ category.label }\r\n\t\t\t\t\t\t</Heading>\r\n\t\t\t\t\t</FlexBlock>\r\n\t\t\t\t\t<PatternsFilter\r\n\t\t\t\t\t\tpatternSyncFilter={ patternSyncFilter }\r\n\t\t\t\t\t\tpatternSourceFilter={ patternSourceFilter }\r\n\t\t\t\t\t\tsetPatternSyncFilter={ onSetPatternSyncFilter }\r\n\t\t\t\t\t\tsetPatternSourceFilter={ onSetPatternSourceFilter }\r\n\t\t\t\t\t\tscrollContainerRef={ scrollContainerRef }\r\n\t\t\t\t\t\tcategory={ category }\r\n\t\t\t\t\t/>\r\n\t\t\t\t</HStack>\r\n\t\t\t\t{ ! currentCategoryPatterns.length && (\r\n\t\t\t\t\t<Text\r\n\t\t\t\t\t\tvariant=\"muted\"\r\n\t\t\t\t\t\tclassName=\"block-editor-inserter__patterns-category-no-results\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{ __( 'No results found' ) }\r\n\t\t\t\t\t</Text>\r\n\t\t\t\t) }\r\n\t\t\t</VStack>\r\n\t\t\t{/* <VStack spacing={ 4 }> */}\r\n\t\t\t\t{ currentCategoryPatterns.length > 0 && (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t{ isZoomOutMode && (\r\n\t\t\t\t\t\t\t<Text\r\n\t\t\t\t\t\t\t\tsize=\"12\"\r\n\t\t\t\t\t\t\t\tas=\"p\"\r\n\t\t\t\t\t\t\t\tclassName=\"block-editor-inserter__help-text\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{ __(\r\n\t\t\t\t\t\t\t\t\t'Drag and drop patterns into the canvas.'\r\n\t\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\t</Text>\r\n\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t<BlockPatternsList\r\n\t\t\t\t\t\t\tref={ scrollContainerRef }\r\n\t\t\t\t\t\t\tshownPatterns={\r\n\t\t\t\t\t\t\t\tpagingProps.categoryPatternsAsyncList\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tblockPatterns={ pagingProps.categoryPatterns }\r\n\t\t\t\t\t\t\tonClickPattern={ onClickPattern }\r\n\t\t\t\t\t\t\tonHover={ onHover }\r\n\t\t\t\t\t\t\tlabel={ category.label }\r\n\t\t\t\t\t\t\torientation=\"vertical\"\r\n\t\t\t\t\t\t\tcategory={ category.name }\r\n\t\t\t\t\t\t\tisDraggable\r\n\t\t\t\t\t\t\tshowTitlesAsTooltip={ showTitlesAsTooltip }\r\n\t\t\t\t\t\t\tpatternFilter={ patternSourceFilter }\r\n\t\t\t\t\t\t\tpagingProps={ pagingProps }\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</>\r\n\t\t\t\t) }\r\n\t\t\t{/* </VStack> */}\r\n\t\t</>\r\n\t);\r\n}\r\n"],"mappings":"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","ignoreList":[]}