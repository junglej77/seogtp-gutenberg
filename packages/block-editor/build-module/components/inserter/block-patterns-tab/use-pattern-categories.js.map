{"version":3,"names":["useMemo","_x","_n","sprintf","speak","usePatternsState","isPatternFiltered","allPatternsCategory","myPatternsCategory","INSERTER_PATTERN_TYPES","hasRegisteredCategory","pattern","allCategories","categories","length","some","cat","category","name","usePatternCategories","rootClientId","sourceFilter","patterns","undefined","filteredPatterns","filter","populatedCategories","includes","sort","a","b","label","localeCompare","find","push","type","user","unshift"],"sources":["@wordpress/block-editor/src/components/inserter/block-patterns-tab/use-pattern-categories.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useMemo } from '@wordpress/element';\r\nimport { _x, _n, sprintf } from '@wordpress/i18n';\r\n\r\nimport { speak } from '@wordpress/a11y';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport usePatternsState from '../hooks/use-patterns-state';\r\nimport {\r\n\tisPatternFiltered,\r\n\tallPatternsCategory,\r\n\tmyPatternsCategory,\r\n\tINSERTER_PATTERN_TYPES,\r\n} from './utils';\r\n\r\nfunction hasRegisteredCategory( pattern, allCategories ) {\r\n\tif ( ! pattern.categories || ! pattern.categories.length ) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\treturn pattern.categories.some( ( cat ) =>\r\n\t\tallCategories.some( ( category ) => category.name === cat )\r\n\t);\r\n}\r\n\r\nexport function usePatternCategories( rootClientId, sourceFilter = 'all' ) {\r\n\tconst [ patterns, allCategories ] = usePatternsState(\r\n\t\tundefined,\r\n\t\trootClientId\r\n\t);\r\n\r\n\tconst filteredPatterns = useMemo(\r\n\t\t() =>\r\n\t\t\tsourceFilter === 'all'\r\n\t\t\t\t? patterns\r\n\t\t\t\t: patterns.filter(\r\n\t\t\t\t\t\t( pattern ) =>\r\n\t\t\t\t\t\t\t! isPatternFiltered( pattern, sourceFilter )\r\n\t\t\t\t  ),\r\n\t\t[ sourceFilter, patterns ]\r\n\t);\r\n\r\n\t// Remove any empty categories.\r\n\tconst populatedCategories = useMemo( () => {\r\n\t\tconst categories = allCategories\r\n\t\t\t.filter( ( category ) =>\r\n\t\t\t\tfilteredPatterns.some( ( pattern ) =>\r\n\t\t\t\t\tpattern.categories?.includes( category.name )\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t\t.sort( ( a, b ) => a.label.localeCompare( b.label ) );\r\n\r\n\t\tif (\r\n\t\t\tfilteredPatterns.some(\r\n\t\t\t\t( pattern ) => ! hasRegisteredCategory( pattern, allCategories )\r\n\t\t\t) &&\r\n\t\t\t! categories.find(\r\n\t\t\t\t( category ) => category.name === 'uncategorized'\r\n\t\t\t)\r\n\t\t) {\r\n\t\t\tcategories.push( {\r\n\t\t\t\tname: 'uncategorized',\r\n\t\t\t\tlabel: _x( 'Uncategorized' ),\r\n\t\t\t} );\r\n\t\t}\r\n\t\tif (\r\n\t\t\tfilteredPatterns.some(\r\n\t\t\t\t( pattern ) => pattern.type === INSERTER_PATTERN_TYPES.user\r\n\t\t\t)\r\n\t\t) {\r\n\t\t\tcategories.unshift( myPatternsCategory );\r\n\t\t}\r\n\t\tif ( filteredPatterns.length > 0 ) {\r\n\t\t\tcategories.unshift( {\r\n\t\t\t\tname: allPatternsCategory.name,\r\n\t\t\t\tlabel: allPatternsCategory.label,\r\n\t\t\t} );\r\n\t\t}\r\n\t\tspeak(\r\n\t\t\tsprintf(\r\n\t\t\t\t/* translators: %d: number of categories . */\r\n\t\t\t\t_n(\r\n\t\t\t\t\t'%d category button displayed.',\r\n\t\t\t\t\t'%d category buttons displayed.',\r\n\t\t\t\t\tcategories.length\r\n\t\t\t\t),\r\n\t\t\t\tcategories.length\r\n\t\t\t)\r\n\t\t);\r\n\t\treturn categories;\r\n\t}, [ allCategories, filteredPatterns ] );\r\n\r\n\treturn populatedCategories;\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,OAAO,QAAQ,oBAAoB;AAC5C,SAASC,EAAE,EAAEC,EAAE,EAAEC,OAAO,QAAQ,iBAAiB;AAEjD,SAASC,KAAK,QAAQ,iBAAiB;;AAEvC;AACA;AACA;AACA,OAAOC,gBAAgB,MAAM,6BAA6B;AAC1D,SACCC,iBAAiB,EACjBC,mBAAmB,EACnBC,kBAAkB,EAClBC,sBAAsB,QAChB,SAAS;AAEhB,SAASC,qBAAqBA,CAAEC,OAAO,EAAEC,aAAa,EAAG;EACxD,IAAK,CAAED,OAAO,CAACE,UAAU,IAAI,CAAEF,OAAO,CAACE,UAAU,CAACC,MAAM,EAAG;IAC1D,OAAO,KAAK;EACb;EAEA,OAAOH,OAAO,CAACE,UAAU,CAACE,IAAI,CAAIC,GAAG,IACpCJ,aAAa,CAACG,IAAI,CAAIE,QAAQ,IAAMA,QAAQ,CAACC,IAAI,KAAKF,GAAI,CAC3D,CAAC;AACF;AAEA,OAAO,SAASG,oBAAoBA,CAAEC,YAAY,EAAEC,YAAY,GAAG,KAAK,EAAG;EAC1E,MAAM,CAAEC,QAAQ,EAAEV,aAAa,CAAE,GAAGP,gBAAgB,CACnDkB,SAAS,EACTH,YACD,CAAC;EAED,MAAMI,gBAAgB,GAAGxB,OAAO,CAC/B,MACCqB,YAAY,KAAK,KAAK,GACnBC,QAAQ,GACRA,QAAQ,CAACG,MAAM,CACbd,OAAO,IACR,CAAEL,iBAAiB,CAAEK,OAAO,EAAEU,YAAa,CAC5C,CAAC,EACL,CAAEA,YAAY,EAAEC,QAAQ,CACzB,CAAC;;EAED;EACA,MAAMI,mBAAmB,GAAG1B,OAAO,CAAE,MAAM;IAC1C,MAAMa,UAAU,GAAGD,aAAa,CAC9Ba,MAAM,CAAIR,QAAQ,IAClBO,gBAAgB,CAACT,IAAI,CAAIJ,OAAO,IAC/BA,OAAO,CAACE,UAAU,EAAEc,QAAQ,CAAEV,QAAQ,CAACC,IAAK,CAC7C,CACD,CAAC,CACAU,IAAI,CAAE,CAAEC,CAAC,EAAEC,CAAC,KAAMD,CAAC,CAACE,KAAK,CAACC,aAAa,CAAEF,CAAC,CAACC,KAAM,CAAE,CAAC;IAEtD,IACCP,gBAAgB,CAACT,IAAI,CAClBJ,OAAO,IAAM,CAAED,qBAAqB,CAAEC,OAAO,EAAEC,aAAc,CAChE,CAAC,IACD,CAAEC,UAAU,CAACoB,IAAI,CACdhB,QAAQ,IAAMA,QAAQ,CAACC,IAAI,KAAK,eACnC,CAAC,EACA;MACDL,UAAU,CAACqB,IAAI,CAAE;QAChBhB,IAAI,EAAE,eAAe;QACrBa,KAAK,EAAE9B,EAAE,CAAE,eAAgB;MAC5B,CAAE,CAAC;IACJ;IACA,IACCuB,gBAAgB,CAACT,IAAI,CAClBJ,OAAO,IAAMA,OAAO,CAACwB,IAAI,KAAK1B,sBAAsB,CAAC2B,IACxD,CAAC,EACA;MACDvB,UAAU,CAACwB,OAAO,CAAE7B,kBAAmB,CAAC;IACzC;IACA,IAAKgB,gBAAgB,CAACV,MAAM,GAAG,CAAC,EAAG;MAClCD,UAAU,CAACwB,OAAO,CAAE;QACnBnB,IAAI,EAAEX,mBAAmB,CAACW,IAAI;QAC9Ba,KAAK,EAAExB,mBAAmB,CAACwB;MAC5B,CAAE,CAAC;IACJ;IACA3B,KAAK,CACJD,OAAO,EACN;IACAD,EAAE,CACD,+BAA+B,EAC/B,gCAAgC,EAChCW,UAAU,CAACC,MACZ,CAAC,EACDD,UAAU,CAACC,MACZ,CACD,CAAC;IACD,OAAOD,UAAU;EAClB,CAAC,EAAE,CAAED,aAAa,EAAEY,gBAAgB,CAAG,CAAC;EAExC,OAAOE,mBAAmB;AAC3B","ignoreList":[]}