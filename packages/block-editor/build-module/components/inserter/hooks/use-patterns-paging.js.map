{"version":3,"names":["useMemo","useState","useEffect","useAsyncList","usePrevious","getScrollContainer","PAGE_SIZE","INITIAL_INSERTER_RESULTS","usePatternsPaging","currentCategoryPatterns","currentCategory","scrollContainerRef","currentFilter","currentPage","setCurrentPage","previousCategory","previousFilter","totalItems","length","pageIndex","categoryPatterns","slice","categoryPatternsAsyncList","step","numPages","Math","ceil","changePage","page","scrollContainer","current","scrollTo","scrollToTopOnCategoryChange"],"sources":["@wordpress/block-editor/src/components/inserter/hooks/use-patterns-paging.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useMemo, useState, useEffect } from '@wordpress/element';\r\nimport { useAsyncList, usePrevious } from '@wordpress/compose';\r\nimport { getScrollContainer } from '@wordpress/dom';\r\n\r\nconst PAGE_SIZE = 20;\r\nconst INITIAL_INSERTER_RESULTS = 5;\r\n\r\n/**\r\n * Supplies values needed to page the patterns list client side.\r\n *\r\n * @param {Array}  currentCategoryPatterns An array of the current patterns to display.\r\n * @param {string} currentCategory         The currently selected category.\r\n * @param {Object} scrollContainerRef      Ref of container to to find scroll container for when moving between pages.\r\n * @param {string} currentFilter           The currently search filter.\r\n *\r\n * @return {Object} Returns the relevant paging values. (totalItems, categoryPatternsList, numPages, changePage, currentPage)\r\n */\r\nexport default function usePatternsPaging(\r\n\tcurrentCategoryPatterns,\r\n\tcurrentCategory,\r\n\tscrollContainerRef,\r\n\tcurrentFilter = ''\r\n) {\r\n\tconst [ currentPage, setCurrentPage ] = useState( 1 );\r\n\tconst previousCategory = usePrevious( currentCategory );\r\n\tconst previousFilter = usePrevious( currentFilter );\r\n\tif (\r\n\t\t( previousCategory !== currentCategory ||\r\n\t\t\tpreviousFilter !== currentFilter ) &&\r\n\t\tcurrentPage !== 1\r\n\t) {\r\n\t\tsetCurrentPage( 1 );\r\n\t}\r\n\tconst totalItems = currentCategoryPatterns.length;\r\n\tconst pageIndex = currentPage - 1;\r\n\tconst categoryPatterns = useMemo( () => {\r\n\t\treturn currentCategoryPatterns.slice(\r\n\t\t\tpageIndex * PAGE_SIZE,\r\n\t\t\tpageIndex * PAGE_SIZE + PAGE_SIZE\r\n\t\t);\r\n\t}, [ pageIndex, currentCategoryPatterns ] );\r\n\tconst categoryPatternsAsyncList = useAsyncList( categoryPatterns, {\r\n\t\tstep: INITIAL_INSERTER_RESULTS,\r\n\t} );\r\n\tconst numPages = Math.ceil( currentCategoryPatterns.length / PAGE_SIZE );\r\n\tconst changePage = ( page ) => {\r\n\t\tconst scrollContainer = getScrollContainer(\r\n\t\t\tscrollContainerRef?.current\r\n\t\t);\r\n\t\tscrollContainer?.scrollTo( 0, 0 );\r\n\r\n\t\tsetCurrentPage( page );\r\n\t};\r\n\r\n\tuseEffect(\r\n\t\tfunction scrollToTopOnCategoryChange() {\r\n\t\t\tconst scrollContainer = getScrollContainer(\r\n\t\t\t\tscrollContainerRef?.current\r\n\t\t\t);\r\n\t\t\tscrollContainer?.scrollTo( 0, 0 );\r\n\t\t},\r\n\t\t[ currentCategory, scrollContainerRef ]\r\n\t);\r\n\r\n\treturn {\r\n\t\ttotalItems,\r\n\t\tcategoryPatterns,\r\n\t\tcategoryPatternsAsyncList,\r\n\t\tnumPages,\r\n\t\tchangePage,\r\n\t\tcurrentPage,\r\n\t};\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,OAAO,EAAEC,QAAQ,EAAEC,SAAS,QAAQ,oBAAoB;AACjE,SAASC,YAAY,EAAEC,WAAW,QAAQ,oBAAoB;AAC9D,SAASC,kBAAkB,QAAQ,gBAAgB;AAEnD,MAAMC,SAAS,GAAG,EAAE;AACpB,MAAMC,wBAAwB,GAAG,CAAC;;AAElC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAASC,iBAAiBA,CACxCC,uBAAuB,EACvBC,eAAe,EACfC,kBAAkB,EAClBC,aAAa,GAAG,EAAE,EACjB;EACD,MAAM,CAAEC,WAAW,EAAEC,cAAc,CAAE,GAAGb,QAAQ,CAAE,CAAE,CAAC;EACrD,MAAMc,gBAAgB,GAAGX,WAAW,CAAEM,eAAgB,CAAC;EACvD,MAAMM,cAAc,GAAGZ,WAAW,CAAEQ,aAAc,CAAC;EACnD,IACC,CAAEG,gBAAgB,KAAKL,eAAe,IACrCM,cAAc,KAAKJ,aAAa,KACjCC,WAAW,KAAK,CAAC,EAChB;IACDC,cAAc,CAAE,CAAE,CAAC;EACpB;EACA,MAAMG,UAAU,GAAGR,uBAAuB,CAACS,MAAM;EACjD,MAAMC,SAAS,GAAGN,WAAW,GAAG,CAAC;EACjC,MAAMO,gBAAgB,GAAGpB,OAAO,CAAE,MAAM;IACvC,OAAOS,uBAAuB,CAACY,KAAK,CACnCF,SAAS,GAAGb,SAAS,EACrBa,SAAS,GAAGb,SAAS,GAAGA,SACzB,CAAC;EACF,CAAC,EAAE,CAAEa,SAAS,EAAEV,uBAAuB,CAAG,CAAC;EAC3C,MAAMa,yBAAyB,GAAGnB,YAAY,CAAEiB,gBAAgB,EAAE;IACjEG,IAAI,EAAEhB;EACP,CAAE,CAAC;EACH,MAAMiB,QAAQ,GAAGC,IAAI,CAACC,IAAI,CAAEjB,uBAAuB,CAACS,MAAM,GAAGZ,SAAU,CAAC;EACxE,MAAMqB,UAAU,GAAKC,IAAI,IAAM;IAC9B,MAAMC,eAAe,GAAGxB,kBAAkB,CACzCM,kBAAkB,EAAEmB,OACrB,CAAC;IACDD,eAAe,EAAEE,QAAQ,CAAE,CAAC,EAAE,CAAE,CAAC;IAEjCjB,cAAc,CAAEc,IAAK,CAAC;EACvB,CAAC;EAED1B,SAAS,CACR,SAAS8B,2BAA2BA,CAAA,EAAG;IACtC,MAAMH,eAAe,GAAGxB,kBAAkB,CACzCM,kBAAkB,EAAEmB,OACrB,CAAC;IACDD,eAAe,EAAEE,QAAQ,CAAE,CAAC,EAAE,CAAE,CAAC;EAClC,CAAC,EACD,CAAErB,eAAe,EAAEC,kBAAkB,CACtC,CAAC;EAED,OAAO;IACNM,UAAU;IACVG,gBAAgB;IAChBE,yBAAyB;IACzBE,QAAQ;IACRG,UAAU;IACVd;EACD,CAAC;AACF","ignoreList":[]}