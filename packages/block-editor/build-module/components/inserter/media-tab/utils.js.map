{"version":3,"names":["createBlock","jsx","_jsx","mediaTypeTag","image","video","audio","getBlockAndPreviewFromMedia","media","mediaType","attributes","id","undefined","caption","mediaSrc","url","alt","includes","src","PreviewTag","preview","previewUrl","controls","inert","onError","currentTarget"],"sources":["@wordpress/block-editor/src/components/inserter/media-tab/utils.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { createBlock } from '@wordpress/blocks';\r\n\r\nconst mediaTypeTag = { image: 'img', video: 'video', audio: 'audio' };\r\n\r\n/** @typedef {import('./hooks').InserterMediaItem} InserterMediaItem */\r\n\r\n/**\r\n * Creates a block and a preview element from a media object.\r\n *\r\n * @param {InserterMediaItem}         media     The media object to create the block from.\r\n * @param {('image'|'audio'|'video')} mediaType The media type to create the block for.\r\n * @return {[WPBlock, JSX.Element]} An array containing the block and the preview element.\r\n */\r\nexport function getBlockAndPreviewFromMedia( media, mediaType ) {\r\n\t// Add the common attributes between the different media types.\r\n\tconst attributes = {\r\n\t\tid: media.id || undefined,\r\n\t\tcaption: media.caption || undefined,\r\n\t};\r\n\tconst mediaSrc = media.url;\r\n\tconst alt = media.alt || undefined;\r\n\tif ( mediaType === 'image' ) {\r\n\t\tattributes.url = mediaSrc;\r\n\t\tattributes.alt = alt;\r\n\t} else if ( [ 'video', 'audio' ].includes( mediaType ) ) {\r\n\t\tattributes.src = mediaSrc;\r\n\t}\r\n\tconst PreviewTag = mediaTypeTag[ mediaType ];\r\n\tconst preview = (\r\n\t\t<PreviewTag\r\n\t\t\tsrc={ media.previewUrl || mediaSrc }\r\n\t\t\talt={ alt }\r\n\t\t\tcontrols={ mediaType === 'audio' ? true : undefined }\r\n\t\t\tinert=\"true\"\r\n\t\t\tonError={ ( { currentTarget } ) => {\r\n\t\t\t\t// Fall back to the media source if the preview cannot be loaded.\r\n\t\t\t\tif ( currentTarget.src === media.previewUrl ) {\r\n\t\t\t\t\tcurrentTarget.src = mediaSrc;\r\n\t\t\t\t}\r\n\t\t\t} }\r\n\t\t/>\r\n\t);\r\n\treturn [ createBlock( `core/${ mediaType }`, attributes ), preview ];\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,WAAW,QAAQ,mBAAmB;AAAC,SAAAC,GAAA,IAAAC,IAAA;AAEhD,MAAMC,YAAY,GAAG;EAAEC,KAAK,EAAE,KAAK;EAAEC,KAAK,EAAE,OAAO;EAAEC,KAAK,EAAE;AAAQ,CAAC;;AAErE;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,2BAA2BA,CAAEC,KAAK,EAAEC,SAAS,EAAG;EAC/D;EACA,MAAMC,UAAU,GAAG;IAClBC,EAAE,EAAEH,KAAK,CAACG,EAAE,IAAIC,SAAS;IACzBC,OAAO,EAAEL,KAAK,CAACK,OAAO,IAAID;EAC3B,CAAC;EACD,MAAME,QAAQ,GAAGN,KAAK,CAACO,GAAG;EAC1B,MAAMC,GAAG,GAAGR,KAAK,CAACQ,GAAG,IAAIJ,SAAS;EAClC,IAAKH,SAAS,KAAK,OAAO,EAAG;IAC5BC,UAAU,CAACK,GAAG,GAAGD,QAAQ;IACzBJ,UAAU,CAACM,GAAG,GAAGA,GAAG;EACrB,CAAC,MAAM,IAAK,CAAE,OAAO,EAAE,OAAO,CAAE,CAACC,QAAQ,CAAER,SAAU,CAAC,EAAG;IACxDC,UAAU,CAACQ,GAAG,GAAGJ,QAAQ;EAC1B;EACA,MAAMK,UAAU,GAAGhB,YAAY,CAAEM,SAAS,CAAE;EAC5C,MAAMW,OAAO,gBACZlB,IAAA,CAACiB,UAAU;IACVD,GAAG,EAAGV,KAAK,CAACa,UAAU,IAAIP,QAAU;IACpCE,GAAG,EAAGA,GAAK;IACXM,QAAQ,EAAGb,SAAS,KAAK,OAAO,GAAG,IAAI,GAAGG,SAAW;IACrDW,KAAK,EAAC,MAAM;IACZC,OAAO,EAAGA,CAAE;MAAEC;IAAc,CAAC,KAAM;MAClC;MACA,IAAKA,aAAa,CAACP,GAAG,KAAKV,KAAK,CAACa,UAAU,EAAG;QAC7CI,aAAa,CAACP,GAAG,GAAGJ,QAAQ;MAC7B;IACD;EAAG,CACH,CACD;EACD,OAAO,CAAEd,WAAW,CAAG,QAAQS,SAAW,EAAC,EAAEC,UAAW,CAAC,EAAEU,OAAO,CAAE;AACrE","ignoreList":[]}