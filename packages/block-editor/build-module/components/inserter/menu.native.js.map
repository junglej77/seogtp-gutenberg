{"version":3,"names":["AccessibilityInfo","TouchableHighlight","Platform","useEffect","useState","useCallback","useSelect","useDispatch","createBlock","BottomSheet","BottomSheetConsumer","SearchControl","InserterSearchResults","store","blockEditorStore","InserterTabs","styles","filterInserterItems","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","MIN_ITEMS_FOR_SEARCH","InserterMenu","onSelect","onDismiss","rootClientId","clientId","isAppender","shouldReplaceBlock","insertionIndex","filterValue","setFilterValue","showTabs","setShowTabs","tabIndex","setTabIndex","isIOS","OS","showInsertionPoint","hideInsertionPoint","clearSelectedBlock","insertBlock","removeBlock","resetBlocks","insertDefaultBlock","items","destinationRootClientId","showReusableBlocks","select","getInserterItems","getBlockRootClientId","getBlockSelectionEnd","targetRootClientId","end","undefined","allItems","reusableBlockItems","onlyReusable","length","getBlockOrder","getBlockCount","count","blockToReplace","onClose","onInsert","item","name","initialAttributes","innerBlocks","newBlock","source","onSelectItem","isScreenReaderEnabled","then","enabled","timeout","setTimeout","onChangeSearch","value","onKeyboardShow","onKeyboardHide","showSearchForm","isFullScreen","isVisible","header","children","onChange","Control","onChangeTab","hasNavigation","setMinHeightToMaxHeight","contentStyle","allowDragIndicator","listProps","accessible","style"],"sources":["@wordpress/block-editor/src/components/inserter/menu.native.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport { AccessibilityInfo, TouchableHighlight, Platform } from 'react-native';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { useEffect, useState, useCallback } from '@wordpress/element';\r\nimport { useSelect, useDispatch } from '@wordpress/data';\r\nimport { createBlock } from '@wordpress/blocks';\r\nimport {\r\n\tBottomSheet,\r\n\tBottomSheetConsumer,\r\n\tSearchControl,\r\n} from '@wordpress/components';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport InserterSearchResults from './search-results';\r\nimport { store as blockEditorStore } from '../../store';\r\nimport InserterTabs from './tabs';\r\nimport styles from './style.scss';\r\nimport { filterInserterItems } from './utils';\r\n\r\nconst MIN_ITEMS_FOR_SEARCH = 2;\r\nfunction InserterMenu( {\r\n\tonSelect,\r\n\tonDismiss,\r\n\trootClientId,\r\n\tclientId,\r\n\tisAppender,\r\n\tshouldReplaceBlock,\r\n\tinsertionIndex,\r\n} ) {\r\n\tconst [ filterValue, setFilterValue ] = useState( '' );\r\n\tconst [ showTabs, setShowTabs ] = useState( true );\r\n\tconst [ tabIndex, setTabIndex ] = useState( 0 );\r\n\r\n\tconst isIOS = Platform.OS === 'ios';\r\n\r\n\tconst {\r\n\t\tshowInsertionPoint,\r\n\t\thideInsertionPoint,\r\n\t\tclearSelectedBlock,\r\n\t\tinsertBlock,\r\n\t\tremoveBlock,\r\n\t\tresetBlocks,\r\n\t\tinsertDefaultBlock,\r\n\t} = useDispatch( blockEditorStore );\r\n\r\n\tconst { items, destinationRootClientId, showReusableBlocks } = useSelect(\r\n\t\t( select ) => {\r\n\t\t\tconst {\r\n\t\t\t\tgetInserterItems,\r\n\t\t\t\tgetBlockRootClientId,\r\n\t\t\t\tgetBlockSelectionEnd,\r\n\t\t\t} = select( blockEditorStore );\r\n\r\n\t\t\tlet targetRootClientId = rootClientId;\r\n\t\t\tif ( ! targetRootClientId && ! clientId && ! isAppender ) {\r\n\t\t\t\tconst end = getBlockSelectionEnd();\r\n\t\t\t\tif ( end ) {\r\n\t\t\t\t\ttargetRootClientId =\r\n\t\t\t\t\t\tgetBlockRootClientId( end ) || undefined;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst allItems = getInserterItems( targetRootClientId );\r\n\t\t\tconst reusableBlockItems = filterInserterItems( allItems, {\r\n\t\t\t\tonlyReusable: true,\r\n\t\t\t} );\r\n\r\n\t\t\treturn {\r\n\t\t\t\titems: allItems,\r\n\t\t\t\tdestinationRootClientId: targetRootClientId,\r\n\t\t\t\tshowReusableBlocks: !! reusableBlockItems.length,\r\n\t\t\t};\r\n\t\t}\r\n\t);\r\n\r\n\tconst { getBlockOrder, getBlockCount } = useSelect( blockEditorStore );\r\n\r\n\tuseEffect( () => {\r\n\t\t// Show/Hide insertion point on Mount/Dismount\r\n\t\tif ( shouldReplaceBlock ) {\r\n\t\t\tconst count = getBlockCount();\r\n\t\t\t// Check if there is a rootClientId because that means it is a nested replaceable block\r\n\t\t\t// and we don't want to clear/reset all blocks.\r\n\t\t\tif ( count === 1 && ! rootClientId ) {\r\n\t\t\t\t// Removing the last block is not possilble with `removeBlock` action.\r\n\t\t\t\t// It always inserts a default block if the last of the blocks have been removed.\r\n\t\t\t\tclearSelectedBlock();\r\n\t\t\t\tresetBlocks( [] );\r\n\t\t\t} else {\r\n\t\t\t\tconst blockToReplace = getBlockOrder( destinationRootClientId )[\r\n\t\t\t\t\tinsertionIndex\r\n\t\t\t\t];\r\n\t\t\t\tremoveBlock( blockToReplace, false );\r\n\t\t\t}\r\n\t\t}\r\n\t\tshowInsertionPoint( destinationRootClientId, insertionIndex );\r\n\r\n\t\treturn hideInsertionPoint;\r\n\t}, [] );\r\n\r\n\tconst onClose = useCallback( () => {\r\n\t\t// If should replace but didn't insert any block\r\n\t\t// re-insert default block.\r\n\t\tif ( shouldReplaceBlock ) {\r\n\t\t\tinsertDefaultBlock( {}, destinationRootClientId, insertionIndex );\r\n\t\t}\r\n\t\tonDismiss();\r\n\t}, [ shouldReplaceBlock, destinationRootClientId, insertionIndex ] );\r\n\r\n\tconst onInsert = useCallback(\r\n\t\t( item ) => {\r\n\t\t\tconst { name, initialAttributes, innerBlocks } = item;\r\n\r\n\t\t\tconst newBlock = createBlock(\r\n\t\t\t\tname,\r\n\t\t\t\tinitialAttributes,\r\n\t\t\t\tinnerBlocks\r\n\t\t\t);\r\n\r\n\t\t\tinsertBlock(\r\n\t\t\t\tnewBlock,\r\n\t\t\t\tinsertionIndex,\r\n\t\t\t\tdestinationRootClientId,\r\n\t\t\t\ttrue,\r\n\t\t\t\t{ source: 'inserter_menu' }\r\n\t\t\t);\r\n\t\t},\r\n\t\t[ insertBlock, destinationRootClientId, insertionIndex ]\r\n\t);\r\n\r\n\tconst onSelectItem = useCallback(\r\n\t\t( item ) => {\r\n\t\t\t// Avoid a focus loop, see https://github.com/WordPress/gutenberg/issues/30562\r\n\t\t\tif ( Platform.OS === 'ios' ) {\r\n\t\t\t\tAccessibilityInfo.isScreenReaderEnabled().then( ( enabled ) => {\r\n\t\t\t\t\t// In testing, the bug focus loop needed a longer timeout when VoiceOver was enabled.\r\n\t\t\t\t\tconst timeout = enabled ? 200 : 100;\r\n\t\t\t\t\t// eslint-disable-next-line @wordpress/react-no-unsafe-timeout\r\n\t\t\t\t\tsetTimeout( () => {\r\n\t\t\t\t\t\tonInsert( item );\r\n\t\t\t\t\t}, timeout );\r\n\t\t\t\t} );\r\n\t\t\t} else {\r\n\t\t\t\tonInsert( item );\r\n\t\t\t}\r\n\t\t\tonSelect( item );\r\n\t\t},\r\n\t\t[ onInsert, onSelect ]\r\n\t);\r\n\r\n\tconst onChangeSearch = useCallback(\r\n\t\t( value ) => {\r\n\t\t\tsetFilterValue( value );\r\n\t\t},\r\n\t\t[ setFilterValue ]\r\n\t);\r\n\r\n\tconst onKeyboardShow = useCallback(\r\n\t\t() => setShowTabs( false ),\r\n\t\t[ setShowTabs ]\r\n\t);\r\n\r\n\tconst onKeyboardHide = useCallback(\r\n\t\t() => setShowTabs( true ),\r\n\t\t[ setShowTabs ]\r\n\t);\r\n\r\n\tconst showSearchForm = items.length > MIN_ITEMS_FOR_SEARCH;\r\n\tconst isFullScreen = ! isIOS && showSearchForm;\r\n\r\n\treturn (\r\n\t\t<BottomSheet\r\n\t\t\tisVisible\r\n\t\t\tonClose={ onClose }\r\n\t\t\tonKeyboardShow={ onKeyboardShow }\r\n\t\t\tonKeyboardHide={ onKeyboardHide }\r\n\t\t\theader={\r\n\t\t\t\t<>\r\n\t\t\t\t\t{ showSearchForm && (\r\n\t\t\t\t\t\t<SearchControl\r\n\t\t\t\t\t\t\tonChange={ onChangeSearch }\r\n\t\t\t\t\t\t\tvalue={ filterValue }\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t) }\r\n\t\t\t\t\t{ showTabs && ! filterValue && (\r\n\t\t\t\t\t\t<InserterTabs.Control\r\n\t\t\t\t\t\t\tonChangeTab={ setTabIndex }\r\n\t\t\t\t\t\t\tshowReusableBlocks={ showReusableBlocks }\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t) }\r\n\t\t\t\t</>\r\n\t\t\t}\r\n\t\t\thasNavigation\r\n\t\t\tsetMinHeightToMaxHeight\r\n\t\t\tcontentStyle={ styles[ 'inserter-menu__list' ] }\r\n\t\t\tisFullScreen={ isFullScreen }\r\n\t\t\tallowDragIndicator\r\n\t\t>\r\n\t\t\t<BottomSheetConsumer>\r\n\t\t\t\t{ ( { listProps } ) => (\r\n\t\t\t\t\t<TouchableHighlight\r\n\t\t\t\t\t\taccessible={ false }\r\n\t\t\t\t\t\tstyle={ styles[ 'inserter-menu__list-wrapper' ] }\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{ ! showTabs || filterValue ? (\r\n\t\t\t\t\t\t\t<InserterSearchResults\r\n\t\t\t\t\t\t\t\trootClientId={ rootClientId }\r\n\t\t\t\t\t\t\t\tfilterValue={ filterValue }\r\n\t\t\t\t\t\t\t\tonSelect={ onSelectItem }\r\n\t\t\t\t\t\t\t\tlistProps={ listProps }\r\n\t\t\t\t\t\t\t\tisFullScreen={ isFullScreen }\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<InserterTabs\r\n\t\t\t\t\t\t\t\trootClientId={ rootClientId }\r\n\t\t\t\t\t\t\t\tlistProps={ listProps }\r\n\t\t\t\t\t\t\t\ttabIndex={ tabIndex }\r\n\t\t\t\t\t\t\t\tonSelect={ onSelectItem }\r\n\t\t\t\t\t\t\t\tshowReusableBlocks={ showReusableBlocks }\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t) }\r\n\t\t\t\t\t</TouchableHighlight>\r\n\t\t\t\t) }\r\n\t\t\t</BottomSheetConsumer>\r\n\t\t</BottomSheet>\r\n\t);\r\n}\r\n\r\nexport default InserterMenu;\r\n"],"mappings":"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","ignoreList":[]}