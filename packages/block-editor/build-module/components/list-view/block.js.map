{"version":3,"names":["clsx","hasBlockSupport","switchToBlockType","store","blocksStore","__experimentalTreeGridCell","TreeGridCell","__experimentalTreeGridItem","TreeGridItem","useInstanceId","moreVertical","useCallback","useMemo","useState","useRef","memo","useDispatch","useSelect","__","BACKSPACE","DELETE","isShallowEqual","__unstableUseShortcutEventMatch","useShortcutEventMatch","speak","ListViewLeaf","useListViewScrollIntoView","BlockMoverUpButton","BlockMoverDownButton","ListViewBlockContents","useListViewContext","getBlockPositionDescription","getBlockPropertiesDescription","focusListItem","blockEditorStore","useBlockDisplayInformation","useBlockLock","AriaReferencedText","unlock","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ListViewBlock","block","clientId","displacement","isAfterDraggedBlocks","isDragged","isNesting","isSelected","isBranchSelected","selectBlock","position","level","rowCount","siblingBlockCount","showBlockMovers","path","isExpanded","selectedClientIds","isSyncedBranch","cellRef","rowRef","settingsRef","isHovered","setIsHovered","settingsAnchorRect","setSettingsAnchorRect","isLocked","canEdit","canMove","isFirstSelectedBlock","isLastSelectedBlock","length","toggleBlockHighlight","duplicateBlocks","multiSelect","replaceBlocks","removeBlocks","insertAfterBlock","insertBeforeBlock","setOpenedBlockSettingsMenu","canInsertBlockType","getSelectedBlockClientIds","getPreviousBlockClientId","getBlockRootClientId","getBlockOrder","getBlockParents","getBlocksByClientId","canRemoveBlocks","isGroupable","getGroupingBlockName","blockInformation","blockName","allowRightClickOverrides","select","getBlock","getBlockName","getSettings","showBlockActions","instanceId","descriptionId","expand","collapse","collapseAll","BlockSettingsMenu","listViewInstanceId","expandedState","setInsertedBlock","treeGridElementRef","rootClientId","isMatch","getBlocksToUpdate","selectedBlockClientIds","isUpdatingSelectedBlocks","includes","firstBlockClientId","firstBlockRootClientId","blocksToUpdate","onKeyDown","event","defaultPrevented","target","closest","isDeleteKey","keyCode","stopPropagation","preventDefault","undefined","_getPreviousBlockClie","blocksToDelete","blockToFocus","shouldUpdateSelection","updateFocusAndSelection","canDuplicate","every","blockToUpdate","name","updatedBlocks","newlySelectedBlocks","at","blockClientIds","blockParents","blocks","groupingBlockName","newBlocks","onMouseEnter","onMouseLeave","selectEditorBlock","focusClientId","shouldSelectBlock","current","toggleExpanded","onContextMenu","click","window","DOMRect","clientX","clientY","onMouseDown","button","settingsPopoverAnchor","ownerDocument","getBoundingClientRect","clearSettingsAnchorRect","rowItemRef","blockPositionDescription","blockPropertiesDescription","hasSiblings","hasRenderedMovers","moverCellClassName","listViewBlockSettingsClassName","colSpan","classes","isSynced","dropdownClientIds","currentlyEditingBlockInCanvas","className","onFocus","onBlur","id","ref","children","tabIndex","onClick","onToggleExpanded","ariaDescribedBy","filter","Boolean","join","withoutGridItem","orientation","clientIds","icon","label","popoverProps","anchor","toggleProps","disableOpenOnArrowDown","__experimentalSelectBlock"],"sources":["@wordpress/block-editor/src/components/list-view/block.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport clsx from 'clsx';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport {\r\n\thasBlockSupport,\r\n\tswitchToBlockType,\r\n\tstore as blocksStore,\r\n} from '@wordpress/blocks';\r\nimport {\r\n\t__experimentalTreeGridCell as TreeGridCell,\r\n\t__experimentalTreeGridItem as TreeGridItem,\r\n} from '@wordpress/components';\r\nimport { useInstanceId } from '@wordpress/compose';\r\nimport { moreVertical } from '@wordpress/icons';\r\nimport {\r\n\tuseCallback,\r\n\tuseMemo,\r\n\tuseState,\r\n\tuseRef,\r\n\tmemo,\r\n} from '@wordpress/element';\r\nimport { useDispatch, useSelect } from '@wordpress/data';\r\nimport { __ } from '@wordpress/i18n';\r\nimport { BACKSPACE, DELETE } from '@wordpress/keycodes';\r\nimport isShallowEqual from '@wordpress/is-shallow-equal';\r\nimport { __unstableUseShortcutEventMatch as useShortcutEventMatch } from '@wordpress/keyboard-shortcuts';\r\nimport { speak } from '@wordpress/a11y';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport ListViewLeaf from './leaf';\r\nimport useListViewScrollIntoView from './use-list-view-scroll-into-view';\r\nimport {\r\n\tBlockMoverUpButton,\r\n\tBlockMoverDownButton,\r\n} from '../block-mover/button';\r\nimport ListViewBlockContents from './block-contents';\r\nimport { useListViewContext } from './context';\r\nimport {\r\n\tgetBlockPositionDescription,\r\n\tgetBlockPropertiesDescription,\r\n\tfocusListItem,\r\n} from './utils';\r\nimport { store as blockEditorStore } from '../../store';\r\nimport useBlockDisplayInformation from '../use-block-display-information';\r\nimport { useBlockLock } from '../block-lock';\r\nimport AriaReferencedText from './aria-referenced-text';\r\nimport { unlock } from '../../lock-unlock';\r\n\r\nfunction ListViewBlock( {\r\n\tblock: { clientId },\r\n\tdisplacement,\r\n\tisAfterDraggedBlocks,\r\n\tisDragged,\r\n\tisNesting,\r\n\tisSelected,\r\n\tisBranchSelected,\r\n\tselectBlock,\r\n\tposition,\r\n\tlevel,\r\n\trowCount,\r\n\tsiblingBlockCount,\r\n\tshowBlockMovers,\r\n\tpath,\r\n\tisExpanded,\r\n\tselectedClientIds,\r\n\tisSyncedBranch,\r\n} ) {\r\n\tconst cellRef = useRef( null );\r\n\tconst rowRef = useRef( null );\r\n\tconst settingsRef = useRef( null );\r\n\tconst [ isHovered, setIsHovered ] = useState( false );\r\n\tconst [ settingsAnchorRect, setSettingsAnchorRect ] = useState();\r\n\r\n\tconst { isLocked, canEdit, canMove } = useBlockLock( clientId );\r\n\r\n\tconst isFirstSelectedBlock =\r\n\t\tisSelected && selectedClientIds[ 0 ] === clientId;\r\n\tconst isLastSelectedBlock =\r\n\t\tisSelected &&\r\n\t\tselectedClientIds[ selectedClientIds.length - 1 ] === clientId;\r\n\r\n\tconst {\r\n\t\ttoggleBlockHighlight,\r\n\t\tduplicateBlocks,\r\n\t\tmultiSelect,\r\n\t\treplaceBlocks,\r\n\t\tremoveBlocks,\r\n\t\tinsertAfterBlock,\r\n\t\tinsertBeforeBlock,\r\n\t\tsetOpenedBlockSettingsMenu,\r\n\t} = unlock( useDispatch( blockEditorStore ) );\r\n\r\n\tconst {\r\n\t\tcanInsertBlockType,\r\n\t\tgetSelectedBlockClientIds,\r\n\t\tgetPreviousBlockClientId,\r\n\t\tgetBlockRootClientId,\r\n\t\tgetBlockOrder,\r\n\t\tgetBlockParents,\r\n\t\tgetBlocksByClientId,\r\n\t\tcanRemoveBlocks,\r\n\t\tisGroupable,\r\n\t} = useSelect( blockEditorStore );\r\n\tconst { getGroupingBlockName } = useSelect( blocksStore );\r\n\r\n\tconst blockInformation = useBlockDisplayInformation( clientId );\r\n\r\n\tconst { block, blockName, allowRightClickOverrides } = useSelect(\r\n\t\t( select ) => {\r\n\t\t\tconst { getBlock, getBlockName, getSettings } =\r\n\t\t\t\tselect( blockEditorStore );\r\n\r\n\t\t\treturn {\r\n\t\t\t\tblock: getBlock( clientId ),\r\n\t\t\t\tblockName: getBlockName( clientId ),\r\n\t\t\t\tallowRightClickOverrides:\r\n\t\t\t\t\tgetSettings().allowRightClickOverrides,\r\n\t\t\t};\r\n\t\t},\r\n\t\t[ clientId ]\r\n\t);\r\n\r\n\tconst showBlockActions =\r\n\t\t// When a block hides its toolbar it also hides the block settings menu,\r\n\t\t// since that menu is part of the toolbar in the editor canvas.\r\n\t\t// List View respects this by also hiding the block settings menu.\r\n\t\thasBlockSupport( blockName, '__experimentalToolbar', true );\r\n\tconst instanceId = useInstanceId( ListViewBlock );\r\n\tconst descriptionId = `list-view-block-select-button__description-${ instanceId }`;\r\n\r\n\tconst {\r\n\t\texpand,\r\n\t\tcollapse,\r\n\t\tcollapseAll,\r\n\t\tBlockSettingsMenu,\r\n\t\tlistViewInstanceId,\r\n\t\texpandedState,\r\n\t\tsetInsertedBlock,\r\n\t\ttreeGridElementRef,\r\n\t\trootClientId,\r\n\t} = useListViewContext();\r\n\tconst isMatch = useShortcutEventMatch();\r\n\r\n\t// Determine which blocks to update:\r\n\t// If the current (focused) block is part of the block selection, use the whole selection.\r\n\t// If the focused block is not part of the block selection, only update the focused block.\r\n\tfunction getBlocksToUpdate() {\r\n\t\tconst selectedBlockClientIds = getSelectedBlockClientIds();\r\n\t\tconst isUpdatingSelectedBlocks =\r\n\t\t\tselectedBlockClientIds.includes( clientId );\r\n\t\tconst firstBlockClientId = isUpdatingSelectedBlocks\r\n\t\t\t? selectedBlockClientIds[ 0 ]\r\n\t\t\t: clientId;\r\n\t\tconst firstBlockRootClientId =\r\n\t\t\tgetBlockRootClientId( firstBlockClientId );\r\n\r\n\t\tconst blocksToUpdate = isUpdatingSelectedBlocks\r\n\t\t\t? selectedBlockClientIds\r\n\t\t\t: [ clientId ];\r\n\r\n\t\treturn {\r\n\t\t\tblocksToUpdate,\r\n\t\t\tfirstBlockClientId,\r\n\t\t\tfirstBlockRootClientId,\r\n\t\t\tselectedBlockClientIds,\r\n\t\t};\r\n\t}\r\n\r\n\t/**\r\n\t * @param {KeyboardEvent} event\r\n\t */\r\n\tasync function onKeyDown( event ) {\r\n\t\tif ( event.defaultPrevented ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Do not handle events if it comes from modals;\r\n\t\t// retain the default behavior for these keys.\r\n\t\tif ( event.target.closest( '[role=dialog]' ) ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst isDeleteKey = [ BACKSPACE, DELETE ].includes( event.keyCode );\r\n\r\n\t\t// If multiple blocks are selected, deselect all blocks when the user\r\n\t\t// presses the escape key.\r\n\t\tif (\r\n\t\t\tisMatch( 'core/block-editor/unselect', event ) &&\r\n\t\t\tselectedClientIds.length > 0\r\n\t\t) {\r\n\t\t\tevent.stopPropagation();\r\n\t\t\tevent.preventDefault();\r\n\t\t\tselectBlock( event, undefined );\r\n\t\t} else if (\r\n\t\t\tisDeleteKey ||\r\n\t\t\tisMatch( 'core/block-editor/remove', event )\r\n\t\t) {\r\n\t\t\tconst {\r\n\t\t\t\tblocksToUpdate: blocksToDelete,\r\n\t\t\t\tfirstBlockClientId,\r\n\t\t\t\tfirstBlockRootClientId,\r\n\t\t\t\tselectedBlockClientIds,\r\n\t\t\t} = getBlocksToUpdate();\r\n\r\n\t\t\t// Don't update the selection if the blocks cannot be deleted.\r\n\t\t\tif ( ! canRemoveBlocks( blocksToDelete ) ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tlet blockToFocus =\r\n\t\t\t\tgetPreviousBlockClientId( firstBlockClientId ) ??\r\n\t\t\t\t// If the previous block is not found (when the first block is deleted),\r\n\t\t\t\t// fallback to focus the parent block.\r\n\t\t\t\tfirstBlockRootClientId;\r\n\r\n\t\t\tremoveBlocks( blocksToDelete, false );\r\n\r\n\t\t\t// Update the selection if the original selection has been removed.\r\n\t\t\tconst shouldUpdateSelection =\r\n\t\t\t\tselectedBlockClientIds.length > 0 &&\r\n\t\t\t\tgetSelectedBlockClientIds().length === 0;\r\n\r\n\t\t\t// If there's no previous block nor parent block, focus the first block.\r\n\t\t\tif ( ! blockToFocus ) {\r\n\t\t\t\tblockToFocus = getBlockOrder()[ 0 ];\r\n\t\t\t}\r\n\r\n\t\t\tupdateFocusAndSelection( blockToFocus, shouldUpdateSelection );\r\n\t\t} else if ( isMatch( 'core/block-editor/duplicate', event ) ) {\r\n\t\t\tevent.preventDefault();\r\n\r\n\t\t\tconst { blocksToUpdate, firstBlockRootClientId } =\r\n\t\t\t\tgetBlocksToUpdate();\r\n\r\n\t\t\tconst canDuplicate = getBlocksByClientId( blocksToUpdate ).every(\r\n\t\t\t\t( blockToUpdate ) => {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t!! blockToUpdate &&\r\n\t\t\t\t\t\thasBlockSupport(\r\n\t\t\t\t\t\t\tblockToUpdate.name,\r\n\t\t\t\t\t\t\t'multiple',\r\n\t\t\t\t\t\t\ttrue\r\n\t\t\t\t\t\t) &&\r\n\t\t\t\t\t\tcanInsertBlockType(\r\n\t\t\t\t\t\t\tblockToUpdate.name,\r\n\t\t\t\t\t\t\tfirstBlockRootClientId\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t);\r\n\r\n\t\t\tif ( canDuplicate ) {\r\n\t\t\t\tconst updatedBlocks = await duplicateBlocks(\r\n\t\t\t\t\tblocksToUpdate,\r\n\t\t\t\t\tfalse\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif ( updatedBlocks?.length ) {\r\n\t\t\t\t\t// If blocks have been duplicated, focus the first duplicated block.\r\n\t\t\t\t\tupdateFocusAndSelection( updatedBlocks[ 0 ], false );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if ( isMatch( 'core/block-editor/insert-before', event ) ) {\r\n\t\t\tevent.preventDefault();\r\n\r\n\t\t\tconst { blocksToUpdate } = getBlocksToUpdate();\r\n\t\t\tawait insertBeforeBlock( blocksToUpdate[ 0 ] );\r\n\t\t\tconst newlySelectedBlocks = getSelectedBlockClientIds();\r\n\r\n\t\t\t// Focus the first block of the newly inserted blocks, to keep focus within the list view.\r\n\t\t\tsetOpenedBlockSettingsMenu( undefined );\r\n\t\t\tupdateFocusAndSelection( newlySelectedBlocks[ 0 ], false );\r\n\t\t} else if ( isMatch( 'core/block-editor/insert-after', event ) ) {\r\n\t\t\tevent.preventDefault();\r\n\r\n\t\t\tconst { blocksToUpdate } = getBlocksToUpdate();\r\n\t\t\tawait insertAfterBlock( blocksToUpdate.at( -1 ) );\r\n\t\t\tconst newlySelectedBlocks = getSelectedBlockClientIds();\r\n\r\n\t\t\t// Focus the first block of the newly inserted blocks, to keep focus within the list view.\r\n\t\t\tsetOpenedBlockSettingsMenu( undefined );\r\n\t\t\tupdateFocusAndSelection( newlySelectedBlocks[ 0 ], false );\r\n\t\t} else if ( isMatch( 'core/block-editor/select-all', event ) ) {\r\n\t\t\tevent.preventDefault();\r\n\r\n\t\t\tconst { firstBlockRootClientId, selectedBlockClientIds } =\r\n\t\t\t\tgetBlocksToUpdate();\r\n\t\t\tconst blockClientIds = getBlockOrder( firstBlockRootClientId );\r\n\t\t\tif ( ! blockClientIds.length ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// If we have selected all sibling nested blocks, try selecting up a level.\r\n\t\t\t// This is a similar implementation to that used by `useSelectAll`.\r\n\t\t\t// `isShallowEqual` is used for the list view instead of a length check,\r\n\t\t\t// as the array of siblings of the currently focused block may be a different\r\n\t\t\t// set of blocks from the current block selection if the user is focused\r\n\t\t\t// on a different part of the list view from the block selection.\r\n\t\t\tif ( isShallowEqual( selectedBlockClientIds, blockClientIds ) ) {\r\n\t\t\t\t// Only select up a level if the first block is not the root block.\r\n\t\t\t\t// This ensures that the block selection can't break out of the root block\r\n\t\t\t\t// used by the list view, if the list view is only showing a partial hierarchy.\r\n\t\t\t\tif (\r\n\t\t\t\t\tfirstBlockRootClientId &&\r\n\t\t\t\t\tfirstBlockRootClientId !== rootClientId\r\n\t\t\t\t) {\r\n\t\t\t\t\tupdateFocusAndSelection( firstBlockRootClientId, true );\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Select all while passing `null` to skip focusing to the editor canvas,\r\n\t\t\t// and retain focus within the list view.\r\n\t\t\tmultiSelect(\r\n\t\t\t\tblockClientIds[ 0 ],\r\n\t\t\t\tblockClientIds[ blockClientIds.length - 1 ],\r\n\t\t\t\tnull\r\n\t\t\t);\r\n\t\t} else if ( isMatch( 'core/block-editor/collapse-list-view', event ) ) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tconst { firstBlockClientId } = getBlocksToUpdate();\r\n\t\t\tconst blockParents = getBlockParents( firstBlockClientId, false );\r\n\t\t\t// Collapse all blocks.\r\n\t\t\tcollapseAll();\r\n\t\t\t// Expand all parents of the current block.\r\n\t\t\texpand( blockParents );\r\n\t\t} else if ( isMatch( 'core/block-editor/group', event ) ) {\r\n\t\t\tconst { blocksToUpdate } = getBlocksToUpdate();\r\n\t\t\tif ( blocksToUpdate.length > 1 && isGroupable( blocksToUpdate ) ) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\tconst blocks = getBlocksByClientId( blocksToUpdate );\r\n\t\t\t\tconst groupingBlockName = getGroupingBlockName();\r\n\t\t\t\tconst newBlocks = switchToBlockType(\r\n\t\t\t\t\tblocks,\r\n\t\t\t\t\tgroupingBlockName\r\n\t\t\t\t);\r\n\t\t\t\treplaceBlocks( blocksToUpdate, newBlocks );\r\n\t\t\t\tspeak( __( 'Selected blocks are grouped.' ) );\r\n\t\t\t\tconst newlySelectedBlocks = getSelectedBlockClientIds();\r\n\t\t\t\t// Focus the first block of the newly inserted blocks, to keep focus within the list view.\r\n\t\t\t\tsetOpenedBlockSettingsMenu( undefined );\r\n\t\t\t\tupdateFocusAndSelection( newlySelectedBlocks[ 0 ], false );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst onMouseEnter = useCallback( () => {\r\n\t\tsetIsHovered( true );\r\n\t\ttoggleBlockHighlight( clientId, true );\r\n\t}, [ clientId, setIsHovered, toggleBlockHighlight ] );\r\n\tconst onMouseLeave = useCallback( () => {\r\n\t\tsetIsHovered( false );\r\n\t\ttoggleBlockHighlight( clientId, false );\r\n\t}, [ clientId, setIsHovered, toggleBlockHighlight ] );\r\n\r\n\tconst selectEditorBlock = useCallback(\r\n\t\t( event ) => {\r\n\t\t\tselectBlock( event, clientId );\r\n\t\t\tevent.preventDefault();\r\n\t\t},\r\n\t\t[ clientId, selectBlock ]\r\n\t);\r\n\r\n\tconst updateFocusAndSelection = useCallback(\r\n\t\t( focusClientId, shouldSelectBlock ) => {\r\n\t\t\tif ( shouldSelectBlock ) {\r\n\t\t\t\tselectBlock( undefined, focusClientId, null, null );\r\n\t\t\t}\r\n\r\n\t\t\tfocusListItem( focusClientId, treeGridElementRef?.current );\r\n\t\t},\r\n\t\t[ selectBlock, treeGridElementRef ]\r\n\t);\r\n\r\n\tconst toggleExpanded = useCallback(\r\n\t\t( event ) => {\r\n\t\t\t// Prevent shift+click from opening link in a new window when toggling.\r\n\t\t\tevent.preventDefault();\r\n\t\t\tevent.stopPropagation();\r\n\t\t\tif ( isExpanded === true ) {\r\n\t\t\t\tcollapse( clientId );\r\n\t\t\t} else if ( isExpanded === false ) {\r\n\t\t\t\texpand( clientId );\r\n\t\t\t}\r\n\t\t},\r\n\t\t[ clientId, expand, collapse, isExpanded ]\r\n\t);\r\n\r\n\t// Allow right-clicking an item in the List View to open up the block settings dropdown.\r\n\tconst onContextMenu = useCallback(\r\n\t\t( event ) => {\r\n\t\t\tif ( showBlockActions && allowRightClickOverrides ) {\r\n\t\t\t\tsettingsRef.current?.click();\r\n\t\t\t\t// Ensure the position of the settings dropdown is at the cursor.\r\n\t\t\t\tsetSettingsAnchorRect(\r\n\t\t\t\t\tnew window.DOMRect( event.clientX, event.clientY, 0, 0 )\r\n\t\t\t\t);\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t}\r\n\t\t},\r\n\t\t[ allowRightClickOverrides, settingsRef, showBlockActions ]\r\n\t);\r\n\r\n\tconst onMouseDown = useCallback(\r\n\t\t( event ) => {\r\n\t\t\t// Prevent right-click from focusing the block,\r\n\t\t\t// because focus will be handled when opening the block settings dropdown.\r\n\t\t\tif ( allowRightClickOverrides && event.button === 2 ) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t}\r\n\t\t},\r\n\t\t[ allowRightClickOverrides ]\r\n\t);\r\n\r\n\tconst settingsPopoverAnchor = useMemo( () => {\r\n\t\tconst { ownerDocument } = rowRef?.current || {};\r\n\r\n\t\t// If no custom position is set, the settings dropdown will be anchored to the\r\n\t\t// DropdownMenu toggle button.\r\n\t\tif ( ! settingsAnchorRect || ! ownerDocument ) {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\r\n\t\t// Position the settings dropdown at the cursor when right-clicking a block.\r\n\t\treturn {\r\n\t\t\townerDocument,\r\n\t\t\tgetBoundingClientRect() {\r\n\t\t\t\treturn settingsAnchorRect;\r\n\t\t\t},\r\n\t\t};\r\n\t}, [ settingsAnchorRect ] );\r\n\r\n\tconst clearSettingsAnchorRect = useCallback( () => {\r\n\t\t// Clear the custom position for the settings dropdown so that it is restored back\r\n\t\t// to being anchored to the DropdownMenu toggle button.\r\n\t\tsetSettingsAnchorRect( undefined );\r\n\t}, [ setSettingsAnchorRect ] );\r\n\r\n\t// Pass in a ref to the row, so that it can be scrolled\r\n\t// into view when selected. For long lists, the placeholder for the\r\n\t// selected block is also observed, within ListViewLeafPlaceholder.\r\n\tuseListViewScrollIntoView( {\r\n\t\tisSelected,\r\n\t\trowItemRef: rowRef,\r\n\t\tselectedClientIds,\r\n\t} );\r\n\r\n\t// When switching between rendering modes (such as template preview and content only),\r\n\t// it is possible for a block to temporarily be unavailable. In this case, we should not\r\n\t// render the leaf, to avoid errors further down the tree.\r\n\tif ( ! block ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconst blockPositionDescription = getBlockPositionDescription(\r\n\t\tposition,\r\n\t\tsiblingBlockCount,\r\n\t\tlevel\r\n\t);\r\n\r\n\tconst blockPropertiesDescription = getBlockPropertiesDescription(\r\n\t\tblockInformation,\r\n\t\tisLocked\r\n\t);\r\n\r\n\tconst hasSiblings = siblingBlockCount > 0;\r\n\tconst hasRenderedMovers = showBlockMovers && hasSiblings;\r\n\tconst moverCellClassName = clsx(\r\n\t\t'block-editor-list-view-block__mover-cell',\r\n\t\t{ 'is-visible': isHovered || isSelected }\r\n\t);\r\n\r\n\tconst listViewBlockSettingsClassName = clsx(\r\n\t\t'block-editor-list-view-block__menu-cell',\r\n\t\t{ 'is-visible': isHovered || isFirstSelectedBlock }\r\n\t);\r\n\r\n\tlet colSpan;\r\n\tif ( hasRenderedMovers ) {\r\n\t\tcolSpan = 2;\r\n\t} else if ( ! showBlockActions ) {\r\n\t\tcolSpan = 3;\r\n\t}\r\n\r\n\tconst classes = clsx( {\r\n\t\t'is-selected': isSelected,\r\n\t\t'is-first-selected': isFirstSelectedBlock,\r\n\t\t'is-last-selected': isLastSelectedBlock,\r\n\t\t'is-branch-selected': isBranchSelected,\r\n\t\t'is-synced-branch': isSyncedBranch,\r\n\t\t'is-dragging': isDragged,\r\n\t\t'has-single-cell': ! showBlockActions,\r\n\t\t'is-synced': blockInformation?.isSynced,\r\n\t\t'is-draggable': canMove,\r\n\t\t'is-displacement-normal': displacement === 'normal',\r\n\t\t'is-displacement-up': displacement === 'up',\r\n\t\t'is-displacement-down': displacement === 'down',\r\n\t\t'is-after-dragged-blocks': isAfterDraggedBlocks,\r\n\t\t'is-nesting': isNesting,\r\n\t} );\r\n\r\n\t// Only include all selected blocks if the currently clicked on block\r\n\t// is one of the selected blocks. This ensures that if a user attempts\r\n\t// to alter a block that isn't part of the selection, they're still able\r\n\t// to do so.\r\n\tconst dropdownClientIds = selectedClientIds.includes( clientId )\r\n\t\t? selectedClientIds\r\n\t\t: [ clientId ];\r\n\r\n\t// Detect if there is a block in the canvas currently being edited and multi-selection is not happening.\r\n\tconst currentlyEditingBlockInCanvas =\r\n\t\tisSelected && selectedClientIds.length === 1;\r\n\r\n\treturn (\r\n\t\t<ListViewLeaf\r\n\t\t\tclassName={ classes }\r\n\t\t\tisDragged={ isDragged }\r\n\t\t\tonKeyDown={ onKeyDown }\r\n\t\t\tonMouseEnter={ onMouseEnter }\r\n\t\t\tonMouseLeave={ onMouseLeave }\r\n\t\t\tonFocus={ onMouseEnter }\r\n\t\t\tonBlur={ onMouseLeave }\r\n\t\t\tlevel={ level }\r\n\t\t\tposition={ position }\r\n\t\t\trowCount={ rowCount }\r\n\t\t\tpath={ path }\r\n\t\t\tid={ `list-view-${ listViewInstanceId }-block-${ clientId }` }\r\n\t\t\tdata-block={ clientId }\r\n\t\t\tdata-expanded={ canEdit ? isExpanded : undefined }\r\n\t\t\tref={ rowRef }\r\n\t\t>\r\n\t\t\t<TreeGridCell\r\n\t\t\t\tclassName=\"block-editor-list-view-block__contents-cell\"\r\n\t\t\t\tcolSpan={ colSpan }\r\n\t\t\t\tref={ cellRef }\r\n\t\t\t\taria-selected={ !! isSelected }\r\n\t\t\t>\r\n\t\t\t\t{ ( { ref, tabIndex, onFocus } ) => (\r\n\t\t\t\t\t<div className=\"block-editor-list-view-block__contents-container\">\r\n\t\t\t\t\t\t<ListViewBlockContents\r\n\t\t\t\t\t\t\tblock={ block }\r\n\t\t\t\t\t\t\tonClick={ selectEditorBlock }\r\n\t\t\t\t\t\t\tonContextMenu={ onContextMenu }\r\n\t\t\t\t\t\t\tonMouseDown={ onMouseDown }\r\n\t\t\t\t\t\t\tonToggleExpanded={ toggleExpanded }\r\n\t\t\t\t\t\t\tisSelected={ isSelected }\r\n\t\t\t\t\t\t\tposition={ position }\r\n\t\t\t\t\t\t\tsiblingBlockCount={ siblingBlockCount }\r\n\t\t\t\t\t\t\tlevel={ level }\r\n\t\t\t\t\t\t\tref={ ref }\r\n\t\t\t\t\t\t\ttabIndex={\r\n\t\t\t\t\t\t\t\tcurrentlyEditingBlockInCanvas ? 0 : tabIndex\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tonFocus={ onFocus }\r\n\t\t\t\t\t\t\tisExpanded={ canEdit ? isExpanded : undefined }\r\n\t\t\t\t\t\t\tselectedClientIds={ selectedClientIds }\r\n\t\t\t\t\t\t\tariaDescribedBy={ descriptionId }\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<AriaReferencedText id={ descriptionId }>\r\n\t\t\t\t\t\t\t{ [\r\n\t\t\t\t\t\t\t\tblockPositionDescription,\r\n\t\t\t\t\t\t\t\tblockPropertiesDescription,\r\n\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t\t\t.filter( Boolean )\r\n\t\t\t\t\t\t\t\t.join( ' ' ) }\r\n\t\t\t\t\t\t</AriaReferencedText>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t) }\r\n\t\t\t</TreeGridCell>\r\n\t\t\t{ hasRenderedMovers && (\r\n\t\t\t\t<>\r\n\t\t\t\t\t<TreeGridCell\r\n\t\t\t\t\t\tclassName={ moverCellClassName }\r\n\t\t\t\t\t\twithoutGridItem\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<TreeGridItem>\r\n\t\t\t\t\t\t\t{ ( { ref, tabIndex, onFocus } ) => (\r\n\t\t\t\t\t\t\t\t<BlockMoverUpButton\r\n\t\t\t\t\t\t\t\t\torientation=\"vertical\"\r\n\t\t\t\t\t\t\t\t\tclientIds={ [ clientId ] }\r\n\t\t\t\t\t\t\t\t\tref={ ref }\r\n\t\t\t\t\t\t\t\t\ttabIndex={ tabIndex }\r\n\t\t\t\t\t\t\t\t\tonFocus={ onFocus }\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t</TreeGridItem>\r\n\t\t\t\t\t\t<TreeGridItem>\r\n\t\t\t\t\t\t\t{ ( { ref, tabIndex, onFocus } ) => (\r\n\t\t\t\t\t\t\t\t<BlockMoverDownButton\r\n\t\t\t\t\t\t\t\t\torientation=\"vertical\"\r\n\t\t\t\t\t\t\t\t\tclientIds={ [ clientId ] }\r\n\t\t\t\t\t\t\t\t\tref={ ref }\r\n\t\t\t\t\t\t\t\t\ttabIndex={ tabIndex }\r\n\t\t\t\t\t\t\t\t\tonFocus={ onFocus }\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t</TreeGridItem>\r\n\t\t\t\t\t</TreeGridCell>\r\n\t\t\t\t</>\r\n\t\t\t) }\r\n\r\n\t\t\t{ showBlockActions && BlockSettingsMenu && (\r\n\t\t\t\t<TreeGridCell\r\n\t\t\t\t\tclassName={ listViewBlockSettingsClassName }\r\n\t\t\t\t\taria-selected={ !! isSelected }\r\n\t\t\t\t\tref={ settingsRef }\r\n\t\t\t\t>\r\n\t\t\t\t\t{ ( { ref, tabIndex, onFocus } ) => (\r\n\t\t\t\t\t\t<BlockSettingsMenu\r\n\t\t\t\t\t\t\tclientIds={ dropdownClientIds }\r\n\t\t\t\t\t\t\tblock={ block }\r\n\t\t\t\t\t\t\ticon={ moreVertical }\r\n\t\t\t\t\t\t\tlabel={ __( 'Options' ) }\r\n\t\t\t\t\t\t\tpopoverProps={ {\r\n\t\t\t\t\t\t\t\tanchor: settingsPopoverAnchor, // Used to position the settings at the cursor on right-click.\r\n\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\ttoggleProps={ {\r\n\t\t\t\t\t\t\t\tref,\r\n\t\t\t\t\t\t\t\tclassName: 'block-editor-list-view-block__menu',\r\n\t\t\t\t\t\t\t\ttabIndex,\r\n\t\t\t\t\t\t\t\tonClick: clearSettingsAnchorRect,\r\n\t\t\t\t\t\t\t\tonFocus,\r\n\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\tdisableOpenOnArrowDown\r\n\t\t\t\t\t\t\texpand={ expand }\r\n\t\t\t\t\t\t\texpandedState={ expandedState }\r\n\t\t\t\t\t\t\tsetInsertedBlock={ setInsertedBlock }\r\n\t\t\t\t\t\t\t__experimentalSelectBlock={\r\n\t\t\t\t\t\t\t\tupdateFocusAndSelection\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t) }\r\n\t\t\t\t</TreeGridCell>\r\n\t\t\t) }\r\n\t\t</ListViewLeaf>\r\n\t);\r\n}\r\n\r\nexport default memo( ListViewBlock );\r\n"],"mappings":"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","ignoreList":[]}