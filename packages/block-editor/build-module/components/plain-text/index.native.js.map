{"version":3,"names":["TextInput","Platform","Dimensions","Component","getPxFromCssUnit","RichText","styles","jsx","_jsx","PlainText","constructor","arguments","isAndroid","OS","onChangeTextInput","bind","onChangeRichText","componentDidMount","_input","isFocused","props","isSelected","timeoutID","setTimeout","focus","componentDidUpdate","prevProps","blur","componentWillUnmount","clearTimeout","getFontSize","style","fontSize","width","height","get","cssUnitOptions","parseFloat","replaceLineBreakTags","value","replace","RegExp","event","onChange","nativeEvent","text","render","__experimentalVersion","onFocus","otherProps","textStyles","disableFormattingProps","withoutInteractiveFormatting","disableEditingMenu","__unstableDisableFormats","disableSuggestions","forcePlainTextProps","preserveWhiteSpace","__unstablePastePlainText","multiline","fontProps","fontFamily","fontWeight","identifier","unstableOnFocus","ref","x","onBlur","scrollEnabled"],"sources":["@wordpress/block-editor/src/components/plain-text/index.native.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport { TextInput, Platform, Dimensions } from 'react-native';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { Component } from '@wordpress/element';\r\nimport { getPxFromCssUnit } from '@wordpress/components';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport RichText from '../rich-text';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport styles from './style.scss';\r\n\r\nexport default class PlainText extends Component {\r\n\tconstructor() {\r\n\t\tsuper( ...arguments );\r\n\t\tthis.isAndroid = Platform.OS === 'android';\r\n\r\n\t\tthis.onChangeTextInput = this.onChangeTextInput.bind( this );\r\n\t\tthis.onChangeRichText = this.onChangeRichText.bind( this );\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\t// If isSelected is true, we should request the focus on this TextInput.\r\n\t\tif (\r\n\t\t\tthis._input &&\r\n\t\t\tthis._input.isFocused() === false &&\r\n\t\t\tthis.props.isSelected\r\n\t\t) {\r\n\t\t\tif ( this.isAndroid ) {\r\n\t\t\t\t/*\r\n\t\t\t\t * There seems to be an issue in React Native where the keyboard doesn't show if called shortly after rendering.\r\n\t\t\t\t * As a common work around this delay is used.\r\n\t\t\t\t * https://github.com/facebook/react-native/issues/19366#issuecomment-400603928\r\n\t\t\t\t */\r\n\t\t\t\tthis.timeoutID = setTimeout( () => {\r\n\t\t\t\t\tthis._input.focus();\r\n\t\t\t\t}, 100 );\r\n\t\t\t} else {\r\n\t\t\t\tthis._input.focus();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentDidUpdate( prevProps ) {\r\n\t\tif ( ! this.props.isSelected && prevProps.isSelected ) {\r\n\t\t\tthis._input?.blur();\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tif ( this.isAndroid ) {\r\n\t\t\tclearTimeout( this.timeoutID );\r\n\t\t}\r\n\t}\r\n\r\n\tfocus() {\r\n\t\tthis._input?.focus();\r\n\t}\r\n\r\n\tblur() {\r\n\t\tthis._input?.blur();\r\n\t}\r\n\r\n\tgetFontSize() {\r\n\t\tconst { style } = this.props;\r\n\r\n\t\tif ( ! style?.fontSize ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst { width, height } = Dimensions.get( 'window' );\r\n\t\tconst cssUnitOptions = { height, width };\r\n\r\n\t\treturn {\r\n\t\t\tfontSize: parseFloat(\r\n\t\t\t\tgetPxFromCssUnit( style.fontSize, cssUnitOptions )\r\n\t\t\t),\r\n\t\t};\r\n\t}\r\n\r\n\treplaceLineBreakTags( value ) {\r\n\t\treturn value?.replace( RegExp( '<br>', 'gim' ), '\\n' );\r\n\t}\r\n\r\n\tonChangeTextInput( event ) {\r\n\t\tconst { onChange } = this.props;\r\n\t\tonChange( event.nativeEvent.text );\r\n\t}\r\n\r\n\tonChangeRichText( value ) {\r\n\t\tconst { onChange } = this.props;\r\n\t\t// The <br> tags have to be replaced with new line characters\r\n\t\t// as the content of plain text shouldn't contain HTML tags.\r\n\t\tonChange( this.replaceLineBreakTags( value ) );\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { style, __experimentalVersion, onFocus, ...otherProps } =\r\n\t\t\tthis.props;\r\n\t\tconst textStyles = [\r\n\t\t\tstyle || styles[ 'block-editor-plain-text' ],\r\n\t\t\tthis.getFontSize(),\r\n\t\t];\r\n\r\n\t\tif ( __experimentalVersion === 2 ) {\r\n\t\t\tconst disableFormattingProps = {\r\n\t\t\t\twithoutInteractiveFormatting: true,\r\n\t\t\t\tdisableEditingMenu: true,\r\n\t\t\t\t__unstableDisableFormats: true,\r\n\t\t\t\tdisableSuggestions: true,\r\n\t\t\t};\r\n\r\n\t\t\tconst forcePlainTextProps = {\r\n\t\t\t\tpreserveWhiteSpace: true,\r\n\t\t\t\t__unstablePastePlainText: true,\r\n\t\t\t\tmultiline: false,\r\n\t\t\t};\r\n\r\n\t\t\tconst fontProps = {\r\n\t\t\t\tfontFamily: style?.fontFamily,\r\n\t\t\t\tfontSize: style?.fontSize,\r\n\t\t\t\tfontWeight: style?.fontWeight,\r\n\t\t\t};\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<RichText\r\n\t\t\t\t\t{ ...otherProps }\r\n\t\t\t\t\t{ ...disableFormattingProps }\r\n\t\t\t\t\t{ ...forcePlainTextProps }\r\n\t\t\t\t\t{ ...fontProps }\r\n\t\t\t\t\tidentifier=\"content\"\r\n\t\t\t\t\tstyle={ style }\r\n\t\t\t\t\tonChange={ this.onChangeRichText }\r\n\t\t\t\t\tunstableOnFocus={ onFocus }\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<TextInput\r\n\t\t\t\t{ ...this.props }\r\n\t\t\t\tref={ ( x ) => ( this._input = x ) }\r\n\t\t\t\tonChange={ this.onChangeTextInput }\r\n\t\t\t\tonFocus={ this.props.onFocus } // Always assign onFocus as a props.\r\n\t\t\t\tonBlur={ this.props.onBlur } // Always assign onBlur as a props.\r\n\t\t\t\tfontFamily={\r\n\t\t\t\t\t( this.props.style && this.props.style.fontFamily ) ||\r\n\t\t\t\t\tstyles[ 'block-editor-plain-text' ].fontFamily\r\n\t\t\t\t}\r\n\t\t\t\tstyle={ textStyles }\r\n\t\t\t\tscrollEnabled={ false }\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}\r\n"],"mappings":"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","ignoreList":[]}