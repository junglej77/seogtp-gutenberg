{"version":3,"names":["ENTER","insert","remove","props","element","onKeyDownDeprecated","event","keyCode","onReplace","onSplit","current","__deprecatedOnSplit","onKeyDown","defaultPrevented","target","value","onChange","disableLineBreaks","onSplitAtEnd","onSplitAtDoubleLineEnd","registry","preventDefault","text","start","end","shiftKey","length","slice","batch","_value","defaultView","ownerDocument","addEventListener","removeEventListener"],"sources":["@wordpress/block-editor/src/components/rich-text/event-listeners/enter.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { ENTER } from '@wordpress/keycodes';\r\nimport { insert, remove } from '@wordpress/rich-text';\r\n\r\nexport default ( props ) => ( element ) => {\r\n\tfunction onKeyDownDeprecated( event ) {\r\n\t\tif ( event.keyCode !== ENTER ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst { onReplace, onSplit } = props.current;\r\n\r\n\t\tif ( onReplace && onSplit ) {\r\n\t\t\tevent.__deprecatedOnSplit = true;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction onKeyDown( event ) {\r\n\t\tif ( event.defaultPrevented ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// The event listener is attached to the window, so we need to check if\r\n\t\t// the target is the element.\r\n\t\tif ( event.target !== element ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif ( event.keyCode !== ENTER ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst {\r\n\t\t\tvalue,\r\n\t\t\tonChange,\r\n\t\t\tdisableLineBreaks,\r\n\t\t\tonSplitAtEnd,\r\n\t\t\tonSplitAtDoubleLineEnd,\r\n\t\t\tregistry,\r\n\t\t} = props.current;\r\n\r\n\t\tevent.preventDefault();\r\n\r\n\t\tconst { text, start, end } = value;\r\n\r\n\t\tif ( event.shiftKey ) {\r\n\t\t\tif ( ! disableLineBreaks ) {\r\n\t\t\t\tonChange( insert( value, '\\n' ) );\r\n\t\t\t}\r\n\t\t} else if ( onSplitAtEnd && start === end && end === text.length ) {\r\n\t\t\tonSplitAtEnd();\r\n\t\t} else if (\r\n\t\t\t// For some blocks it's desirable to split at the end of the\r\n\t\t\t// block when there are two line breaks at the end of the\r\n\t\t\t// block, so triple Enter exits the block.\r\n\t\t\tonSplitAtDoubleLineEnd &&\r\n\t\t\tstart === end &&\r\n\t\t\tend === text.length &&\r\n\t\t\ttext.slice( -2 ) === '\\n\\n'\r\n\t\t) {\r\n\t\t\tregistry.batch( () => {\r\n\t\t\t\tconst _value = { ...value };\r\n\t\t\t\t_value.start = _value.end - 2;\r\n\t\t\t\tonChange( remove( _value ) );\r\n\t\t\t\tonSplitAtDoubleLineEnd();\r\n\t\t\t} );\r\n\t\t} else if ( ! disableLineBreaks ) {\r\n\t\t\tonChange( insert( value, '\\n' ) );\r\n\t\t}\r\n\t}\r\n\r\n\tconst { defaultView } = element.ownerDocument;\r\n\r\n\t// Attach the listener to the window so parent elements have the chance to\r\n\t// prevent the default behavior.\r\n\tdefaultView.addEventListener( 'keydown', onKeyDown );\r\n\telement.addEventListener( 'keydown', onKeyDownDeprecated );\r\n\treturn () => {\r\n\t\tdefaultView.removeEventListener( 'keydown', onKeyDown );\r\n\t\telement.removeEventListener( 'keydown', onKeyDownDeprecated );\r\n\t};\r\n};\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,KAAK,QAAQ,qBAAqB;AAC3C,SAASC,MAAM,EAAEC,MAAM,QAAQ,sBAAsB;AAErD,gBAAiBC,KAAK,IAAQC,OAAO,IAAM;EAC1C,SAASC,mBAAmBA,CAAEC,KAAK,EAAG;IACrC,IAAKA,KAAK,CAACC,OAAO,KAAKP,KAAK,EAAG;MAC9B;IACD;IAEA,MAAM;MAAEQ,SAAS;MAAEC;IAAQ,CAAC,GAAGN,KAAK,CAACO,OAAO;IAE5C,IAAKF,SAAS,IAAIC,OAAO,EAAG;MAC3BH,KAAK,CAACK,mBAAmB,GAAG,IAAI;IACjC;EACD;EAEA,SAASC,SAASA,CAAEN,KAAK,EAAG;IAC3B,IAAKA,KAAK,CAACO,gBAAgB,EAAG;MAC7B;IACD;;IAEA;IACA;IACA,IAAKP,KAAK,CAACQ,MAAM,KAAKV,OAAO,EAAG;MAC/B;IACD;IAEA,IAAKE,KAAK,CAACC,OAAO,KAAKP,KAAK,EAAG;MAC9B;IACD;IAEA,MAAM;MACLe,KAAK;MACLC,QAAQ;MACRC,iBAAiB;MACjBC,YAAY;MACZC,sBAAsB;MACtBC;IACD,CAAC,GAAGjB,KAAK,CAACO,OAAO;IAEjBJ,KAAK,CAACe,cAAc,CAAC,CAAC;IAEtB,MAAM;MAAEC,IAAI;MAAEC,KAAK;MAAEC;IAAI,CAAC,GAAGT,KAAK;IAElC,IAAKT,KAAK,CAACmB,QAAQ,EAAG;MACrB,IAAK,CAAER,iBAAiB,EAAG;QAC1BD,QAAQ,CAAEf,MAAM,CAAEc,KAAK,EAAE,IAAK,CAAE,CAAC;MAClC;IACD,CAAC,MAAM,IAAKG,YAAY,IAAIK,KAAK,KAAKC,GAAG,IAAIA,GAAG,KAAKF,IAAI,CAACI,MAAM,EAAG;MAClER,YAAY,CAAC,CAAC;IACf,CAAC,MAAM;IACN;IACA;IACA;IACAC,sBAAsB,IACtBI,KAAK,KAAKC,GAAG,IACbA,GAAG,KAAKF,IAAI,CAACI,MAAM,IACnBJ,IAAI,CAACK,KAAK,CAAE,CAAC,CAAE,CAAC,KAAK,MAAM,EAC1B;MACDP,QAAQ,CAACQ,KAAK,CAAE,MAAM;QACrB,MAAMC,MAAM,GAAG;UAAE,GAAGd;QAAM,CAAC;QAC3Bc,MAAM,CAACN,KAAK,GAAGM,MAAM,CAACL,GAAG,GAAG,CAAC;QAC7BR,QAAQ,CAAEd,MAAM,CAAE2B,MAAO,CAAE,CAAC;QAC5BV,sBAAsB,CAAC,CAAC;MACzB,CAAE,CAAC;IACJ,CAAC,MAAM,IAAK,CAAEF,iBAAiB,EAAG;MACjCD,QAAQ,CAAEf,MAAM,CAAEc,KAAK,EAAE,IAAK,CAAE,CAAC;IAClC;EACD;EAEA,MAAM;IAAEe;EAAY,CAAC,GAAG1B,OAAO,CAAC2B,aAAa;;EAE7C;EACA;EACAD,WAAW,CAACE,gBAAgB,CAAE,SAAS,EAAEpB,SAAU,CAAC;EACpDR,OAAO,CAAC4B,gBAAgB,CAAE,SAAS,EAAE3B,mBAAoB,CAAC;EAC1D,OAAO,MAAM;IACZyB,WAAW,CAACG,mBAAmB,CAAE,SAAS,EAAErB,SAAU,CAAC;IACvDR,OAAO,CAAC6B,mBAAmB,CAAE,SAAS,EAAE5B,mBAAoB,CAAC;EAC9D,CAAC;AACF,CAAC","ignoreList":[]}