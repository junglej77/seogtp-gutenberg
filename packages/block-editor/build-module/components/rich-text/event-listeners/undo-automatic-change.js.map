{"version":3,"names":["BACKSPACE","ESCAPE","store","blockEditorStore","props","element","onKeyDown","event","keyCode","defaultPrevented","registry","current","didAutomaticChange","getSettings","select","__experimentalUndo","preventDefault","addEventListener","removeEventListener"],"sources":["@wordpress/block-editor/src/components/rich-text/event-listeners/undo-automatic-change.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { BACKSPACE, ESCAPE } from '@wordpress/keycodes';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { store as blockEditorStore } from '../../../store';\r\n\r\nexport default ( props ) => ( element ) => {\r\n\tfunction onKeyDown( event ) {\r\n\t\tconst { keyCode } = event;\r\n\r\n\t\tif ( event.defaultPrevented ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif ( keyCode !== BACKSPACE && keyCode !== ESCAPE ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst { registry } = props.current;\r\n\t\tconst { didAutomaticChange, getSettings } =\r\n\t\t\tregistry.select( blockEditorStore );\r\n\r\n\t\tconst { __experimentalUndo } = getSettings();\r\n\r\n\t\tif ( ! __experimentalUndo ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif ( ! didAutomaticChange() ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tevent.preventDefault();\r\n\t\t__experimentalUndo();\r\n\t}\r\n\r\n\telement.addEventListener( 'keydown', onKeyDown );\r\n\treturn () => {\r\n\t\telement.removeEventListener( 'keydown', onKeyDown );\r\n\t};\r\n};\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,SAAS,EAAEC,MAAM,QAAQ,qBAAqB;;AAEvD;AACA;AACA;AACA,SAASC,KAAK,IAAIC,gBAAgB,QAAQ,gBAAgB;AAE1D,gBAAiBC,KAAK,IAAQC,OAAO,IAAM;EAC1C,SAASC,SAASA,CAAEC,KAAK,EAAG;IAC3B,MAAM;MAAEC;IAAQ,CAAC,GAAGD,KAAK;IAEzB,IAAKA,KAAK,CAACE,gBAAgB,EAAG;MAC7B;IACD;IAEA,IAAKD,OAAO,KAAKR,SAAS,IAAIQ,OAAO,KAAKP,MAAM,EAAG;MAClD;IACD;IAEA,MAAM;MAAES;IAAS,CAAC,GAAGN,KAAK,CAACO,OAAO;IAClC,MAAM;MAAEC,kBAAkB;MAAEC;IAAY,CAAC,GACxCH,QAAQ,CAACI,MAAM,CAAEX,gBAAiB,CAAC;IAEpC,MAAM;MAAEY;IAAmB,CAAC,GAAGF,WAAW,CAAC,CAAC;IAE5C,IAAK,CAAEE,kBAAkB,EAAG;MAC3B;IACD;IAEA,IAAK,CAAEH,kBAAkB,CAAC,CAAC,EAAG;MAC7B;IACD;IAEAL,KAAK,CAACS,cAAc,CAAC,CAAC;IACtBD,kBAAkB,CAAC,CAAC;EACrB;EAEAV,OAAO,CAACY,gBAAgB,CAAE,SAAS,EAAEX,SAAU,CAAC;EAChD,OAAO,MAAM;IACZD,OAAO,CAACa,mBAAmB,CAAE,SAAS,EAAEZ,SAAU,CAAC;EACpD,CAAC;AACF,CAAC","ignoreList":[]}