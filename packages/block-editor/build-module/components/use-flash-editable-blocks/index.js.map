{"version":3,"names":["useRefEffect","useSelect","store","blockEditorStore","unlock","useFlashEditableBlocks","clientId","isEnabled","getEnabledClientIdsTree","element","flashEditableBlocks","forEach","id","block","querySelector","classList","remove","offsetWidth","add","handleClick","event","shouldFlash","target","contains","defaultPrevented","preventDefault","addEventListener","removeEventListener"],"sources":["@wordpress/block-editor/src/components/use-flash-editable-blocks/index.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useRefEffect } from '@wordpress/compose';\r\nimport { useSelect } from '@wordpress/data';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { store as blockEditorStore } from '../../store';\r\nimport { unlock } from '../../lock-unlock';\r\n\r\nexport function useFlashEditableBlocks( {\r\n\tclientId = '',\r\n\tisEnabled = true,\r\n} = {} ) {\r\n\tconst { getEnabledClientIdsTree } = unlock( useSelect( blockEditorStore ) );\r\n\r\n\treturn useRefEffect(\r\n\t\t( element ) => {\r\n\t\t\tif ( ! isEnabled ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst flashEditableBlocks = () => {\r\n\t\t\t\tgetEnabledClientIdsTree( clientId ).forEach(\r\n\t\t\t\t\t( { clientId: id } ) => {\r\n\t\t\t\t\t\tconst block = element.querySelector(\r\n\t\t\t\t\t\t\t`[data-block=\"${ id }\"]`\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tif ( ! block ) {\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tblock.classList.remove( 'has-editable-outline' );\r\n\t\t\t\t\t\t// Force reflow to trigger the animation.\r\n\t\t\t\t\t\t// eslint-disable-next-line no-unused-expressions\r\n\t\t\t\t\t\tblock.offsetWidth;\r\n\t\t\t\t\t\tblock.classList.add( 'has-editable-outline' );\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t};\r\n\r\n\t\t\tconst handleClick = ( event ) => {\r\n\t\t\t\tconst shouldFlash =\r\n\t\t\t\t\tevent.target === element ||\r\n\t\t\t\t\tevent.target.classList.contains( 'is-root-container' );\r\n\t\t\t\tif ( ! shouldFlash ) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif ( event.defaultPrevented ) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\tflashEditableBlocks();\r\n\t\t\t};\r\n\r\n\t\t\telement.addEventListener( 'click', handleClick );\r\n\t\t\treturn () => element.removeEventListener( 'click', handleClick );\r\n\t\t},\r\n\t\t[ isEnabled ]\r\n\t);\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,YAAY,QAAQ,oBAAoB;AACjD,SAASC,SAAS,QAAQ,iBAAiB;;AAE3C;AACA;AACA;AACA,SAASC,KAAK,IAAIC,gBAAgB,QAAQ,aAAa;AACvD,SAASC,MAAM,QAAQ,mBAAmB;AAE1C,OAAO,SAASC,sBAAsBA,CAAE;EACvCC,QAAQ,GAAG,EAAE;EACbC,SAAS,GAAG;AACb,CAAC,GAAG,CAAC,CAAC,EAAG;EACR,MAAM;IAAEC;EAAwB,CAAC,GAAGJ,MAAM,CAAEH,SAAS,CAAEE,gBAAiB,CAAE,CAAC;EAE3E,OAAOH,YAAY,CAChBS,OAAO,IAAM;IACd,IAAK,CAAEF,SAAS,EAAG;MAClB;IACD;IAEA,MAAMG,mBAAmB,GAAGA,CAAA,KAAM;MACjCF,uBAAuB,CAAEF,QAAS,CAAC,CAACK,OAAO,CAC1C,CAAE;QAAEL,QAAQ,EAAEM;MAAG,CAAC,KAAM;QACvB,MAAMC,KAAK,GAAGJ,OAAO,CAACK,aAAa,CACjC,gBAAgBF,EAAI,IACtB,CAAC;QACD,IAAK,CAAEC,KAAK,EAAG;UACd;QACD;QACAA,KAAK,CAACE,SAAS,CAACC,MAAM,CAAE,sBAAuB,CAAC;QAChD;QACA;QACAH,KAAK,CAACI,WAAW;QACjBJ,KAAK,CAACE,SAAS,CAACG,GAAG,CAAE,sBAAuB,CAAC;MAC9C,CACD,CAAC;IACF,CAAC;IAED,MAAMC,WAAW,GAAKC,KAAK,IAAM;MAChC,MAAMC,WAAW,GAChBD,KAAK,CAACE,MAAM,KAAKb,OAAO,IACxBW,KAAK,CAACE,MAAM,CAACP,SAAS,CAACQ,QAAQ,CAAE,mBAAoB,CAAC;MACvD,IAAK,CAAEF,WAAW,EAAG;QACpB;MACD;MACA,IAAKD,KAAK,CAACI,gBAAgB,EAAG;QAC7B;MACD;MACAJ,KAAK,CAACK,cAAc,CAAC,CAAC;MACtBf,mBAAmB,CAAC,CAAC;IACtB,CAAC;IAEDD,OAAO,CAACiB,gBAAgB,CAAE,OAAO,EAAEP,WAAY,CAAC;IAChD,OAAO,MAAMV,OAAO,CAACkB,mBAAmB,CAAE,OAAO,EAAER,WAAY,CAAC;EACjE,CAAC,EACD,CAAEZ,SAAS,CACZ,CAAC;AACF","ignoreList":[]}