{"version":3,"names":["Component","Icon","__","View","TouchableOpacity","Platform","Linking","Alert","default","VideoPlayer","styles","PlayIcon","jsx","_jsx","jsxs","_jsxs","VIDEO_ASPECT_RATIO","Video","constructor","arguments","isIOS","OS","state","isFullScreen","videoContainerHeight","onPressPlay","bind","onVideoLayout","event","height","nativeEvent","layout","setState","player","presentFullscreenPlayer","source","props","uri","openURL","url","canOpenURL","then","supported","alert","window","console","warn","catch","err","error","render","isSelected","style","showPlayButton","videoContainer","children","ref","controls","ignoreSilentSwitch","paused","onLayout","onFullscreenPlayerWillPresent","onFullscreenPlayerDidDismiss","disabled","onPress","overlayContainer","blackOverlay","icon","playIcon","size"],"sources":["@wordpress/block-editor/src/components/video-player/index.native.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { Component } from '@wordpress/element';\r\nimport { Icon } from '@wordpress/components';\r\nimport { __ } from '@wordpress/i18n';\r\n\r\n/**\r\n * External dependencies\r\n */\r\nimport { View, TouchableOpacity, Platform, Linking, Alert } from 'react-native';\r\nimport { default as VideoPlayer } from 'react-native-video';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport styles from './styles.scss';\r\nimport PlayIcon from './gridicon-play';\r\n\r\n// Default Video ratio 16:9\r\nexport const VIDEO_ASPECT_RATIO = 16 / 9;\r\n\r\nclass Video extends Component {\r\n\tconstructor() {\r\n\t\tsuper( ...arguments );\r\n\t\tthis.isIOS = Platform.OS === 'ios';\r\n\t\tthis.state = {\r\n\t\t\tisFullScreen: false,\r\n\t\t\tvideoContainerHeight: 0,\r\n\t\t};\r\n\t\tthis.onPressPlay = this.onPressPlay.bind( this );\r\n\t\tthis.onVideoLayout = this.onVideoLayout.bind( this );\r\n\t}\r\n\r\n\tonVideoLayout( event ) {\r\n\t\tconst { height } = event.nativeEvent.layout;\r\n\t\tif ( height !== this.state.videoContainerHeight ) {\r\n\t\t\tthis.setState( { videoContainerHeight: height } );\r\n\t\t}\r\n\t}\r\n\r\n\tonPressPlay() {\r\n\t\tif ( this.isIOS ) {\r\n\t\t\tif ( this.player ) {\r\n\t\t\t\tthis.player.presentFullscreenPlayer();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconst { source } = this.props;\r\n\t\t\tif ( source && source.uri ) {\r\n\t\t\t\tthis.openURL( source.uri );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// Tries opening the URL outside of the app\r\n\topenURL( url ) {\r\n\t\tLinking.canOpenURL( url )\r\n\t\t\t.then( ( supported ) => {\r\n\t\t\t\tif ( ! supported ) {\r\n\t\t\t\t\tAlert.alert(\r\n\t\t\t\t\t\t__( 'Problem opening the video' ),\r\n\t\t\t\t\t\t__(\r\n\t\t\t\t\t\t\t'No application can handle this request. Please install a Web browser.'\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t);\r\n\t\t\t\t\twindow.console.warn(\r\n\t\t\t\t\t\t'No application found that can open the video with URL: ' +\r\n\t\t\t\t\t\t\turl\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn Linking.openURL( url );\r\n\t\t\t\t}\r\n\t\t\t} )\r\n\t\t\t.catch( ( err ) => {\r\n\t\t\t\tAlert.alert(\r\n\t\t\t\t\t__( 'Problem opening the video' ),\r\n\t\t\t\t\t__( 'An unknown error occurred. Please try again.' )\r\n\t\t\t\t);\r\n\t\t\t\twindow.console.error(\r\n\t\t\t\t\t'An error occurred while opening the video URL: ' + url,\r\n\t\t\t\t\terr\r\n\t\t\t\t);\r\n\t\t\t} );\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { isSelected, style } = this.props;\r\n\t\tconst { isFullScreen, videoContainerHeight } = this.state;\r\n\t\tconst showPlayButton = videoContainerHeight > 0;\r\n\r\n\t\treturn (\r\n\t\t\t<View style={ styles.videoContainer }>\r\n\t\t\t\t<VideoPlayer\r\n\t\t\t\t\t{ ...this.props }\r\n\t\t\t\t\tref={ ( ref ) => {\r\n\t\t\t\t\t\tthis.player = ref;\r\n\t\t\t\t\t} }\r\n\t\t\t\t\t// Using built-in player controls is messing up the layout on iOS.\r\n\t\t\t\t\t// So we are setting controls=false and adding a play button that\r\n\t\t\t\t\t// will trigger presentFullscreenPlayer()\r\n\t\t\t\t\tcontrols={ false }\r\n\t\t\t\t\tignoreSilentSwitch=\"ignore\"\r\n\t\t\t\t\tpaused={ ! isFullScreen }\r\n\t\t\t\t\tonLayout={ this.onVideoLayout }\r\n\t\t\t\t\tonFullscreenPlayerWillPresent={ () => {\r\n\t\t\t\t\t\tthis.setState( { isFullScreen: true } );\r\n\t\t\t\t\t} }\r\n\t\t\t\t\tonFullscreenPlayerDidDismiss={ () => {\r\n\t\t\t\t\t\tthis.setState( { isFullScreen: false } );\r\n\t\t\t\t\t} }\r\n\t\t\t\t/>\r\n\t\t\t\t{ showPlayButton && (\r\n\t\t\t\t\t// If we add the play icon as a subview to VideoPlayer then react-native-video decides to show control buttons\r\n\t\t\t\t\t// even if we set controls={ false }, so we are adding our play button as a sibling overlay view.\r\n\t\t\t\t\t<TouchableOpacity\r\n\t\t\t\t\t\tdisabled={ ! isSelected }\r\n\t\t\t\t\t\tonPress={ this.onPressPlay }\r\n\t\t\t\t\t\tstyle={ [ style, styles.overlayContainer ] }\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<View style={ styles.blackOverlay } />\r\n\t\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t\ticon={ PlayIcon }\r\n\t\t\t\t\t\t\tstyle={ styles.playIcon }\r\n\t\t\t\t\t\t\tsize={ styles.playIcon.size }\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</TouchableOpacity>\r\n\t\t\t\t) }\r\n\t\t\t</View>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default Video;\r\n"],"mappings":"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","ignoreList":[]}