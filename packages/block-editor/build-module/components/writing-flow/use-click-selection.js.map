{"version":3,"names":["useSelect","useDispatch","useRefEffect","store","blockEditorStore","getBlockClientId","useClickSelection","selectBlock","isSelectionEnabled","getBlockSelectionStart","hasMultiSelection","node","onMouseDown","event","button","startClientId","clickedClientId","target","shiftKey","contentEditable","focus","addEventListener","removeEventListener"],"sources":["@wordpress/block-editor/src/components/writing-flow/use-click-selection.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useSelect, useDispatch } from '@wordpress/data';\r\nimport { useRefEffect } from '@wordpress/compose';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { store as blockEditorStore } from '../../store';\r\nimport { getBlockClientId } from '../../utils/dom';\r\n\r\nexport default function useClickSelection() {\r\n\tconst { selectBlock } = useDispatch( blockEditorStore );\r\n\tconst { isSelectionEnabled, getBlockSelectionStart, hasMultiSelection } =\r\n\t\tuseSelect( blockEditorStore );\r\n\treturn useRefEffect(\r\n\t\t( node ) => {\r\n\t\t\tfunction onMouseDown( event ) {\r\n\t\t\t\t// The main button.\r\n\t\t\t\t// https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/button\r\n\t\t\t\tif ( ! isSelectionEnabled() || event.button !== 0 ) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst startClientId = getBlockSelectionStart();\r\n\t\t\t\tconst clickedClientId = getBlockClientId( event.target );\r\n\r\n\t\t\t\tif ( event.shiftKey ) {\r\n\t\t\t\t\tif ( startClientId !== clickedClientId ) {\r\n\t\t\t\t\t\tnode.contentEditable = true;\r\n\t\t\t\t\t\t// Firefox doesn't automatically move focus.\r\n\t\t\t\t\t\tnode.focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if ( hasMultiSelection() ) {\r\n\t\t\t\t\t// Allow user to escape out of a multi-selection to a\r\n\t\t\t\t\t// singular selection of a block via click. This is handled\r\n\t\t\t\t\t// here since focus handling excludes blocks when there is\r\n\t\t\t\t\t// multiselection, as focus can be incurred by starting a\r\n\t\t\t\t\t// multiselection (focus moved to first block's multi-\r\n\t\t\t\t\t// controls).\r\n\t\t\t\t\tselectBlock( clickedClientId );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tnode.addEventListener( 'mousedown', onMouseDown );\r\n\r\n\t\t\treturn () => {\r\n\t\t\t\tnode.removeEventListener( 'mousedown', onMouseDown );\r\n\t\t\t};\r\n\t\t},\r\n\t\t[\r\n\t\t\tselectBlock,\r\n\t\t\tisSelectionEnabled,\r\n\t\t\tgetBlockSelectionStart,\r\n\t\t\thasMultiSelection,\r\n\t\t]\r\n\t);\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,SAAS,EAAEC,WAAW,QAAQ,iBAAiB;AACxD,SAASC,YAAY,QAAQ,oBAAoB;;AAEjD;AACA;AACA;AACA,SAASC,KAAK,IAAIC,gBAAgB,QAAQ,aAAa;AACvD,SAASC,gBAAgB,QAAQ,iBAAiB;AAElD,eAAe,SAASC,iBAAiBA,CAAA,EAAG;EAC3C,MAAM;IAAEC;EAAY,CAAC,GAAGN,WAAW,CAAEG,gBAAiB,CAAC;EACvD,MAAM;IAAEI,kBAAkB;IAAEC,sBAAsB;IAAEC;EAAkB,CAAC,GACtEV,SAAS,CAAEI,gBAAiB,CAAC;EAC9B,OAAOF,YAAY,CAChBS,IAAI,IAAM;IACX,SAASC,WAAWA,CAAEC,KAAK,EAAG;MAC7B;MACA;MACA,IAAK,CAAEL,kBAAkB,CAAC,CAAC,IAAIK,KAAK,CAACC,MAAM,KAAK,CAAC,EAAG;QACnD;MACD;MAEA,MAAMC,aAAa,GAAGN,sBAAsB,CAAC,CAAC;MAC9C,MAAMO,eAAe,GAAGX,gBAAgB,CAAEQ,KAAK,CAACI,MAAO,CAAC;MAExD,IAAKJ,KAAK,CAACK,QAAQ,EAAG;QACrB,IAAKH,aAAa,KAAKC,eAAe,EAAG;UACxCL,IAAI,CAACQ,eAAe,GAAG,IAAI;UAC3B;UACAR,IAAI,CAACS,KAAK,CAAC,CAAC;QACb;MACD,CAAC,MAAM,IAAKV,iBAAiB,CAAC,CAAC,EAAG;QACjC;QACA;QACA;QACA;QACA;QACA;QACAH,WAAW,CAAES,eAAgB,CAAC;MAC/B;IACD;IAEAL,IAAI,CAACU,gBAAgB,CAAE,WAAW,EAAET,WAAY,CAAC;IAEjD,OAAO,MAAM;MACZD,IAAI,CAACW,mBAAmB,CAAE,WAAW,EAAEV,WAAY,CAAC;IACrD,CAAC;EACF,CAAC,EACD,CACCL,WAAW,EACXC,kBAAkB,EAClBC,sBAAsB,EACtBC,iBAAiB,CAEnB,CAAC;AACF","ignoreList":[]}