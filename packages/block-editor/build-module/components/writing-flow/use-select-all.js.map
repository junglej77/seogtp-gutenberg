{"version":3,"names":["isEntirelySelected","useSelect","useDispatch","__unstableUseShortcutEventMatch","useShortcutEventMatch","useRefEffect","store","blockEditorStore","getSelectionRoot","useSelectAll","getBlockOrder","getSelectedBlockClientIds","getBlockRootClientId","multiSelect","selectBlock","isMatch","node","onKeyDown","event","selectionRoot","ownerDocument","selectedClientIds","length","activeElement","preventDefault","defaultView","getSelection","selectAllChildren","firstSelectedClientId","rootClientId","blockClientIds","removeAllRanges","contentEditable","addEventListener","removeEventListener"],"sources":["@wordpress/block-editor/src/components/writing-flow/use-select-all.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { isEntirelySelected } from '@wordpress/dom';\r\nimport { useSelect, useDispatch } from '@wordpress/data';\r\nimport { __unstableUseShortcutEventMatch as useShortcutEventMatch } from '@wordpress/keyboard-shortcuts';\r\nimport { useRefEffect } from '@wordpress/compose';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { store as blockEditorStore } from '../../store';\r\nimport { getSelectionRoot } from './utils';\r\n\r\nexport default function useSelectAll() {\r\n\tconst { getBlockOrder, getSelectedBlockClientIds, getBlockRootClientId } =\r\n\t\tuseSelect( blockEditorStore );\r\n\tconst { multiSelect, selectBlock } = useDispatch( blockEditorStore );\r\n\tconst isMatch = useShortcutEventMatch();\r\n\r\n\treturn useRefEffect( ( node ) => {\r\n\t\tfunction onKeyDown( event ) {\r\n\t\t\tif ( ! isMatch( 'core/block-editor/select-all', event ) ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst selectionRoot = getSelectionRoot( node.ownerDocument );\r\n\t\t\tconst selectedClientIds = getSelectedBlockClientIds();\r\n\r\n\t\t\t// Abort if there is selection, but it is not within a block.\r\n\t\t\tif ( selectionRoot && ! selectedClientIds.length ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\tselectionRoot &&\r\n\t\t\t\tselectedClientIds.length < 2 &&\r\n\t\t\t\t! isEntirelySelected( selectionRoot )\r\n\t\t\t) {\r\n\t\t\t\tif ( node === node.ownerDocument.activeElement ) {\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tnode.ownerDocument.defaultView\r\n\t\t\t\t\t\t.getSelection()\r\n\t\t\t\t\t\t.selectAllChildren( selectionRoot );\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tevent.preventDefault();\r\n\r\n\t\t\tconst [ firstSelectedClientId ] = selectedClientIds;\r\n\t\t\tconst rootClientId = getBlockRootClientId( firstSelectedClientId );\r\n\t\t\tconst blockClientIds = getBlockOrder( rootClientId );\r\n\r\n\t\t\t// If we have selected all sibling nested blocks, try selecting up a\r\n\t\t\t// level. See: https://github.com/WordPress/gutenberg/pull/31859/\r\n\t\t\tif ( selectedClientIds.length === blockClientIds.length ) {\r\n\t\t\t\tif ( rootClientId ) {\r\n\t\t\t\t\tnode.ownerDocument.defaultView\r\n\t\t\t\t\t\t.getSelection()\r\n\t\t\t\t\t\t.removeAllRanges();\r\n\t\t\t\t\tnode.contentEditable = 'false';\r\n\t\t\t\t\tselectBlock( rootClientId );\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tmultiSelect(\r\n\t\t\t\tblockClientIds[ 0 ],\r\n\t\t\t\tblockClientIds[ blockClientIds.length - 1 ]\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tnode.addEventListener( 'keydown', onKeyDown );\r\n\r\n\t\treturn () => {\r\n\t\t\tnode.removeEventListener( 'keydown', onKeyDown );\r\n\t\t};\r\n\t}, [] );\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,kBAAkB,QAAQ,gBAAgB;AACnD,SAASC,SAAS,EAAEC,WAAW,QAAQ,iBAAiB;AACxD,SAASC,+BAA+B,IAAIC,qBAAqB,QAAQ,+BAA+B;AACxG,SAASC,YAAY,QAAQ,oBAAoB;;AAEjD;AACA;AACA;AACA,SAASC,KAAK,IAAIC,gBAAgB,QAAQ,aAAa;AACvD,SAASC,gBAAgB,QAAQ,SAAS;AAE1C,eAAe,SAASC,YAAYA,CAAA,EAAG;EACtC,MAAM;IAAEC,aAAa;IAAEC,yBAAyB;IAAEC;EAAqB,CAAC,GACvEX,SAAS,CAAEM,gBAAiB,CAAC;EAC9B,MAAM;IAAEM,WAAW;IAAEC;EAAY,CAAC,GAAGZ,WAAW,CAAEK,gBAAiB,CAAC;EACpE,MAAMQ,OAAO,GAAGX,qBAAqB,CAAC,CAAC;EAEvC,OAAOC,YAAY,CAAIW,IAAI,IAAM;IAChC,SAASC,SAASA,CAAEC,KAAK,EAAG;MAC3B,IAAK,CAAEH,OAAO,CAAE,8BAA8B,EAAEG,KAAM,CAAC,EAAG;QACzD;MACD;MAEA,MAAMC,aAAa,GAAGX,gBAAgB,CAAEQ,IAAI,CAACI,aAAc,CAAC;MAC5D,MAAMC,iBAAiB,GAAGV,yBAAyB,CAAC,CAAC;;MAErD;MACA,IAAKQ,aAAa,IAAI,CAAEE,iBAAiB,CAACC,MAAM,EAAG;QAClD;MACD;MAEA,IACCH,aAAa,IACbE,iBAAiB,CAACC,MAAM,GAAG,CAAC,IAC5B,CAAEtB,kBAAkB,CAAEmB,aAAc,CAAC,EACpC;QACD,IAAKH,IAAI,KAAKA,IAAI,CAACI,aAAa,CAACG,aAAa,EAAG;UAChDL,KAAK,CAACM,cAAc,CAAC,CAAC;UACtBR,IAAI,CAACI,aAAa,CAACK,WAAW,CAC5BC,YAAY,CAAC,CAAC,CACdC,iBAAiB,CAAER,aAAc,CAAC;UACpC;QACD;QAEA;MACD;MAEAD,KAAK,CAACM,cAAc,CAAC,CAAC;MAEtB,MAAM,CAAEI,qBAAqB,CAAE,GAAGP,iBAAiB;MACnD,MAAMQ,YAAY,GAAGjB,oBAAoB,CAAEgB,qBAAsB,CAAC;MAClE,MAAME,cAAc,GAAGpB,aAAa,CAAEmB,YAAa,CAAC;;MAEpD;MACA;MACA,IAAKR,iBAAiB,CAACC,MAAM,KAAKQ,cAAc,CAACR,MAAM,EAAG;QACzD,IAAKO,YAAY,EAAG;UACnBb,IAAI,CAACI,aAAa,CAACK,WAAW,CAC5BC,YAAY,CAAC,CAAC,CACdK,eAAe,CAAC,CAAC;UACnBf,IAAI,CAACgB,eAAe,GAAG,OAAO;UAC9BlB,WAAW,CAAEe,YAAa,CAAC;QAC5B;QACA;MACD;MAEAhB,WAAW,CACViB,cAAc,CAAE,CAAC,CAAE,EACnBA,cAAc,CAAEA,cAAc,CAACR,MAAM,GAAG,CAAC,CAC1C,CAAC;IACF;IAEAN,IAAI,CAACiB,gBAAgB,CAAE,SAAS,EAAEhB,SAAU,CAAC;IAE7C,OAAO,MAAM;MACZD,IAAI,CAACkB,mBAAmB,CAAE,SAAS,EAAEjB,SAAU,CAAC;IACjD,CAAC;EACF,CAAC,EAAE,EAAG,CAAC;AACR","ignoreList":[]}