{"version":3,"names":["useSelect","useDispatch","useRefEffect","create","isSelectionForward","store","blockEditorStore","getBlockClientId","extractSelectionStartNode","selection","anchorNode","anchorOffset","nodeType","TEXT_NODE","childNodes","extractSelectionEndNode","focusNode","focusOffset","length","_focusNode$previousSi","previousSibling","parentElement","findDepth","a","b","depth","setContentEditableWrapper","node","value","contentEditable","String","focus","getRichTextElement","element","ELEMENT_NODE","closest","useSelectionObserver","multiSelect","selectBlock","selectionChange","getBlockParents","getBlockSelectionStart","isMultiSelecting","getSelectedBlockClientId","ownerDocument","defaultView","onSelectionChange","event","getSelection","rangeCount","startNode","endNode","contains","isClickShift","shiftKey","type","isCollapsed","startClientId","endClientId","selectedClientId","clickedClientId","target","focusNodeIsNonSelectable","undefined","isSingularSelection","startPath","endPath","richTextElementStart","richTextElementEnd","_richTextDataStart$st","_richTextDataEnd$star","range","getRangeAt","richTextDataStart","__unstableIsEditableTree","richTextDataEnd","startOffset","start","end","endOffset","clientId","attributeKey","dataset","wpBlockAttributeKey","offset","addEventListener","removeEventListener"],"sources":["@wordpress/block-editor/src/components/writing-flow/use-selection-observer.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useSelect, useDispatch } from '@wordpress/data';\r\nimport { useRefEffect } from '@wordpress/compose';\r\nimport { create } from '@wordpress/rich-text';\r\nimport { isSelectionForward } from '@wordpress/dom';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { store as blockEditorStore } from '../../store';\r\nimport { getBlockClientId } from '../../utils/dom';\r\n\r\n/**\r\n * Extract the selection start node from the selection. When the anchor node is\r\n * not a text node, the selection offset is the index of a child node.\r\n *\r\n * @param {Selection} selection The selection.\r\n *\r\n * @return {Element} The selection start node.\r\n */\r\nfunction extractSelectionStartNode( selection ) {\r\n\tconst { anchorNode, anchorOffset } = selection;\r\n\r\n\tif ( anchorNode.nodeType === anchorNode.TEXT_NODE ) {\r\n\t\treturn anchorNode;\r\n\t}\r\n\r\n\tif ( anchorOffset === 0 ) {\r\n\t\treturn anchorNode;\r\n\t}\r\n\r\n\treturn anchorNode.childNodes[ anchorOffset - 1 ];\r\n}\r\n\r\n/**\r\n * Extract the selection end node from the selection. When the focus node is not\r\n * a text node, the selection offset is the index of a child node. The selection\r\n * reaches up to but excluding that child node.\r\n *\r\n * @param {Selection} selection The selection.\r\n *\r\n * @return {Element} The selection start node.\r\n */\r\nfunction extractSelectionEndNode( selection ) {\r\n\tconst { focusNode, focusOffset } = selection;\r\n\r\n\tif ( focusNode.nodeType === focusNode.TEXT_NODE ) {\r\n\t\treturn focusNode;\r\n\t}\r\n\r\n\tif ( focusOffset === focusNode.childNodes.length ) {\r\n\t\treturn focusNode;\r\n\t}\r\n\r\n\t// When the selection is forward (the selection ends with the focus node),\r\n\t// the selection may extend into the next element with an offset of 0. This\r\n\t// may trigger multi selection even though the selection does not visually\r\n\t// end in the next block.\r\n\tif ( focusOffset === 0 && isSelectionForward( selection ) ) {\r\n\t\treturn focusNode.previousSibling ?? focusNode.parentElement;\r\n\t}\r\n\r\n\treturn focusNode.childNodes[ focusOffset ];\r\n}\r\n\r\nfunction findDepth( a, b ) {\r\n\tlet depth = 0;\r\n\r\n\twhile ( a[ depth ] === b[ depth ] ) {\r\n\t\tdepth++;\r\n\t}\r\n\r\n\treturn depth;\r\n}\r\n\r\n/**\r\n * Sets the `contenteditable` wrapper element to `value`.\r\n *\r\n * @param {HTMLElement} node  Block element.\r\n * @param {boolean}     value `contentEditable` value (true or false)\r\n */\r\nfunction setContentEditableWrapper( node, value ) {\r\n\t// Since we are calling this on every selection change, check if the value\r\n\t// needs to be updated first because it trigger the browser to recalculate\r\n\t// style.\r\n\tif ( node.contentEditable !== String( value ) ) {\r\n\t\tnode.contentEditable = value;\r\n\r\n\t\t// Firefox doesn't automatically move focus.\r\n\t\tif ( value ) {\r\n\t\t\tnode.focus();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction getRichTextElement( node ) {\r\n\tconst element =\r\n\t\tnode.nodeType === node.ELEMENT_NODE ? node : node.parentElement;\r\n\treturn element?.closest( '[data-wp-block-attribute-key]' );\r\n}\r\n\r\n/**\r\n * Sets a multi-selection based on the native selection across blocks.\r\n */\r\nexport default function useSelectionObserver() {\r\n\tconst { multiSelect, selectBlock, selectionChange } =\r\n\t\tuseDispatch( blockEditorStore );\r\n\tconst {\r\n\t\tgetBlockParents,\r\n\t\tgetBlockSelectionStart,\r\n\t\tisMultiSelecting,\r\n\t\tgetSelectedBlockClientId,\r\n\t} = useSelect( blockEditorStore );\r\n\treturn useRefEffect(\r\n\t\t( node ) => {\r\n\t\t\tconst { ownerDocument } = node;\r\n\t\t\tconst { defaultView } = ownerDocument;\r\n\r\n\t\t\tfunction onSelectionChange( event ) {\r\n\t\t\t\tconst selection = defaultView.getSelection();\r\n\r\n\t\t\t\tif ( ! selection.rangeCount ) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst startNode = extractSelectionStartNode( selection );\r\n\t\t\t\tconst endNode = extractSelectionEndNode( selection );\r\n\r\n\t\t\t\tif (\r\n\t\t\t\t\t! node.contains( startNode ) ||\r\n\t\t\t\t\t! node.contains( endNode )\r\n\t\t\t\t) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// If selection is collapsed and we haven't used `shift+click`,\r\n\t\t\t\t// end multi selection and disable the contentEditable wrapper.\r\n\t\t\t\t// We have to check about `shift+click` case because elements\r\n\t\t\t\t// that don't support text selection might be involved, and we might\r\n\t\t\t\t// update the clientIds to multi-select blocks.\r\n\t\t\t\t// For now we check if the event is a `mouse` event.\r\n\t\t\t\tconst isClickShift = event.shiftKey && event.type === 'mouseup';\r\n\t\t\t\tif ( selection.isCollapsed && ! isClickShift ) {\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tnode.contentEditable === 'true' &&\r\n\t\t\t\t\t\t! isMultiSelecting()\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tsetContentEditableWrapper( node, false );\r\n\t\t\t\t\t\tlet element =\r\n\t\t\t\t\t\t\tstartNode.nodeType === startNode.ELEMENT_NODE\r\n\t\t\t\t\t\t\t\t? startNode\r\n\t\t\t\t\t\t\t\t: startNode.parentElement;\r\n\t\t\t\t\t\telement = element?.closest( '[contenteditable]' );\r\n\t\t\t\t\t\telement?.focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet startClientId = getBlockClientId( startNode );\r\n\t\t\t\tlet endClientId = getBlockClientId( endNode );\r\n\r\n\t\t\t\t// If the selection has changed and we had pressed `shift+click`,\r\n\t\t\t\t// we need to check if in an element that doesn't support\r\n\t\t\t\t// text selection has been clicked.\r\n\t\t\t\tif ( isClickShift ) {\r\n\t\t\t\t\tconst selectedClientId = getBlockSelectionStart();\r\n\t\t\t\t\tconst clickedClientId = getBlockClientId( event.target );\r\n\t\t\t\t\t// `endClientId` is not defined if we end the selection by clicking a non-selectable block.\r\n\t\t\t\t\t// We need to check if there was already a selection with a non-selectable focusNode.\r\n\t\t\t\t\tconst focusNodeIsNonSelectable =\r\n\t\t\t\t\t\tclickedClientId !== endClientId;\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\t( startClientId === endClientId &&\r\n\t\t\t\t\t\t\tselection.isCollapsed ) ||\r\n\t\t\t\t\t\t! endClientId ||\r\n\t\t\t\t\t\tfocusNodeIsNonSelectable\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tendClientId = clickedClientId;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Handle the case when we have a non-selectable block\r\n\t\t\t\t\t// selected and click another one.\r\n\t\t\t\t\tif ( startClientId !== selectedClientId ) {\r\n\t\t\t\t\t\tstartClientId = selectedClientId;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// If the selection did not involve a block, return.\r\n\t\t\t\tif (\r\n\t\t\t\t\tstartClientId === undefined &&\r\n\t\t\t\t\tendClientId === undefined\r\n\t\t\t\t) {\r\n\t\t\t\t\tsetContentEditableWrapper( node, false );\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tsetContentEditableWrapper(\r\n\t\t\t\t\tnode,\r\n\t\t\t\t\t!! ( startClientId && endClientId )\r\n\t\t\t\t);\r\n\r\n\t\t\t\tconst isSingularSelection = startClientId === endClientId;\r\n\t\t\t\tif ( isSingularSelection ) {\r\n\t\t\t\t\tif ( ! isMultiSelecting() ) {\r\n\t\t\t\t\t\tif ( getSelectedBlockClientId() !== startClientId ) {\r\n\t\t\t\t\t\t\tselectBlock( startClientId );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tmultiSelect( startClientId, startClientId );\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst startPath = [\r\n\t\t\t\t\t\t...getBlockParents( startClientId ),\r\n\t\t\t\t\t\tstartClientId,\r\n\t\t\t\t\t];\r\n\t\t\t\t\tconst endPath = [\r\n\t\t\t\t\t\t...getBlockParents( endClientId ),\r\n\t\t\t\t\t\tendClientId,\r\n\t\t\t\t\t];\r\n\t\t\t\t\tconst depth = findDepth( startPath, endPath );\r\n\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tstartPath[ depth ] !== startClientId ||\r\n\t\t\t\t\t\tendPath[ depth ] !== endClientId\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tmultiSelect( startPath[ depth ], endPath[ depth ] );\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst richTextElementStart =\r\n\t\t\t\t\t\tgetRichTextElement( startNode );\r\n\t\t\t\t\tconst richTextElementEnd = getRichTextElement( endNode );\r\n\r\n\t\t\t\t\tif ( richTextElementStart && richTextElementEnd ) {\r\n\t\t\t\t\t\tconst range = selection.getRangeAt( 0 );\r\n\t\t\t\t\t\tconst richTextDataStart = create( {\r\n\t\t\t\t\t\t\telement: richTextElementStart,\r\n\t\t\t\t\t\t\trange,\r\n\t\t\t\t\t\t\t__unstableIsEditableTree: true,\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t\tconst richTextDataEnd = create( {\r\n\t\t\t\t\t\t\telement: richTextElementEnd,\r\n\t\t\t\t\t\t\trange,\r\n\t\t\t\t\t\t\t__unstableIsEditableTree: true,\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t\tconst startOffset =\r\n\t\t\t\t\t\t\trichTextDataStart.start ?? richTextDataStart.end;\r\n\t\t\t\t\t\tconst endOffset =\r\n\t\t\t\t\t\t\trichTextDataEnd.start ?? richTextDataEnd.end;\r\n\t\t\t\t\t\tselectionChange( {\r\n\t\t\t\t\t\t\tstart: {\r\n\t\t\t\t\t\t\t\tclientId: startClientId,\r\n\t\t\t\t\t\t\t\tattributeKey:\r\n\t\t\t\t\t\t\t\t\trichTextElementStart.dataset\r\n\t\t\t\t\t\t\t\t\t\t.wpBlockAttributeKey,\r\n\t\t\t\t\t\t\t\toffset: startOffset,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tend: {\r\n\t\t\t\t\t\t\t\tclientId: endClientId,\r\n\t\t\t\t\t\t\t\tattributeKey:\r\n\t\t\t\t\t\t\t\t\trichTextElementEnd.dataset\r\n\t\t\t\t\t\t\t\t\t\t.wpBlockAttributeKey,\r\n\t\t\t\t\t\t\t\toffset: endOffset,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tmultiSelect( startClientId, endClientId );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\townerDocument.addEventListener(\r\n\t\t\t\t'selectionchange',\r\n\t\t\t\tonSelectionChange\r\n\t\t\t);\r\n\t\t\tdefaultView.addEventListener( 'mouseup', onSelectionChange );\r\n\t\t\treturn () => {\r\n\t\t\t\townerDocument.removeEventListener(\r\n\t\t\t\t\t'selectionchange',\r\n\t\t\t\t\tonSelectionChange\r\n\t\t\t\t);\r\n\t\t\t\tdefaultView.removeEventListener( 'mouseup', onSelectionChange );\r\n\t\t\t};\r\n\t\t},\r\n\t\t[ multiSelect, selectBlock, selectionChange, getBlockParents ]\r\n\t);\r\n}\r\n"],"mappings":"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","ignoreList":[]}