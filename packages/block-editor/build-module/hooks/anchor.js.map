{"version":3,"names":["addFilter","TextControl","ExternalLink","__","hasBlockSupport","Platform","InspectorControls","useBlockEditingMode","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","ANCHOR_REGEX","ANCHOR_SCHEMA","type","source","attribute","selector","addAttribute","settings","_settings$attributes$","attributes","anchor","BlockEditAnchorControlPure","setAttributes","blockEditingMode","isWeb","OS","group","children","__nextHasNoMarginBottom","__next40pxDefaultSize","className","label","help","href","value","placeholder","onChange","nextValue","replace","autoCapitalize","autoComplete","addSaveProps","edit","attributeKeys","hasSupport","name","extraProps","blockType","id"],"sources":["@wordpress/block-editor/src/hooks/anchor.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { addFilter } from '@wordpress/hooks';\r\nimport { TextControl, ExternalLink } from '@wordpress/components';\r\nimport { __ } from '@wordpress/i18n';\r\nimport { hasBlockSupport } from '@wordpress/blocks';\r\nimport { Platform } from '@wordpress/element';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { InspectorControls } from '../components';\r\nimport { useBlockEditingMode } from '../components/block-editing-mode';\r\n\r\n/**\r\n * Regular expression matching invalid anchor characters for replacement.\r\n *\r\n * @type {RegExp}\r\n */\r\nconst ANCHOR_REGEX = /[\\s#]/g;\r\n\r\nconst ANCHOR_SCHEMA = {\r\n\ttype: 'string',\r\n\tsource: 'attribute',\r\n\tattribute: 'id',\r\n\tselector: '*',\r\n};\r\n\r\n/**\r\n * Filters registered block settings, extending attributes with anchor using ID\r\n * of the first node.\r\n *\r\n * @param {Object} settings Original block settings.\r\n *\r\n * @return {Object} Filtered block settings.\r\n */\r\nexport function addAttribute( settings ) {\r\n\t// Allow blocks to specify their own attribute definition with default values if needed.\r\n\tif ( 'type' in ( settings.attributes?.anchor ?? {} ) ) {\r\n\t\treturn settings;\r\n\t}\r\n\tif ( hasBlockSupport( settings, 'anchor' ) ) {\r\n\t\t// Gracefully handle if settings.attributes is undefined.\r\n\t\tsettings.attributes = {\r\n\t\t\t...settings.attributes,\r\n\t\t\tanchor: ANCHOR_SCHEMA,\r\n\t\t};\r\n\t}\r\n\r\n\treturn settings;\r\n}\r\n\r\nfunction BlockEditAnchorControlPure( { anchor, setAttributes } ) {\r\n\tconst blockEditingMode = useBlockEditingMode();\r\n\r\n\tif ( blockEditingMode !== 'default' ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconst isWeb = Platform.OS === 'web';\r\n\r\n\treturn (\r\n\t\t<InspectorControls group=\"advanced\">\r\n\t\t\t<TextControl\r\n\t\t\t\t__nextHasNoMarginBottom\r\n\t\t\t\t__next40pxDefaultSize\r\n\t\t\t\tclassName=\"html-anchor-control\"\r\n\t\t\t\tlabel={ __( 'HTML anchor' ) }\r\n\t\t\t\thelp={\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t{ __(\r\n\t\t\t\t\t\t\t'Enter a word or two — without spaces — to make a unique web address just for this block, called an “anchor”. Then, you’ll be able to link directly to this section of your page.'\r\n\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t{ isWeb && (\r\n\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t{ ' ' }\r\n\t\t\t\t\t\t\t\t<ExternalLink\r\n\t\t\t\t\t\t\t\t\thref={ __(\r\n\t\t\t\t\t\t\t\t\t\t'https://wordpress.org/documentation/article/page-jumps/'\r\n\t\t\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{ __( 'Learn more about anchors' ) }\r\n\t\t\t\t\t\t\t\t</ExternalLink>\r\n\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t) }\r\n\t\t\t\t\t</>\r\n\t\t\t\t}\r\n\t\t\t\tvalue={ anchor || '' }\r\n\t\t\t\tplaceholder={ ! isWeb ? __( 'Add an anchor' ) : null }\r\n\t\t\t\tonChange={ ( nextValue ) => {\r\n\t\t\t\t\tnextValue = nextValue.replace( ANCHOR_REGEX, '-' );\r\n\t\t\t\t\tsetAttributes( {\r\n\t\t\t\t\t\tanchor: nextValue,\r\n\t\t\t\t\t} );\r\n\t\t\t\t} }\r\n\t\t\t\tautoCapitalize=\"none\"\r\n\t\t\t\tautoComplete=\"off\"\r\n\t\t\t/>\r\n\t\t</InspectorControls>\r\n\t);\r\n}\r\n\r\nexport default {\r\n\taddSaveProps,\r\n\tedit: BlockEditAnchorControlPure,\r\n\tattributeKeys: [ 'anchor' ],\r\n\thasSupport( name ) {\r\n\t\treturn hasBlockSupport( name, 'anchor' );\r\n\t},\r\n};\r\n\r\n/**\r\n * Override props assigned to save component to inject anchor ID, if block\r\n * supports anchor. This is only applied if the block's save result is an\r\n * element and not a markup string.\r\n *\r\n * @param {Object} extraProps Additional props applied to save element.\r\n * @param {Object} blockType  Block type.\r\n * @param {Object} attributes Current block attributes.\r\n *\r\n * @return {Object} Filtered props applied to save element.\r\n */\r\nexport function addSaveProps( extraProps, blockType, attributes ) {\r\n\tif ( hasBlockSupport( blockType, 'anchor' ) ) {\r\n\t\textraProps.id = attributes.anchor === '' ? null : attributes.anchor;\r\n\t}\r\n\r\n\treturn extraProps;\r\n}\r\n\r\naddFilter( 'blocks.registerBlockType', 'core/anchor/attribute', addAttribute );\r\n"],"mappings":"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","ignoreList":[]}