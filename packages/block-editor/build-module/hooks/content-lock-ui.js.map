{"version":3,"names":["ToolbarButton","useDispatch","useSelect","__","useCallback","store","blockEditorStore","BlockControls","unlock","jsx","_jsx","ContentLockControlsPure","clientId","templateLock","isLockedByParent","isEditingAsBlocks","select","getContentLockingParent","getTemplateLock","getTemporarilyEditingAsBlocks","stopEditingAsBlocks","isContentLocked","stopEditingAsBlockCallback","showStopEditingAsBlocks","group","children","onClick","edit","hasSupport"],"sources":["@wordpress/block-editor/src/hooks/content-lock-ui.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { ToolbarButton } from '@wordpress/components';\r\nimport { useDispatch, useSelect } from '@wordpress/data';\r\nimport { __ } from '@wordpress/i18n';\r\nimport { useCallback } from '@wordpress/element';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { store as blockEditorStore } from '../store';\r\nimport { BlockControls } from '../components';\r\nimport { unlock } from '../lock-unlock';\r\n\r\n// The implementation of content locking is mainly in this file, although the mechanism\r\n// to stop temporarily editing as blocks when an outside block is selected is on component StopEditingAsBlocksOnOutsideSelect\r\n// at block-editor/src/components/block-list/index.js.\r\n// Besides the components on this file and the file referenced above the implementation\r\n// also includes artifacts on the store (actions, reducers, and selector).\r\n\r\nfunction ContentLockControlsPure( { clientId } ) {\r\n\tconst { templateLock, isLockedByParent, isEditingAsBlocks } = useSelect(\r\n\t\t( select ) => {\r\n\t\t\tconst {\r\n\t\t\t\tgetContentLockingParent,\r\n\t\t\t\tgetTemplateLock,\r\n\t\t\t\tgetTemporarilyEditingAsBlocks,\r\n\t\t\t} = unlock( select( blockEditorStore ) );\r\n\t\t\treturn {\r\n\t\t\t\ttemplateLock: getTemplateLock( clientId ),\r\n\t\t\t\tisLockedByParent: !! getContentLockingParent( clientId ),\r\n\t\t\t\tisEditingAsBlocks: getTemporarilyEditingAsBlocks() === clientId,\r\n\t\t\t};\r\n\t\t},\r\n\t\t[ clientId ]\r\n\t);\r\n\r\n\tconst { stopEditingAsBlocks } = unlock( useDispatch( blockEditorStore ) );\r\n\tconst isContentLocked =\r\n\t\t! isLockedByParent && templateLock === 'contentOnly';\r\n\r\n\tconst stopEditingAsBlockCallback = useCallback( () => {\r\n\t\tstopEditingAsBlocks( clientId );\r\n\t}, [ clientId, stopEditingAsBlocks ] );\r\n\r\n\tif ( ! isContentLocked && ! isEditingAsBlocks ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconst showStopEditingAsBlocks = isEditingAsBlocks && ! isContentLocked;\r\n\r\n\treturn (\r\n\t\tshowStopEditingAsBlocks && (\r\n\t\t\t<BlockControls group=\"other\">\r\n\t\t\t\t<ToolbarButton onClick={ stopEditingAsBlockCallback }>\r\n\t\t\t\t\t{ __( 'Done' ) }\r\n\t\t\t\t</ToolbarButton>\r\n\t\t\t</BlockControls>\r\n\t\t)\r\n\t);\r\n}\r\n\r\nexport default {\r\n\tedit: ContentLockControlsPure,\r\n\thasSupport() {\r\n\t\treturn true;\r\n\t},\r\n};\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,aAAa,QAAQ,uBAAuB;AACrD,SAASC,WAAW,EAAEC,SAAS,QAAQ,iBAAiB;AACxD,SAASC,EAAE,QAAQ,iBAAiB;AACpC,SAASC,WAAW,QAAQ,oBAAoB;;AAEhD;AACA;AACA;AACA,SAASC,KAAK,IAAIC,gBAAgB,QAAQ,UAAU;AACpD,SAASC,aAAa,QAAQ,eAAe;AAC7C,SAASC,MAAM,QAAQ,gBAAgB;;AAEvC;AACA;AACA;AACA;AACA;AAAA,SAAAC,GAAA,IAAAC,IAAA;AAEA,SAASC,uBAAuBA,CAAE;EAAEC;AAAS,CAAC,EAAG;EAChD,MAAM;IAAEC,YAAY;IAAEC,gBAAgB;IAAEC;EAAkB,CAAC,GAAGb,SAAS,CACpEc,MAAM,IAAM;IACb,MAAM;MACLC,uBAAuB;MACvBC,eAAe;MACfC;IACD,CAAC,GAAGX,MAAM,CAAEQ,MAAM,CAAEV,gBAAiB,CAAE,CAAC;IACxC,OAAO;MACNO,YAAY,EAAEK,eAAe,CAAEN,QAAS,CAAC;MACzCE,gBAAgB,EAAE,CAAC,CAAEG,uBAAuB,CAAEL,QAAS,CAAC;MACxDG,iBAAiB,EAAEI,6BAA6B,CAAC,CAAC,KAAKP;IACxD,CAAC;EACF,CAAC,EACD,CAAEA,QAAQ,CACX,CAAC;EAED,MAAM;IAAEQ;EAAoB,CAAC,GAAGZ,MAAM,CAAEP,WAAW,CAAEK,gBAAiB,CAAE,CAAC;EACzE,MAAMe,eAAe,GACpB,CAAEP,gBAAgB,IAAID,YAAY,KAAK,aAAa;EAErD,MAAMS,0BAA0B,GAAGlB,WAAW,CAAE,MAAM;IACrDgB,mBAAmB,CAAER,QAAS,CAAC;EAChC,CAAC,EAAE,CAAEA,QAAQ,EAAEQ,mBAAmB,CAAG,CAAC;EAEtC,IAAK,CAAEC,eAAe,IAAI,CAAEN,iBAAiB,EAAG;IAC/C,OAAO,IAAI;EACZ;EAEA,MAAMQ,uBAAuB,GAAGR,iBAAiB,IAAI,CAAEM,eAAe;EAEtE,OACCE,uBAAuB,iBACtBb,IAAA,CAACH,aAAa;IAACiB,KAAK,EAAC,OAAO;IAAAC,QAAA,eAC3Bf,IAAA,CAACV,aAAa;MAAC0B,OAAO,EAAGJ,0BAA4B;MAAAG,QAAA,EAClDtB,EAAE,CAAE,MAAO;IAAC,CACA;EAAC,CACF,CACf;AAEH;AAEA,eAAe;EACdwB,IAAI,EAAEhB,uBAAuB;EAC7BiB,UAAUA,CAAA,EAAG;IACZ,OAAO,IAAI;EACZ;AACD,CAAC","ignoreList":[]}