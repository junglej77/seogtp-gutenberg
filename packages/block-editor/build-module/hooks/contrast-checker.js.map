{"version":3,"names":["useState","useEffect","ContrastChecker","useBlockElement","jsx","_jsx","getComputedStyle","node","ownerDocument","defaultView","BlockColorContrastChecker","clientId","detectedBackgroundColor","setDetectedBackgroundColor","detectedColor","setDetectedColor","detectedLinkColor","setDetectedLinkColor","blockEl","color","firstLinkElement","querySelector","innerText","backgroundColorNode","backgroundColor","parentNode","nodeType","ELEMENT_NODE","textColor","enableAlphaChecker","linkColor"],"sources":["@wordpress/block-editor/src/hooks/contrast-checker.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useState, useEffect } from '@wordpress/element';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport ContrastChecker from '../components/contrast-checker';\r\nimport { useBlockElement } from '../components/block-list/use-block-props/use-block-refs';\r\n\r\nfunction getComputedStyle( node ) {\r\n\treturn node.ownerDocument.defaultView.getComputedStyle( node );\r\n}\r\n\r\nexport default function BlockColorContrastChecker( { clientId } ) {\r\n\tconst [ detectedBackgroundColor, setDetectedBackgroundColor ] = useState();\r\n\tconst [ detectedColor, setDetectedColor ] = useState();\r\n\tconst [ detectedLinkColor, setDetectedLinkColor ] = useState();\r\n\tconst blockEl = useBlockElement( clientId );\r\n\r\n\t// There are so many things that can change the color of a block\r\n\t// So we perform this check on every render.\r\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\tuseEffect( () => {\r\n\t\tif ( ! blockEl ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tsetDetectedColor( getComputedStyle( blockEl ).color );\r\n\r\n\t\tconst firstLinkElement = blockEl.querySelector( 'a' );\r\n\t\tif ( firstLinkElement && !! firstLinkElement.innerText ) {\r\n\t\t\tsetDetectedLinkColor( getComputedStyle( firstLinkElement ).color );\r\n\t\t}\r\n\r\n\t\tlet backgroundColorNode = blockEl;\r\n\t\tlet backgroundColor =\r\n\t\t\tgetComputedStyle( backgroundColorNode ).backgroundColor;\r\n\t\twhile (\r\n\t\t\tbackgroundColor === 'rgba(0, 0, 0, 0)' &&\r\n\t\t\tbackgroundColorNode.parentNode &&\r\n\t\t\tbackgroundColorNode.parentNode.nodeType ===\r\n\t\t\t\tbackgroundColorNode.parentNode.ELEMENT_NODE\r\n\t\t) {\r\n\t\t\tbackgroundColorNode = backgroundColorNode.parentNode;\r\n\t\t\tbackgroundColor =\r\n\t\t\t\tgetComputedStyle( backgroundColorNode ).backgroundColor;\r\n\t\t}\r\n\r\n\t\tsetDetectedBackgroundColor( backgroundColor );\r\n\t}, [ blockEl ] );\r\n\r\n\treturn (\r\n\t\t<ContrastChecker\r\n\t\t\tbackgroundColor={ detectedBackgroundColor }\r\n\t\t\ttextColor={ detectedColor }\r\n\t\t\tenableAlphaChecker\r\n\t\t\tlinkColor={ detectedLinkColor }\r\n\t\t/>\r\n\t);\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,QAAQ,EAAEC,SAAS,QAAQ,oBAAoB;;AAExD;AACA;AACA;AACA,OAAOC,eAAe,MAAM,gCAAgC;AAC5D,SAASC,eAAe,QAAQ,yDAAyD;AAAC,SAAAC,GAAA,IAAAC,IAAA;AAE1F,SAASC,gBAAgBA,CAAEC,IAAI,EAAG;EACjC,OAAOA,IAAI,CAACC,aAAa,CAACC,WAAW,CAACH,gBAAgB,CAAEC,IAAK,CAAC;AAC/D;AAEA,eAAe,SAASG,yBAAyBA,CAAE;EAAEC;AAAS,CAAC,EAAG;EACjE,MAAM,CAAEC,uBAAuB,EAAEC,0BAA0B,CAAE,GAAGb,QAAQ,CAAC,CAAC;EAC1E,MAAM,CAAEc,aAAa,EAAEC,gBAAgB,CAAE,GAAGf,QAAQ,CAAC,CAAC;EACtD,MAAM,CAAEgB,iBAAiB,EAAEC,oBAAoB,CAAE,GAAGjB,QAAQ,CAAC,CAAC;EAC9D,MAAMkB,OAAO,GAAGf,eAAe,CAAEQ,QAAS,CAAC;;EAE3C;EACA;EACA;EACAV,SAAS,CAAE,MAAM;IAChB,IAAK,CAAEiB,OAAO,EAAG;MAChB;IACD;IACAH,gBAAgB,CAAET,gBAAgB,CAAEY,OAAQ,CAAC,CAACC,KAAM,CAAC;IAErD,MAAMC,gBAAgB,GAAGF,OAAO,CAACG,aAAa,CAAE,GAAI,CAAC;IACrD,IAAKD,gBAAgB,IAAI,CAAC,CAAEA,gBAAgB,CAACE,SAAS,EAAG;MACxDL,oBAAoB,CAAEX,gBAAgB,CAAEc,gBAAiB,CAAC,CAACD,KAAM,CAAC;IACnE;IAEA,IAAII,mBAAmB,GAAGL,OAAO;IACjC,IAAIM,eAAe,GAClBlB,gBAAgB,CAAEiB,mBAAoB,CAAC,CAACC,eAAe;IACxD,OACCA,eAAe,KAAK,kBAAkB,IACtCD,mBAAmB,CAACE,UAAU,IAC9BF,mBAAmB,CAACE,UAAU,CAACC,QAAQ,KACtCH,mBAAmB,CAACE,UAAU,CAACE,YAAY,EAC3C;MACDJ,mBAAmB,GAAGA,mBAAmB,CAACE,UAAU;MACpDD,eAAe,GACdlB,gBAAgB,CAAEiB,mBAAoB,CAAC,CAACC,eAAe;IACzD;IAEAX,0BAA0B,CAAEW,eAAgB,CAAC;EAC9C,CAAC,EAAE,CAAEN,OAAO,CAAG,CAAC;EAEhB,oBACCb,IAAA,CAACH,eAAe;IACfsB,eAAe,EAAGZ,uBAAyB;IAC3CgB,SAAS,EAAGd,aAAe;IAC3Be,kBAAkB;IAClBC,SAAS,EAAGd;EAAmB,CAC/B,CAAC;AAEJ","ignoreList":[]}