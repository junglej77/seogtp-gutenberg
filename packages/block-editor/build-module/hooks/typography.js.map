{"version":3,"names":["getBlockSupport","hasBlockSupport","useMemo","useCallback","useSelect","InspectorControls","default","StylesTypographyPanel","useHasTypographyPanel","LINE_HEIGHT_SUPPORT_KEY","FONT_FAMILY_SUPPORT_KEY","FONT_SIZE_SUPPORT_KEY","TEXT_ALIGN_SUPPORT_KEY","cleanEmptyObject","store","blockEditorStore","jsx","_jsx","omit","object","keys","Object","fromEntries","entries","filter","key","includes","LETTER_SPACING_SUPPORT_KEY","TEXT_TRANSFORM_SUPPORT_KEY","TEXT_DECORATION_SUPPORT_KEY","TEXT_COLUMNS_SUPPORT_KEY","FONT_STYLE_SUPPORT_KEY","FONT_WEIGHT_SUPPORT_KEY","WRITING_MODE_SUPPORT_KEY","TYPOGRAPHY_SUPPORT_KEY","TYPOGRAPHY_SUPPORT_KEYS","styleToAttributes","style","updatedStyle","fontSizeValue","typography","fontSize","fontFamilyValue","fontFamily","fontSizeSlug","startsWith","substring","length","undefined","fontFamilySlug","attributesToStyle","attributes","TypographyInspectorControl","children","resetAllFilter","attributesResetAllFilter","existingStyle","group","TypographyPanel","clientId","name","setAttributes","settings","selector","select","getBlockAttributes","isEnabled","value","onChange","newStyle","defaultControls","as","panelId","hasTypographySupport","blockName","some"],"sources":["@wordpress/block-editor/src/hooks/typography.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { getBlockSupport, hasBlockSupport } from '@wordpress/blocks';\r\nimport { useMemo, useCallback } from '@wordpress/element';\r\nimport { useSelect } from '@wordpress/data';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport InspectorControls from '../components/inspector-controls';\r\nimport {\r\n\tdefault as StylesTypographyPanel,\r\n\tuseHasTypographyPanel,\r\n} from '../components/global-styles/typography-panel';\r\n\r\nimport { LINE_HEIGHT_SUPPORT_KEY } from './line-height';\r\nimport { FONT_FAMILY_SUPPORT_KEY } from './font-family';\r\nimport { FONT_SIZE_SUPPORT_KEY } from './font-size';\r\nimport { TEXT_ALIGN_SUPPORT_KEY } from './text-align';\r\nimport { cleanEmptyObject } from './utils';\r\nimport { store as blockEditorStore } from '../store';\r\n\r\nfunction omit( object, keys ) {\r\n\treturn Object.fromEntries(\r\n\t\tObject.entries( object ).filter( ( [ key ] ) => ! keys.includes( key ) )\r\n\t);\r\n}\r\n\r\nconst LETTER_SPACING_SUPPORT_KEY = 'typography.__experimentalLetterSpacing';\r\nconst TEXT_TRANSFORM_SUPPORT_KEY = 'typography.__experimentalTextTransform';\r\nconst TEXT_DECORATION_SUPPORT_KEY = 'typography.__experimentalTextDecoration';\r\nconst TEXT_COLUMNS_SUPPORT_KEY = 'typography.textColumns';\r\nconst FONT_STYLE_SUPPORT_KEY = 'typography.__experimentalFontStyle';\r\nconst FONT_WEIGHT_SUPPORT_KEY = 'typography.__experimentalFontWeight';\r\nconst WRITING_MODE_SUPPORT_KEY = 'typography.__experimentalWritingMode';\r\nexport const TYPOGRAPHY_SUPPORT_KEY = 'typography';\r\nexport const TYPOGRAPHY_SUPPORT_KEYS = [\r\n\tLINE_HEIGHT_SUPPORT_KEY,\r\n\tFONT_SIZE_SUPPORT_KEY,\r\n\tFONT_STYLE_SUPPORT_KEY,\r\n\tFONT_WEIGHT_SUPPORT_KEY,\r\n\tFONT_FAMILY_SUPPORT_KEY,\r\n\tTEXT_ALIGN_SUPPORT_KEY,\r\n\tTEXT_COLUMNS_SUPPORT_KEY,\r\n\tTEXT_DECORATION_SUPPORT_KEY,\r\n\tWRITING_MODE_SUPPORT_KEY,\r\n\tTEXT_TRANSFORM_SUPPORT_KEY,\r\n\tLETTER_SPACING_SUPPORT_KEY,\r\n];\r\n\r\nfunction styleToAttributes( style ) {\r\n\tconst updatedStyle = { ...omit( style, [ 'fontFamily' ] ) };\r\n\tconst fontSizeValue = style?.typography?.fontSize;\r\n\tconst fontFamilyValue = style?.typography?.fontFamily;\r\n\tconst fontSizeSlug = fontSizeValue?.startsWith( 'var:preset|font-size|' )\r\n\t\t? fontSizeValue.substring( 'var:preset|font-size|'.length )\r\n\t\t: undefined;\r\n\tconst fontFamilySlug = fontFamilyValue?.startsWith(\r\n\t\t'var:preset|font-family|'\r\n\t)\r\n\t\t? fontFamilyValue.substring( 'var:preset|font-family|'.length )\r\n\t\t: undefined;\r\n\tupdatedStyle.typography = {\r\n\t\t...omit( updatedStyle.typography, [ 'fontFamily' ] ),\r\n\t\tfontSize: fontSizeSlug ? undefined : fontSizeValue,\r\n\t};\r\n\treturn {\r\n\t\tstyle: cleanEmptyObject( updatedStyle ),\r\n\t\tfontFamily: fontFamilySlug,\r\n\t\tfontSize: fontSizeSlug,\r\n\t};\r\n}\r\n\r\nfunction attributesToStyle( attributes ) {\r\n\treturn {\r\n\t\t...attributes.style,\r\n\t\ttypography: {\r\n\t\t\t...attributes.style?.typography,\r\n\t\t\tfontFamily: attributes.fontFamily\r\n\t\t\t\t? 'var:preset|font-family|' + attributes.fontFamily\r\n\t\t\t\t: undefined,\r\n\t\t\tfontSize: attributes.fontSize\r\n\t\t\t\t? 'var:preset|font-size|' + attributes.fontSize\r\n\t\t\t\t: attributes.style?.typography?.fontSize,\r\n\t\t},\r\n\t};\r\n}\r\n\r\nfunction TypographyInspectorControl( { children, resetAllFilter } ) {\r\n\tconst attributesResetAllFilter = useCallback(\r\n\t\t( attributes ) => {\r\n\t\t\tconst existingStyle = attributesToStyle( attributes );\r\n\t\t\tconst updatedStyle = resetAllFilter( existingStyle );\r\n\t\t\treturn {\r\n\t\t\t\t...attributes,\r\n\t\t\t\t...styleToAttributes( updatedStyle ),\r\n\t\t\t};\r\n\t\t},\r\n\t\t[ resetAllFilter ]\r\n\t);\r\n\r\n\treturn (\r\n\t\t<InspectorControls\r\n\t\t\tgroup=\"typography\"\r\n\t\t\tresetAllFilter={ attributesResetAllFilter }\r\n\t\t>\r\n\t\t\t{ children }\r\n\t\t</InspectorControls>\r\n\t);\r\n}\r\n\r\nexport function TypographyPanel( { clientId, name, setAttributes, settings } ) {\r\n\tfunction selector( select ) {\r\n\t\tconst { style, fontFamily, fontSize } =\r\n\t\t\tselect( blockEditorStore ).getBlockAttributes( clientId ) || {};\r\n\t\treturn { style, fontFamily, fontSize };\r\n\t}\r\n\tconst { style, fontFamily, fontSize } = useSelect( selector, [ clientId ] );\r\n\tconst isEnabled = useHasTypographyPanel( settings );\r\n\tconst value = useMemo(\r\n\t\t() => attributesToStyle( { style, fontFamily, fontSize } ),\r\n\t\t[ style, fontSize, fontFamily ]\r\n\t);\r\n\r\n\tconst onChange = ( newStyle ) => {\r\n\t\tsetAttributes( styleToAttributes( newStyle ) );\r\n\t};\r\n\r\n\tif ( ! isEnabled ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconst defaultControls = getBlockSupport( name, [\r\n\t\tTYPOGRAPHY_SUPPORT_KEY,\r\n\t\t'__experimentalDefaultControls',\r\n\t] );\r\n\r\n\treturn (\r\n\t\t<StylesTypographyPanel\r\n\t\t\tas={ TypographyInspectorControl }\r\n\t\t\tpanelId={ clientId }\r\n\t\t\tsettings={ settings }\r\n\t\t\tvalue={ value }\r\n\t\t\tonChange={ onChange }\r\n\t\t\tdefaultControls={ defaultControls }\r\n\t\t/>\r\n\t);\r\n}\r\n\r\nexport const hasTypographySupport = ( blockName ) => {\r\n\treturn TYPOGRAPHY_SUPPORT_KEYS.some( ( key ) =>\r\n\t\thasBlockSupport( blockName, key )\r\n\t);\r\n};\r\n"],"mappings":"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","ignoreList":[]}