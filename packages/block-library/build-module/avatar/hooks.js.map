{"version":3,"names":["store","blockEditorStore","coreStore","useEntityProp","__","sprintf","useSelect","getAvatarSizes","sizes","minSize","maxSize","length","maxSizeBuffer","Math","floor","useDefaultAvatar","avatarURL","defaultAvatarUrl","select","getSettings","__experimentalDiscussionSettings","useCommentAvatar","commentId","avatars","authorName","avatarUrls","Object","values","keys","defaultAvatar","src","alt","useUserAvatar","userId","postId","postType","authorDetails","getEditedEntityRecord","getUser","_authorId","author","avatar_urls","name"],"sources":["@wordpress/block-library/src/avatar/hooks.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { store as blockEditorStore } from '@wordpress/block-editor';\r\nimport { store as coreStore, useEntityProp } from '@wordpress/core-data';\r\nimport { __, sprintf } from '@wordpress/i18n';\r\nimport { useSelect } from '@wordpress/data';\r\n\r\nfunction getAvatarSizes( sizes ) {\r\n\tconst minSize = sizes ? sizes[ 0 ] : 24;\r\n\tconst maxSize = sizes ? sizes[ sizes.length - 1 ] : 96;\r\n\tconst maxSizeBuffer = Math.floor( maxSize * 2.5 );\r\n\treturn {\r\n\t\tminSize,\r\n\t\tmaxSize: maxSizeBuffer,\r\n\t};\r\n}\r\n\r\nfunction useDefaultAvatar() {\r\n\tconst { avatarURL: defaultAvatarUrl } = useSelect( ( select ) => {\r\n\t\tconst { getSettings } = select( blockEditorStore );\r\n\t\tconst { __experimentalDiscussionSettings } = getSettings();\r\n\t\treturn __experimentalDiscussionSettings;\r\n\t} );\r\n\treturn defaultAvatarUrl;\r\n}\r\n\r\nexport function useCommentAvatar( { commentId } ) {\r\n\tconst [ avatars ] = useEntityProp(\r\n\t\t'root',\r\n\t\t'comment',\r\n\t\t'author_avatar_urls',\r\n\t\tcommentId\r\n\t);\r\n\r\n\tconst [ authorName ] = useEntityProp(\r\n\t\t'root',\r\n\t\t'comment',\r\n\t\t'author_name',\r\n\t\tcommentId\r\n\t);\r\n\tconst avatarUrls = avatars ? Object.values( avatars ) : null;\r\n\tconst sizes = avatars ? Object.keys( avatars ) : null;\r\n\tconst { minSize, maxSize } = getAvatarSizes( sizes );\r\n\tconst defaultAvatar = useDefaultAvatar();\r\n\treturn {\r\n\t\tsrc: avatarUrls ? avatarUrls[ avatarUrls.length - 1 ] : defaultAvatar,\r\n\t\tminSize,\r\n\t\tmaxSize,\r\n\t\t// translators: %s is the Author name.\r\n\t\talt: authorName\r\n\t\t\t? // translators: %s is the Author name.\r\n\t\t\t  sprintf( __( '%s Avatar' ), authorName )\r\n\t\t\t: __( 'Default Avatar' ),\r\n\t};\r\n}\r\n\r\nexport function useUserAvatar( { userId, postId, postType } ) {\r\n\tconst { authorDetails } = useSelect(\r\n\t\t( select ) => {\r\n\t\t\tconst { getEditedEntityRecord, getUser } = select( coreStore );\r\n\t\t\tif ( userId ) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tauthorDetails: getUser( userId ),\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tconst _authorId = getEditedEntityRecord(\r\n\t\t\t\t'postType',\r\n\t\t\t\tpostType,\r\n\t\t\t\tpostId\r\n\t\t\t)?.author;\r\n\r\n\t\t\treturn {\r\n\t\t\t\tauthorDetails: _authorId ? getUser( _authorId ) : null,\r\n\t\t\t};\r\n\t\t},\r\n\t\t[ postType, postId, userId ]\r\n\t);\r\n\tconst avatarUrls = authorDetails?.avatar_urls\r\n\t\t? Object.values( authorDetails.avatar_urls )\r\n\t\t: null;\r\n\tconst sizes = authorDetails?.avatar_urls\r\n\t\t? Object.keys( authorDetails.avatar_urls )\r\n\t\t: null;\r\n\tconst { minSize, maxSize } = getAvatarSizes( sizes );\r\n\tconst defaultAvatar = useDefaultAvatar();\r\n\treturn {\r\n\t\tsrc: avatarUrls ? avatarUrls[ avatarUrls.length - 1 ] : defaultAvatar,\r\n\t\tminSize,\r\n\t\tmaxSize,\r\n\t\talt: authorDetails\r\n\t\t\t? // translators: %s is the Author name.\r\n\t\t\t  sprintf( __( '%s Avatar' ), authorDetails?.name )\r\n\t\t\t: __( 'Default Avatar' ),\r\n\t};\r\n}\r\n"],"mappings":"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","ignoreList":[]}