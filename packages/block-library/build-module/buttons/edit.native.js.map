{"version":3,"names":["View","BlockControls","InnerBlocks","JustifyContentControl","store","blockEditorStore","createBlock","getBlockSupport","debounce","useResizeObserver","useDispatch","useSelect","useState","useEffect","useRef","useCallback","alignmentHelpers","styles","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","layoutProp","type","alignments","POPOVER_PROPS","placement","ButtonsEdit","attributes","layout","align","clientId","isSelected","setAttributes","blockWidth","name","resizeObserver","sizes","maxWidth","setMaxWidth","marginLeft","spacing","layoutBlockSupport","defaultBlockLayout","default","usedLayout","justifyContent","isInnerButtonSelected","shouldDelete","select","getBlockCount","getBlockParents","getSelectedBlockClientId","selectedBlockClientId","selectedBlockParents","getBlockOrder","insertBlock","removeBlock","selectBlock","width","isFullWidth","isFullWidthBlock","onAddNextButton","selectedId","order","selectedButtonIndex","findIndex","i","index","length","insertedBlock","renderFooterAppender","style","appenderContainer","children","ButtonBlockAppender","isFloating","onAddBlock","justifyControls","remove","shouldRenderFooterAppender","group","allowedControls","value","onChange","popoverProps","template","current","orientation","horizontalAlignment","onDeleteBlock","undefined","parentWidth","marginHorizontal","marginVertical","templateInsertUpdatesSelection"],"sources":["@wordpress/block-library/src/buttons/edit.native.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport { View } from 'react-native';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport {\r\n\tBlockControls,\r\n\tInnerBlocks,\r\n\tJustifyContentControl,\r\n\tstore as blockEditorStore,\r\n} from '@wordpress/block-editor';\r\nimport { createBlock, getBlockSupport } from '@wordpress/blocks';\r\nimport { debounce, useResizeObserver } from '@wordpress/compose';\r\nimport { useDispatch, useSelect } from '@wordpress/data';\r\nimport { useState, useEffect, useRef, useCallback } from '@wordpress/element';\r\nimport { alignmentHelpers } from '@wordpress/components';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport styles from './editor.scss';\r\n\r\nconst layoutProp = { type: 'default', alignments: [] };\r\n\r\nconst POPOVER_PROPS = {\r\n\tplacement: 'bottom-start',\r\n};\r\n\r\nexport default function ButtonsEdit( {\r\n\tattributes: { layout, align },\r\n\tclientId,\r\n\tisSelected,\r\n\tsetAttributes,\r\n\tblockWidth,\r\n\tname,\r\n} ) {\r\n\tconst [ resizeObserver, sizes ] = useResizeObserver();\r\n\tconst [ maxWidth, setMaxWidth ] = useState( 0 );\r\n\tconst { marginLeft: spacing } = styles.spacing;\r\n\r\n\t// Extract attributes from block layout\r\n\tconst layoutBlockSupport = getBlockSupport( name, 'layout' );\r\n\tconst defaultBlockLayout = layoutBlockSupport?.default;\r\n\tconst usedLayout = layout || defaultBlockLayout || {};\r\n\tconst { justifyContent } = usedLayout;\r\n\r\n\tconst { isInnerButtonSelected, shouldDelete } = useSelect(\r\n\t\t( select ) => {\r\n\t\t\tconst { getBlockCount, getBlockParents, getSelectedBlockClientId } =\r\n\t\t\t\tselect( blockEditorStore );\r\n\t\t\tconst selectedBlockClientId = getSelectedBlockClientId();\r\n\t\t\tconst selectedBlockParents = getBlockParents(\r\n\t\t\t\tselectedBlockClientId,\r\n\t\t\t\ttrue\r\n\t\t\t);\r\n\r\n\t\t\treturn {\r\n\t\t\t\tisInnerButtonSelected: selectedBlockParents[ 0 ] === clientId,\r\n\t\t\t\t// The purpose of `shouldDelete` check is giving the ability to\r\n\t\t\t\t// pass to mobile toolbar function called `onDelete` which removes\r\n\t\t\t\t// the whole `Buttons` container along with the last inner button\r\n\t\t\t\t// when there is exactly one button.\r\n\t\t\t\tshouldDelete: getBlockCount( clientId ) === 1,\r\n\t\t\t};\r\n\t\t},\r\n\t\t[ clientId ]\r\n\t);\r\n\r\n\tconst { getBlockOrder } = useSelect( blockEditorStore );\r\n\tconst { insertBlock, removeBlock, selectBlock } =\r\n\t\tuseDispatch( blockEditorStore );\r\n\r\n\tuseEffect( () => {\r\n\t\tconst { width } = sizes || {};\r\n\t\tconst { isFullWidth } = alignmentHelpers;\r\n\r\n\t\tif ( width ) {\r\n\t\t\tconst isFullWidthBlock = isFullWidth( align );\r\n\t\t\tsetMaxWidth( isFullWidthBlock ? blockWidth : width );\r\n\t\t}\r\n\t}, [ sizes, align ] );\r\n\r\n\tconst onAddNextButton = useCallback(\r\n\t\tdebounce( ( selectedId ) => {\r\n\t\t\tconst order = getBlockOrder( clientId );\r\n\t\t\tconst selectedButtonIndex = order.findIndex(\r\n\t\t\t\t( i ) => i === selectedId\r\n\t\t\t);\r\n\r\n\t\t\tconst index =\r\n\t\t\t\tselectedButtonIndex === -1\r\n\t\t\t\t\t? order.length + 1\r\n\t\t\t\t\t: selectedButtonIndex;\r\n\r\n\t\t\tconst insertedBlock = createBlock( 'core/button' );\r\n\r\n\t\t\tinsertBlock( insertedBlock, index, clientId, false );\r\n\t\t\tselectBlock( insertedBlock.clientId );\r\n\t\t}, 200 ),\r\n\t\t[]\r\n\t);\r\n\r\n\tconst renderFooterAppender = useRef( () => (\r\n\t\t<View style={ styles.appenderContainer }>\r\n\t\t\t<InnerBlocks.ButtonBlockAppender\r\n\t\t\t\tisFloating\r\n\t\t\t\tonAddBlock={ onAddNextButton }\r\n\t\t\t/>\r\n\t\t</View>\r\n\t) );\r\n\r\n\tconst justifyControls = [ 'left', 'center', 'right' ];\r\n\r\n\tconst remove = useCallback( () => removeBlock( clientId ), [ clientId ] );\r\n\tconst shouldRenderFooterAppender = isSelected || isInnerButtonSelected;\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{ isSelected && (\r\n\t\t\t\t<BlockControls group=\"block\">\r\n\t\t\t\t\t<JustifyContentControl\r\n\t\t\t\t\t\tallowedControls={ justifyControls }\r\n\t\t\t\t\t\tvalue={ justifyContent }\r\n\t\t\t\t\t\tonChange={ ( value ) =>\r\n\t\t\t\t\t\t\tsetAttributes( {\r\n\t\t\t\t\t\t\t\tlayout: {\r\n\t\t\t\t\t\t\t\t\t...usedLayout,\r\n\t\t\t\t\t\t\t\t\tjustifyContent: value,\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t} )\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tpopoverProps={ POPOVER_PROPS }\r\n\t\t\t\t\t/>\r\n\t\t\t\t</BlockControls>\r\n\t\t\t) }\r\n\t\t\t{ resizeObserver }\r\n\t\t\t<InnerBlocks\r\n\t\t\t\ttemplate={ [ [ 'core/button' ] ] }\r\n\t\t\t\trenderFooterAppender={\r\n\t\t\t\t\tshouldRenderFooterAppender && renderFooterAppender.current\r\n\t\t\t\t}\r\n\t\t\t\torientation=\"horizontal\"\r\n\t\t\t\thorizontalAlignment={ justifyContent }\r\n\t\t\t\tonDeleteBlock={ shouldDelete ? remove : undefined }\r\n\t\t\t\tonAddBlock={ onAddNextButton }\r\n\t\t\t\tparentWidth={ maxWidth } // This value controls the width of that the buttons are able to expand to.\r\n\t\t\t\tmarginHorizontal={ spacing }\r\n\t\t\t\tmarginVertical={ spacing }\r\n\t\t\t\tlayout={ layoutProp }\r\n\t\t\t\ttemplateInsertUpdatesSelection\r\n\t\t\t\tblockWidth={ blockWidth }\r\n\t\t\t/>\r\n\t\t</>\r\n\t);\r\n}\r\n"],"mappings":"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","ignoreList":[]}