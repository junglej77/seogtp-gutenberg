{"version":3,"names":["ALIGNMENT_BREAKPOINTS","convertUnitToMobile","getColumnWidths","getWidths","styles","MAX_COLUMNS_NUM_IN_ROW","MIN_WIDTH","columnsContainer","minWidth","MARGIN","marginLeft","getColumnsInRow","width","columnCount","mobile","medium","Math","min","max","calculateContainerWidth","containerWidth","columnsInRow","getContentWidths","innerColumns","globalStyles","widths","columnWidthsWithUnits","columnWidths","columnWidthsValues","map","v","columnWidthsSum","reduce","acc","curr","columnRatios","colWidth","columnWidthsPerRatio","columnRatio","filteredColumnWidthsPerRatio","filter","columnWidthPerRatio","baseContainerWidth","length","minPercentageRatio","largeColumnsWidthsSum","ratio","index","columnWidth","maxColumnWidth","forEach","attributes","innerColumnAttributes","clientId","attributeWidth","proportionalRatio","percentageRatio","initialColumnWidth","round","newColumnWidth","floor","maxWidth"],"sources":["@wordpress/block-library/src/columns/columnCalculations.native.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport {\r\n\tALIGNMENT_BREAKPOINTS,\r\n\tconvertUnitToMobile,\r\n} from '@wordpress/components';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { getColumnWidths, getWidths } from './utils';\r\nimport styles from './editor.scss';\r\n\r\n/**\r\n * Maximum number of columns in a row\r\n *\r\n * @type {number}\r\n */\r\nconst MAX_COLUMNS_NUM_IN_ROW = 3;\r\n\r\n/**\r\n * Minimum width of column\r\n *\r\n * @type {number}\r\n */\r\nconst MIN_WIDTH = styles.columnsContainer?.minWidth;\r\n\r\n/**\r\n * Container margin value\r\n *\r\n * @type {number}\r\n */\r\nconst MARGIN = styles.columnsContainer?.marginLeft;\r\n\r\nexport const getColumnsInRow = ( width, columnCount ) => {\r\n\tif ( width ) {\r\n\t\tif ( width < ALIGNMENT_BREAKPOINTS.mobile ) {\r\n\t\t\t// show only 1 Column in row for mobile breakpoint container width\r\n\t\t\treturn 1;\r\n\t\t} else if ( width <= ALIGNMENT_BREAKPOINTS.medium ) {\r\n\t\t\t// show the maximum number of columns in a row for large breakpoint container width\r\n\t\t\treturn Math.min(\r\n\t\t\t\tMath.max( 1, columnCount ),\r\n\t\t\t\tMAX_COLUMNS_NUM_IN_ROW\r\n\t\t\t);\r\n\t\t}\r\n\t\t// Show all Column in one row.\r\n\t\treturn columnCount;\r\n\t}\r\n};\r\n\r\nexport const calculateContainerWidth = ( containerWidth, columnsInRow ) =>\r\n\t2 * MARGIN + containerWidth - columnsInRow * 2 * MARGIN;\r\n\r\nexport const getContentWidths = (\r\n\tcolumnsInRow,\r\n\twidth,\r\n\tcolumnCount,\r\n\tinnerColumns,\r\n\tglobalStyles\r\n) => {\r\n\tconst widths = {};\r\n\tconst columnWidthsWithUnits = getWidths( innerColumns, false );\r\n\tconst columnWidths = getColumnWidths( innerColumns, columnCount );\r\n\r\n\t// Array of column width attribute values\r\n\tconst columnWidthsValues = columnWidthsWithUnits.map( ( v ) =>\r\n\t\tconvertUnitToMobile( { width }, globalStyles, v )\r\n\t);\r\n\r\n\t// The sum of column width attribute values\r\n\tconst columnWidthsSum = columnWidthsValues.reduce(\r\n\t\t( acc, curr ) => acc + curr,\r\n\t\t0\r\n\t);\r\n\r\n\t// Array of ratios of each column width attribute value to their sum\r\n\tconst columnRatios = columnWidthsValues.map(\r\n\t\t( colWidth ) => colWidth / columnWidthsSum\r\n\t);\r\n\r\n\t// Array of calculated column width for its ratio\r\n\tconst columnWidthsPerRatio = columnRatios.map(\r\n\t\t( columnRatio ) =>\r\n\t\t\tcolumnRatio * calculateContainerWidth( width, columnsInRow )\r\n\t);\r\n\r\n\t//  Array of columns whose calculated width is lower than minimum width value\r\n\tconst filteredColumnWidthsPerRatio = columnWidthsPerRatio.filter(\r\n\t\t( columnWidthPerRatio ) => columnWidthPerRatio <= MIN_WIDTH\r\n\t);\r\n\r\n\t// Container width to be divided. If there are some results within `filteredColumnWidthsPerRatio`\r\n\t// there is a need to reduce the main width by multiplying number\r\n\t// of results in `filteredColumnWidthsPerRatio` and minimum width value\r\n\tconst baseContainerWidth =\r\n\t\twidth - filteredColumnWidthsPerRatio.length * MIN_WIDTH;\r\n\r\n\t// The minimum percentage ratio for which column width is equal minimum width value\r\n\tconst minPercentageRatio =\r\n\t\tMIN_WIDTH / calculateContainerWidth( width, columnsInRow );\r\n\r\n\t// The sum of column widths which ratio is higher than `minPercentageRatio`\r\n\tconst largeColumnsWidthsSum = columnRatios\r\n\t\t.map( ( ratio, index ) => {\r\n\t\t\tif ( ratio > minPercentageRatio ) {\r\n\t\t\t\treturn columnWidthsValues[ index ];\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t} )\r\n\t\t.reduce( ( acc, curr ) => acc + curr, 0 );\r\n\r\n\tconst containerWidth = calculateContainerWidth(\r\n\t\tbaseContainerWidth,\r\n\t\tcolumnsInRow\r\n\t);\r\n\r\n\tlet columnWidth =\r\n\t\tcalculateContainerWidth( width, columnsInRow ) / columnsInRow;\r\n\tlet maxColumnWidth = columnWidth;\r\n\r\n\tinnerColumns.forEach(\r\n\t\t( { attributes: innerColumnAttributes, clientId } ) => {\r\n\t\t\tconst attributeWidth = convertUnitToMobile(\r\n\t\t\t\t{ width },\r\n\t\t\t\tglobalStyles,\r\n\t\t\t\tinnerColumnAttributes.width || columnWidths[ clientId ]\r\n\t\t\t);\r\n\t\t\tconst proportionalRatio = attributeWidth / columnWidthsSum;\r\n\t\t\tconst percentageRatio = attributeWidth / width;\r\n\t\t\tconst initialColumnWidth = proportionalRatio * containerWidth;\r\n\r\n\t\t\tif ( columnCount === 1 && width > ALIGNMENT_BREAKPOINTS.medium ) {\r\n\t\t\t\t// Exactly one column inside columns on the breakpoint higher than medium\r\n\t\t\t\t// has to take a percentage of the full width\r\n\t\t\t\tcolumnWidth = percentageRatio * containerWidth;\r\n\t\t\t} else if ( columnsInRow > 1 ) {\r\n\t\t\t\tif ( width > ALIGNMENT_BREAKPOINTS.medium ) {\r\n\t\t\t\t\tif ( initialColumnWidth <= MIN_WIDTH ) {\r\n\t\t\t\t\t\t// Column width cannot be lower than minimum 32px\r\n\t\t\t\t\t\tcolumnWidth = MIN_WIDTH;\r\n\t\t\t\t\t} else if ( initialColumnWidth > MIN_WIDTH ) {\r\n\t\t\t\t\t\t// Column width has to be the result of multiplying the container width and\r\n\t\t\t\t\t\t// the ratio of attribute and the sum of widths of columns wider than 32px\r\n\t\t\t\t\t\tcolumnWidth =\r\n\t\t\t\t\t\t\t( attributeWidth / largeColumnsWidthsSum ) *\r\n\t\t\t\t\t\t\tcontainerWidth;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tmaxColumnWidth = columnWidth;\r\n\r\n\t\t\t\t\tif ( Math.round( columnWidthsSum ) < width ) {\r\n\t\t\t\t\t\t// In case that column width attribute values does not exceed 100, each column\r\n\t\t\t\t\t\t// should have attribute percentage of container width\r\n\t\t\t\t\t\tconst newColumnWidth = percentageRatio * containerWidth;\r\n\t\t\t\t\t\tif ( newColumnWidth <= MIN_WIDTH ) {\r\n\t\t\t\t\t\t\tcolumnWidth = MIN_WIDTH;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcolumnWidth = newColumnWidth;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if ( width < ALIGNMENT_BREAKPOINTS.medium ) {\r\n\t\t\t\t\t// On the breakpoint lower than medium each column inside columns\r\n\t\t\t\t\t// has to take equal part of container width\r\n\t\t\t\t\tcolumnWidth =\r\n\t\t\t\t\t\tcalculateContainerWidth( width, columnsInRow ) /\r\n\t\t\t\t\t\tcolumnsInRow;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\twidths[ clientId ] = {\r\n\t\t\t\twidth: Math.floor( columnWidth ),\r\n\t\t\t\tmaxWidth: Math.floor( maxColumnWidth ),\r\n\t\t\t};\r\n\t\t}\r\n\t);\r\n\treturn widths;\r\n};\r\n"],"mappings":"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","ignoreList":[]}