{"version":3,"names":["clsx","createBlock","InnerBlocks","getColorClassName","jsx","_jsx","getDeprecatedLayoutColumn","originalContent","doc","document","implementation","createHTMLDocument","columnMatch","body","innerHTML","classListItem","firstChild","classList","match","Number","migrateCustomColors","attributes","customTextColor","customBackgroundColor","style","color","text","background","restAttributes","isStackedOnMobile","verticalAlignment","type","backgroundColor","textColor","migrate","save","backgroundClass","textClass","className","undefined","children","Content","columns","default","isEligible","innerBlocks","isFastPassEligible","some","innerBlock","test","reduce","accumulator","columnIndex","push","migratedInnerBlocks","map","columnBlocks","ignoredColumns","wrapperClasses"],"sources":["@wordpress/block-library/src/columns/deprecated.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport clsx from 'clsx';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { createBlock } from '@wordpress/blocks';\r\nimport { InnerBlocks, getColorClassName } from '@wordpress/block-editor';\r\n\r\n/**\r\n * Given an HTML string for a deprecated columns inner block, returns the\r\n * column index to which the migrated inner block should be assigned. Returns\r\n * undefined if the inner block was not assigned to a column.\r\n *\r\n * @param {string} originalContent Deprecated Columns inner block HTML.\r\n *\r\n * @return {number | undefined} Column to which inner block is to be assigned.\r\n */\r\nfunction getDeprecatedLayoutColumn( originalContent ) {\r\n\tlet { doc } = getDeprecatedLayoutColumn;\r\n\tif ( ! doc ) {\r\n\t\tdoc = document.implementation.createHTMLDocument( '' );\r\n\t\tgetDeprecatedLayoutColumn.doc = doc;\r\n\t}\r\n\r\n\tlet columnMatch;\r\n\r\n\tdoc.body.innerHTML = originalContent;\r\n\tfor ( const classListItem of doc.body.firstChild.classList ) {\r\n\t\tif (\r\n\t\t\t( columnMatch = classListItem.match( /^layout-column-(\\d+)$/ ) )\r\n\t\t) {\r\n\t\t\treturn Number( columnMatch[ 1 ] ) - 1;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nconst migrateCustomColors = ( attributes ) => {\r\n\tif ( ! attributes.customTextColor && ! attributes.customBackgroundColor ) {\r\n\t\treturn attributes;\r\n\t}\r\n\tconst style = { color: {} };\r\n\tif ( attributes.customTextColor ) {\r\n\t\tstyle.color.text = attributes.customTextColor;\r\n\t}\r\n\tif ( attributes.customBackgroundColor ) {\r\n\t\tstyle.color.background = attributes.customBackgroundColor;\r\n\t}\r\n\r\n\tconst { customTextColor, customBackgroundColor, ...restAttributes } =\r\n\t\tattributes;\r\n\r\n\treturn {\r\n\t\t...restAttributes,\r\n\t\tstyle,\r\n\t\tisStackedOnMobile: true,\r\n\t};\r\n};\r\n\r\nexport default [\r\n\t{\r\n\t\tattributes: {\r\n\t\t\tverticalAlignment: {\r\n\t\t\t\ttype: 'string',\r\n\t\t\t},\r\n\t\t\tbackgroundColor: {\r\n\t\t\t\ttype: 'string',\r\n\t\t\t},\r\n\t\t\tcustomBackgroundColor: {\r\n\t\t\t\ttype: 'string',\r\n\t\t\t},\r\n\t\t\tcustomTextColor: {\r\n\t\t\t\ttype: 'string',\r\n\t\t\t},\r\n\t\t\ttextColor: {\r\n\t\t\t\ttype: 'string',\r\n\t\t\t},\r\n\t\t},\r\n\t\tmigrate: migrateCustomColors,\r\n\t\tsave( { attributes } ) {\r\n\t\t\tconst {\r\n\t\t\t\tverticalAlignment,\r\n\t\t\t\tbackgroundColor,\r\n\t\t\t\tcustomBackgroundColor,\r\n\t\t\t\ttextColor,\r\n\t\t\t\tcustomTextColor,\r\n\t\t\t} = attributes;\r\n\r\n\t\t\tconst backgroundClass = getColorClassName(\r\n\t\t\t\t'background-color',\r\n\t\t\t\tbackgroundColor\r\n\t\t\t);\r\n\r\n\t\t\tconst textClass = getColorClassName( 'color', textColor );\r\n\r\n\t\t\tconst className = clsx( {\r\n\t\t\t\t'has-background': backgroundColor || customBackgroundColor,\r\n\t\t\t\t'has-text-color': textColor || customTextColor,\r\n\t\t\t\t[ backgroundClass ]: backgroundClass,\r\n\t\t\t\t[ textClass ]: textClass,\r\n\t\t\t\t[ `are-vertically-aligned-${ verticalAlignment }` ]:\r\n\t\t\t\t\tverticalAlignment,\r\n\t\t\t} );\r\n\r\n\t\t\tconst style = {\r\n\t\t\t\tbackgroundColor: backgroundClass\r\n\t\t\t\t\t? undefined\r\n\t\t\t\t\t: customBackgroundColor,\r\n\t\t\t\tcolor: textClass ? undefined : customTextColor,\r\n\t\t\t};\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<div\r\n\t\t\t\t\tclassName={ className ? className : undefined }\r\n\t\t\t\t\tstyle={ style }\r\n\t\t\t\t>\r\n\t\t\t\t\t<InnerBlocks.Content />\r\n\t\t\t\t</div>\r\n\t\t\t);\r\n\t\t},\r\n\t},\r\n\t{\r\n\t\tattributes: {\r\n\t\t\tcolumns: {\r\n\t\t\t\ttype: 'number',\r\n\t\t\t\tdefault: 2,\r\n\t\t\t},\r\n\t\t},\r\n\t\tisEligible( attributes, innerBlocks ) {\r\n\t\t\t// Since isEligible is called on every valid instance of the\r\n\t\t\t// Columns block and a deprecation is the unlikely case due to\r\n\t\t\t// its subsequent migration, optimize for the `false` condition\r\n\t\t\t// by performing a naive, inaccurate pass at inner blocks.\r\n\t\t\tconst isFastPassEligible = innerBlocks.some( ( innerBlock ) =>\r\n\t\t\t\t/layout-column-\\d+/.test( innerBlock.originalContent )\r\n\t\t\t);\r\n\r\n\t\t\tif ( ! isFastPassEligible ) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\t// Only if the fast pass is considered eligible is the more\r\n\t\t\t// accurate, durable, slower condition performed.\r\n\t\t\treturn innerBlocks.some(\r\n\t\t\t\t( innerBlock ) =>\r\n\t\t\t\t\tgetDeprecatedLayoutColumn( innerBlock.originalContent ) !==\r\n\t\t\t\t\tundefined\r\n\t\t\t);\r\n\t\t},\r\n\t\tmigrate( attributes, innerBlocks ) {\r\n\t\t\tconst columns = innerBlocks.reduce( ( accumulator, innerBlock ) => {\r\n\t\t\t\tconst { originalContent } = innerBlock;\r\n\r\n\t\t\t\tlet columnIndex = getDeprecatedLayoutColumn( originalContent );\r\n\t\t\t\tif ( columnIndex === undefined ) {\r\n\t\t\t\t\tcolumnIndex = 0;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( ! accumulator[ columnIndex ] ) {\r\n\t\t\t\t\taccumulator[ columnIndex ] = [];\r\n\t\t\t\t}\r\n\r\n\t\t\t\taccumulator[ columnIndex ].push( innerBlock );\r\n\r\n\t\t\t\treturn accumulator;\r\n\t\t\t}, [] );\r\n\r\n\t\t\tconst migratedInnerBlocks = columns.map( ( columnBlocks ) =>\r\n\t\t\t\tcreateBlock( 'core/column', {}, columnBlocks )\r\n\t\t\t);\r\n\r\n\t\t\tconst { columns: ignoredColumns, ...restAttributes } = attributes;\r\n\r\n\t\t\treturn [\r\n\t\t\t\t{\r\n\t\t\t\t\t...restAttributes,\r\n\t\t\t\t\tisStackedOnMobile: true,\r\n\t\t\t\t},\r\n\t\t\t\tmigratedInnerBlocks,\r\n\t\t\t];\r\n\t\t},\r\n\t\tsave( { attributes } ) {\r\n\t\t\tconst { columns } = attributes;\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<div className={ `has-${ columns }-columns` }>\r\n\t\t\t\t\t<InnerBlocks.Content />\r\n\t\t\t\t</div>\r\n\t\t\t);\r\n\t\t},\r\n\t},\r\n\t{\r\n\t\tattributes: {\r\n\t\t\tcolumns: {\r\n\t\t\t\ttype: 'number',\r\n\t\t\t\tdefault: 2,\r\n\t\t\t},\r\n\t\t},\r\n\t\tmigrate( attributes, innerBlocks ) {\r\n\t\t\tconst { columns, ...restAttributes } = attributes;\r\n\t\t\tattributes = {\r\n\t\t\t\t...restAttributes,\r\n\t\t\t\tisStackedOnMobile: true,\r\n\t\t\t};\r\n\r\n\t\t\treturn [ attributes, innerBlocks ];\r\n\t\t},\r\n\t\tsave( { attributes } ) {\r\n\t\t\tconst { verticalAlignment, columns } = attributes;\r\n\r\n\t\t\tconst wrapperClasses = clsx( `has-${ columns }-columns`, {\r\n\t\t\t\t[ `are-vertically-aligned-${ verticalAlignment }` ]:\r\n\t\t\t\t\tverticalAlignment,\r\n\t\t\t} );\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<div className={ wrapperClasses }>\r\n\t\t\t\t\t<InnerBlocks.Content />\r\n\t\t\t\t</div>\r\n\t\t\t);\r\n\t\t},\r\n\t},\r\n];\r\n"],"mappings":"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","ignoreList":[]}