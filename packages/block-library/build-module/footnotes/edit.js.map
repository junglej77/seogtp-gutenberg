{"version":3,"names":["BlockIcon","RichText","useBlockProps","useEntityProp","__","Placeholder","formatListNumbered","icon","jsx","_jsx","jsxs","_jsxs","FootnotesEdit","context","postType","postId","meta","updateMeta","footnotesSupported","footnotes","JSON","parse","blockProps","children","label","instructions","length","map","id","content","onMouseDown","event","target","currentTarget","firstElementChild","focus","preventDefault","tagName","value","identifier","onFocus","textContent","trim","scrollIntoView","onChange","nextFootnote","stringify","footnote","href"],"sources":["@wordpress/block-library/src/footnotes/edit.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { BlockIcon, RichText, useBlockProps } from '@wordpress/block-editor';\r\nimport { useEntityProp } from '@wordpress/core-data';\r\nimport { __ } from '@wordpress/i18n';\r\nimport { Placeholder } from '@wordpress/components';\r\nimport { formatListNumbered as icon } from '@wordpress/icons';\r\n\r\nexport default function FootnotesEdit( { context: { postType, postId } } ) {\r\n\tconst [ meta, updateMeta ] = useEntityProp(\r\n\t\t'postType',\r\n\t\tpostType,\r\n\t\t'meta',\r\n\t\tpostId\r\n\t);\r\n\tconst footnotesSupported = 'string' === typeof meta?.footnotes;\r\n\tconst footnotes = meta?.footnotes ? JSON.parse( meta.footnotes ) : [];\r\n\tconst blockProps = useBlockProps();\r\n\r\n\tif ( ! footnotesSupported ) {\r\n\t\treturn (\r\n\t\t\t<div { ...blockProps }>\r\n\t\t\t\t<Placeholder\r\n\t\t\t\t\ticon={ <BlockIcon icon={ icon } /> }\r\n\t\t\t\t\tlabel={ __( 'Footnotes' ) }\r\n\t\t\t\t\tinstructions={ __(\r\n\t\t\t\t\t\t'Footnotes are not supported here. Add this block to post or page content.'\r\n\t\t\t\t\t) }\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\tif ( ! footnotes.length ) {\r\n\t\treturn (\r\n\t\t\t<div { ...blockProps }>\r\n\t\t\t\t<Placeholder\r\n\t\t\t\t\ticon={ <BlockIcon icon={ icon } /> }\r\n\t\t\t\t\tlabel={ __( 'Footnotes' ) }\r\n\t\t\t\t\tinstructions={ __(\r\n\t\t\t\t\t\t'Footnotes found in blocks within this document will be displayed here.'\r\n\t\t\t\t\t) }\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<ol { ...blockProps }>\r\n\t\t\t{ footnotes.map( ( { id, content } ) => (\r\n\t\t\t\t/* eslint-disable-next-line jsx-a11y/no-noninteractive-element-interactions */\r\n\t\t\t\t<li\r\n\t\t\t\t\tkey={ id }\r\n\t\t\t\t\tonMouseDown={ ( event ) => {\r\n\t\t\t\t\t\t// When clicking on the list item (not on descendants),\r\n\t\t\t\t\t\t// focus the rich text element since it's only 1px wide when\r\n\t\t\t\t\t\t// empty.\r\n\t\t\t\t\t\tif ( event.target === event.currentTarget ) {\r\n\t\t\t\t\t\t\tevent.target.firstElementChild.focus();\r\n\t\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} }\r\n\t\t\t\t>\r\n\t\t\t\t\t<RichText\r\n\t\t\t\t\t\tid={ id }\r\n\t\t\t\t\t\ttagName=\"span\"\r\n\t\t\t\t\t\tvalue={ content }\r\n\t\t\t\t\t\tidentifier={ id }\r\n\t\t\t\t\t\t// To do: figure out why the browser is not scrolling\r\n\t\t\t\t\t\t// into view when it receives focus.\r\n\t\t\t\t\t\tonFocus={ ( event ) => {\r\n\t\t\t\t\t\t\tif ( ! event.target.textContent.trim() ) {\r\n\t\t\t\t\t\t\t\tevent.target.scrollIntoView();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} }\r\n\t\t\t\t\t\tonChange={ ( nextFootnote ) => {\r\n\t\t\t\t\t\t\tupdateMeta( {\r\n\t\t\t\t\t\t\t\t...meta,\r\n\t\t\t\t\t\t\t\tfootnotes: JSON.stringify(\r\n\t\t\t\t\t\t\t\t\tfootnotes.map( ( footnote ) => {\r\n\t\t\t\t\t\t\t\t\t\treturn footnote.id === id\r\n\t\t\t\t\t\t\t\t\t\t\t? {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcontent: nextFootnote,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tid,\r\n\t\t\t\t\t\t\t\t\t\t\t  }\r\n\t\t\t\t\t\t\t\t\t\t\t: footnote;\r\n\t\t\t\t\t\t\t\t\t} )\r\n\t\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t} );\r\n\t\t\t\t\t\t} }\r\n\t\t\t\t\t/>{ ' ' }\r\n\t\t\t\t\t<a href={ `#${ id }-link` }>↩︎</a>\r\n\t\t\t\t</li>\r\n\t\t\t) ) }\r\n\t\t</ol>\r\n\t);\r\n}\r\n"],"mappings":"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","ignoreList":[]}