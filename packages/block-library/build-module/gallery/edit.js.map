{"version":3,"names":["clsx","BaseControl","PanelBody","SelectControl","ToggleControl","RangeControl","Spinner","MenuGroup","MenuItem","ToolbarDropdownMenu","store","blockEditorStore","MediaPlaceholder","InspectorControls","useBlockProps","useInnerBlocksProps","BlockControls","MediaReplaceFlow","Platform","useEffect","useMemo","__","_x","sprintf","useSelect","useDispatch","View","createBlock","createBlobURL","noticesStore","link","linkIcon","customLink","image","imageIcon","linkOff","sharedIcon","defaultColumnsNumber","pickRelevantMediaFiles","getHrefAndDestination","getUpdatedLinkTargetSettings","getImageSizeAttributes","Gallery","LINK_DESTINATION_ATTACHMENT","LINK_DESTINATION_MEDIA","LINK_DESTINATION_NONE","useImageSizes","useGetNewImages","useGetMedia","GapStyles","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","MAX_COLUMNS","linkOptions","icon","label","value","noticeText","ALLOWED_MEDIA_TYPES","PLACEHOLDER_TEXT","isNative","MOBILE_CONTROL_PROPS_RANGE_CONTROL","type","DEFAULT_BLOCK","name","EMPTY_ARRAY","GalleryEdit","props","setAttributes","attributes","className","clientId","isSelected","insertBlocksAfter","isContentLocked","onFocus","columns","imageCrop","randomOrder","linkTarget","linkTo","sizeSlug","__unstableMarkNextChangeAsNotPersistent","replaceInnerBlocks","updateBlockAttributes","selectBlock","createSuccessNotice","createErrorNotice","getBlock","getSettings","innerBlockImages","blockWasJustInserted","multiGallerySelection","select","_getBlock$innerBlocks","getBlockName","getMultiSelectedBlockClientIds","_getSettings","_getBlock","wasBlockJustInserted","multiSelectedClientIds","innerBlocks","length","every","_clientId","images","map","block","id","url","fromSavedContent","Boolean","originalContent","imageData","newImages","forEach","newImage","buildImageAttributes","align","undefined","imageSizeOptions","imageAttributes","find","newClassName","newLinkTarget","rel","linkDestination","caption","raw","alt","alt_text","isValidFileType","file","nativeFileData","mediaTypeSelector","media_type","some","mediaType","indexOf","blob","updateImages","selectedImages","newFileUploads","Object","prototype","toString","call","imageArray","Array","from","processedImages","filter","newOrderMap","reduce","result","index","existingImageBlocks","img","newImageList","existingImg","newBlocks","concat","sort","a","b","onUploadError","message","setLinkTo","changedAttributes","blocks","push","linkToText","linkType","setColumnsNumber","toggleImageCrop","toggleRandomOrder","toggleOpenInNewTab","openInNewTab","updateImagesSize","newSizeSlug","imageSize","size","window","wp","media","view","settings","defaultProps","hasImages","hasImageIds","imagesUploading","mediaPlaceholderProps","web","addToGallery","disableMediaButtons","native","isAppender","autoOpenMediaUpload","mediaPlaceholder","handleUpload","labels","title","instructions","onSelect","accept","allowedTypes","multiple","onError","blockProps","nativeInnerBlockProps","marginHorizontal","marginVertical","innerBlocksProps","defaultBlock","directInsert","orientation","renderAppender","children","hasLinkTo","__nextHasNoMarginBottom","onChange","min","max","Math","required","__next40pxDefaultSize","help","options","hideCancelButton","checked","isWeb","VisualLabel","group","onClose","linkItem","isOptionSelected","iconPosition","onClick","role","mediaIds","blockGap","style","spacing"],"sources":["@wordpress/block-library/src/gallery/edit.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport clsx from 'clsx';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport {\r\n\tBaseControl,\r\n\tPanelBody,\r\n\tSelectControl,\r\n\tToggleControl,\r\n\tRangeControl,\r\n\tSpinner,\r\n\tMenuGroup,\r\n\tMenuItem,\r\n\tToolbarDropdownMenu,\r\n} from '@wordpress/components';\r\nimport {\r\n\tstore as blockEditorStore,\r\n\tMediaPlaceholder,\r\n\tInspectorControls,\r\n\tuseBlockProps,\r\n\tuseInnerBlocksProps,\r\n\tBlockControls,\r\n\tMediaReplaceFlow,\r\n} from '@wordpress/block-editor';\r\nimport { Platform, useEffect, useMemo } from '@wordpress/element';\r\nimport { __, _x, sprintf } from '@wordpress/i18n';\r\nimport { useSelect, useDispatch } from '@wordpress/data';\r\nimport { View } from '@wordpress/primitives';\r\nimport { createBlock } from '@wordpress/blocks';\r\nimport { createBlobURL } from '@wordpress/blob';\r\nimport { store as noticesStore } from '@wordpress/notices';\r\nimport {\r\n\tlink as linkIcon,\r\n\tcustomLink,\r\n\timage as imageIcon,\r\n\tlinkOff,\r\n} from '@wordpress/icons';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { sharedIcon } from './shared-icon';\r\nimport { defaultColumnsNumber, pickRelevantMediaFiles } from './shared';\r\nimport { getHrefAndDestination } from './utils';\r\nimport {\r\n\tgetUpdatedLinkTargetSettings,\r\n\tgetImageSizeAttributes,\r\n} from '../image/utils';\r\nimport Gallery from './gallery';\r\nimport {\r\n\tLINK_DESTINATION_ATTACHMENT,\r\n\tLINK_DESTINATION_MEDIA,\r\n\tLINK_DESTINATION_NONE,\r\n} from './constants';\r\nimport useImageSizes from './use-image-sizes';\r\nimport useGetNewImages from './use-get-new-images';\r\nimport useGetMedia from './use-get-media';\r\nimport GapStyles from './gap-styles';\r\n\r\nconst MAX_COLUMNS = 8;\r\nconst linkOptions = [\r\n\t{\r\n\t\ticon: customLink,\r\n\t\tlabel: __( 'Link images to attachment pages' ),\r\n\t\tvalue: LINK_DESTINATION_ATTACHMENT,\r\n\t\tnoticeText: __( 'Attachment Pages' ),\r\n\t},\r\n\t{\r\n\t\ticon: imageIcon,\r\n\t\tlabel: __( 'Link images to media files' ),\r\n\t\tvalue: LINK_DESTINATION_MEDIA,\r\n\t\tnoticeText: __( 'Media Files' ),\r\n\t},\r\n\t{\r\n\t\ticon: linkOff,\r\n\t\tlabel: _x( 'None', 'Media item link option' ),\r\n\t\tvalue: LINK_DESTINATION_NONE,\r\n\t\tnoticeText: __( 'None' ),\r\n\t},\r\n];\r\nconst ALLOWED_MEDIA_TYPES = [ 'image' ];\r\n\r\nconst PLACEHOLDER_TEXT = Platform.isNative\r\n\t? __( 'Add media' )\r\n\t: __( 'Drag images, upload new ones or select files from your library.' );\r\n\r\nconst MOBILE_CONTROL_PROPS_RANGE_CONTROL = Platform.isNative\r\n\t? { type: 'stepper' }\r\n\t: {};\r\n\r\nconst DEFAULT_BLOCK = { name: 'core/image' };\r\nconst EMPTY_ARRAY = [];\r\n\r\nexport default function GalleryEdit( props ) {\r\n\tconst {\r\n\t\tsetAttributes,\r\n\t\tattributes,\r\n\t\tclassName,\r\n\t\tclientId,\r\n\t\tisSelected,\r\n\t\tinsertBlocksAfter,\r\n\t\tisContentLocked,\r\n\t\tonFocus,\r\n\t} = props;\r\n\r\n\tconst { columns, imageCrop, randomOrder, linkTarget, linkTo, sizeSlug } =\r\n\t\tattributes;\r\n\r\n\tconst {\r\n\t\t__unstableMarkNextChangeAsNotPersistent,\r\n\t\treplaceInnerBlocks,\r\n\t\tupdateBlockAttributes,\r\n\t\tselectBlock,\r\n\t} = useDispatch( blockEditorStore );\r\n\tconst { createSuccessNotice, createErrorNotice } =\r\n\t\tuseDispatch( noticesStore );\r\n\r\n\tconst {\r\n\t\tgetBlock,\r\n\t\tgetSettings,\r\n\t\tinnerBlockImages,\r\n\t\tblockWasJustInserted,\r\n\t\tmultiGallerySelection,\r\n\t} = useSelect(\r\n\t\t( select ) => {\r\n\t\t\tconst {\r\n\t\t\t\tgetBlockName,\r\n\t\t\t\tgetMultiSelectedBlockClientIds,\r\n\t\t\t\tgetSettings: _getSettings,\r\n\t\t\t\tgetBlock: _getBlock,\r\n\t\t\t\twasBlockJustInserted,\r\n\t\t\t} = select( blockEditorStore );\r\n\t\t\tconst multiSelectedClientIds = getMultiSelectedBlockClientIds();\r\n\r\n\t\t\treturn {\r\n\t\t\t\tgetBlock: _getBlock,\r\n\t\t\t\tgetSettings: _getSettings,\r\n\t\t\t\tinnerBlockImages:\r\n\t\t\t\t\t_getBlock( clientId )?.innerBlocks ?? EMPTY_ARRAY,\r\n\t\t\t\tblockWasJustInserted: wasBlockJustInserted(\r\n\t\t\t\t\tclientId,\r\n\t\t\t\t\t'inserter_menu'\r\n\t\t\t\t),\r\n\t\t\t\tmultiGallerySelection:\r\n\t\t\t\t\tmultiSelectedClientIds.length &&\r\n\t\t\t\t\tmultiSelectedClientIds.every(\r\n\t\t\t\t\t\t( _clientId ) =>\r\n\t\t\t\t\t\t\tgetBlockName( _clientId ) === 'core/gallery'\r\n\t\t\t\t\t),\r\n\t\t\t};\r\n\t\t},\r\n\t\t[ clientId ]\r\n\t);\r\n\r\n\tconst images = useMemo(\r\n\t\t() =>\r\n\t\t\tinnerBlockImages?.map( ( block ) => ( {\r\n\t\t\t\tclientId: block.clientId,\r\n\t\t\t\tid: block.attributes.id,\r\n\t\t\t\turl: block.attributes.url,\r\n\t\t\t\tattributes: block.attributes,\r\n\t\t\t\tfromSavedContent: Boolean( block.originalContent ),\r\n\t\t\t} ) ),\r\n\t\t[ innerBlockImages ]\r\n\t);\r\n\r\n\tconst imageData = useGetMedia( innerBlockImages );\r\n\r\n\tconst newImages = useGetNewImages( images, imageData );\r\n\r\n\tuseEffect( () => {\r\n\t\tnewImages?.forEach( ( newImage ) => {\r\n\t\t\t// Update the images data without creating new undo levels.\r\n\t\t\t__unstableMarkNextChangeAsNotPersistent();\r\n\t\t\tupdateBlockAttributes( newImage.clientId, {\r\n\t\t\t\t...buildImageAttributes( newImage.attributes ),\r\n\t\t\t\tid: newImage.id,\r\n\t\t\t\talign: undefined,\r\n\t\t\t} );\r\n\t\t} );\r\n\t}, [ newImages ] );\r\n\r\n\tconst imageSizeOptions = useImageSizes(\r\n\t\timageData,\r\n\t\tisSelected,\r\n\t\tgetSettings\r\n\t);\r\n\r\n\t/**\r\n\t * Determines the image attributes that should be applied to an image block\r\n\t * after the gallery updates.\r\n\t *\r\n\t * The gallery will receive the full collection of images when a new image\r\n\t * is added. As a result we need to reapply the image's original settings if\r\n\t * it already existed in the gallery. If the image is in fact new, we need\r\n\t * to apply the gallery's current settings to the image.\r\n\t *\r\n\t * @param {Object} imageAttributes Media object for the actual image.\r\n\t * @return {Object}                Attributes to set on the new image block.\r\n\t */\r\n\tfunction buildImageAttributes( imageAttributes ) {\r\n\t\tconst image = imageAttributes.id\r\n\t\t\t? imageData.find( ( { id } ) => id === imageAttributes.id )\r\n\t\t\t: null;\r\n\r\n\t\tlet newClassName;\r\n\t\tif ( imageAttributes.className && imageAttributes.className !== '' ) {\r\n\t\t\tnewClassName = imageAttributes.className;\r\n\t\t}\r\n\r\n\t\tlet newLinkTarget;\r\n\t\tif ( imageAttributes.linkTarget || imageAttributes.rel ) {\r\n\t\t\t// When transformed from image blocks, the link destination and rel attributes are inherited.\r\n\t\t\tnewLinkTarget = {\r\n\t\t\t\tlinkTarget: imageAttributes.linkTarget,\r\n\t\t\t\trel: imageAttributes.rel,\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\t// When an image is added, update the link destination and rel attributes according to the gallery settings\r\n\t\t\tnewLinkTarget = getUpdatedLinkTargetSettings(\r\n\t\t\t\tlinkTarget,\r\n\t\t\t\tattributes\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\t...pickRelevantMediaFiles( image, sizeSlug ),\r\n\t\t\t...getHrefAndDestination(\r\n\t\t\t\timage,\r\n\t\t\t\tlinkTo,\r\n\t\t\t\timageAttributes?.linkDestination\r\n\t\t\t),\r\n\t\t\t...newLinkTarget,\r\n\t\t\tclassName: newClassName,\r\n\t\t\tsizeSlug,\r\n\t\t\tcaption: imageAttributes.caption || image.caption?.raw,\r\n\t\t\talt: imageAttributes.alt || image.alt_text,\r\n\t\t};\r\n\t}\r\n\r\n\tfunction isValidFileType( file ) {\r\n\t\t// It's necessary to retrieve the media type from the raw image data for already-uploaded images on native.\r\n\t\tconst nativeFileData =\r\n\t\t\tPlatform.isNative && file.id\r\n\t\t\t\t? imageData.find( ( { id } ) => id === file.id )\r\n\t\t\t\t: null;\r\n\r\n\t\tconst mediaTypeSelector = nativeFileData\r\n\t\t\t? nativeFileData?.media_type\r\n\t\t\t: file.type;\r\n\r\n\t\treturn (\r\n\t\t\tALLOWED_MEDIA_TYPES.some(\r\n\t\t\t\t( mediaType ) => mediaTypeSelector?.indexOf( mediaType ) === 0\r\n\t\t\t) || file.blob\r\n\t\t);\r\n\t}\r\n\r\n\tfunction updateImages( selectedImages ) {\r\n\t\tconst newFileUploads =\r\n\t\t\tObject.prototype.toString.call( selectedImages ) ===\r\n\t\t\t'[object FileList]';\r\n\r\n\t\tconst imageArray = newFileUploads\r\n\t\t\t? Array.from( selectedImages ).map( ( file ) => {\r\n\t\t\t\t\tif ( ! file.url ) {\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\tblob: createBlobURL( file ),\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn file;\r\n\t\t\t  } )\r\n\t\t\t: selectedImages;\r\n\r\n\t\tif ( ! imageArray.every( isValidFileType ) ) {\r\n\t\t\tcreateErrorNotice(\r\n\t\t\t\t__(\r\n\t\t\t\t\t'If uploading to a gallery all files need to be image formats'\r\n\t\t\t\t),\r\n\t\t\t\t{ id: 'gallery-upload-invalid-file', type: 'snackbar' }\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tconst processedImages = imageArray\r\n\t\t\t.filter( ( file ) => file.url || isValidFileType( file ) )\r\n\t\t\t.map( ( file ) => {\r\n\t\t\t\tif ( ! file.url ) {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tblob: file.blob || createBlobURL( file ),\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn file;\r\n\t\t\t} );\r\n\r\n\t\t// Because we are reusing existing innerImage blocks any reordering\r\n\t\t// done in the media library will be lost so we need to reapply that ordering\r\n\t\t// once the new image blocks are merged in with existing.\r\n\t\tconst newOrderMap = processedImages.reduce(\r\n\t\t\t( result, image, index ) => (\r\n\t\t\t\t( result[ image.id ] = index ), result\r\n\t\t\t),\r\n\t\t\t{}\r\n\t\t);\r\n\r\n\t\tconst existingImageBlocks = ! newFileUploads\r\n\t\t\t? innerBlockImages.filter( ( block ) =>\r\n\t\t\t\t\tprocessedImages.find(\r\n\t\t\t\t\t\t( img ) => img.id === block.attributes.id\r\n\t\t\t\t\t)\r\n\t\t\t  )\r\n\t\t\t: innerBlockImages;\r\n\r\n\t\tconst newImageList = processedImages.filter(\r\n\t\t\t( img ) =>\r\n\t\t\t\t! existingImageBlocks.find(\r\n\t\t\t\t\t( existingImg ) => img.id === existingImg.attributes.id\r\n\t\t\t\t)\r\n\t\t);\r\n\r\n\t\tconst newBlocks = newImageList.map( ( image ) => {\r\n\t\t\treturn createBlock( 'core/image', {\r\n\t\t\t\tid: image.id,\r\n\t\t\t\tblob: image.blob,\r\n\t\t\t\turl: image.url,\r\n\t\t\t\tcaption: image.caption,\r\n\t\t\t\talt: image.alt,\r\n\t\t\t} );\r\n\t\t} );\r\n\r\n\t\treplaceInnerBlocks(\r\n\t\t\tclientId,\r\n\t\t\texistingImageBlocks\r\n\t\t\t\t.concat( newBlocks )\r\n\t\t\t\t.sort(\r\n\t\t\t\t\t( a, b ) =>\r\n\t\t\t\t\t\tnewOrderMap[ a.attributes.id ] -\r\n\t\t\t\t\t\tnewOrderMap[ b.attributes.id ]\r\n\t\t\t\t)\r\n\t\t);\r\n\r\n\t\t// Select the first block to scroll into view when new blocks are added.\r\n\t\tif ( newBlocks?.length > 0 ) {\r\n\t\t\tselectBlock( newBlocks[ 0 ].clientId );\r\n\t\t}\r\n\t}\r\n\r\n\tfunction onUploadError( message ) {\r\n\t\tcreateErrorNotice( message, { type: 'snackbar' } );\r\n\t}\r\n\r\n\tfunction setLinkTo( value ) {\r\n\t\tsetAttributes( { linkTo: value } );\r\n\t\tconst changedAttributes = {};\r\n\t\tconst blocks = [];\r\n\t\tgetBlock( clientId ).innerBlocks.forEach( ( block ) => {\r\n\t\t\tblocks.push( block.clientId );\r\n\t\t\tconst image = block.attributes.id\r\n\t\t\t\t? imageData.find( ( { id } ) => id === block.attributes.id )\r\n\t\t\t\t: null;\r\n\t\t\tchangedAttributes[ block.clientId ] = getHrefAndDestination(\r\n\t\t\t\timage,\r\n\t\t\t\tvalue\r\n\t\t\t);\r\n\t\t} );\r\n\t\tupdateBlockAttributes( blocks, changedAttributes, true );\r\n\t\tconst linkToText = [ ...linkOptions ].find(\r\n\t\t\t( linkType ) => linkType.value === value\r\n\t\t);\r\n\r\n\t\tcreateSuccessNotice(\r\n\t\t\tsprintf(\r\n\t\t\t\t/* translators: %s: image size settings */\r\n\t\t\t\t__( 'All gallery image links updated to: %s' ),\r\n\t\t\t\tlinkToText.noticeText\r\n\t\t\t),\r\n\t\t\t{\r\n\t\t\t\tid: 'gallery-attributes-linkTo',\r\n\t\t\t\ttype: 'snackbar',\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tfunction setColumnsNumber( value ) {\r\n\t\tsetAttributes( { columns: value } );\r\n\t}\r\n\r\n\tfunction toggleImageCrop() {\r\n\t\tsetAttributes( { imageCrop: ! imageCrop } );\r\n\t}\r\n\r\n\tfunction toggleRandomOrder() {\r\n\t\tsetAttributes( { randomOrder: ! randomOrder } );\r\n\t}\r\n\r\n\tfunction toggleOpenInNewTab( openInNewTab ) {\r\n\t\tconst newLinkTarget = openInNewTab ? '_blank' : undefined;\r\n\t\tsetAttributes( { linkTarget: newLinkTarget } );\r\n\t\tconst changedAttributes = {};\r\n\t\tconst blocks = [];\r\n\t\tgetBlock( clientId ).innerBlocks.forEach( ( block ) => {\r\n\t\t\tblocks.push( block.clientId );\r\n\t\t\tchangedAttributes[ block.clientId ] = getUpdatedLinkTargetSettings(\r\n\t\t\t\tnewLinkTarget,\r\n\t\t\t\tblock.attributes\r\n\t\t\t);\r\n\t\t} );\r\n\t\tupdateBlockAttributes( blocks, changedAttributes, true );\r\n\t\tconst noticeText = openInNewTab\r\n\t\t\t? __( 'All gallery images updated to open in new tab' )\r\n\t\t\t: __( 'All gallery images updated to not open in new tab' );\r\n\t\tcreateSuccessNotice( noticeText, {\r\n\t\t\tid: 'gallery-attributes-openInNewTab',\r\n\t\t\ttype: 'snackbar',\r\n\t\t} );\r\n\t}\r\n\r\n\tfunction updateImagesSize( newSizeSlug ) {\r\n\t\tsetAttributes( { sizeSlug: newSizeSlug } );\r\n\t\tconst changedAttributes = {};\r\n\t\tconst blocks = [];\r\n\t\tgetBlock( clientId ).innerBlocks.forEach( ( block ) => {\r\n\t\t\tblocks.push( block.clientId );\r\n\t\t\tconst image = block.attributes.id\r\n\t\t\t\t? imageData.find( ( { id } ) => id === block.attributes.id )\r\n\t\t\t\t: null;\r\n\t\t\tchangedAttributes[ block.clientId ] = getImageSizeAttributes(\r\n\t\t\t\timage,\r\n\t\t\t\tnewSizeSlug\r\n\t\t\t);\r\n\t\t} );\r\n\t\tupdateBlockAttributes( blocks, changedAttributes, true );\r\n\t\tconst imageSize = imageSizeOptions.find(\r\n\t\t\t( size ) => size.value === newSizeSlug\r\n\t\t);\r\n\r\n\t\tcreateSuccessNotice(\r\n\t\t\tsprintf(\r\n\t\t\t\t/* translators: %s: image size settings */\r\n\t\t\t\t__( 'All gallery image sizes updated to: %s' ),\r\n\t\t\t\timageSize.label\r\n\t\t\t),\r\n\t\t\t{\r\n\t\t\t\tid: 'gallery-attributes-sizeSlug',\r\n\t\t\t\ttype: 'snackbar',\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tuseEffect( () => {\r\n\t\t// linkTo attribute must be saved so blocks don't break when changing image_default_link_type in options.php.\r\n\t\tif ( ! linkTo ) {\r\n\t\t\t__unstableMarkNextChangeAsNotPersistent();\r\n\t\t\tsetAttributes( {\r\n\t\t\t\tlinkTo:\r\n\t\t\t\t\twindow?.wp?.media?.view?.settings?.defaultProps?.link ||\r\n\t\t\t\t\tLINK_DESTINATION_NONE,\r\n\t\t\t} );\r\n\t\t}\r\n\t}, [ linkTo ] );\r\n\r\n\tconst hasImages = !! images.length;\r\n\tconst hasImageIds = hasImages && images.some( ( image ) => !! image.id );\r\n\tconst imagesUploading = images.some( ( img ) =>\r\n\t\t! Platform.isNative\r\n\t\t\t? ! img.id && img.url?.indexOf( 'blob:' ) === 0\r\n\t\t\t: img.url?.indexOf( 'file:' ) === 0\r\n\t);\r\n\r\n\t// MediaPlaceholder props are different between web and native hence, we provide a platform-specific set.\r\n\tconst mediaPlaceholderProps = Platform.select( {\r\n\t\tweb: {\r\n\t\t\taddToGallery: false,\r\n\t\t\tdisableMediaButtons: imagesUploading,\r\n\t\t\tvalue: {},\r\n\t\t},\r\n\t\tnative: {\r\n\t\t\taddToGallery: hasImageIds,\r\n\t\t\tisAppender: hasImages,\r\n\t\t\tdisableMediaButtons:\r\n\t\t\t\t( hasImages && ! isSelected ) || imagesUploading,\r\n\t\t\tvalue: hasImageIds ? images : {},\r\n\t\t\tautoOpenMediaUpload:\r\n\t\t\t\t! hasImages && isSelected && blockWasJustInserted,\r\n\t\t\tonFocus,\r\n\t\t},\r\n\t} );\r\n\tconst mediaPlaceholder = (\r\n\t\t<MediaPlaceholder\r\n\t\t\thandleUpload={ false }\r\n\t\t\ticon={ sharedIcon }\r\n\t\t\tlabels={ {\r\n\t\t\t\ttitle: __( 'Gallery' ),\r\n\t\t\t\tinstructions: PLACEHOLDER_TEXT,\r\n\t\t\t} }\r\n\t\t\tonSelect={ updateImages }\r\n\t\t\taccept=\"image/*\"\r\n\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\r\n\t\t\tmultiple\r\n\t\t\tonError={ onUploadError }\r\n\t\t\t{ ...mediaPlaceholderProps }\r\n\t\t/>\r\n\t);\r\n\r\n\tconst blockProps = useBlockProps( {\r\n\t\tclassName: clsx( className, 'has-nested-images' ),\r\n\t} );\r\n\r\n\tconst nativeInnerBlockProps = Platform.isNative && {\r\n\t\tmarginHorizontal: 0,\r\n\t\tmarginVertical: 0,\r\n\t};\r\n\r\n\tconst innerBlocksProps = useInnerBlocksProps( blockProps, {\r\n\t\tdefaultBlock: DEFAULT_BLOCK,\r\n\t\tdirectInsert: true,\r\n\t\torientation: 'horizontal',\r\n\t\trenderAppender: false,\r\n\t\t...nativeInnerBlockProps,\r\n\t} );\r\n\r\n\tif ( ! hasImages ) {\r\n\t\treturn (\r\n\t\t\t<View { ...innerBlocksProps }>\r\n\t\t\t\t{ innerBlocksProps.children }\r\n\t\t\t\t{ mediaPlaceholder }\r\n\t\t\t</View>\r\n\t\t);\r\n\t}\r\n\r\n\tconst hasLinkTo = linkTo && linkTo !== 'none';\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<InspectorControls>\r\n\t\t\t\t<PanelBody title={ __( 'Settings' ) }>\r\n\t\t\t\t\t{ images.length > 1 && (\r\n\t\t\t\t\t\t<RangeControl\r\n\t\t\t\t\t\t\t__nextHasNoMarginBottom\r\n\t\t\t\t\t\t\tlabel={ __( 'Columns' ) }\r\n\t\t\t\t\t\t\tvalue={\r\n\t\t\t\t\t\t\t\tcolumns\r\n\t\t\t\t\t\t\t\t\t? columns\r\n\t\t\t\t\t\t\t\t\t: defaultColumnsNumber( images.length )\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tonChange={ setColumnsNumber }\r\n\t\t\t\t\t\t\tmin={ 1 }\r\n\t\t\t\t\t\t\tmax={ Math.min( MAX_COLUMNS, images.length ) }\r\n\t\t\t\t\t\t\t{ ...MOBILE_CONTROL_PROPS_RANGE_CONTROL }\r\n\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t__next40pxDefaultSize\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t) }\r\n\t\t\t\t\t{ imageSizeOptions?.length > 0 && (\r\n\t\t\t\t\t\t<SelectControl\r\n\t\t\t\t\t\t\t__nextHasNoMarginBottom\r\n\t\t\t\t\t\t\tlabel={ __( 'Resolution' ) }\r\n\t\t\t\t\t\t\thelp={ __(\r\n\t\t\t\t\t\t\t\t'Select the size of the source images.'\r\n\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\tvalue={ sizeSlug }\r\n\t\t\t\t\t\t\toptions={ imageSizeOptions }\r\n\t\t\t\t\t\t\tonChange={ updateImagesSize }\r\n\t\t\t\t\t\t\thideCancelButton\r\n\t\t\t\t\t\t\tsize=\"__unstable-large\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t) }\r\n\t\t\t\t\t{ Platform.isNative ? (\r\n\t\t\t\t\t\t<SelectControl\r\n\t\t\t\t\t\t\t__nextHasNoMarginBottom\r\n\t\t\t\t\t\t\tlabel={ __( 'Link' ) }\r\n\t\t\t\t\t\t\tvalue={ linkTo }\r\n\t\t\t\t\t\t\tonChange={ setLinkTo }\r\n\t\t\t\t\t\t\toptions={ linkOptions }\r\n\t\t\t\t\t\t\thideCancelButton\r\n\t\t\t\t\t\t\tsize=\"__unstable-large\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t) : null }\r\n\t\t\t\t\t<ToggleControl\r\n\t\t\t\t\t\t__nextHasNoMarginBottom\r\n\t\t\t\t\t\tlabel={ __( 'Crop images to fit' ) }\r\n\t\t\t\t\t\tchecked={ !! imageCrop }\r\n\t\t\t\t\t\tonChange={ toggleImageCrop }\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<ToggleControl\r\n\t\t\t\t\t\t__nextHasNoMarginBottom\r\n\t\t\t\t\t\tlabel={ __( 'Randomize order' ) }\r\n\t\t\t\t\t\tchecked={ !! randomOrder }\r\n\t\t\t\t\t\tonChange={ toggleRandomOrder }\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t{ hasLinkTo && (\r\n\t\t\t\t\t\t<ToggleControl\r\n\t\t\t\t\t\t\t__nextHasNoMarginBottom\r\n\t\t\t\t\t\t\tlabel={ __( 'Open images in new tab' ) }\r\n\t\t\t\t\t\t\tchecked={ linkTarget === '_blank' }\r\n\t\t\t\t\t\t\tonChange={ toggleOpenInNewTab }\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t) }\r\n\t\t\t\t\t{ Platform.isWeb && ! imageSizeOptions && hasImageIds && (\r\n\t\t\t\t\t\t<BaseControl\r\n\t\t\t\t\t\t\tclassName=\"gallery-image-sizes\"\r\n\t\t\t\t\t\t\t__nextHasNoMarginBottom\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<BaseControl.VisualLabel>\r\n\t\t\t\t\t\t\t\t{ __( 'Resolution' ) }\r\n\t\t\t\t\t\t\t</BaseControl.VisualLabel>\r\n\t\t\t\t\t\t\t<View className=\"gallery-image-sizes__loading\">\r\n\t\t\t\t\t\t\t\t<Spinner />\r\n\t\t\t\t\t\t\t\t{ __( 'Loading options…' ) }\r\n\t\t\t\t\t\t\t</View>\r\n\t\t\t\t\t\t</BaseControl>\r\n\t\t\t\t\t) }\r\n\t\t\t\t</PanelBody>\r\n\t\t\t</InspectorControls>\r\n\t\t\t{ Platform.isWeb ? (\r\n\t\t\t\t<BlockControls group=\"block\">\r\n\t\t\t\t\t<ToolbarDropdownMenu\r\n\t\t\t\t\t\ticon={ linkIcon }\r\n\t\t\t\t\t\tlabel={ __( 'Link' ) }\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{ ( { onClose } ) => (\r\n\t\t\t\t\t\t\t<MenuGroup>\r\n\t\t\t\t\t\t\t\t{ linkOptions.map( ( linkItem ) => {\r\n\t\t\t\t\t\t\t\t\tconst isOptionSelected =\r\n\t\t\t\t\t\t\t\t\t\tlinkTo === linkItem.value;\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<MenuItem\r\n\t\t\t\t\t\t\t\t\t\t\tkey={ linkItem.value }\r\n\t\t\t\t\t\t\t\t\t\t\tisSelected={ isOptionSelected }\r\n\t\t\t\t\t\t\t\t\t\t\tclassName={ clsx(\r\n\t\t\t\t\t\t\t\t\t\t\t\t'components-dropdown-menu__menu-item',\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t'is-active':\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tisOptionSelected,\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\t\t\t\t\ticonPosition=\"left\"\r\n\t\t\t\t\t\t\t\t\t\t\ticon={ linkItem.icon }\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={ () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetLinkTo( linkItem.value );\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClose();\r\n\t\t\t\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t\t\t\t\trole=\"menuitemradio\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{ linkItem.label }\r\n\t\t\t\t\t\t\t\t\t\t</MenuItem>\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t} ) }\r\n\t\t\t\t\t\t\t</MenuGroup>\r\n\t\t\t\t\t\t) }\r\n\t\t\t\t\t</ToolbarDropdownMenu>\r\n\t\t\t\t</BlockControls>\r\n\t\t\t) : null }\r\n\t\t\t{ Platform.isWeb && (\r\n\t\t\t\t<>\r\n\t\t\t\t\t{ ! multiGallerySelection && (\r\n\t\t\t\t\t\t<BlockControls group=\"other\">\r\n\t\t\t\t\t\t\t<MediaReplaceFlow\r\n\t\t\t\t\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\r\n\t\t\t\t\t\t\t\taccept=\"image/*\"\r\n\t\t\t\t\t\t\t\thandleUpload={ false }\r\n\t\t\t\t\t\t\t\tonSelect={ updateImages }\r\n\t\t\t\t\t\t\t\tname={ __( 'Add' ) }\r\n\t\t\t\t\t\t\t\tmultiple\r\n\t\t\t\t\t\t\t\tmediaIds={ images\r\n\t\t\t\t\t\t\t\t\t.filter( ( image ) => image.id )\r\n\t\t\t\t\t\t\t\t\t.map( ( image ) => image.id ) }\r\n\t\t\t\t\t\t\t\taddToGallery={ hasImageIds }\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</BlockControls>\r\n\t\t\t\t\t) }\r\n\t\t\t\t\t<GapStyles\r\n\t\t\t\t\t\tblockGap={ attributes.style?.spacing?.blockGap }\r\n\t\t\t\t\t\tclientId={ clientId }\r\n\t\t\t\t\t/>\r\n\t\t\t\t</>\r\n\t\t\t) }\r\n\t\t\t<Gallery\r\n\t\t\t\t{ ...props }\r\n\t\t\t\tisContentLocked={ isContentLocked }\r\n\t\t\t\timages={ images }\r\n\t\t\t\tmediaPlaceholder={\r\n\t\t\t\t\t! hasImages || Platform.isNative\r\n\t\t\t\t\t\t? mediaPlaceholder\r\n\t\t\t\t\t\t: undefined\r\n\t\t\t\t}\r\n\t\t\t\tblockProps={ innerBlocksProps }\r\n\t\t\t\tinsertBlocksAfter={ insertBlocksAfter }\r\n\t\t\t\tmultiGallerySelection={ multiGallerySelection }\r\n\t\t\t/>\r\n\t\t</>\r\n\t);\r\n}\r\n"],"mappings":"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","ignoreList":[]}