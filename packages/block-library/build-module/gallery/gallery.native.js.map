{"version":3,"names":["View","defaultColumnsNumber","styles","__","sprintf","BlockCaption","RichText","useInnerBlocksProps","useState","useEffect","mediaUploadSync","WIDE_ALIGNMENTS","useResizeObserver","withViewportMatch","jsx","_jsx","jsxs","_jsxs","TILE_SPACING","MAX_DISPLAYED_COLUMNS","MAX_DISPLAYED_COLUMNS_NARROW","Gallery","props","isCaptionSelected","setIsCaptionSelected","resizeObserver","sizes","maxWidth","setMaxWidth","mediaPlaceholder","attributes","images","isNarrow","onBlur","insertBlocksAfter","clientId","width","align","columns","length","displayedColumns","Math","min","innerBlocksProps","contentResizeMode","orientation","renderAppender","numColumns","marginHorizontal","marginVertical","layout","type","alignments","gridProperties","parentWidth","focusGalleryCaption","isFullWidth","full","style","fullWidth","children","galleryAppender","isSelected","accessible","accessibilityLabelCreator","caption","isEmpty","onFocus"],"sources":["@wordpress/block-library/src/gallery/gallery.native.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport { View } from 'react-native';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { defaultColumnsNumber } from './shared';\r\nimport styles from './gallery-styles.scss';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { __, sprintf } from '@wordpress/i18n';\r\nimport {\r\n\tBlockCaption,\r\n\tRichText,\r\n\tuseInnerBlocksProps,\r\n} from '@wordpress/block-editor';\r\nimport { useState, useEffect } from '@wordpress/element';\r\nimport { mediaUploadSync } from '@wordpress/react-native-bridge';\r\nimport { WIDE_ALIGNMENTS } from '@wordpress/components';\r\nimport { useResizeObserver } from '@wordpress/compose';\r\nimport { withViewportMatch } from '@wordpress/viewport';\r\n\r\nconst TILE_SPACING = 8;\r\n\r\n// we must limit displayed columns since readable content max-width is 580px\r\nconst MAX_DISPLAYED_COLUMNS = 4;\r\nconst MAX_DISPLAYED_COLUMNS_NARROW = 2;\r\n\r\nexport const Gallery = ( props ) => {\r\n\tconst [ isCaptionSelected, setIsCaptionSelected ] = useState( false );\r\n\tconst [ resizeObserver, sizes ] = useResizeObserver();\r\n\tconst [ maxWidth, setMaxWidth ] = useState( 0 );\r\n\tuseEffect( mediaUploadSync, [] );\r\n\r\n\tconst {\r\n\t\tmediaPlaceholder,\r\n\t\tattributes,\r\n\t\timages,\r\n\t\tisNarrow,\r\n\t\tonBlur,\r\n\t\tinsertBlocksAfter,\r\n\t\tclientId,\r\n\t} = props;\r\n\r\n\tuseEffect( () => {\r\n\t\tconst { width } = sizes || {};\r\n\t\tif ( width ) {\r\n\t\t\tsetMaxWidth( width );\r\n\t\t}\r\n\t}, [ sizes ] );\r\n\r\n\tconst { align, columns = defaultColumnsNumber( images.length ) } =\r\n\t\tattributes;\r\n\r\n\tconst displayedColumns = Math.min(\r\n\t\tcolumns,\r\n\t\tisNarrow ? MAX_DISPLAYED_COLUMNS_NARROW : MAX_DISPLAYED_COLUMNS\r\n\t);\r\n\r\n\tconst innerBlocksProps = useInnerBlocksProps(\r\n\t\t{},\r\n\t\t{\r\n\t\t\tcontentResizeMode: 'stretch',\r\n\t\t\torientation: 'horizontal',\r\n\t\t\trenderAppender: false,\r\n\t\t\tnumColumns: displayedColumns,\r\n\t\t\tmarginHorizontal: TILE_SPACING,\r\n\t\t\tmarginVertical: TILE_SPACING,\r\n\t\t\tlayout: { type: 'default', alignments: [] },\r\n\t\t\tgridProperties: {\r\n\t\t\t\tnumColumns: displayedColumns,\r\n\t\t\t},\r\n\t\t\tparentWidth: maxWidth + 2 * TILE_SPACING,\r\n\t\t}\r\n\t);\r\n\r\n\tconst focusGalleryCaption = () => {\r\n\t\tif ( ! isCaptionSelected ) {\r\n\t\t\tsetIsCaptionSelected( true );\r\n\t\t}\r\n\t};\r\n\r\n\tconst isFullWidth = align === WIDE_ALIGNMENTS.alignments.full;\r\n\r\n\treturn (\r\n\t\t<View style={ isFullWidth && styles.fullWidth }>\r\n\t\t\t{ resizeObserver }\r\n\t\t\t<View { ...innerBlocksProps } />\r\n\t\t\t<View\r\n\t\t\t\tstyle={ [\r\n\t\t\t\t\tisFullWidth && styles.fullWidth,\r\n\t\t\t\t\tstyles.galleryAppender,\r\n\t\t\t\t] }\r\n\t\t\t>\r\n\t\t\t\t{ mediaPlaceholder }\r\n\t\t\t</View>\r\n\t\t\t<BlockCaption\r\n\t\t\t\tclientId={ clientId }\r\n\t\t\t\tisSelected={ isCaptionSelected }\r\n\t\t\t\taccessible\r\n\t\t\t\taccessibilityLabelCreator={ ( caption ) =>\r\n\t\t\t\t\tRichText.isEmpty( caption )\r\n\t\t\t\t\t\t? /* translators: accessibility text. Empty gallery caption. */\r\n\r\n\t\t\t\t\t\t  'Gallery caption. Empty'\r\n\t\t\t\t\t\t: sprintf(\r\n\t\t\t\t\t\t\t\t/* translators: accessibility text. %s: gallery caption. */\r\n\t\t\t\t\t\t\t\t__( 'Gallery caption. %s' ),\r\n\t\t\t\t\t\t\t\tcaption\r\n\t\t\t\t\t\t  )\r\n\t\t\t\t}\r\n\t\t\t\tonFocus={ focusGalleryCaption }\r\n\t\t\t\tonBlur={ onBlur } // Always assign onBlur as props.\r\n\t\t\t\tinsertBlocksAfter={ insertBlocksAfter }\r\n\t\t\t/>\r\n\t\t</View>\r\n\t);\r\n};\r\n\r\nexport default withViewportMatch( { isNarrow: '< small' } )( Gallery );\r\n"],"mappings":"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","ignoreList":[]}