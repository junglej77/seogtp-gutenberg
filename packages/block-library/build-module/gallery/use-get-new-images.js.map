{"version":3,"names":["useMemo","useState","useGetNewImages","images","imageData","currentImages","setCurrentImages","getNewImages","imagesUpdated","newCurrentImages","filter","currentImg","find","img","clientId","length","forEach","image","fromSavedContent","currentImage","id","push","newImages","fromSavedConent"],"sources":["@wordpress/block-library/src/gallery/use-get-new-images.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useMemo, useState } from '@wordpress/element';\r\n\r\n/**\r\n * Keeps track of images already in the gallery to allow new innerBlocks to be identified. This\r\n * is required so default gallery attributes can be applied without overwriting any custom\r\n * attributes applied to existing images.\r\n *\r\n * @param {Array} images    Basic image block data taken from current gallery innerBlock\r\n * @param {Array} imageData The related image data for each of the current gallery images.\r\n *\r\n * @return {Array} An array of any new images that have been added to the gallery.\r\n */\r\nexport default function useGetNewImages( images, imageData ) {\r\n\tconst [ currentImages, setCurrentImages ] = useState( [] );\r\n\r\n\treturn useMemo( () => getNewImages(), [ images, imageData ] );\r\n\r\n\tfunction getNewImages() {\r\n\t\tlet imagesUpdated = false;\r\n\r\n\t\t// First lets check if any images have been deleted.\r\n\t\tconst newCurrentImages = currentImages.filter( ( currentImg ) =>\r\n\t\t\timages.find( ( img ) => {\r\n\t\t\t\treturn currentImg.clientId === img.clientId;\r\n\t\t\t} )\r\n\t\t);\r\n\r\n\t\tif ( newCurrentImages.length < currentImages.length ) {\r\n\t\t\timagesUpdated = true;\r\n\t\t}\r\n\r\n\t\t// Now lets see if we have any images hydrated from saved content and if so\r\n\t\t// add them to currentImages state.\r\n\t\timages.forEach( ( image ) => {\r\n\t\t\tif (\r\n\t\t\t\timage.fromSavedContent &&\r\n\t\t\t\t! newCurrentImages.find(\r\n\t\t\t\t\t( currentImage ) => currentImage.id === image.id\r\n\t\t\t\t)\r\n\t\t\t) {\r\n\t\t\t\timagesUpdated = true;\r\n\t\t\t\tnewCurrentImages.push( image );\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t\t// Now check for any new images that have been added to InnerBlocks and for which\r\n\t\t// we have the imageData we need for setting default block attributes.\r\n\t\tconst newImages = images.filter(\r\n\t\t\t( image ) =>\r\n\t\t\t\t! newCurrentImages.find(\r\n\t\t\t\t\t( currentImage ) =>\r\n\t\t\t\t\t\timage.clientId &&\r\n\t\t\t\t\t\tcurrentImage.clientId === image.clientId\r\n\t\t\t\t) &&\r\n\t\t\t\timageData?.find( ( img ) => img.id === image.id ) &&\r\n\t\t\t\t! image.fromSavedConent\r\n\t\t);\r\n\r\n\t\tif ( imagesUpdated || newImages?.length > 0 ) {\r\n\t\t\tsetCurrentImages( [ ...newCurrentImages, ...newImages ] );\r\n\t\t}\r\n\r\n\t\treturn newImages.length > 0 ? newImages : null;\r\n\t}\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,OAAO,EAAEC,QAAQ,QAAQ,oBAAoB;;AAEtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAASC,eAAeA,CAAEC,MAAM,EAAEC,SAAS,EAAG;EAC5D,MAAM,CAAEC,aAAa,EAAEC,gBAAgB,CAAE,GAAGL,QAAQ,CAAE,EAAG,CAAC;EAE1D,OAAOD,OAAO,CAAE,MAAMO,YAAY,CAAC,CAAC,EAAE,CAAEJ,MAAM,EAAEC,SAAS,CAAG,CAAC;EAE7D,SAASG,YAAYA,CAAA,EAAG;IACvB,IAAIC,aAAa,GAAG,KAAK;;IAEzB;IACA,MAAMC,gBAAgB,GAAGJ,aAAa,CAACK,MAAM,CAAIC,UAAU,IAC1DR,MAAM,CAACS,IAAI,CAAIC,GAAG,IAAM;MACvB,OAAOF,UAAU,CAACG,QAAQ,KAAKD,GAAG,CAACC,QAAQ;IAC5C,CAAE,CACH,CAAC;IAED,IAAKL,gBAAgB,CAACM,MAAM,GAAGV,aAAa,CAACU,MAAM,EAAG;MACrDP,aAAa,GAAG,IAAI;IACrB;;IAEA;IACA;IACAL,MAAM,CAACa,OAAO,CAAIC,KAAK,IAAM;MAC5B,IACCA,KAAK,CAACC,gBAAgB,IACtB,CAAET,gBAAgB,CAACG,IAAI,CACpBO,YAAY,IAAMA,YAAY,CAACC,EAAE,KAAKH,KAAK,CAACG,EAC/C,CAAC,EACA;QACDZ,aAAa,GAAG,IAAI;QACpBC,gBAAgB,CAACY,IAAI,CAAEJ,KAAM,CAAC;MAC/B;IACD,CAAE,CAAC;;IAEH;IACA;IACA,MAAMK,SAAS,GAAGnB,MAAM,CAACO,MAAM,CAC5BO,KAAK,IACN,CAAER,gBAAgB,CAACG,IAAI,CACpBO,YAAY,IACbF,KAAK,CAACH,QAAQ,IACdK,YAAY,CAACL,QAAQ,KAAKG,KAAK,CAACH,QAClC,CAAC,IACDV,SAAS,EAAEQ,IAAI,CAAIC,GAAG,IAAMA,GAAG,CAACO,EAAE,KAAKH,KAAK,CAACG,EAAG,CAAC,IACjD,CAAEH,KAAK,CAACM,eACV,CAAC;IAED,IAAKf,aAAa,IAAIc,SAAS,EAAEP,MAAM,GAAG,CAAC,EAAG;MAC7CT,gBAAgB,CAAE,CAAE,GAAGG,gBAAgB,EAAE,GAAGa,SAAS,CAAG,CAAC;IAC1D;IAEA,OAAOA,SAAS,CAACP,MAAM,GAAG,CAAC,GAAGO,SAAS,GAAG,IAAI;EAC/C;AACD","ignoreList":[]}