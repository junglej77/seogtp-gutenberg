{"version":3,"names":["useMemo","useImageSizes","images","isSelected","getSettings","getImageSizing","length","imageSizes","resizedImages","reduce","currentResizedImages","img","id","sizes","currentSizes","size","defaultUrl","slug","url","mediaDetailsUrl","media_details","source_url","parseInt","resizedImageSizes","Object","values","filter","some","map","name","value","label"],"sources":["@wordpress/block-library/src/gallery/use-image-sizes.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useMemo } from '@wordpress/element';\r\n\r\n/**\r\n * Calculates the image sizes that are available for the current gallery images in order to\r\n * populate the 'Resolution' selector.\r\n *\r\n * @param {Array}    images      Basic image block data taken from current gallery innerBlock.\r\n * @param {boolean}  isSelected  Is the block currently selected in the editor.\r\n * @param {Function} getSettings Block editor store selector.\r\n *\r\n * @return {Array} An array of image size options.\r\n */\r\nexport default function useImageSizes( images, isSelected, getSettings ) {\r\n\treturn useMemo( () => getImageSizing(), [ images, isSelected ] );\r\n\r\n\tfunction getImageSizing() {\r\n\t\tif ( ! images || images.length === 0 ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst { imageSizes } = getSettings();\r\n\t\tlet resizedImages = {};\r\n\r\n\t\tif ( isSelected ) {\r\n\t\t\tresizedImages = images.reduce( ( currentResizedImages, img ) => {\r\n\t\t\t\tif ( ! img.id ) {\r\n\t\t\t\t\treturn currentResizedImages;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst sizes = imageSizes.reduce( ( currentSizes, size ) => {\r\n\t\t\t\t\tconst defaultUrl = img.sizes?.[ size.slug ]?.url;\r\n\t\t\t\t\tconst mediaDetailsUrl =\r\n\t\t\t\t\t\timg.media_details?.sizes?.[ size.slug ]?.source_url;\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\t...currentSizes,\r\n\t\t\t\t\t\t[ size.slug ]: defaultUrl || mediaDetailsUrl,\r\n\t\t\t\t\t};\r\n\t\t\t\t}, {} );\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...currentResizedImages,\r\n\t\t\t\t\t[ parseInt( img.id, 10 ) ]: sizes,\r\n\t\t\t\t};\r\n\t\t\t}, {} );\r\n\t\t}\r\n\t\tconst resizedImageSizes = Object.values( resizedImages );\r\n\t\treturn imageSizes\r\n\t\t\t.filter( ( { slug } ) =>\r\n\t\t\t\tresizedImageSizes.some( ( sizes ) => sizes[ slug ] )\r\n\t\t\t)\r\n\t\t\t.map( ( { name, slug } ) => ( { value: slug, label: name } ) );\r\n\t}\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,OAAO,QAAQ,oBAAoB;;AAE5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAASC,aAAaA,CAAEC,MAAM,EAAEC,UAAU,EAAEC,WAAW,EAAG;EACxE,OAAOJ,OAAO,CAAE,MAAMK,cAAc,CAAC,CAAC,EAAE,CAAEH,MAAM,EAAEC,UAAU,CAAG,CAAC;EAEhE,SAASE,cAAcA,CAAA,EAAG;IACzB,IAAK,CAAEH,MAAM,IAAIA,MAAM,CAACI,MAAM,KAAK,CAAC,EAAG;MACtC;IACD;IACA,MAAM;MAAEC;IAAW,CAAC,GAAGH,WAAW,CAAC,CAAC;IACpC,IAAII,aAAa,GAAG,CAAC,CAAC;IAEtB,IAAKL,UAAU,EAAG;MACjBK,aAAa,GAAGN,MAAM,CAACO,MAAM,CAAE,CAAEC,oBAAoB,EAAEC,GAAG,KAAM;QAC/D,IAAK,CAAEA,GAAG,CAACC,EAAE,EAAG;UACf,OAAOF,oBAAoB;QAC5B;QAEA,MAAMG,KAAK,GAAGN,UAAU,CAACE,MAAM,CAAE,CAAEK,YAAY,EAAEC,IAAI,KAAM;UAC1D,MAAMC,UAAU,GAAGL,GAAG,CAACE,KAAK,GAAIE,IAAI,CAACE,IAAI,CAAE,EAAEC,GAAG;UAChD,MAAMC,eAAe,GACpBR,GAAG,CAACS,aAAa,EAAEP,KAAK,GAAIE,IAAI,CAACE,IAAI,CAAE,EAAEI,UAAU;UACpD,OAAO;YACN,GAAGP,YAAY;YACf,CAAEC,IAAI,CAACE,IAAI,GAAID,UAAU,IAAIG;UAC9B,CAAC;QACF,CAAC,EAAE,CAAC,CAAE,CAAC;QACP,OAAO;UACN,GAAGT,oBAAoB;UACvB,CAAEY,QAAQ,CAAEX,GAAG,CAACC,EAAE,EAAE,EAAG,CAAC,GAAIC;QAC7B,CAAC;MACF,CAAC,EAAE,CAAC,CAAE,CAAC;IACR;IACA,MAAMU,iBAAiB,GAAGC,MAAM,CAACC,MAAM,CAAEjB,aAAc,CAAC;IACxD,OAAOD,UAAU,CACfmB,MAAM,CAAE,CAAE;MAAET;IAAK,CAAC,KAClBM,iBAAiB,CAACI,IAAI,CAAId,KAAK,IAAMA,KAAK,CAAEI,IAAI,CAAG,CACpD,CAAC,CACAW,GAAG,CAAE,CAAE;MAAEC,IAAI;MAAEZ;IAAK,CAAC,MAAQ;MAAEa,KAAK,EAAEb,IAAI;MAAEc,KAAK,EAAEF;IAAK,CAAC,CAAG,CAAC;EAChE;AACD","ignoreList":[]}