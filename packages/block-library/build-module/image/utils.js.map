{"version":3,"names":["NEW_TAB_REL","ALLOWED_MEDIA_TYPES","evalAspectRatio","value","width","height","split","map","Number","aspectRatio","Infinity","NaN","removeNewTabRel","currentRel","newRel","undefined","forEach","relVal","regExp","RegExp","replace","trim","getUpdatedLinkTargetSettings","rel","linkTarget","updatedRel","getImageSizeAttributes","image","size","url","media_details","sizes","source_url","sizeSlug","isValidFileType","file","some","mediaType","type","indexOf"],"sources":["@wordpress/block-library/src/image/utils.js"],"sourcesContent":["/**\r\n * Internal dependencies\r\n */\r\nimport { NEW_TAB_REL, ALLOWED_MEDIA_TYPES } from './constants';\r\n\r\n/**\r\n * Evaluates a CSS aspect-ratio property value as a number.\r\n *\r\n * Degenerate or invalid ratios behave as 'auto'. And 'auto' ratios return NaN.\r\n *\r\n * @see https://drafts.csswg.org/css-sizing-4/#aspect-ratio\r\n *\r\n * @param {string} value CSS aspect-ratio property value.\r\n * @return {number} Numerical aspect ratio or NaN if invalid.\r\n */\r\nexport function evalAspectRatio( value ) {\r\n\tconst [ width, height = 1 ] = value.split( '/' ).map( Number );\r\n\tconst aspectRatio = width / height;\r\n\treturn aspectRatio === Infinity || aspectRatio === 0 ? NaN : aspectRatio;\r\n}\r\n\r\nexport function removeNewTabRel( currentRel ) {\r\n\tlet newRel = currentRel;\r\n\r\n\tif ( currentRel !== undefined && newRel ) {\r\n\t\tNEW_TAB_REL.forEach( ( relVal ) => {\r\n\t\t\tconst regExp = new RegExp( '\\\\b' + relVal + '\\\\b', 'gi' );\r\n\t\t\tnewRel = newRel.replace( regExp, '' );\r\n\t\t} );\r\n\r\n\t\t// Only trim if NEW_TAB_REL values was replaced.\r\n\t\tif ( newRel !== currentRel ) {\r\n\t\t\tnewRel = newRel.trim();\r\n\t\t}\r\n\r\n\t\tif ( ! newRel ) {\r\n\t\t\tnewRel = undefined;\r\n\t\t}\r\n\t}\r\n\r\n\treturn newRel;\r\n}\r\n\r\n/**\r\n * Helper to get the link target settings to be stored.\r\n *\r\n * @param {boolean} value          The new link target value.\r\n * @param {Object}  attributes     Block attributes.\r\n * @param {Object}  attributes.rel Image block's rel attribute.\r\n *\r\n * @return {Object} Updated link target settings.\r\n */\r\nexport function getUpdatedLinkTargetSettings( value, { rel } ) {\r\n\tconst linkTarget = value ? '_blank' : undefined;\r\n\r\n\tlet updatedRel;\r\n\tif ( ! linkTarget && ! rel ) {\r\n\t\tupdatedRel = undefined;\r\n\t} else {\r\n\t\tupdatedRel = removeNewTabRel( rel );\r\n\t}\r\n\r\n\treturn {\r\n\t\tlinkTarget,\r\n\t\trel: updatedRel,\r\n\t};\r\n}\r\n\r\n/**\r\n * Determines new Image block attributes size selection.\r\n *\r\n * @param {Object} image Media file object for gallery image.\r\n * @param {string} size  Selected size slug to apply.\r\n */\r\nexport function getImageSizeAttributes( image, size ) {\r\n\tconst url = image?.media_details?.sizes?.[ size ]?.source_url;\r\n\r\n\tif ( url ) {\r\n\t\treturn { url, width: undefined, height: undefined, sizeSlug: size };\r\n\t}\r\n\r\n\treturn {};\r\n}\r\n\r\n/**\r\n * Checks if the file has a valid file type.\r\n *\r\n * @param {File} file - The file to check.\r\n * @return {boolean} - Returns true if the file has a valid file type, otherwise false.\r\n */\r\nexport function isValidFileType( file ) {\r\n\treturn ALLOWED_MEDIA_TYPES.some(\r\n\t\t( mediaType ) => file.type.indexOf( mediaType ) === 0\r\n\t);\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,WAAW,EAAEC,mBAAmB,QAAQ,aAAa;;AAE9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,eAAeA,CAAEC,KAAK,EAAG;EACxC,MAAM,CAAEC,KAAK,EAAEC,MAAM,GAAG,CAAC,CAAE,GAAGF,KAAK,CAACG,KAAK,CAAE,GAAI,CAAC,CAACC,GAAG,CAAEC,MAAO,CAAC;EAC9D,MAAMC,WAAW,GAAGL,KAAK,GAAGC,MAAM;EAClC,OAAOI,WAAW,KAAKC,QAAQ,IAAID,WAAW,KAAK,CAAC,GAAGE,GAAG,GAAGF,WAAW;AACzE;AAEA,OAAO,SAASG,eAAeA,CAAEC,UAAU,EAAG;EAC7C,IAAIC,MAAM,GAAGD,UAAU;EAEvB,IAAKA,UAAU,KAAKE,SAAS,IAAID,MAAM,EAAG;IACzCd,WAAW,CAACgB,OAAO,CAAIC,MAAM,IAAM;MAClC,MAAMC,MAAM,GAAG,IAAIC,MAAM,CAAE,KAAK,GAAGF,MAAM,GAAG,KAAK,EAAE,IAAK,CAAC;MACzDH,MAAM,GAAGA,MAAM,CAACM,OAAO,CAAEF,MAAM,EAAE,EAAG,CAAC;IACtC,CAAE,CAAC;;IAEH;IACA,IAAKJ,MAAM,KAAKD,UAAU,EAAG;MAC5BC,MAAM,GAAGA,MAAM,CAACO,IAAI,CAAC,CAAC;IACvB;IAEA,IAAK,CAAEP,MAAM,EAAG;MACfA,MAAM,GAAGC,SAAS;IACnB;EACD;EAEA,OAAOD,MAAM;AACd;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASQ,4BAA4BA,CAAEnB,KAAK,EAAE;EAAEoB;AAAI,CAAC,EAAG;EAC9D,MAAMC,UAAU,GAAGrB,KAAK,GAAG,QAAQ,GAAGY,SAAS;EAE/C,IAAIU,UAAU;EACd,IAAK,CAAED,UAAU,IAAI,CAAED,GAAG,EAAG;IAC5BE,UAAU,GAAGV,SAAS;EACvB,CAAC,MAAM;IACNU,UAAU,GAAGb,eAAe,CAAEW,GAAI,CAAC;EACpC;EAEA,OAAO;IACNC,UAAU;IACVD,GAAG,EAAEE;EACN,CAAC;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,sBAAsBA,CAAEC,KAAK,EAAEC,IAAI,EAAG;EACrD,MAAMC,GAAG,GAAGF,KAAK,EAAEG,aAAa,EAAEC,KAAK,GAAIH,IAAI,CAAE,EAAEI,UAAU;EAE7D,IAAKH,GAAG,EAAG;IACV,OAAO;MAAEA,GAAG;MAAEzB,KAAK,EAAEW,SAAS;MAAEV,MAAM,EAAEU,SAAS;MAAEkB,QAAQ,EAAEL;IAAK,CAAC;EACpE;EAEA,OAAO,CAAC,CAAC;AACV;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASM,eAAeA,CAAEC,IAAI,EAAG;EACvC,OAAOlC,mBAAmB,CAACmC,IAAI,CAC5BC,SAAS,IAAMF,IAAI,CAACG,IAAI,CAACC,OAAO,CAAEF,SAAU,CAAC,KAAK,CACrD,CAAC;AACF","ignoreList":[]}