{"version":3,"names":["createBlock","getDefaultBlockName","cloneBlock","useRef","useSelect","useDispatch","store","blockEditorStore","useOutdentListItem","useEnter","props","preventDefault","replaceBlocks","selectionChange","getBlock","getBlockRootClientId","getBlockIndex","getBlockName","propsRef","current","outdentListItem","onEnter","content","clientId","length","topParentListBlock","blockIndex","head","innerBlocks","slice","middle","after","tail"],"sources":["@wordpress/block-library/src/list-item/hooks/use-enter.native.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport {\r\n\tcreateBlock,\r\n\tgetDefaultBlockName,\r\n\tcloneBlock,\r\n} from '@wordpress/blocks';\r\nimport { useRef } from '@wordpress/element';\r\nimport { useSelect, useDispatch } from '@wordpress/data';\r\nimport { store as blockEditorStore } from '@wordpress/block-editor';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport useOutdentListItem from './use-outdent-list-item';\r\n\r\nexport default function useEnter( props, preventDefault ) {\r\n\tconst { replaceBlocks, selectionChange } = useDispatch( blockEditorStore );\r\n\tconst { getBlock, getBlockRootClientId, getBlockIndex, getBlockName } =\r\n\t\tuseSelect( blockEditorStore );\r\n\tconst propsRef = useRef( props );\r\n\tpropsRef.current = props;\r\n\tconst outdentListItem = useOutdentListItem();\r\n\r\n\treturn {\r\n\t\tonEnter() {\r\n\t\t\tconst { content, clientId } = propsRef.current;\r\n\t\t\tif ( content.length ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tpreventDefault.current = true;\r\n\t\t\tif (\r\n\t\t\t\tgetBlockName(\r\n\t\t\t\t\tgetBlockRootClientId(\r\n\t\t\t\t\t\tgetBlockRootClientId( propsRef.current.clientId )\r\n\t\t\t\t\t)\r\n\t\t\t\t) === 'core/list-item'\r\n\t\t\t) {\r\n\t\t\t\toutdentListItem();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t// Here we are in top level list so we need to split.\r\n\t\t\tconst topParentListBlock = getBlock(\r\n\t\t\t\tgetBlockRootClientId( clientId )\r\n\t\t\t);\r\n\t\t\tconst blockIndex = getBlockIndex( clientId );\r\n\t\t\tconst head = cloneBlock( {\r\n\t\t\t\t...topParentListBlock,\r\n\t\t\t\tinnerBlocks: topParentListBlock.innerBlocks.slice(\r\n\t\t\t\t\t0,\r\n\t\t\t\t\tblockIndex\r\n\t\t\t\t),\r\n\t\t\t} );\r\n\t\t\tconst middle = createBlock( getDefaultBlockName() );\r\n\t\t\t// Last list item might contain a `list` block innerBlock\r\n\t\t\t// In that case append remaining innerBlocks blocks.\r\n\t\t\tconst after = [\r\n\t\t\t\t...( topParentListBlock.innerBlocks[ blockIndex ]\r\n\t\t\t\t\t.innerBlocks[ 0 ]?.innerBlocks || [] ),\r\n\t\t\t\t...topParentListBlock.innerBlocks.slice( blockIndex + 1 ),\r\n\t\t\t];\r\n\t\t\tconst tail = after.length\r\n\t\t\t\t? [\r\n\t\t\t\t\t\tcloneBlock( {\r\n\t\t\t\t\t\t\t...topParentListBlock,\r\n\t\t\t\t\t\t\tinnerBlocks: after,\r\n\t\t\t\t\t\t} ),\r\n\t\t\t\t  ]\r\n\t\t\t\t: [];\r\n\t\t\treplaceBlocks(\r\n\t\t\t\ttopParentListBlock.clientId,\r\n\t\t\t\t[ head, middle, ...tail ],\r\n\t\t\t\t1\r\n\t\t\t);\r\n\t\t\t// We manually change the selection here because we are replacing\r\n\t\t\t// a different block than the selected one.\r\n\t\t\tselectionChange( middle.clientId );\r\n\t\t},\r\n\t};\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SACCA,WAAW,EACXC,mBAAmB,EACnBC,UAAU,QACJ,mBAAmB;AAC1B,SAASC,MAAM,QAAQ,oBAAoB;AAC3C,SAASC,SAAS,EAAEC,WAAW,QAAQ,iBAAiB;AACxD,SAASC,KAAK,IAAIC,gBAAgB,QAAQ,yBAAyB;;AAEnE;AACA;AACA;AACA,OAAOC,kBAAkB,MAAM,yBAAyB;AAExD,eAAe,SAASC,QAAQA,CAAEC,KAAK,EAAEC,cAAc,EAAG;EACzD,MAAM;IAAEC,aAAa;IAAEC;EAAgB,CAAC,GAAGR,WAAW,CAAEE,gBAAiB,CAAC;EAC1E,MAAM;IAAEO,QAAQ;IAAEC,oBAAoB;IAAEC,aAAa;IAAEC;EAAa,CAAC,GACpEb,SAAS,CAAEG,gBAAiB,CAAC;EAC9B,MAAMW,QAAQ,GAAGf,MAAM,CAAEO,KAAM,CAAC;EAChCQ,QAAQ,CAACC,OAAO,GAAGT,KAAK;EACxB,MAAMU,eAAe,GAAGZ,kBAAkB,CAAC,CAAC;EAE5C,OAAO;IACNa,OAAOA,CAAA,EAAG;MACT,MAAM;QAAEC,OAAO;QAAEC;MAAS,CAAC,GAAGL,QAAQ,CAACC,OAAO;MAC9C,IAAKG,OAAO,CAACE,MAAM,EAAG;QACrB;MACD;MACAb,cAAc,CAACQ,OAAO,GAAG,IAAI;MAC7B,IACCF,YAAY,CACXF,oBAAoB,CACnBA,oBAAoB,CAAEG,QAAQ,CAACC,OAAO,CAACI,QAAS,CACjD,CACD,CAAC,KAAK,gBAAgB,EACrB;QACDH,eAAe,CAAC,CAAC;QACjB;MACD;MACA;MACA,MAAMK,kBAAkB,GAAGX,QAAQ,CAClCC,oBAAoB,CAAEQ,QAAS,CAChC,CAAC;MACD,MAAMG,UAAU,GAAGV,aAAa,CAAEO,QAAS,CAAC;MAC5C,MAAMI,IAAI,GAAGzB,UAAU,CAAE;QACxB,GAAGuB,kBAAkB;QACrBG,WAAW,EAAEH,kBAAkB,CAACG,WAAW,CAACC,KAAK,CAChD,CAAC,EACDH,UACD;MACD,CAAE,CAAC;MACH,MAAMI,MAAM,GAAG9B,WAAW,CAAEC,mBAAmB,CAAC,CAAE,CAAC;MACnD;MACA;MACA,MAAM8B,KAAK,GAAG,CACb,IAAKN,kBAAkB,CAACG,WAAW,CAAEF,UAAU,CAAE,CAC/CE,WAAW,CAAE,CAAC,CAAE,EAAEA,WAAW,IAAI,EAAE,CAAE,EACvC,GAAGH,kBAAkB,CAACG,WAAW,CAACC,KAAK,CAAEH,UAAU,GAAG,CAAE,CAAC,CACzD;MACD,MAAMM,IAAI,GAAGD,KAAK,CAACP,MAAM,GACtB,CACAtB,UAAU,CAAE;QACX,GAAGuB,kBAAkB;QACrBG,WAAW,EAAEG;MACd,CAAE,CAAC,CACF,GACD,EAAE;MACLnB,aAAa,CACZa,kBAAkB,CAACF,QAAQ,EAC3B,CAAEI,IAAI,EAAEG,MAAM,EAAE,GAAGE,IAAI,CAAE,EACzB,CACD,CAAC;MACD;MACA;MACAnB,eAAe,CAAEiB,MAAM,CAACP,QAAS,CAAC;IACnC;EACD,CAAC;AACF","ignoreList":[]}