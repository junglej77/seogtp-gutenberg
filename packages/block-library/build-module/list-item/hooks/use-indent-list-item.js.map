{"version":3,"names":["useCallback","useSelect","useDispatch","store","blockEditorStore","createBlock","cloneBlock","useIndentListItem","clientId","replaceBlocks","selectionChange","multiSelect","getBlock","getPreviousBlockClientId","getSelectionStart","getSelectionEnd","hasMultiSelection","getMultiSelectedBlockClientIds","_hasMultiSelection","clientIds","clonedBlocks","map","_clientId","previousSiblingId","newListItem","innerBlocks","length","push","selectionStart","selectionEnd","attributeKey","offset"],"sources":["@wordpress/block-library/src/list-item/hooks/use-indent-list-item.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useCallback } from '@wordpress/element';\r\nimport { useSelect, useDispatch } from '@wordpress/data';\r\nimport { store as blockEditorStore } from '@wordpress/block-editor';\r\nimport { createBlock, cloneBlock } from '@wordpress/blocks';\r\n\r\nexport default function useIndentListItem( clientId ) {\r\n\tconst { replaceBlocks, selectionChange, multiSelect } =\r\n\t\tuseDispatch( blockEditorStore );\r\n\tconst {\r\n\t\tgetBlock,\r\n\t\tgetPreviousBlockClientId,\r\n\t\tgetSelectionStart,\r\n\t\tgetSelectionEnd,\r\n\t\thasMultiSelection,\r\n\t\tgetMultiSelectedBlockClientIds,\r\n\t} = useSelect( blockEditorStore );\r\n\treturn useCallback( () => {\r\n\t\tconst _hasMultiSelection = hasMultiSelection();\r\n\t\tconst clientIds = _hasMultiSelection\r\n\t\t\t? getMultiSelectedBlockClientIds()\r\n\t\t\t: [ clientId ];\r\n\t\tconst clonedBlocks = clientIds.map( ( _clientId ) =>\r\n\t\t\tcloneBlock( getBlock( _clientId ) )\r\n\t\t);\r\n\t\tconst previousSiblingId = getPreviousBlockClientId( clientId );\r\n\t\tconst newListItem = cloneBlock( getBlock( previousSiblingId ) );\r\n\t\t// If the sibling has no innerBlocks, create a new `list` block.\r\n\t\tif ( ! newListItem.innerBlocks?.length ) {\r\n\t\t\tnewListItem.innerBlocks = [ createBlock( 'core/list' ) ];\r\n\t\t}\r\n\t\t// A list item usually has one `list`, but it's possible to have\r\n\t\t// more. So we need to preserve the previous `list` blocks and\r\n\t\t// merge the new blocks to the last `list`.\r\n\t\tnewListItem.innerBlocks[\r\n\t\t\tnewListItem.innerBlocks.length - 1\r\n\t\t].innerBlocks.push( ...clonedBlocks );\r\n\r\n\t\t// We get the selection start/end here, because when\r\n\t\t// we replace blocks, the selection is updated too.\r\n\t\tconst selectionStart = getSelectionStart();\r\n\t\tconst selectionEnd = getSelectionEnd();\r\n\t\t// Replace the previous sibling of the block being indented and the indented blocks,\r\n\t\t// with a new block whose attributes are equal to the ones of the previous sibling and\r\n\t\t// whose descendants are the children of the previous sibling, followed by the indented blocks.\r\n\t\treplaceBlocks( [ previousSiblingId, ...clientIds ], [ newListItem ] );\r\n\t\tif ( ! _hasMultiSelection ) {\r\n\t\t\tselectionChange(\r\n\t\t\t\tclonedBlocks[ 0 ].clientId,\r\n\t\t\t\tselectionEnd.attributeKey,\r\n\t\t\t\tselectionEnd.clientId === selectionStart.clientId\r\n\t\t\t\t\t? selectionStart.offset\r\n\t\t\t\t\t: selectionEnd.offset,\r\n\t\t\t\tselectionEnd.offset\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\tmultiSelect(\r\n\t\t\t\tclonedBlocks[ 0 ].clientId,\r\n\t\t\t\tclonedBlocks[ clonedBlocks.length - 1 ].clientId\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}, [ clientId ] );\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,WAAW,QAAQ,oBAAoB;AAChD,SAASC,SAAS,EAAEC,WAAW,QAAQ,iBAAiB;AACxD,SAASC,KAAK,IAAIC,gBAAgB,QAAQ,yBAAyB;AACnE,SAASC,WAAW,EAAEC,UAAU,QAAQ,mBAAmB;AAE3D,eAAe,SAASC,iBAAiBA,CAAEC,QAAQ,EAAG;EACrD,MAAM;IAAEC,aAAa;IAAEC,eAAe;IAAEC;EAAY,CAAC,GACpDT,WAAW,CAAEE,gBAAiB,CAAC;EAChC,MAAM;IACLQ,QAAQ;IACRC,wBAAwB;IACxBC,iBAAiB;IACjBC,eAAe;IACfC,iBAAiB;IACjBC;EACD,CAAC,GAAGhB,SAAS,CAAEG,gBAAiB,CAAC;EACjC,OAAOJ,WAAW,CAAE,MAAM;IACzB,MAAMkB,kBAAkB,GAAGF,iBAAiB,CAAC,CAAC;IAC9C,MAAMG,SAAS,GAAGD,kBAAkB,GACjCD,8BAA8B,CAAC,CAAC,GAChC,CAAET,QAAQ,CAAE;IACf,MAAMY,YAAY,GAAGD,SAAS,CAACE,GAAG,CAAIC,SAAS,IAC9ChB,UAAU,CAAEM,QAAQ,CAAEU,SAAU,CAAE,CACnC,CAAC;IACD,MAAMC,iBAAiB,GAAGV,wBAAwB,CAAEL,QAAS,CAAC;IAC9D,MAAMgB,WAAW,GAAGlB,UAAU,CAAEM,QAAQ,CAAEW,iBAAkB,CAAE,CAAC;IAC/D;IACA,IAAK,CAAEC,WAAW,CAACC,WAAW,EAAEC,MAAM,EAAG;MACxCF,WAAW,CAACC,WAAW,GAAG,CAAEpB,WAAW,CAAE,WAAY,CAAC,CAAE;IACzD;IACA;IACA;IACA;IACAmB,WAAW,CAACC,WAAW,CACtBD,WAAW,CAACC,WAAW,CAACC,MAAM,GAAG,CAAC,CAClC,CAACD,WAAW,CAACE,IAAI,CAAE,GAAGP,YAAa,CAAC;;IAErC;IACA;IACA,MAAMQ,cAAc,GAAGd,iBAAiB,CAAC,CAAC;IAC1C,MAAMe,YAAY,GAAGd,eAAe,CAAC,CAAC;IACtC;IACA;IACA;IACAN,aAAa,CAAE,CAAEc,iBAAiB,EAAE,GAAGJ,SAAS,CAAE,EAAE,CAAEK,WAAW,CAAG,CAAC;IACrE,IAAK,CAAEN,kBAAkB,EAAG;MAC3BR,eAAe,CACdU,YAAY,CAAE,CAAC,CAAE,CAACZ,QAAQ,EAC1BqB,YAAY,CAACC,YAAY,EACzBD,YAAY,CAACrB,QAAQ,KAAKoB,cAAc,CAACpB,QAAQ,GAC9CoB,cAAc,CAACG,MAAM,GACrBF,YAAY,CAACE,MAAM,EACtBF,YAAY,CAACE,MACd,CAAC;IACF,CAAC,MAAM;MACNpB,WAAW,CACVS,YAAY,CAAE,CAAC,CAAE,CAACZ,QAAQ,EAC1BY,YAAY,CAAEA,YAAY,CAACM,MAAM,GAAG,CAAC,CAAE,CAAClB,QACzC,CAAC;IACF;IAEA,OAAO,IAAI;EACZ,CAAC,EAAE,CAAEA,QAAQ,CAAG,CAAC;AAClB","ignoreList":[]}