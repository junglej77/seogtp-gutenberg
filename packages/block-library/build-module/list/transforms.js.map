{"version":3,"names":["createBlock","create","split","toHTMLString","createListBlockFromDOMElement","getListContentSchema","phrasingContentSchema","listContentSchema","ul","ol","attributes","forEach","tag","children","li","getListContentFlat","blocks","flatMap","name","innerBlocks","content","transforms","from","type","isMultiBlock","transform","blockAttributes","childBlocks","length","map","value","html","result","anchor","selector","schema","args","prefix","ordered","to","block","_attributes"],"sources":["@wordpress/block-library/src/list/transforms.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { createBlock } from '@wordpress/blocks';\r\nimport { create, split, toHTMLString } from '@wordpress/rich-text';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { createListBlockFromDOMElement } from './utils';\r\n\r\nfunction getListContentSchema( { phrasingContentSchema } ) {\r\n\tconst listContentSchema = {\r\n\t\t...phrasingContentSchema,\r\n\t\tul: {},\r\n\t\tol: { attributes: [ 'type', 'start', 'reversed' ] },\r\n\t};\r\n\r\n\t// Recursion is needed.\r\n\t// Possible: ul > li > ul.\r\n\t// Impossible: ul > ul.\r\n\t[ 'ul', 'ol' ].forEach( ( tag ) => {\r\n\t\tlistContentSchema[ tag ].children = {\r\n\t\t\tli: {\r\n\t\t\t\tchildren: listContentSchema,\r\n\t\t\t},\r\n\t\t};\r\n\t} );\r\n\r\n\treturn listContentSchema;\r\n}\r\n\r\nfunction getListContentFlat( blocks ) {\r\n\treturn blocks.flatMap( ( { name, attributes, innerBlocks = [] } ) => {\r\n\t\tif ( name === 'core/list-item' ) {\r\n\t\t\treturn [ attributes.content, ...getListContentFlat( innerBlocks ) ];\r\n\t\t}\r\n\t\treturn getListContentFlat( innerBlocks );\r\n\t} );\r\n}\r\n\r\nconst transforms = {\r\n\tfrom: [\r\n\t\t{\r\n\t\t\ttype: 'block',\r\n\t\t\tisMultiBlock: true,\r\n\t\t\tblocks: [ 'core/paragraph', 'core/heading' ],\r\n\t\t\ttransform: ( blockAttributes ) => {\r\n\t\t\t\tlet childBlocks = [];\r\n\t\t\t\tif ( blockAttributes.length > 1 ) {\r\n\t\t\t\t\tchildBlocks = blockAttributes.map( ( { content } ) => {\r\n\t\t\t\t\t\treturn createBlock( 'core/list-item', { content } );\r\n\t\t\t\t\t} );\r\n\t\t\t\t} else if ( blockAttributes.length === 1 ) {\r\n\t\t\t\t\tconst value = create( {\r\n\t\t\t\t\t\thtml: blockAttributes[ 0 ].content,\r\n\t\t\t\t\t} );\r\n\t\t\t\t\tchildBlocks = split( value, '\\n' ).map( ( result ) => {\r\n\t\t\t\t\t\treturn createBlock( 'core/list-item', {\r\n\t\t\t\t\t\t\tcontent: toHTMLString( { value: result } ),\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t} );\r\n\t\t\t\t}\r\n\t\t\t\treturn createBlock(\r\n\t\t\t\t\t'core/list',\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tanchor: blockAttributes.anchor,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tchildBlocks\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: 'raw',\r\n\t\t\tselector: 'ol,ul',\r\n\t\t\tschema: ( args ) => ( {\r\n\t\t\t\tol: getListContentSchema( args ).ol,\r\n\t\t\t\tul: getListContentSchema( args ).ul,\r\n\t\t\t} ),\r\n\t\t\ttransform: createListBlockFromDOMElement,\r\n\t\t},\r\n\t\t...[ '*', '-' ].map( ( prefix ) => ( {\r\n\t\t\ttype: 'prefix',\r\n\t\t\tprefix,\r\n\t\t\ttransform( content ) {\r\n\t\t\t\treturn createBlock( 'core/list', {}, [\r\n\t\t\t\t\tcreateBlock( 'core/list-item', { content } ),\r\n\t\t\t\t] );\r\n\t\t\t},\r\n\t\t} ) ),\r\n\t\t...[ '1.', '1)' ].map( ( prefix ) => ( {\r\n\t\t\ttype: 'prefix',\r\n\t\t\tprefix,\r\n\t\t\ttransform( content ) {\r\n\t\t\t\treturn createBlock(\r\n\t\t\t\t\t'core/list',\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tordered: true,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t[ createBlock( 'core/list-item', { content } ) ]\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t} ) ),\r\n\t],\r\n\tto: [\r\n\t\t...[ 'core/paragraph', 'core/heading' ].map( ( block ) => ( {\r\n\t\t\ttype: 'block',\r\n\t\t\tblocks: [ block ],\r\n\t\t\ttransform: ( _attributes, childBlocks ) => {\r\n\t\t\t\treturn getListContentFlat( childBlocks ).map( ( content ) =>\r\n\t\t\t\t\tcreateBlock( block, {\r\n\t\t\t\t\t\tcontent,\r\n\t\t\t\t\t} )\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t} ) ),\r\n\t],\r\n};\r\n\r\nexport default transforms;\r\n"],"mappings":"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","ignoreList":[]}