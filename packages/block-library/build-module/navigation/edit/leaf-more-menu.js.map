{"version":3,"names":["createBlock","addSubmenu","chevronUp","chevronDown","moreVertical","DropdownMenu","MenuItem","MenuGroup","useDispatch","useSelect","__","sprintf","BlockTitle","store","blockEditorStore","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","POPOVER_PROPS","className","placement","BLOCKS_THAT_CAN_BE_CONVERTED_TO_SUBMENU","AddSubmenuItem","block","onClose","expandedState","expand","setInsertedBlock","insertBlock","replaceBlock","replaceInnerBlocks","clientId","isDisabled","includes","name","icon","disabled","onClick","updateSelectionOnInsert","newLink","innerBlocks","length","newSubmenu","attributes","children","LeafMoreMenu","props","moveBlocksDown","moveBlocksUp","removeBlocks","removeLabel","maximumLength","rootClientId","select","getBlockRootClientId","label","popoverProps","noIcons","expanded"],"sources":["@wordpress/block-library/src/navigation/edit/leaf-more-menu.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { createBlock } from '@wordpress/blocks';\r\nimport {\r\n\taddSubmenu,\r\n\tchevronUp,\r\n\tchevronDown,\r\n\tmoreVertical,\r\n} from '@wordpress/icons';\r\nimport { DropdownMenu, MenuItem, MenuGroup } from '@wordpress/components';\r\nimport { useDispatch, useSelect } from '@wordpress/data';\r\nimport { __, sprintf } from '@wordpress/i18n';\r\nimport { BlockTitle, store as blockEditorStore } from '@wordpress/block-editor';\r\n\r\nconst POPOVER_PROPS = {\r\n\tclassName: 'block-editor-block-settings-menu__popover',\r\n\tplacement: 'bottom-start',\r\n};\r\n\r\nconst BLOCKS_THAT_CAN_BE_CONVERTED_TO_SUBMENU = [\r\n\t'core/navigation-link',\r\n\t'core/navigation-submenu',\r\n];\r\n\r\nfunction AddSubmenuItem( {\r\n\tblock,\r\n\tonClose,\r\n\texpandedState,\r\n\texpand,\r\n\tsetInsertedBlock,\r\n} ) {\r\n\tconst { insertBlock, replaceBlock, replaceInnerBlocks } =\r\n\t\tuseDispatch( blockEditorStore );\r\n\r\n\tconst clientId = block.clientId;\r\n\tconst isDisabled = ! BLOCKS_THAT_CAN_BE_CONVERTED_TO_SUBMENU.includes(\r\n\t\tblock.name\r\n\t);\r\n\treturn (\r\n\t\t<MenuItem\r\n\t\t\ticon={ addSubmenu }\r\n\t\t\tdisabled={ isDisabled }\r\n\t\t\tonClick={ () => {\r\n\t\t\t\tconst updateSelectionOnInsert = false;\r\n\t\t\t\tconst newLink = createBlock( 'core/navigation-link' );\r\n\r\n\t\t\t\tif ( block.name === 'core/navigation-submenu' ) {\r\n\t\t\t\t\tinsertBlock(\r\n\t\t\t\t\t\tnewLink,\r\n\t\t\t\t\t\tblock.innerBlocks.length,\r\n\t\t\t\t\t\tclientId,\r\n\t\t\t\t\t\tupdateSelectionOnInsert\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Convert to a submenu if the block currently isn't one.\r\n\t\t\t\t\tconst newSubmenu = createBlock(\r\n\t\t\t\t\t\t'core/navigation-submenu',\r\n\t\t\t\t\t\tblock.attributes,\r\n\t\t\t\t\t\tblock.innerBlocks\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\t// The following must happen as two independent actions.\r\n\t\t\t\t\t// Why? Because the offcanvas editor relies on the getLastInsertedBlocksClientIds\r\n\t\t\t\t\t// selector to determine which block is \"active\". As the UX needs the newLink to be\r\n\t\t\t\t\t// the \"active\" block it must be the last block to be inserted.\r\n\t\t\t\t\t// Therefore the Submenu is first created and **then** the newLink is inserted\r\n\t\t\t\t\t// thus ensuring it is the last inserted block.\r\n\t\t\t\t\treplaceBlock( clientId, newSubmenu );\r\n\r\n\t\t\t\t\treplaceInnerBlocks(\r\n\t\t\t\t\t\tnewSubmenu.clientId,\r\n\t\t\t\t\t\t[ newLink ],\r\n\t\t\t\t\t\tupdateSelectionOnInsert\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// This call sets the local List View state for the \"last inserted block\".\r\n\t\t\t\t// This is required for the Nav Block to determine whether or not to display\r\n\t\t\t\t// the Link UI for this new block.\r\n\t\t\t\tsetInsertedBlock( newLink );\r\n\r\n\t\t\t\tif ( ! expandedState[ block.clientId ] ) {\r\n\t\t\t\t\texpand( block.clientId );\r\n\t\t\t\t}\r\n\t\t\t\tonClose();\r\n\t\t\t} }\r\n\t\t>\r\n\t\t\t{ __( 'Add submenu link' ) }\r\n\t\t</MenuItem>\r\n\t);\r\n}\r\n\r\nexport default function LeafMoreMenu( props ) {\r\n\tconst { block } = props;\r\n\tconst { clientId } = block;\r\n\r\n\tconst { moveBlocksDown, moveBlocksUp, removeBlocks } =\r\n\t\tuseDispatch( blockEditorStore );\r\n\r\n\tconst removeLabel = sprintf(\r\n\t\t/* translators: %s: block name */\r\n\t\t__( 'Remove %s' ),\r\n\t\tBlockTitle( { clientId, maximumLength: 25 } )\r\n\t);\r\n\r\n\tconst rootClientId = useSelect(\r\n\t\t( select ) => {\r\n\t\t\tconst { getBlockRootClientId } = select( blockEditorStore );\r\n\r\n\t\t\treturn getBlockRootClientId( clientId );\r\n\t\t},\r\n\t\t[ clientId ]\r\n\t);\r\n\r\n\treturn (\r\n\t\t<DropdownMenu\r\n\t\t\ticon={ moreVertical }\r\n\t\t\tlabel={ __( 'Options' ) }\r\n\t\t\tclassName=\"block-editor-block-settings-menu\"\r\n\t\t\tpopoverProps={ POPOVER_PROPS }\r\n\t\t\tnoIcons\r\n\t\t\t{ ...props }\r\n\t\t>\r\n\t\t\t{ ( { onClose } ) => (\r\n\t\t\t\t<>\r\n\t\t\t\t\t<MenuGroup>\r\n\t\t\t\t\t\t<MenuItem\r\n\t\t\t\t\t\t\ticon={ chevronUp }\r\n\t\t\t\t\t\t\tonClick={ () => {\r\n\t\t\t\t\t\t\t\tmoveBlocksUp( [ clientId ], rootClientId );\r\n\t\t\t\t\t\t\t\tonClose();\r\n\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{ __( 'Move up' ) }\r\n\t\t\t\t\t\t</MenuItem>\r\n\t\t\t\t\t\t<MenuItem\r\n\t\t\t\t\t\t\ticon={ chevronDown }\r\n\t\t\t\t\t\t\tonClick={ () => {\r\n\t\t\t\t\t\t\t\tmoveBlocksDown( [ clientId ], rootClientId );\r\n\t\t\t\t\t\t\t\tonClose();\r\n\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{ __( 'Move down' ) }\r\n\t\t\t\t\t\t</MenuItem>\r\n\t\t\t\t\t\t<AddSubmenuItem\r\n\t\t\t\t\t\t\tblock={ block }\r\n\t\t\t\t\t\t\tonClose={ onClose }\r\n\t\t\t\t\t\t\texpanded\r\n\t\t\t\t\t\t\texpandedState={ props.expandedState }\r\n\t\t\t\t\t\t\texpand={ props.expand }\r\n\t\t\t\t\t\t\tsetInsertedBlock={ props.setInsertedBlock }\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</MenuGroup>\r\n\t\t\t\t\t<MenuGroup>\r\n\t\t\t\t\t\t<MenuItem\r\n\t\t\t\t\t\t\tonClick={ () => {\r\n\t\t\t\t\t\t\t\tremoveBlocks( [ clientId ], false );\r\n\t\t\t\t\t\t\t\tonClose();\r\n\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{ removeLabel }\r\n\t\t\t\t\t\t</MenuItem>\r\n\t\t\t\t\t</MenuGroup>\r\n\t\t\t\t</>\r\n\t\t\t) }\r\n\t\t</DropdownMenu>\r\n\t);\r\n}\r\n"],"mappings":"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","ignoreList":[]}