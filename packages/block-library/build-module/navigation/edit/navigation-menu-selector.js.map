{"version":3,"names":["MenuGroup","MenuItem","MenuItemsChoice","DropdownMenu","moreVertical","__","sprintf","decodeEntities","useEffect","useMemo","useState","useEntityProp","useNavigationMenu","useNavigationEntities","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","buildMenuLabel","title","id","status","NavigationMenuSelector","currentMenuId","onSelectNavigationMenu","onSelectClassicMenu","onCreateNew","actionLabel","createNavigationMenuIsSuccess","createNavigationMenuIsError","createActionLabel","isUpdatingMenuRef","setIsUpdatingMenuRef","menus","classicMenus","navigationMenus","isResolvingNavigationMenus","hasResolvedNavigationMenus","canUserCreateNavigationMenus","canSwitchNavigationMenu","currentTitle","menuChoices","map","index","label","rendered","value","ariaLabel","disabled","hasNavigationMenus","length","hasClassicMenus","showNavigationMenus","showClassicMenus","noMenuSelected","noBlockMenus","menuUnavailable","selectorLabel","NavigationMenuSelectorDropdown","icon","toggleProps","size","children","onClose","onSelect","menuId","choices","menu","name","onClick"],"sources":["@wordpress/block-library/src/navigation/edit/navigation-menu-selector.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport {\r\n\tMenuGroup,\r\n\tMenuItem,\r\n\tMenuItemsChoice,\r\n\tDropdownMenu,\r\n} from '@wordpress/components';\r\nimport { moreVertical } from '@wordpress/icons';\r\nimport { __, sprintf } from '@wordpress/i18n';\r\nimport { decodeEntities } from '@wordpress/html-entities';\r\nimport { useEffect, useMemo, useState } from '@wordpress/element';\r\nimport { useEntityProp } from '@wordpress/core-data';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport useNavigationMenu from '../use-navigation-menu';\r\nimport useNavigationEntities from '../use-navigation-entities';\r\n\r\nfunction buildMenuLabel( title, id, status ) {\r\n\tif ( ! title ) {\r\n\t\t/* translators: %s is the index of the menu in the list of menus. */\r\n\t\treturn sprintf( __( '(no title %s)' ), id );\r\n\t}\r\n\r\n\tif ( status === 'publish' ) {\r\n\t\treturn decodeEntities( title );\r\n\t}\r\n\r\n\treturn sprintf(\r\n\t\t// translators: %1s: title of the menu; %2s: status of the menu (draft, pending, etc.).\r\n\t\t__( '%1$s (%2$s)' ),\r\n\t\tdecodeEntities( title ),\r\n\t\tstatus\r\n\t);\r\n}\r\n\r\nfunction NavigationMenuSelector( {\r\n\tcurrentMenuId,\r\n\tonSelectNavigationMenu,\r\n\tonSelectClassicMenu,\r\n\tonCreateNew,\r\n\tactionLabel,\r\n\tcreateNavigationMenuIsSuccess,\r\n\tcreateNavigationMenuIsError,\r\n} ) {\r\n\t/* translators: %s: The name of a menu. */\r\n\tconst createActionLabel = __( \"Create from '%s'\" );\r\n\r\n\tconst [ isUpdatingMenuRef, setIsUpdatingMenuRef ] = useState( false );\r\n\r\n\tactionLabel = actionLabel || createActionLabel;\r\n\r\n\tconst { menus: classicMenus } = useNavigationEntities();\r\n\r\n\tconst {\r\n\t\tnavigationMenus,\r\n\t\tisResolvingNavigationMenus,\r\n\t\thasResolvedNavigationMenus,\r\n\t\tcanUserCreateNavigationMenus,\r\n\t\tcanSwitchNavigationMenu,\r\n\t} = useNavigationMenu();\r\n\r\n\tconst [ currentTitle ] = useEntityProp(\r\n\t\t'postType',\r\n\t\t'wp_navigation',\r\n\t\t'title'\r\n\t);\r\n\r\n\tconst menuChoices = useMemo( () => {\r\n\t\treturn (\r\n\t\t\tnavigationMenus?.map( ( { id, title, status }, index ) => {\r\n\t\t\t\tconst label = buildMenuLabel(\r\n\t\t\t\t\ttitle?.rendered,\r\n\t\t\t\t\tindex + 1,\r\n\t\t\t\t\tstatus\r\n\t\t\t\t);\r\n\r\n\t\t\t\treturn {\r\n\t\t\t\t\tvalue: id,\r\n\t\t\t\t\tlabel,\r\n\t\t\t\t\tariaLabel: sprintf( actionLabel, label ),\r\n\t\t\t\t\tdisabled:\r\n\t\t\t\t\t\tisUpdatingMenuRef ||\r\n\t\t\t\t\t\tisResolvingNavigationMenus ||\r\n\t\t\t\t\t\t! hasResolvedNavigationMenus,\r\n\t\t\t\t};\r\n\t\t\t} ) || []\r\n\t\t);\r\n\t}, [\r\n\t\tnavigationMenus,\r\n\t\tactionLabel,\r\n\t\tisResolvingNavigationMenus,\r\n\t\thasResolvedNavigationMenus,\r\n\t\tisUpdatingMenuRef,\r\n\t] );\r\n\r\n\tconst hasNavigationMenus = !! navigationMenus?.length;\r\n\tconst hasClassicMenus = !! classicMenus?.length;\r\n\tconst showNavigationMenus = !! canSwitchNavigationMenu;\r\n\tconst showClassicMenus = !! canUserCreateNavigationMenus;\r\n\r\n\tconst noMenuSelected = hasNavigationMenus && ! currentMenuId;\r\n\tconst noBlockMenus = ! hasNavigationMenus && hasResolvedNavigationMenus;\r\n\tconst menuUnavailable =\r\n\t\thasResolvedNavigationMenus && currentMenuId === null;\r\n\r\n\tlet selectorLabel = '';\r\n\r\n\tif ( isResolvingNavigationMenus ) {\r\n\t\tselectorLabel = __( 'Loadingâ€¦' );\r\n\t} else if ( noMenuSelected || noBlockMenus || menuUnavailable ) {\r\n\t\t// Note: classic Menus may be available.\r\n\t\tselectorLabel = __( 'Choose or create a Navigation Menu' );\r\n\t} else {\r\n\t\t// Current Menu's title.\r\n\t\tselectorLabel = currentTitle;\r\n\t}\r\n\r\n\tuseEffect( () => {\r\n\t\tif (\r\n\t\t\tisUpdatingMenuRef &&\r\n\t\t\t( createNavigationMenuIsSuccess || createNavigationMenuIsError )\r\n\t\t) {\r\n\t\t\tsetIsUpdatingMenuRef( false );\r\n\t\t}\r\n\t}, [\r\n\t\thasResolvedNavigationMenus,\r\n\t\tcreateNavigationMenuIsSuccess,\r\n\t\tcanUserCreateNavigationMenus,\r\n\t\tcreateNavigationMenuIsError,\r\n\t\tisUpdatingMenuRef,\r\n\t\tmenuUnavailable,\r\n\t\tnoBlockMenus,\r\n\t\tnoMenuSelected,\r\n\t] );\r\n\r\n\tconst NavigationMenuSelectorDropdown = (\r\n\t\t<DropdownMenu\r\n\t\t\tlabel={ selectorLabel }\r\n\t\t\ticon={ moreVertical }\r\n\t\t\ttoggleProps={ { size: 'small' } }\r\n\t\t>\r\n\t\t\t{ ( { onClose } ) => (\r\n\t\t\t\t<>\r\n\t\t\t\t\t{ showNavigationMenus && hasNavigationMenus && (\r\n\t\t\t\t\t\t<MenuGroup label={ __( 'Menus' ) }>\r\n\t\t\t\t\t\t\t<MenuItemsChoice\r\n\t\t\t\t\t\t\t\tvalue={ currentMenuId }\r\n\t\t\t\t\t\t\t\tonSelect={ ( menuId ) => {\r\n\t\t\t\t\t\t\t\t\tonSelectNavigationMenu( menuId );\r\n\t\t\t\t\t\t\t\t\tonClose();\r\n\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t\tchoices={ menuChoices }\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</MenuGroup>\r\n\t\t\t\t\t) }\r\n\t\t\t\t\t{ showClassicMenus && hasClassicMenus && (\r\n\t\t\t\t\t\t<MenuGroup label={ __( 'Import Classic Menus' ) }>\r\n\t\t\t\t\t\t\t{ classicMenus?.map( ( menu ) => {\r\n\t\t\t\t\t\t\t\tconst label = decodeEntities( menu.name );\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<MenuItem\r\n\t\t\t\t\t\t\t\t\t\tonClick={ async () => {\r\n\t\t\t\t\t\t\t\t\t\t\tsetIsUpdatingMenuRef( true );\r\n\t\t\t\t\t\t\t\t\t\t\tawait onSelectClassicMenu( menu );\r\n\t\t\t\t\t\t\t\t\t\t\tsetIsUpdatingMenuRef( false );\r\n\t\t\t\t\t\t\t\t\t\t\tonClose();\r\n\t\t\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t\t\t\tkey={ menu.id }\r\n\t\t\t\t\t\t\t\t\t\taria-label={ sprintf(\r\n\t\t\t\t\t\t\t\t\t\t\tcreateActionLabel,\r\n\t\t\t\t\t\t\t\t\t\t\tlabel\r\n\t\t\t\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\t\t\t\tdisabled={\r\n\t\t\t\t\t\t\t\t\t\t\tisUpdatingMenuRef ||\r\n\t\t\t\t\t\t\t\t\t\t\tisResolvingNavigationMenus ||\r\n\t\t\t\t\t\t\t\t\t\t\t! hasResolvedNavigationMenus\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{ label }\r\n\t\t\t\t\t\t\t\t\t</MenuItem>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t} ) }\r\n\t\t\t\t\t\t</MenuGroup>\r\n\t\t\t\t\t) }\r\n\r\n\t\t\t\t\t{ canUserCreateNavigationMenus && (\r\n\t\t\t\t\t\t<MenuGroup label={ __( 'Tools' ) }>\r\n\t\t\t\t\t\t\t<MenuItem\r\n\t\t\t\t\t\t\t\tonClick={ async () => {\r\n\t\t\t\t\t\t\t\t\tsetIsUpdatingMenuRef( true );\r\n\t\t\t\t\t\t\t\t\tawait onCreateNew();\r\n\t\t\t\t\t\t\t\t\tsetIsUpdatingMenuRef( false );\r\n\t\t\t\t\t\t\t\t\tonClose();\r\n\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t\tdisabled={\r\n\t\t\t\t\t\t\t\t\tisUpdatingMenuRef ||\r\n\t\t\t\t\t\t\t\t\tisResolvingNavigationMenus ||\r\n\t\t\t\t\t\t\t\t\t! hasResolvedNavigationMenus\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{ __( 'Create new Menu' ) }\r\n\t\t\t\t\t\t\t</MenuItem>\r\n\t\t\t\t\t\t</MenuGroup>\r\n\t\t\t\t\t) }\r\n\t\t\t\t</>\r\n\t\t\t) }\r\n\t\t</DropdownMenu>\r\n\t);\r\n\r\n\treturn NavigationMenuSelectorDropdown;\r\n}\r\n\r\nexport default NavigationMenuSelector;\r\n"],"mappings":"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","ignoreList":[]}