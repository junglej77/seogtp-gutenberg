{"version":3,"names":["Disabled","store","coreStore","useRegistry","useContext","useCallback","__","sprintf","useTemplatePartAreaLabel","DRAFT_MENU_PARAMS","status","per_page","PUBLISHED_MENU_PARAMS","useGenerateDefaultNavigationTitle","clientId","isDisabled","Context","area","undefined","registry","getEntityRecords","resolveSelect","draftNavigationMenus","navigationMenus","Promise","all","title","matchingMenuTitleCount","reduce","count","menu","raw","startsWith","titleWithCount"],"sources":["@wordpress/block-library/src/navigation/edit/use-generate-default-navigation-title.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { Disabled } from '@wordpress/components';\r\nimport { store as coreStore } from '@wordpress/core-data';\r\nimport { useRegistry } from '@wordpress/data';\r\nimport { useContext, useCallback } from '@wordpress/element';\r\nimport { __, sprintf } from '@wordpress/i18n';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport useTemplatePartAreaLabel from '../use-template-part-area-label';\r\n\r\nconst DRAFT_MENU_PARAMS = [\r\n\t'postType',\r\n\t'wp_navigation',\r\n\t{ status: 'draft', per_page: -1 },\r\n];\r\n\r\nconst PUBLISHED_MENU_PARAMS = [\r\n\t'postType',\r\n\t'wp_navigation',\r\n\t{ per_page: -1, status: 'publish' },\r\n];\r\n\r\nexport default function useGenerateDefaultNavigationTitle( clientId ) {\r\n\t// The block will be disabled in a block preview, use this as a way of\r\n\t// avoiding the side-effects of this component for block previews.\r\n\tconst isDisabled = useContext( Disabled.Context );\r\n\r\n\t// Because we can't conditionally call hooks, pass an undefined client id\r\n\t// arg to bypass the expensive `useTemplateArea` code. The hook will return\r\n\t// early.\r\n\tconst area = useTemplatePartAreaLabel( isDisabled ? undefined : clientId );\r\n\r\n\tconst registry = useRegistry();\r\n\treturn useCallback( async () => {\r\n\t\t// Ensure other navigation menus have loaded so an\r\n\t\t// accurate name can be created.\r\n\t\tif ( isDisabled ) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\tconst { getEntityRecords } = registry.resolveSelect( coreStore );\r\n\r\n\t\tconst [ draftNavigationMenus, navigationMenus ] = await Promise.all( [\r\n\t\t\tgetEntityRecords( ...DRAFT_MENU_PARAMS ),\r\n\t\t\tgetEntityRecords( ...PUBLISHED_MENU_PARAMS ),\r\n\t\t] );\r\n\r\n\t\tconst title = area\r\n\t\t\t? sprintf(\r\n\t\t\t\t\t// translators: %s: the name of a menu (e.g. Header navigation).\r\n\t\t\t\t\t__( '%s navigation' ),\r\n\t\t\t\t\tarea\r\n\t\t\t  )\r\n\t\t\t: // translators: 'navigation' as in website navigation.\r\n\t\t\t  __( 'Navigation' );\r\n\r\n\t\t// Determine how many menus start with the automatic title.\r\n\t\tconst matchingMenuTitleCount = [\r\n\t\t\t...draftNavigationMenus,\r\n\t\t\t...navigationMenus,\r\n\t\t].reduce(\r\n\t\t\t( count, menu ) =>\r\n\t\t\t\tmenu?.title?.raw?.startsWith( title ) ? count + 1 : count,\r\n\t\t\t0\r\n\t\t);\r\n\r\n\t\t// Append a number to the end of the title if a menu with\r\n\t\t// the same name exists.\r\n\t\tconst titleWithCount =\r\n\t\t\tmatchingMenuTitleCount > 0\r\n\t\t\t\t? `${ title } ${ matchingMenuTitleCount + 1 }`\r\n\t\t\t\t: title;\r\n\r\n\t\treturn titleWithCount || '';\r\n\t}, [ isDisabled, area, registry ] );\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,QAAQ,QAAQ,uBAAuB;AAChD,SAASC,KAAK,IAAIC,SAAS,QAAQ,sBAAsB;AACzD,SAASC,WAAW,QAAQ,iBAAiB;AAC7C,SAASC,UAAU,EAAEC,WAAW,QAAQ,oBAAoB;AAC5D,SAASC,EAAE,EAAEC,OAAO,QAAQ,iBAAiB;;AAE7C;AACA;AACA;AACA,OAAOC,wBAAwB,MAAM,iCAAiC;AAEtE,MAAMC,iBAAiB,GAAG,CACzB,UAAU,EACV,eAAe,EACf;EAAEC,MAAM,EAAE,OAAO;EAAEC,QAAQ,EAAE,CAAC;AAAE,CAAC,CACjC;AAED,MAAMC,qBAAqB,GAAG,CAC7B,UAAU,EACV,eAAe,EACf;EAAED,QAAQ,EAAE,CAAC,CAAC;EAAED,MAAM,EAAE;AAAU,CAAC,CACnC;AAED,eAAe,SAASG,iCAAiCA,CAAEC,QAAQ,EAAG;EACrE;EACA;EACA,MAAMC,UAAU,GAAGX,UAAU,CAAEJ,QAAQ,CAACgB,OAAQ,CAAC;;EAEjD;EACA;EACA;EACA,MAAMC,IAAI,GAAGT,wBAAwB,CAAEO,UAAU,GAAGG,SAAS,GAAGJ,QAAS,CAAC;EAE1E,MAAMK,QAAQ,GAAGhB,WAAW,CAAC,CAAC;EAC9B,OAAOE,WAAW,CAAE,YAAY;IAC/B;IACA;IACA,IAAKU,UAAU,EAAG;MACjB,OAAO,EAAE;IACV;IACA,MAAM;MAAEK;IAAiB,CAAC,GAAGD,QAAQ,CAACE,aAAa,CAAEnB,SAAU,CAAC;IAEhE,MAAM,CAAEoB,oBAAoB,EAAEC,eAAe,CAAE,GAAG,MAAMC,OAAO,CAACC,GAAG,CAAE,CACpEL,gBAAgB,CAAE,GAAGX,iBAAkB,CAAC,EACxCW,gBAAgB,CAAE,GAAGR,qBAAsB,CAAC,CAC3C,CAAC;IAEH,MAAMc,KAAK,GAAGT,IAAI,GACfV,OAAO;IACP;IACAD,EAAE,CAAE,eAAgB,CAAC,EACrBW,IACA,CAAC;IACD;IACAX,EAAE,CAAE,YAAa,CAAC;;IAErB;IACA,MAAMqB,sBAAsB,GAAG,CAC9B,GAAGL,oBAAoB,EACvB,GAAGC,eAAe,CAClB,CAACK,MAAM,CACP,CAAEC,KAAK,EAAEC,IAAI,KACZA,IAAI,EAAEJ,KAAK,EAAEK,GAAG,EAAEC,UAAU,CAAEN,KAAM,CAAC,GAAGG,KAAK,GAAG,CAAC,GAAGA,KAAK,EAC1D,CACD,CAAC;;IAED;IACA;IACA,MAAMI,cAAc,GACnBN,sBAAsB,GAAG,CAAC,GACtB,GAAGD,KAAO,IAAIC,sBAAsB,GAAG,CAAG,EAAC,GAC5CD,KAAK;IAET,OAAOO,cAAc,IAAI,EAAE;EAC5B,CAAC,EAAE,CAAElB,UAAU,EAAEE,IAAI,EAAEE,QAAQ,CAAG,CAAC;AACpC","ignoreList":[]}