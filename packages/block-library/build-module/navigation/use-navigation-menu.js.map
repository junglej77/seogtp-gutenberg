{"version":3,"names":["store","coreStore","useResourcePermissions","useEntityRecords","useSelect","PRELOADED_NAVIGATION_MENUS_QUERY","useNavigationMenu","ref","permissions","kind","name","id","navigationMenu","isNavigationMenuResolved","isNavigationMenuMissing","select","selectExistingMenu","canCreate","canCreateNavigationMenus","canUpdate","canUpdateNavigationMenu","canDelete","canDeleteNavigationMenu","isResolving","isResolvingPermissions","hasResolved","hasResolvedPermissions","records","navigationMenus","isResolvingNavigationMenus","hasResolvedNavigationMenus","canSwitchNavigationMenu","length","canUserCreateNavigationMenus","isResolvingCanUserCreateNavigationMenus","hasResolvedCanUserCreateNavigationMenus","canUserUpdateNavigationMenu","hasResolvedCanUserUpdateNavigationMenu","undefined","canUserDeleteNavigationMenu","hasResolvedCanUserDeleteNavigationMenu","getEntityRecord","getEditedEntityRecord","hasFinishedResolution","args","editedNavigationMenu","hasResolvedNavigationMenu","isNavigationMenuPublishedOrDraft","status"],"sources":["@wordpress/block-library/src/navigation/use-navigation-menu.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport {\r\n\tstore as coreStore,\r\n\tuseResourcePermissions,\r\n\tuseEntityRecords,\r\n} from '@wordpress/core-data';\r\nimport { useSelect } from '@wordpress/data';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { PRELOADED_NAVIGATION_MENUS_QUERY } from './constants';\r\n\r\nexport default function useNavigationMenu( ref ) {\r\n\tconst permissions = useResourcePermissions( {\r\n\t\tkind: 'postType',\r\n\t\tname: 'wp_navigation',\r\n\t\tid: ref,\r\n\t} );\r\n\r\n\tconst {\r\n\t\tnavigationMenu,\r\n\t\tisNavigationMenuResolved,\r\n\t\tisNavigationMenuMissing,\r\n\t} = useSelect(\r\n\t\t( select ) => {\r\n\t\t\treturn selectExistingMenu( select, ref );\r\n\t\t},\r\n\t\t[ ref ]\r\n\t);\r\n\r\n\tconst {\r\n\t\t// Can the user create navigation menus?\r\n\t\tcanCreate: canCreateNavigationMenus,\r\n\r\n\t\t// Can the user update the specific navigation menu with the given post ID?\r\n\t\tcanUpdate: canUpdateNavigationMenu,\r\n\r\n\t\t// Can the user delete the specific navigation menu with the given post ID?\r\n\t\tcanDelete: canDeleteNavigationMenu,\r\n\t\tisResolving: isResolvingPermissions,\r\n\t\thasResolved: hasResolvedPermissions,\r\n\t} = permissions;\r\n\r\n\tconst {\r\n\t\trecords: navigationMenus,\r\n\t\tisResolving: isResolvingNavigationMenus,\r\n\t\thasResolved: hasResolvedNavigationMenus,\r\n\t} = useEntityRecords(\r\n\t\t'postType',\r\n\t\t`wp_navigation`,\r\n\t\tPRELOADED_NAVIGATION_MENUS_QUERY\r\n\t);\r\n\r\n\tconst canSwitchNavigationMenu = ref\r\n\t\t? navigationMenus?.length > 1\r\n\t\t: navigationMenus?.length > 0;\r\n\r\n\treturn {\r\n\t\tnavigationMenu,\r\n\t\tisNavigationMenuResolved,\r\n\t\tisNavigationMenuMissing,\r\n\t\tnavigationMenus,\r\n\t\tisResolvingNavigationMenus,\r\n\t\thasResolvedNavigationMenus,\r\n\t\tcanSwitchNavigationMenu,\r\n\t\tcanUserCreateNavigationMenus: canCreateNavigationMenus,\r\n\t\tisResolvingCanUserCreateNavigationMenus: isResolvingPermissions,\r\n\t\thasResolvedCanUserCreateNavigationMenus: hasResolvedPermissions,\r\n\t\tcanUserUpdateNavigationMenu: canUpdateNavigationMenu,\r\n\t\thasResolvedCanUserUpdateNavigationMenu: ref\r\n\t\t\t? hasResolvedPermissions\r\n\t\t\t: undefined,\r\n\t\tcanUserDeleteNavigationMenu: canDeleteNavigationMenu,\r\n\t\thasResolvedCanUserDeleteNavigationMenu: ref\r\n\t\t\t? hasResolvedPermissions\r\n\t\t\t: undefined,\r\n\t};\r\n}\r\n\r\nfunction selectExistingMenu( select, ref ) {\r\n\tif ( ! ref ) {\r\n\t\treturn {\r\n\t\t\tisNavigationMenuResolved: false,\r\n\t\t\tisNavigationMenuMissing: true,\r\n\t\t};\r\n\t}\r\n\r\n\tconst { getEntityRecord, getEditedEntityRecord, hasFinishedResolution } =\r\n\t\tselect( coreStore );\r\n\r\n\tconst args = [ 'postType', 'wp_navigation', ref ];\r\n\tconst navigationMenu = getEntityRecord( ...args );\r\n\tconst editedNavigationMenu = getEditedEntityRecord( ...args );\r\n\tconst hasResolvedNavigationMenu = hasFinishedResolution(\r\n\t\t'getEditedEntityRecord',\r\n\t\targs\r\n\t);\r\n\r\n\t// Only published Navigation posts are considered valid.\r\n\t// Draft Navigation posts are valid only on the editor,\r\n\t// requiring a post update to publish to show in frontend.\r\n\t// To achieve that, index.php must reflect this validation only for published.\r\n\tconst isNavigationMenuPublishedOrDraft =\r\n\t\teditedNavigationMenu.status === 'publish' ||\r\n\t\teditedNavigationMenu.status === 'draft';\r\n\r\n\treturn {\r\n\t\tisNavigationMenuResolved: hasResolvedNavigationMenu,\r\n\t\tisNavigationMenuMissing:\r\n\t\t\thasResolvedNavigationMenu &&\r\n\t\t\t( ! navigationMenu || ! isNavigationMenuPublishedOrDraft ),\r\n\r\n\t\t// getEditedEntityRecord will return the post regardless of status.\r\n\t\t// Therefore if the found post is not published then we should ignore it.\r\n\t\tnavigationMenu: isNavigationMenuPublishedOrDraft\r\n\t\t\t? editedNavigationMenu\r\n\t\t\t: null,\r\n\t};\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SACCA,KAAK,IAAIC,SAAS,EAClBC,sBAAsB,EACtBC,gBAAgB,QACV,sBAAsB;AAC7B,SAASC,SAAS,QAAQ,iBAAiB;;AAE3C;AACA;AACA;AACA,SAASC,gCAAgC,QAAQ,aAAa;AAE9D,eAAe,SAASC,iBAAiBA,CAAEC,GAAG,EAAG;EAChD,MAAMC,WAAW,GAAGN,sBAAsB,CAAE;IAC3CO,IAAI,EAAE,UAAU;IAChBC,IAAI,EAAE,eAAe;IACrBC,EAAE,EAAEJ;EACL,CAAE,CAAC;EAEH,MAAM;IACLK,cAAc;IACdC,wBAAwB;IACxBC;EACD,CAAC,GAAGV,SAAS,CACVW,MAAM,IAAM;IACb,OAAOC,kBAAkB,CAAED,MAAM,EAAER,GAAI,CAAC;EACzC,CAAC,EACD,CAAEA,GAAG,CACN,CAAC;EAED,MAAM;IACL;IACAU,SAAS,EAAEC,wBAAwB;IAEnC;IACAC,SAAS,EAAEC,uBAAuB;IAElC;IACAC,SAAS,EAAEC,uBAAuB;IAClCC,WAAW,EAAEC,sBAAsB;IACnCC,WAAW,EAAEC;EACd,CAAC,GAAGlB,WAAW;EAEf,MAAM;IACLmB,OAAO,EAAEC,eAAe;IACxBL,WAAW,EAAEM,0BAA0B;IACvCJ,WAAW,EAAEK;EACd,CAAC,GAAG3B,gBAAgB,CACnB,UAAU,EACT,eAAc,EACfE,gCACD,CAAC;EAED,MAAM0B,uBAAuB,GAAGxB,GAAG,GAChCqB,eAAe,EAAEI,MAAM,GAAG,CAAC,GAC3BJ,eAAe,EAAEI,MAAM,GAAG,CAAC;EAE9B,OAAO;IACNpB,cAAc;IACdC,wBAAwB;IACxBC,uBAAuB;IACvBc,eAAe;IACfC,0BAA0B;IAC1BC,0BAA0B;IAC1BC,uBAAuB;IACvBE,4BAA4B,EAAEf,wBAAwB;IACtDgB,uCAAuC,EAAEV,sBAAsB;IAC/DW,uCAAuC,EAAET,sBAAsB;IAC/DU,2BAA2B,EAAEhB,uBAAuB;IACpDiB,sCAAsC,EAAE9B,GAAG,GACxCmB,sBAAsB,GACtBY,SAAS;IACZC,2BAA2B,EAAEjB,uBAAuB;IACpDkB,sCAAsC,EAAEjC,GAAG,GACxCmB,sBAAsB,GACtBY;EACJ,CAAC;AACF;AAEA,SAAStB,kBAAkBA,CAAED,MAAM,EAAER,GAAG,EAAG;EAC1C,IAAK,CAAEA,GAAG,EAAG;IACZ,OAAO;MACNM,wBAAwB,EAAE,KAAK;MAC/BC,uBAAuB,EAAE;IAC1B,CAAC;EACF;EAEA,MAAM;IAAE2B,eAAe;IAAEC,qBAAqB;IAAEC;EAAsB,CAAC,GACtE5B,MAAM,CAAEd,SAAU,CAAC;EAEpB,MAAM2C,IAAI,GAAG,CAAE,UAAU,EAAE,eAAe,EAAErC,GAAG,CAAE;EACjD,MAAMK,cAAc,GAAG6B,eAAe,CAAE,GAAGG,IAAK,CAAC;EACjD,MAAMC,oBAAoB,GAAGH,qBAAqB,CAAE,GAAGE,IAAK,CAAC;EAC7D,MAAME,yBAAyB,GAAGH,qBAAqB,CACtD,uBAAuB,EACvBC,IACD,CAAC;;EAED;EACA;EACA;EACA;EACA,MAAMG,gCAAgC,GACrCF,oBAAoB,CAACG,MAAM,KAAK,SAAS,IACzCH,oBAAoB,CAACG,MAAM,KAAK,OAAO;EAExC,OAAO;IACNnC,wBAAwB,EAAEiC,yBAAyB;IACnDhC,uBAAuB,EACtBgC,yBAAyB,KACvB,CAAElC,cAAc,IAAI,CAAEmC,gCAAgC,CAAE;IAE3D;IACA;IACAnC,cAAc,EAAEmC,gCAAgC,GAC7CF,oBAAoB,GACpB;EACJ,CAAC;AACF","ignoreList":[]}