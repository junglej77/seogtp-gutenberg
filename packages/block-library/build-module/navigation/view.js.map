{"version":3,"names":["store","getContext","getElement","focusableSelectors","document","addEventListener","state","actions","roleAttribute","ctx","type","isMenuOpen","ariaModal","ariaLabel","Object","values","menuOpenedBy","filter","Boolean","length","overlayOpenedBy","submenuOpenedBy","openMenuOnHover","openMenu","closeMenuOnHover","closeMenu","openMenuOnClick","ref","previousFocus","closeMenuOnClick","openMenuOnFocus","toggleMenuOnClick","window","activeElement","focus","click","handleMenuKeydown","event","firstFocusableElement","lastFocusableElement","key","shiftKey","preventDefault","handleMenuFocusout","modal","relatedTarget","contains","target","menuOpenedOn","documentElement","classList","add","menuClosedOn","remove","callbacks","initMenu","focusableElements","querySelectorAll","focusFirstElement","lock"],"sources":["@wordpress/block-library/src/navigation/view.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { store, getContext, getElement } from '@wordpress/interactivity';\r\n\r\nconst focusableSelectors = [\r\n\t'a[href]',\r\n\t'input:not([disabled]):not([type=\"hidden\"]):not([aria-hidden])',\r\n\t'select:not([disabled]):not([aria-hidden])',\r\n\t'textarea:not([disabled]):not([aria-hidden])',\r\n\t'button:not([disabled]):not([aria-hidden])',\r\n\t'[contenteditable]',\r\n\t'[tabindex]:not([tabindex^=\"-\"])',\r\n];\r\n\r\n// This is a fix for Safari in iOS/iPadOS. Without it, Safari doesn't focus out\r\n// when the user taps in the body. It can be removed once we add an overlay to\r\n// capture the clicks, instead of relying on the focusout event.\r\ndocument.addEventListener( 'click', () => {} );\r\n\r\nconst { state, actions } = store(\r\n\t'core/navigation',\r\n\t{\r\n\t\tstate: {\r\n\t\t\tget roleAttribute() {\r\n\t\t\t\tconst ctx = getContext();\r\n\t\t\t\treturn ctx.type === 'overlay' && state.isMenuOpen\r\n\t\t\t\t\t? 'dialog'\r\n\t\t\t\t\t: null;\r\n\t\t\t},\r\n\t\t\tget ariaModal() {\r\n\t\t\t\tconst ctx = getContext();\r\n\t\t\t\treturn ctx.type === 'overlay' && state.isMenuOpen\r\n\t\t\t\t\t? 'true'\r\n\t\t\t\t\t: null;\r\n\t\t\t},\r\n\t\t\tget ariaLabel() {\r\n\t\t\t\tconst ctx = getContext();\r\n\t\t\t\treturn ctx.type === 'overlay' && state.isMenuOpen\r\n\t\t\t\t\t? ctx.ariaLabel\r\n\t\t\t\t\t: null;\r\n\t\t\t},\r\n\t\t\tget isMenuOpen() {\r\n\t\t\t\t// The menu is opened if either `click`, `hover` or `focus` is true.\r\n\t\t\t\treturn (\r\n\t\t\t\t\tObject.values( state.menuOpenedBy ).filter( Boolean )\r\n\t\t\t\t\t\t.length > 0\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tget menuOpenedBy() {\r\n\t\t\t\tconst ctx = getContext();\r\n\t\t\t\treturn ctx.type === 'overlay'\r\n\t\t\t\t\t? ctx.overlayOpenedBy\r\n\t\t\t\t\t: ctx.submenuOpenedBy;\r\n\t\t\t},\r\n\t\t},\r\n\t\tactions: {\r\n\t\t\topenMenuOnHover() {\r\n\t\t\t\tconst { type, overlayOpenedBy } = getContext();\r\n\t\t\t\tif (\r\n\t\t\t\t\ttype === 'submenu' &&\r\n\t\t\t\t\t// Only open on hover if the overlay is closed.\r\n\t\t\t\t\tObject.values( overlayOpenedBy || {} ).filter( Boolean )\r\n\t\t\t\t\t\t.length === 0\r\n\t\t\t\t) {\r\n\t\t\t\t\tactions.openMenu( 'hover' );\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcloseMenuOnHover() {\r\n\t\t\t\tconst { type, overlayOpenedBy } = getContext();\r\n\t\t\t\tif (\r\n\t\t\t\t\ttype === 'submenu' &&\r\n\t\t\t\t\t// Only close on hover if the overlay is closed.\r\n\t\t\t\t\tObject.values( overlayOpenedBy || {} ).filter( Boolean )\r\n\t\t\t\t\t\t.length === 0\r\n\t\t\t\t) {\r\n\t\t\t\t\tactions.closeMenu( 'hover' );\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\topenMenuOnClick() {\r\n\t\t\t\tconst ctx = getContext();\r\n\t\t\t\tconst { ref } = getElement();\r\n\t\t\t\tctx.previousFocus = ref;\r\n\t\t\t\tactions.openMenu( 'click' );\r\n\t\t\t},\r\n\t\t\tcloseMenuOnClick() {\r\n\t\t\t\tactions.closeMenu( 'click' );\r\n\t\t\t\tactions.closeMenu( 'focus' );\r\n\t\t\t},\r\n\t\t\topenMenuOnFocus() {\r\n\t\t\t\tactions.openMenu( 'focus' );\r\n\t\t\t},\r\n\t\t\ttoggleMenuOnClick() {\r\n\t\t\t\tconst ctx = getContext();\r\n\t\t\t\tconst { ref } = getElement();\r\n\t\t\t\t// Safari won't send focus to the clicked element, so we need to manually place it: https://bugs.webkit.org/show_bug.cgi?id=22261\r\n\t\t\t\tif ( window.document.activeElement !== ref ) {\r\n\t\t\t\t\tref.focus();\r\n\t\t\t\t}\r\n\t\t\t\tconst { menuOpenedBy } = state;\r\n\t\t\t\tif ( menuOpenedBy.click || menuOpenedBy.focus ) {\r\n\t\t\t\t\tactions.closeMenu( 'click' );\r\n\t\t\t\t\tactions.closeMenu( 'focus' );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tctx.previousFocus = ref;\r\n\t\t\t\t\tactions.openMenu( 'click' );\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\thandleMenuKeydown( event ) {\r\n\t\t\t\tconst { type, firstFocusableElement, lastFocusableElement } =\r\n\t\t\t\t\tgetContext();\r\n\t\t\t\tif ( state.menuOpenedBy.click ) {\r\n\t\t\t\t\t// If Escape close the menu.\r\n\t\t\t\t\tif ( event?.key === 'Escape' ) {\r\n\t\t\t\t\t\tactions.closeMenu( 'click' );\r\n\t\t\t\t\t\tactions.closeMenu( 'focus' );\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Trap focus if it is an overlay (main menu).\r\n\t\t\t\t\tif ( type === 'overlay' && event.key === 'Tab' ) {\r\n\t\t\t\t\t\t// If shift + tab it change the direction.\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\tevent.shiftKey &&\r\n\t\t\t\t\t\t\twindow.document.activeElement ===\r\n\t\t\t\t\t\t\t\tfirstFocusableElement\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\t\tlastFocusableElement.focus();\r\n\t\t\t\t\t\t} else if (\r\n\t\t\t\t\t\t\t! event.shiftKey &&\r\n\t\t\t\t\t\t\twindow.document.activeElement ===\r\n\t\t\t\t\t\t\t\tlastFocusableElement\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\t\tfirstFocusableElement.focus();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\thandleMenuFocusout( event ) {\r\n\t\t\t\tconst { modal, type } = getContext();\r\n\t\t\t\t// If focus is outside modal, and in the document, close menu\r\n\t\t\t\t// event.target === The element losing focus\r\n\t\t\t\t// event.relatedTarget === The element receiving focus (if any)\r\n\t\t\t\t// When focusout is outside the document,\r\n\t\t\t\t// `window.document.activeElement` doesn't change.\r\n\r\n\t\t\t\t// The event.relatedTarget is null when something outside the navigation menu is clicked. This is only necessary for Safari.\r\n\t\t\t\tif (\r\n\t\t\t\t\tevent.relatedTarget === null ||\r\n\t\t\t\t\t( ! modal?.contains( event.relatedTarget ) &&\r\n\t\t\t\t\t\tevent.target !== window.document.activeElement &&\r\n\t\t\t\t\t\ttype === 'submenu' )\r\n\t\t\t\t) {\r\n\t\t\t\t\tactions.closeMenu( 'click' );\r\n\t\t\t\t\tactions.closeMenu( 'focus' );\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\topenMenu( menuOpenedOn = 'click' ) {\r\n\t\t\t\tconst { type } = getContext();\r\n\t\t\t\tstate.menuOpenedBy[ menuOpenedOn ] = true;\r\n\t\t\t\tif ( type === 'overlay' ) {\r\n\t\t\t\t\t// Add a `has-modal-open` class to the <html> root.\r\n\t\t\t\t\tdocument.documentElement.classList.add( 'has-modal-open' );\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tcloseMenu( menuClosedOn = 'click' ) {\r\n\t\t\t\tconst ctx = getContext();\r\n\t\t\t\tstate.menuOpenedBy[ menuClosedOn ] = false;\r\n\t\t\t\t// Check if the menu is still open or not.\r\n\t\t\t\tif ( ! state.isMenuOpen ) {\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tctx.modal?.contains( window.document.activeElement )\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tctx.previousFocus?.focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tctx.modal = null;\r\n\t\t\t\t\tctx.previousFocus = null;\r\n\t\t\t\t\tif ( ctx.type === 'overlay' ) {\r\n\t\t\t\t\t\tdocument.documentElement.classList.remove(\r\n\t\t\t\t\t\t\t'has-modal-open'\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t},\r\n\t\tcallbacks: {\r\n\t\t\tinitMenu() {\r\n\t\t\t\tconst ctx = getContext();\r\n\t\t\t\tconst { ref } = getElement();\r\n\t\t\t\tif ( state.isMenuOpen ) {\r\n\t\t\t\t\tconst focusableElements =\r\n\t\t\t\t\t\tref.querySelectorAll( focusableSelectors );\r\n\t\t\t\t\tctx.modal = ref;\r\n\t\t\t\t\tctx.firstFocusableElement = focusableElements[ 0 ];\r\n\t\t\t\t\tctx.lastFocusableElement =\r\n\t\t\t\t\t\tfocusableElements[ focusableElements.length - 1 ];\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tfocusFirstElement() {\r\n\t\t\t\tconst { ref } = getElement();\r\n\t\t\t\tif ( state.isMenuOpen ) {\r\n\t\t\t\t\tconst focusableElements =\r\n\t\t\t\t\t\tref.querySelectorAll( focusableSelectors );\r\n\t\t\t\t\tfocusableElements?.[ 0 ]?.focus();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t},\r\n\t},\r\n\t{ lock: true }\r\n);\r\n"],"mappings":"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","ignoreList":[]}