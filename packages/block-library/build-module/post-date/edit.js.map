{"version":3,"names":["clsx","useEntityProp","store","coreStore","useMemo","useState","dateI18n","humanTimeDiff","getSettings","getDateSettings","AlignmentControl","BlockControls","InspectorControls","useBlockProps","__experimentalDateFormatPicker","DateFormatPicker","__experimentalPublishDateTimePicker","PublishDateTimePicker","Dropdown","ToolbarGroup","ToolbarButton","ToggleControl","PanelBody","__","_x","sprintf","edit","DOWN","useSelect","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","PostDateEdit","attributes","textAlign","format","isLink","displayType","context","postId","postType","postTypeSlug","queryId","setAttributes","blockProps","className","popoverAnchor","setPopoverAnchor","popoverProps","anchor","isDescendentOfQueryLoop","Number","isFinite","dateSettings","siteFormat","formats","date","siteTimeFormat","time","setDate","select","getPostType","dateLabel","postDate","dateTime","ref","children","href","onClick","event","preventDefault","group","value","onChange","nextAlign","renderContent","onClose","currentDate","is12Hour","is12HourFormat","dateOrder","renderToggle","isOpen","onToggle","openOnArrowDown","keyCode","icon","title","onKeyDown","defaultFormat","nextFormat","__nextHasNoMarginBottom","label","labels","singular_name","toLowerCase","checked","help","test"],"sources":["@wordpress/block-library/src/post-date/edit.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport clsx from 'clsx';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { useEntityProp, store as coreStore } from '@wordpress/core-data';\r\nimport { useMemo, useState } from '@wordpress/element';\r\nimport {\r\n\tdateI18n,\r\n\thumanTimeDiff,\r\n\tgetSettings as getDateSettings,\r\n} from '@wordpress/date';\r\nimport {\r\n\tAlignmentControl,\r\n\tBlockControls,\r\n\tInspectorControls,\r\n\tuseBlockProps,\r\n\t__experimentalDateFormatPicker as DateFormatPicker,\r\n\t__experimentalPublishDateTimePicker as PublishDateTimePicker,\r\n} from '@wordpress/block-editor';\r\nimport {\r\n\tDropdown,\r\n\tToolbarGroup,\r\n\tToolbarButton,\r\n\tToggleControl,\r\n\tPanelBody,\r\n} from '@wordpress/components';\r\nimport { __, _x, sprintf } from '@wordpress/i18n';\r\nimport { edit } from '@wordpress/icons';\r\nimport { DOWN } from '@wordpress/keycodes';\r\nimport { useSelect } from '@wordpress/data';\r\n\r\nexport default function PostDateEdit( {\r\n\tattributes: { textAlign, format, isLink, displayType },\r\n\tcontext: { postId, postType: postTypeSlug, queryId },\r\n\tsetAttributes,\r\n} ) {\r\n\tconst blockProps = useBlockProps( {\r\n\t\tclassName: clsx( {\r\n\t\t\t[ `has-text-align-${ textAlign }` ]: textAlign,\r\n\t\t\t[ `wp-block-post-date__modified-date` ]: displayType === 'modified',\r\n\t\t} ),\r\n\t} );\r\n\r\n\t// Use internal state instead of a ref to make sure that the component\r\n\t// re-renders when the popover's anchor updates.\r\n\tconst [ popoverAnchor, setPopoverAnchor ] = useState( null );\r\n\t// Memoize popoverProps to avoid returning a new object every time.\r\n\tconst popoverProps = useMemo(\r\n\t\t() => ( { anchor: popoverAnchor } ),\r\n\t\t[ popoverAnchor ]\r\n\t);\r\n\r\n\tconst isDescendentOfQueryLoop = Number.isFinite( queryId );\r\n\tconst dateSettings = getDateSettings();\r\n\tconst [ siteFormat = dateSettings.formats.date ] = useEntityProp(\r\n\t\t'root',\r\n\t\t'site',\r\n\t\t'date_format'\r\n\t);\r\n\tconst [ siteTimeFormat = dateSettings.formats.time ] = useEntityProp(\r\n\t\t'root',\r\n\t\t'site',\r\n\t\t'time_format'\r\n\t);\r\n\tconst [ date, setDate ] = useEntityProp(\r\n\t\t'postType',\r\n\t\tpostTypeSlug,\r\n\t\tdisplayType,\r\n\t\tpostId\r\n\t);\r\n\r\n\tconst postType = useSelect(\r\n\t\t( select ) =>\r\n\t\t\tpostTypeSlug\r\n\t\t\t\t? select( coreStore ).getPostType( postTypeSlug )\r\n\t\t\t\t: null,\r\n\t\t[ postTypeSlug ]\r\n\t);\r\n\r\n\tconst dateLabel =\r\n\t\tdisplayType === 'date' ? __( 'Post Date' ) : __( 'Post Modified Date' );\r\n\r\n\tlet postDate = date ? (\r\n\t\t<time dateTime={ dateI18n( 'c', date ) } ref={ setPopoverAnchor }>\r\n\t\t\t{ format === 'human-diff'\r\n\t\t\t\t? humanTimeDiff( date )\r\n\t\t\t\t: dateI18n( format || siteFormat, date ) }\r\n\t\t</time>\r\n\t) : (\r\n\t\tdateLabel\r\n\t);\r\n\r\n\tif ( isLink && date ) {\r\n\t\tpostDate = (\r\n\t\t\t<a\r\n\t\t\t\thref=\"#post-date-pseudo-link\"\r\n\t\t\t\tonClick={ ( event ) => event.preventDefault() }\r\n\t\t\t>\r\n\t\t\t\t{ postDate }\r\n\t\t\t</a>\r\n\t\t);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<BlockControls group=\"block\">\r\n\t\t\t\t<AlignmentControl\r\n\t\t\t\t\tvalue={ textAlign }\r\n\t\t\t\t\tonChange={ ( nextAlign ) => {\r\n\t\t\t\t\t\tsetAttributes( { textAlign: nextAlign } );\r\n\t\t\t\t\t} }\r\n\t\t\t\t/>\r\n\t\t\t\t{ date &&\r\n\t\t\t\t\tdisplayType === 'date' &&\r\n\t\t\t\t\t! isDescendentOfQueryLoop && (\r\n\t\t\t\t\t\t<ToolbarGroup>\r\n\t\t\t\t\t\t\t<Dropdown\r\n\t\t\t\t\t\t\t\tpopoverProps={ popoverProps }\r\n\t\t\t\t\t\t\t\trenderContent={ ( { onClose } ) => (\r\n\t\t\t\t\t\t\t\t\t<PublishDateTimePicker\r\n\t\t\t\t\t\t\t\t\t\tcurrentDate={ date }\r\n\t\t\t\t\t\t\t\t\t\tonChange={ setDate }\r\n\t\t\t\t\t\t\t\t\t\tis12Hour={ is12HourFormat(\r\n\t\t\t\t\t\t\t\t\t\t\tsiteTimeFormat\r\n\t\t\t\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\t\t\t\tonClose={ onClose }\r\n\t\t\t\t\t\t\t\t\t\tdateOrder={\r\n\t\t\t\t\t\t\t\t\t\t\t/* translators: Order of day, month, and year. Available formats are 'dmy', 'mdy', and 'ymd'. */\r\n\t\t\t\t\t\t\t\t\t\t\t_x( 'dmy', 'date order' )\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\t\trenderToggle={ ( { isOpen, onToggle } ) => {\r\n\t\t\t\t\t\t\t\t\tconst openOnArrowDown = ( event ) => {\r\n\t\t\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\t\t\t! isOpen &&\r\n\t\t\t\t\t\t\t\t\t\t\tevent.keyCode === DOWN\r\n\t\t\t\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t\tonToggle();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<ToolbarButton\r\n\t\t\t\t\t\t\t\t\t\t\taria-expanded={ isOpen }\r\n\t\t\t\t\t\t\t\t\t\t\ticon={ edit }\r\n\t\t\t\t\t\t\t\t\t\t\ttitle={ __( 'Change Date' ) }\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={ onToggle }\r\n\t\t\t\t\t\t\t\t\t\t\tonKeyDown={ openOnArrowDown }\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</ToolbarGroup>\r\n\t\t\t\t\t) }\r\n\t\t\t</BlockControls>\r\n\r\n\t\t\t<InspectorControls>\r\n\t\t\t\t<PanelBody title={ __( 'Settings' ) }>\r\n\t\t\t\t\t<DateFormatPicker\r\n\t\t\t\t\t\tformat={ format }\r\n\t\t\t\t\t\tdefaultFormat={ siteFormat }\r\n\t\t\t\t\t\tonChange={ ( nextFormat ) =>\r\n\t\t\t\t\t\t\tsetAttributes( { format: nextFormat } )\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<ToggleControl\r\n\t\t\t\t\t\t__nextHasNoMarginBottom\r\n\t\t\t\t\t\tlabel={\r\n\t\t\t\t\t\t\tpostType?.labels.singular_name\r\n\t\t\t\t\t\t\t\t? sprintf(\r\n\t\t\t\t\t\t\t\t\t\t// translators: %s: Name of the post type e.g: \"post\".\r\n\t\t\t\t\t\t\t\t\t\t__( 'Link to %s' ),\r\n\t\t\t\t\t\t\t\t\t\tpostType.labels.singular_name.toLowerCase()\r\n\t\t\t\t\t\t\t\t  )\r\n\t\t\t\t\t\t\t\t: __( 'Link to post' )\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tonChange={ () => setAttributes( { isLink: ! isLink } ) }\r\n\t\t\t\t\t\tchecked={ isLink }\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<ToggleControl\r\n\t\t\t\t\t\t__nextHasNoMarginBottom\r\n\t\t\t\t\t\tlabel={ __( 'Display last modified date' ) }\r\n\t\t\t\t\t\tonChange={ ( value ) =>\r\n\t\t\t\t\t\t\tsetAttributes( {\r\n\t\t\t\t\t\t\t\tdisplayType: value ? 'modified' : 'date',\r\n\t\t\t\t\t\t\t} )\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tchecked={ displayType === 'modified' }\r\n\t\t\t\t\t\thelp={ __(\r\n\t\t\t\t\t\t\t'Only shows if the post has been modified'\r\n\t\t\t\t\t\t) }\r\n\t\t\t\t\t/>\r\n\t\t\t\t</PanelBody>\r\n\t\t\t</InspectorControls>\r\n\r\n\t\t\t<div { ...blockProps }>{ postDate }</div>\r\n\t\t</>\r\n\t);\r\n}\r\n\r\nexport function is12HourFormat( format ) {\r\n\t// To know if the time format is a 12 hour time, look for any of the 12 hour\r\n\t// format characters: 'a', 'A', 'g', and 'h'. The character must be\r\n\t// unescaped, i.e. not preceded by a '\\'. Coincidentally, 'aAgh' is how I\r\n\t// feel when working with regular expressions.\r\n\t// https://www.php.net/manual/en/datetime.format.php\r\n\treturn /(?:^|[^\\\\])[aAgh]/.test( format );\r\n}\r\n"],"mappings":"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","ignoreList":[]}