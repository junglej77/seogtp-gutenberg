{"version":3,"names":["useSelect","useMemo","store","coreStore","blockEditorStore","decodeEntities","cloneBlock","getBlockSupport","blocksStore","getEntitiesInfo","entities","mapping","reduce","accumulator","entity","mapById","mapByName","names","id","name","push","getValueFromObjectPath","object","path","normalizedPath","split","value","forEach","fieldName","mapToIHasNameAndId","map","usePostTypes","postTypes","select","getPostTypes","excludedPostTypes","filteredPostTypes","per_page","filter","viewable","slug","includes","postTypesTaxonomiesMap","length","type","taxonomies","postTypesSelectOptions","labels","label","singular_name","useTaxonomies","postType","getTaxonomies","getPostType","visibility","publicly_queryable","useIsPostTypeHierarchical","hierarchical","useAllowedControls","attributes","getActiveBlockVariation","allowedControls","isControlAllowed","key","getTransformedBlocksFromPattern","blocks","queryBlockAttributes","query","inherit","namespace","clonedBlocks","block","queryClientIds","blocksQueue","shift","clientId","innerBlocks","innerBlock","newBlocks","useBlockNameForPatterns","activeVariationName","blockName","hasActiveVariationPatterns","getBlockRootClientId","getPatternsByBlockTypes","rootClientId","activePatterns","useScopedBlockVariations","blockVariations","getBlockVariations","variations","isNotConnected","variation","connectedVariations","usePatterns","useUnsupportedBlocks","getClientIdsOfDescendants","getBlockName","descendantClientId","blockSupportsInteractivity","Object","is","blockSupportsInteractivityClientNavigation","blockInteractivity","hasBlocksFromPlugins","hasPostContentBlock","hasUnsupportedBlocks"],"sources":["@wordpress/block-library/src/query/utils.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useSelect } from '@wordpress/data';\r\nimport { useMemo } from '@wordpress/element';\r\nimport { store as coreStore } from '@wordpress/core-data';\r\nimport { store as blockEditorStore } from '@wordpress/block-editor';\r\nimport { decodeEntities } from '@wordpress/html-entities';\r\nimport {\r\n\tcloneBlock,\r\n\tgetBlockSupport,\r\n\tstore as blocksStore,\r\n} from '@wordpress/blocks';\r\n\r\n/** @typedef {import('@wordpress/blocks').WPBlockVariation} WPBlockVariation */\r\n\r\n/**\r\n * @typedef IHasNameAndId\r\n * @property {string|number} id   The entity's id.\r\n * @property {string}        name The entity's name.\r\n */\r\n\r\n/**\r\n * The object used in Query block that contains info and helper mappings\r\n * from an array of IHasNameAndId objects.\r\n *\r\n * @typedef {Object} QueryEntitiesInfo\r\n * @property {IHasNameAndId[]}               entities  The array of entities.\r\n * @property {Object<string, IHasNameAndId>} mapById   Object mapping with the id as key and the entity as value.\r\n * @property {Object<string, IHasNameAndId>} mapByName Object mapping with the name as key and the entity as value.\r\n * @property {string[]}                      names     Array with the entities' names.\r\n */\r\n\r\n/**\r\n * Returns a helper object with mapping from Objects that implement\r\n * the `IHasNameAndId` interface. The returned object is used for\r\n * integration with `FormTokenField` component.\r\n *\r\n * @param {IHasNameAndId[]} entities The entities to extract of helper object.\r\n * @return {QueryEntitiesInfo} The object with the entities information.\r\n */\r\nexport const getEntitiesInfo = ( entities ) => {\r\n\tconst mapping = entities?.reduce(\r\n\t\t( accumulator, entity ) => {\r\n\t\t\tconst { mapById, mapByName, names } = accumulator;\r\n\t\t\tmapById[ entity.id ] = entity;\r\n\t\t\tmapByName[ entity.name ] = entity;\r\n\t\t\tnames.push( entity.name );\r\n\t\t\treturn accumulator;\r\n\t\t},\r\n\t\t{ mapById: {}, mapByName: {}, names: [] }\r\n\t);\r\n\treturn {\r\n\t\tentities,\r\n\t\t...mapping,\r\n\t};\r\n};\r\n\r\n/**\r\n * Helper util to return a value from a certain path of the object.\r\n * Path is specified as a string of properties, separated by dots,\r\n * for example: \"parent.child\".\r\n *\r\n * @param {Object} object Input object.\r\n * @param {string} path   Path to the object property.\r\n * @return {*} Value of the object property at the specified path.\r\n */\r\nexport const getValueFromObjectPath = ( object, path ) => {\r\n\tconst normalizedPath = path.split( '.' );\r\n\tlet value = object;\r\n\tnormalizedPath.forEach( ( fieldName ) => {\r\n\t\tvalue = value?.[ fieldName ];\r\n\t} );\r\n\treturn value;\r\n};\r\n\r\n/**\r\n * Helper util to map records to add a `name` prop from a\r\n * provided path, in order to handle all entities in the same\r\n * fashion(implementing`IHasNameAndId` interface).\r\n *\r\n * @param {Object[]} entities The array of entities.\r\n * @param {string}   path     The path to map a `name` property from the entity.\r\n * @return {IHasNameAndId[]} An array of enitities that now implement the `IHasNameAndId` interface.\r\n */\r\nexport const mapToIHasNameAndId = ( entities, path ) => {\r\n\treturn ( entities || [] ).map( ( entity ) => ( {\r\n\t\t...entity,\r\n\t\tname: decodeEntities( getValueFromObjectPath( entity, path ) ),\r\n\t} ) );\r\n};\r\n\r\n/**\r\n * Returns a helper object that contains:\r\n * 1. An `options` object from the available post types, to be passed to a `SelectControl`.\r\n * 2. A helper map with available taxonomies per post type.\r\n *\r\n * @return {Object} The helper object related to post types.\r\n */\r\nexport const usePostTypes = () => {\r\n\tconst postTypes = useSelect( ( select ) => {\r\n\t\tconst { getPostTypes } = select( coreStore );\r\n\t\tconst excludedPostTypes = [ 'attachment' ];\r\n\t\tconst filteredPostTypes = getPostTypes( { per_page: -1 } )?.filter(\r\n\t\t\t( { viewable, slug } ) =>\r\n\t\t\t\tviewable && ! excludedPostTypes.includes( slug )\r\n\t\t);\r\n\t\treturn filteredPostTypes;\r\n\t}, [] );\r\n\tconst postTypesTaxonomiesMap = useMemo( () => {\r\n\t\tif ( ! postTypes?.length ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\treturn postTypes.reduce( ( accumulator, type ) => {\r\n\t\t\taccumulator[ type.slug ] = type.taxonomies;\r\n\t\t\treturn accumulator;\r\n\t\t}, {} );\r\n\t}, [ postTypes ] );\r\n\tconst postTypesSelectOptions = useMemo(\r\n\t\t() =>\r\n\t\t\t( postTypes || [] ).map( ( { labels, slug } ) => ( {\r\n\t\t\t\tlabel: labels.singular_name,\r\n\t\t\t\tvalue: slug,\r\n\t\t\t} ) ),\r\n\t\t[ postTypes ]\r\n\t);\r\n\treturn { postTypesTaxonomiesMap, postTypesSelectOptions };\r\n};\r\n\r\n/**\r\n * Hook that returns the taxonomies associated with a specific post type.\r\n *\r\n * @param {string} postType The post type from which to retrieve the associated taxonomies.\r\n * @return {Object[]} An array of the associated taxonomies.\r\n */\r\nexport const useTaxonomies = ( postType ) => {\r\n\tconst taxonomies = useSelect(\r\n\t\t( select ) => {\r\n\t\t\tconst { getTaxonomies, getPostType } = select( coreStore );\r\n\t\t\t// Does the post type have taxonomies?\r\n\t\t\tif ( getPostType( postType )?.taxonomies?.length > 0 ) {\r\n\t\t\t\treturn getTaxonomies( {\r\n\t\t\t\t\ttype: postType,\r\n\t\t\t\t\tper_page: -1,\r\n\t\t\t\t} );\r\n\t\t\t}\r\n\t\t\treturn [];\r\n\t\t},\r\n\t\t[ postType ]\r\n\t);\r\n\treturn useMemo( () => {\r\n\t\treturn taxonomies?.filter(\r\n\t\t\t( { visibility } ) => !! visibility?.publicly_queryable\r\n\t\t);\r\n\t}, [ taxonomies ] );\r\n};\r\n\r\n/**\r\n * Hook that returns whether a specific post type is hierarchical.\r\n *\r\n * @param {string} postType The post type to check.\r\n * @return {boolean} Whether a specific post type is hierarchical.\r\n */\r\nexport function useIsPostTypeHierarchical( postType ) {\r\n\treturn useSelect(\r\n\t\t( select ) => {\r\n\t\t\tconst type = select( coreStore ).getPostType( postType );\r\n\t\t\treturn type?.viewable && type?.hierarchical;\r\n\t\t},\r\n\t\t[ postType ]\r\n\t);\r\n}\r\n\r\n/**\r\n * Hook that returns the query properties' names defined by the active\r\n * block variation, to determine which block's filters to show.\r\n *\r\n * @param {Object} attributes Block attributes.\r\n * @return {string[]} An array of the query attributes.\r\n */\r\nexport function useAllowedControls( attributes ) {\r\n\treturn useSelect(\r\n\t\t( select ) =>\r\n\t\t\tselect( blocksStore ).getActiveBlockVariation(\r\n\t\t\t\t'core/query',\r\n\t\t\t\tattributes\r\n\t\t\t)?.allowedControls,\r\n\r\n\t\t[ attributes ]\r\n\t);\r\n}\r\nexport function isControlAllowed( allowedControls, key ) {\r\n\t// Every controls is allowed if the list is not defined.\r\n\tif ( ! allowedControls ) {\r\n\t\treturn true;\r\n\t}\r\n\treturn allowedControls.includes( key );\r\n}\r\n\r\n/**\r\n * Clones a pattern's blocks and then recurses over that list of blocks,\r\n * transforming them to retain some `query` attribute properties.\r\n * For now we retain the `postType` and `inherit` properties as they are\r\n * fundamental for the expected functionality of the block and don't affect\r\n * its design and presentation.\r\n *\r\n * Returns the cloned/transformed blocks and array of existing Query Loop\r\n * client ids for further manipulation, in order to avoid multiple recursions.\r\n *\r\n * @param {WPBlock[]}        blocks               The list of blocks to look through and transform(mutate).\r\n * @param {Record<string,*>} queryBlockAttributes The existing Query Loop's attributes.\r\n * @return {{ newBlocks: WPBlock[], queryClientIds: string[] }} An object with the cloned/transformed blocks and all the Query Loop clients from these blocks.\r\n */\r\nexport const getTransformedBlocksFromPattern = (\r\n\tblocks,\r\n\tqueryBlockAttributes\r\n) => {\r\n\tconst {\r\n\t\tquery: { postType, inherit },\r\n\t\tnamespace,\r\n\t} = queryBlockAttributes;\r\n\tconst clonedBlocks = blocks.map( ( block ) => cloneBlock( block ) );\r\n\tconst queryClientIds = [];\r\n\tconst blocksQueue = [ ...clonedBlocks ];\r\n\twhile ( blocksQueue.length > 0 ) {\r\n\t\tconst block = blocksQueue.shift();\r\n\t\tif ( block.name === 'core/query' ) {\r\n\t\t\tblock.attributes.query = {\r\n\t\t\t\t...block.attributes.query,\r\n\t\t\t\tpostType,\r\n\t\t\t\tinherit,\r\n\t\t\t};\r\n\t\t\tif ( namespace ) {\r\n\t\t\t\tblock.attributes.namespace = namespace;\r\n\t\t\t}\r\n\t\t\tqueryClientIds.push( block.clientId );\r\n\t\t}\r\n\t\tblock.innerBlocks?.forEach( ( innerBlock ) => {\r\n\t\t\tblocksQueue.push( innerBlock );\r\n\t\t} );\r\n\t}\r\n\treturn { newBlocks: clonedBlocks, queryClientIds };\r\n};\r\n\r\n/**\r\n * Helper hook that determines if there is an active variation of the block\r\n * and if there are available specific patterns for this variation.\r\n * If there are, these patterns are going to be the only ones suggested to\r\n * the user in setup and replace flow, without including the default ones\r\n * for Query Loop.\r\n *\r\n * If there are no such patterns, the default ones for Query Loop are going\r\n * to be suggested.\r\n *\r\n * @param {string} clientId   The block's client ID.\r\n * @param {Object} attributes The block's attributes.\r\n * @return {string} The block name to be used in the patterns suggestions.\r\n */\r\nexport function useBlockNameForPatterns( clientId, attributes ) {\r\n\tconst activeVariationName = useSelect(\r\n\t\t( select ) =>\r\n\t\t\tselect( blocksStore ).getActiveBlockVariation(\r\n\t\t\t\t'core/query',\r\n\t\t\t\tattributes\r\n\t\t\t)?.name,\r\n\t\t[ attributes ]\r\n\t);\r\n\tconst blockName = `core/query/${ activeVariationName }`;\r\n\tconst hasActiveVariationPatterns = useSelect(\r\n\t\t( select ) => {\r\n\t\t\tif ( ! activeVariationName ) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tconst { getBlockRootClientId, getPatternsByBlockTypes } =\r\n\t\t\t\tselect( blockEditorStore );\r\n\t\t\tconst rootClientId = getBlockRootClientId( clientId );\r\n\t\t\tconst activePatterns = getPatternsByBlockTypes(\r\n\t\t\t\tblockName,\r\n\t\t\t\trootClientId\r\n\t\t\t);\r\n\t\t\treturn activePatterns.length > 0;\r\n\t\t},\r\n\t\t[ clientId, activeVariationName, blockName ]\r\n\t);\r\n\treturn hasActiveVariationPatterns ? blockName : 'core/query';\r\n}\r\n\r\n/**\r\n * Helper hook that determines if there is an active variation of the block\r\n * and if there are available specific scoped `block` variations connected with\r\n * this variation.\r\n *\r\n * If there are, these variations are going to be the only ones suggested\r\n * to the user in setup flow when clicking to `start blank`, without including\r\n * the default ones for Query Loop.\r\n *\r\n * If there are no such scoped `block` variations, the default ones for Query\r\n * Loop are going to be suggested.\r\n *\r\n * The way we determine such variations is with the convention that they have the `namespace`\r\n * attribute defined as an array. This array should contain the names(`name` property) of any\r\n * variations they want to be connected to.\r\n * For example, if we have a `Query Loop` scoped `inserter` variation with the name `products`,\r\n * we can connect a scoped `block` variation by setting its `namespace` attribute to `['products']`.\r\n * If the user selects this variation, the `namespace` attribute will be overridden by the\r\n * main `inserter` variation.\r\n *\r\n * @param {Object} attributes The block's attributes.\r\n * @return {WPBlockVariation[]} The block variations to be suggested in setup flow, when clicking to `start blank`.\r\n */\r\nexport function useScopedBlockVariations( attributes ) {\r\n\tconst { activeVariationName, blockVariations } = useSelect(\r\n\t\t( select ) => {\r\n\t\t\tconst { getActiveBlockVariation, getBlockVariations } =\r\n\t\t\t\tselect( blocksStore );\r\n\t\t\treturn {\r\n\t\t\t\tactiveVariationName: getActiveBlockVariation(\r\n\t\t\t\t\t'core/query',\r\n\t\t\t\t\tattributes\r\n\t\t\t\t)?.name,\r\n\t\t\t\tblockVariations: getBlockVariations( 'core/query', 'block' ),\r\n\t\t\t};\r\n\t\t},\r\n\t\t[ attributes ]\r\n\t);\r\n\tconst variations = useMemo( () => {\r\n\t\t// Filter out the variations that have defined a `namespace` attribute,\r\n\t\t// which means they are 'connected' to specific variations of the block.\r\n\t\tconst isNotConnected = ( variation ) =>\r\n\t\t\t! variation.attributes?.namespace;\r\n\t\tif ( ! activeVariationName ) {\r\n\t\t\treturn blockVariations.filter( isNotConnected );\r\n\t\t}\r\n\t\tconst connectedVariations = blockVariations.filter( ( variation ) =>\r\n\t\t\tvariation.attributes?.namespace?.includes( activeVariationName )\r\n\t\t);\r\n\t\tif ( !! connectedVariations.length ) {\r\n\t\t\treturn connectedVariations;\r\n\t\t}\r\n\t\treturn blockVariations.filter( isNotConnected );\r\n\t}, [ activeVariationName, blockVariations ] );\r\n\treturn variations;\r\n}\r\n\r\n/**\r\n * Hook that returns the block patterns for a specific block type.\r\n *\r\n * @param {string} clientId The block's client ID.\r\n * @param {string} name     The block type name.\r\n * @return {Object[]} An array of valid block patterns.\r\n */\r\nexport const usePatterns = ( clientId, name ) => {\r\n\treturn useSelect(\r\n\t\t( select ) => {\r\n\t\t\tconst { getBlockRootClientId, getPatternsByBlockTypes } =\r\n\t\t\t\tselect( blockEditorStore );\r\n\t\t\tconst rootClientId = getBlockRootClientId( clientId );\r\n\t\t\treturn getPatternsByBlockTypes( name, rootClientId );\r\n\t\t},\r\n\t\t[ name, clientId ]\r\n\t);\r\n};\r\n\r\n/**\r\n * The object returned by useUnsupportedBlocks with info about the type of\r\n * unsupported blocks present inside the Query block.\r\n *\r\n * @typedef  {Object}  UnsupportedBlocksInfo\r\n * @property {boolean} hasBlocksFromPlugins True if blocks from plugins are present.\r\n * @property {boolean} hasPostContentBlock  True if a 'core/post-content' block is present.\r\n * @property {boolean} hasUnsupportedBlocks True if there are any unsupported blocks.\r\n */\r\n\r\n/**\r\n * Hook that returns an object with information about the unsupported blocks\r\n * present inside a Query Loop with the given `clientId`. The returned object\r\n * contains props that are true when a certain type of unsupported block is\r\n * present.\r\n *\r\n * @param {string} clientId The block's client ID.\r\n * @return {UnsupportedBlocksInfo} The object containing the information.\r\n */\r\nexport const useUnsupportedBlocks = ( clientId ) => {\r\n\treturn useSelect(\r\n\t\t( select ) => {\r\n\t\t\tconst { getClientIdsOfDescendants, getBlockName } =\r\n\t\t\t\tselect( blockEditorStore );\r\n\t\t\tconst blocks = {};\r\n\t\t\tgetClientIdsOfDescendants( clientId ).forEach(\r\n\t\t\t\t( descendantClientId ) => {\r\n\t\t\t\t\tconst blockName = getBlockName( descendantClientId );\r\n\t\t\t\t\t/*\r\n\t\t\t\t\t * Client side navigation can be true in two states:\r\n\t\t\t\t\t *  - supports.interactivity = true;\r\n\t\t\t\t\t *  - supports.interactivity.clientNavigation = true;\r\n\t\t\t\t\t */\r\n\t\t\t\t\tconst blockSupportsInteractivity = Object.is(\r\n\t\t\t\t\t\tgetBlockSupport( blockName, 'interactivity' ),\r\n\t\t\t\t\t\ttrue\r\n\t\t\t\t\t);\r\n\t\t\t\t\tconst blockSupportsInteractivityClientNavigation =\r\n\t\t\t\t\t\tgetBlockSupport(\r\n\t\t\t\t\t\t\tblockName,\r\n\t\t\t\t\t\t\t'interactivity.clientNavigation'\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\tconst blockInteractivity =\r\n\t\t\t\t\t\tblockSupportsInteractivity ||\r\n\t\t\t\t\t\tblockSupportsInteractivityClientNavigation;\r\n\t\t\t\t\tif ( ! blockInteractivity ) {\r\n\t\t\t\t\t\tblocks.hasBlocksFromPlugins = true;\r\n\t\t\t\t\t} else if ( blockName === 'core/post-content' ) {\r\n\t\t\t\t\t\tblocks.hasPostContentBlock = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t\tblocks.hasUnsupportedBlocks =\r\n\t\t\t\tblocks.hasBlocksFromPlugins || blocks.hasPostContentBlock;\r\n\t\t\treturn blocks;\r\n\t\t},\r\n\t\t[ clientId ]\r\n\t);\r\n};\r\n"],"mappings":"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","ignoreList":[]}