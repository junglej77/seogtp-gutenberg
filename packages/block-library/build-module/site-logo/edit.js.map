{"version":3,"names":["clsx","isBlobURL","createInterpolateElement","useEffect","useState","__","isRTL","PanelBody","RangeControl","ResizableBox","Spinner","ToggleControl","ToolbarButton","Placeholder","Button","DropZone","FlexItem","__experimentalItemGroup","ItemGroup","__experimentalHStack","HStack","__experimentalTruncate","Truncate","useViewportMatch","BlockControls","InspectorControls","MediaPlaceholder","MediaUpload","MediaUploadCheck","MediaReplaceFlow","useBlockProps","store","blockEditorStore","__experimentalImageEditor","ImageEditor","useSelect","useDispatch","coreStore","crop","upload","noticesStore","MIN_SIZE","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","ALLOWED_MEDIA_TYPES","ACCEPT_MEDIA_STRING","SiteLogo","alt","attributes","align","width","height","isLink","linkTarget","shouldSyncIcon","isSelected","setAttributes","setLogo","logoUrl","siteUrl","logoId","iconId","setIcon","canUserEdit","isLargeViewport","isWideAligned","includes","isResizable","naturalWidth","naturalHeight","setNaturalSize","isEditingImage","setIsEditingImage","toggleSelection","imageEditing","maxWidth","title","select","settings","getSettings","siteEntities","getEntityRecord","name","onResizeStart","onResizeStop","img","children","className","src","onLoad","event","target","imgWrapper","href","rel","onClick","preventDefault","style","defaultWidth","currentWidth","ratio","currentHeight","minWidth","Math","ceil","minHeight","maxWidthBuffer","showRightHandle","showLeftHandle","canEditImage","imgEdit","id","url","onSaveImage","imageAttributes","onFinishEditing","size","showHandle","maxHeight","lockAspectRatio","enable","top","right","bottom","left","direction","elt","delta","parseInt","shouldUseNewUrl","window","__experimentalUseCustomizerSiteLogoUrl","siteIconSettingsUrl","syncSiteIconHelpText","a","__nextHasNoMarginBottom","__next40pxDefaultSize","label","onChange","newWidth","min","max","initialPosition","value","disabled","checked","undefined","help","group","icon","SiteLogoReplaceFlow","mediaURL","onRemoveLogo","mediaReplaceProps","allowedTypes","accept","onReset","InspectorLogoPreview","mediaItemData","itemGroupProps","alt_text","source_url","slug","logoSlug","media_details","logoMediaDetails","logoLabel","sizes","full","file","as","justify","numberOfLines","LogoEdit","siteLogoId","siteIconId","isRequestingMediaItem","canUser","getEditedEntityRecord","_canUserEdit","kind","siteSettings","siteData","_siteLogoId","site_logo","_siteIconId","site_icon","mediaItem","getMedia","context","_isRequestingMediaItem","hasFinishedResolution","home","temporaryURL","setTemporaryURL","editEntityRecord","newValue","shouldForceSync","onInitialSelectLogo","media","onSelectLogo","createErrorNotice","onUploadError","message","type","onFilesDrop","filesList","mediaUpload","onFileChange","image","onError","mediaReplaceFlowProps","onSelect","controls","logoImage","isLoading","placeholder","content","placeholderClassName","preview","withIllustration","classes","blockProps","mediaInspectorPanel","isBordered","popoverProps","render","open","variant","mediaLibraryButton","showTooltip","tooltipPosition"],"sources":["@wordpress/block-library/src/site-logo/edit.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport clsx from 'clsx';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { isBlobURL } from '@wordpress/blob';\r\nimport {\r\n\tcreateInterpolateElement,\r\n\tuseEffect,\r\n\tuseState,\r\n} from '@wordpress/element';\r\nimport { __, isRTL } from '@wordpress/i18n';\r\nimport {\r\n\tPanelBody,\r\n\tRangeControl,\r\n\tResizableBox,\r\n\tSpinner,\r\n\tToggleControl,\r\n\tToolbarButton,\r\n\tPlaceholder,\r\n\tButton,\r\n\tDropZone,\r\n\tFlexItem,\r\n\t__experimentalItemGroup as ItemGroup,\r\n\t__experimentalHStack as HStack,\r\n\t__experimentalTruncate as Truncate,\r\n} from '@wordpress/components';\r\nimport { useViewportMatch } from '@wordpress/compose';\r\nimport {\r\n\tBlockControls,\r\n\tInspectorControls,\r\n\tMediaPlaceholder,\r\n\tMediaUpload,\r\n\tMediaUploadCheck,\r\n\tMediaReplaceFlow,\r\n\tuseBlockProps,\r\n\tstore as blockEditorStore,\r\n\t__experimentalImageEditor as ImageEditor,\r\n} from '@wordpress/block-editor';\r\nimport { useSelect, useDispatch } from '@wordpress/data';\r\nimport { store as coreStore } from '@wordpress/core-data';\r\nimport { crop, upload } from '@wordpress/icons';\r\nimport { store as noticesStore } from '@wordpress/notices';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { MIN_SIZE } from '../image/constants';\r\n\r\nconst ALLOWED_MEDIA_TYPES = [ 'image' ];\r\nconst ACCEPT_MEDIA_STRING = 'image/*';\r\n\r\nconst SiteLogo = ( {\r\n\talt,\r\n\tattributes: { align, width, height, isLink, linkTarget, shouldSyncIcon },\r\n\tisSelected,\r\n\tsetAttributes,\r\n\tsetLogo,\r\n\tlogoUrl,\r\n\tsiteUrl,\r\n\tlogoId,\r\n\ticonId,\r\n\tsetIcon,\r\n\tcanUserEdit,\r\n} ) => {\r\n\tconst isLargeViewport = useViewportMatch( 'medium' );\r\n\tconst isWideAligned = [ 'wide', 'full' ].includes( align );\r\n\tconst isResizable = ! isWideAligned && isLargeViewport;\r\n\tconst [ { naturalWidth, naturalHeight }, setNaturalSize ] = useState( {} );\r\n\tconst [ isEditingImage, setIsEditingImage ] = useState( false );\r\n\tconst { toggleSelection } = useDispatch( blockEditorStore );\r\n\tconst { imageEditing, maxWidth, title } = useSelect( ( select ) => {\r\n\t\tconst settings = select( blockEditorStore ).getSettings();\r\n\t\tconst siteEntities = select( coreStore ).getEntityRecord(\r\n\t\t\t'root',\r\n\t\t\t'__unstableBase'\r\n\t\t);\r\n\t\treturn {\r\n\t\t\ttitle: siteEntities?.name,\r\n\t\t\timageEditing: settings.imageEditing,\r\n\t\t\tmaxWidth: settings.maxWidth,\r\n\t\t};\r\n\t}, [] );\r\n\r\n\tuseEffect( () => {\r\n\t\t// Turn the `Use as site icon` toggle off if it is on but the logo and icon have\r\n\t\t// fallen out of sync. This can happen if the toggle is saved in the `on` position,\r\n\t\t// but changes are later made to the site icon in the Customizer.\r\n\t\tif ( shouldSyncIcon && logoId !== iconId ) {\r\n\t\t\tsetAttributes( { shouldSyncIcon: false } );\r\n\t\t}\r\n\t}, [] );\r\n\r\n\tuseEffect( () => {\r\n\t\tif ( ! isSelected ) {\r\n\t\t\tsetIsEditingImage( false );\r\n\t\t}\r\n\t}, [ isSelected ] );\r\n\r\n\tfunction onResizeStart() {\r\n\t\ttoggleSelection( false );\r\n\t}\r\n\r\n\tfunction onResizeStop() {\r\n\t\ttoggleSelection( true );\r\n\t}\r\n\r\n\tconst img = (\r\n\t\t<>\r\n\t\t\t<img\r\n\t\t\t\tclassName=\"custom-logo\"\r\n\t\t\t\tsrc={ logoUrl }\r\n\t\t\t\talt={ alt }\r\n\t\t\t\tonLoad={ ( event ) => {\r\n\t\t\t\t\tsetNaturalSize( {\r\n\t\t\t\t\t\tnaturalWidth: event.target.naturalWidth,\r\n\t\t\t\t\t\tnaturalHeight: event.target.naturalHeight,\r\n\t\t\t\t\t} );\r\n\t\t\t\t} }\r\n\t\t\t/>\r\n\t\t\t{ isBlobURL( logoUrl ) && <Spinner /> }\r\n\t\t</>\r\n\t);\r\n\r\n\tlet imgWrapper = img;\r\n\r\n\t// Disable reason: Image itself is not meant to be interactive, but\r\n\t// should direct focus to block.\r\n\tif ( isLink ) {\r\n\t\timgWrapper = (\r\n\t\t\t/* eslint-disable jsx-a11y/no-noninteractive-element-interactions, jsx-a11y/click-events-have-key-events */\r\n\t\t\t<a\r\n\t\t\t\thref={ siteUrl }\r\n\t\t\t\tclassName=\"custom-logo-link\"\r\n\t\t\t\trel=\"home\"\r\n\t\t\t\ttitle={ title }\r\n\t\t\t\tonClick={ ( event ) => event.preventDefault() }\r\n\t\t\t>\r\n\t\t\t\t{ img }\r\n\t\t\t</a>\r\n\t\t\t/* eslint-enable jsx-a11y/no-noninteractive-element-interactions, jsx-a11y/click-events-have-key-events */\r\n\t\t);\r\n\t}\r\n\r\n\tif ( ! isResizable || ! naturalWidth || ! naturalHeight ) {\r\n\t\treturn <div style={ { width, height } }>{ imgWrapper }</div>;\r\n\t}\r\n\r\n\t// Set the default width to a responsible size.\r\n\t// Note that this width is also set in the attached frontend CSS file.\r\n\tconst defaultWidth = 120;\r\n\r\n\tconst currentWidth = width || defaultWidth;\r\n\tconst ratio = naturalWidth / naturalHeight;\r\n\tconst currentHeight = currentWidth / ratio;\r\n\tconst minWidth =\r\n\t\tnaturalWidth < naturalHeight ? MIN_SIZE : Math.ceil( MIN_SIZE * ratio );\r\n\tconst minHeight =\r\n\t\tnaturalHeight < naturalWidth ? MIN_SIZE : Math.ceil( MIN_SIZE / ratio );\r\n\r\n\t// With the current implementation of ResizableBox, an image needs an\r\n\t// explicit pixel value for the max-width. In absence of being able to\r\n\t// set the content-width, this max-width is currently dictated by the\r\n\t// vanilla editor style. The following variable adds a buffer to this\r\n\t// vanilla style, so 3rd party themes have some wiggleroom. This does,\r\n\t// in most cases, allow you to scale the image beyond the width of the\r\n\t// main column, though not infinitely.\r\n\t// @todo It would be good to revisit this once a content-width variable\r\n\t// becomes available.\r\n\tconst maxWidthBuffer = maxWidth * 2.5;\r\n\r\n\tlet showRightHandle = false;\r\n\tlet showLeftHandle = false;\r\n\r\n\t/* eslint-disable no-lonely-if */\r\n\t// See https://github.com/WordPress/gutenberg/issues/7584.\r\n\tif ( align === 'center' ) {\r\n\t\t// When the image is centered, show both handles.\r\n\t\tshowRightHandle = true;\r\n\t\tshowLeftHandle = true;\r\n\t} else if ( isRTL() ) {\r\n\t\t// In RTL mode the image is on the right by default.\r\n\t\t// Show the right handle and hide the left handle only when it is\r\n\t\t// aligned left. Otherwise always show the left handle.\r\n\t\tif ( align === 'left' ) {\r\n\t\t\tshowRightHandle = true;\r\n\t\t} else {\r\n\t\t\tshowLeftHandle = true;\r\n\t\t}\r\n\t} else {\r\n\t\t// Show the left handle and hide the right handle only when the\r\n\t\t// image is aligned right. Otherwise always show the right handle.\r\n\t\tif ( align === 'right' ) {\r\n\t\t\tshowLeftHandle = true;\r\n\t\t} else {\r\n\t\t\tshowRightHandle = true;\r\n\t\t}\r\n\t}\r\n\t/* eslint-enable no-lonely-if */\r\n\r\n\tconst canEditImage =\r\n\t\tlogoId && naturalWidth && naturalHeight && imageEditing;\r\n\r\n\tconst imgEdit =\r\n\t\tcanEditImage && isEditingImage ? (\r\n\t\t\t<ImageEditor\r\n\t\t\t\tid={ logoId }\r\n\t\t\t\turl={ logoUrl }\r\n\t\t\t\twidth={ currentWidth }\r\n\t\t\t\theight={ currentHeight }\r\n\t\t\t\tnaturalHeight={ naturalHeight }\r\n\t\t\t\tnaturalWidth={ naturalWidth }\r\n\t\t\t\tonSaveImage={ ( imageAttributes ) => {\r\n\t\t\t\t\tsetLogo( imageAttributes.id );\r\n\t\t\t\t} }\r\n\t\t\t\tonFinishEditing={ () => {\r\n\t\t\t\t\tsetIsEditingImage( false );\r\n\t\t\t\t} }\r\n\t\t\t/>\r\n\t\t) : (\r\n\t\t\t<ResizableBox\r\n\t\t\t\tsize={ {\r\n\t\t\t\t\twidth: currentWidth,\r\n\t\t\t\t\theight: currentHeight,\r\n\t\t\t\t} }\r\n\t\t\t\tshowHandle={ isSelected }\r\n\t\t\t\tminWidth={ minWidth }\r\n\t\t\t\tmaxWidth={ maxWidthBuffer }\r\n\t\t\t\tminHeight={ minHeight }\r\n\t\t\t\tmaxHeight={ maxWidthBuffer / ratio }\r\n\t\t\t\tlockAspectRatio\r\n\t\t\t\tenable={ {\r\n\t\t\t\t\ttop: false,\r\n\t\t\t\t\tright: showRightHandle,\r\n\t\t\t\t\tbottom: true,\r\n\t\t\t\t\tleft: showLeftHandle,\r\n\t\t\t\t} }\r\n\t\t\t\tonResizeStart={ onResizeStart }\r\n\t\t\t\tonResizeStop={ ( event, direction, elt, delta ) => {\r\n\t\t\t\t\tonResizeStop();\r\n\t\t\t\t\tsetAttributes( {\r\n\t\t\t\t\t\twidth: parseInt( currentWidth + delta.width, 10 ),\r\n\t\t\t\t\t\theight: parseInt( currentHeight + delta.height, 10 ),\r\n\t\t\t\t\t} );\r\n\t\t\t\t} }\r\n\t\t\t>\r\n\t\t\t\t{ imgWrapper }\r\n\t\t\t</ResizableBox>\r\n\t\t);\r\n\r\n\t// Support the previous location for the Site Icon settings. To be removed\r\n\t// when the required WP core version for Gutenberg is >= 6.5.0.\r\n\tconst shouldUseNewUrl = ! window?.__experimentalUseCustomizerSiteLogoUrl;\r\n\r\n\tconst siteIconSettingsUrl = shouldUseNewUrl\r\n\t\t? siteUrl + '/wp-admin/options-general.php'\r\n\t\t: siteUrl + '/wp-admin/customize.php?autofocus[section]=title_tagline';\r\n\r\n\tconst syncSiteIconHelpText = createInterpolateElement(\r\n\t\t__(\r\n\t\t\t'Site Icons are what you see in browser tabs, bookmark bars, and within the WordPress mobile apps. To use a custom icon that is different from your site logo, use the <a>Site Icon settings</a>.'\r\n\t\t),\r\n\t\t{\r\n\t\t\ta: (\r\n\t\t\t\t// eslint-disable-next-line jsx-a11y/anchor-has-content\r\n\t\t\t\t<a\r\n\t\t\t\t\thref={ siteIconSettingsUrl }\r\n\t\t\t\t\ttarget=\"_blank\"\r\n\t\t\t\t\trel=\"noopener noreferrer\"\r\n\t\t\t\t/>\r\n\t\t\t),\r\n\t\t}\r\n\t);\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<InspectorControls>\r\n\t\t\t\t<PanelBody title={ __( 'Settings' ) }>\r\n\t\t\t\t\t<RangeControl\r\n\t\t\t\t\t\t__nextHasNoMarginBottom\r\n\t\t\t\t\t\t__next40pxDefaultSize\r\n\t\t\t\t\t\tlabel={ __( 'Image width' ) }\r\n\t\t\t\t\t\tonChange={ ( newWidth ) =>\r\n\t\t\t\t\t\t\tsetAttributes( { width: newWidth } )\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tmin={ minWidth }\r\n\t\t\t\t\t\tmax={ maxWidthBuffer }\r\n\t\t\t\t\t\tinitialPosition={ Math.min(\r\n\t\t\t\t\t\t\tdefaultWidth,\r\n\t\t\t\t\t\t\tmaxWidthBuffer\r\n\t\t\t\t\t\t) }\r\n\t\t\t\t\t\tvalue={ width || '' }\r\n\t\t\t\t\t\tdisabled={ ! isResizable }\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<ToggleControl\r\n\t\t\t\t\t\t__nextHasNoMarginBottom\r\n\t\t\t\t\t\tlabel={ __( 'Link image to home' ) }\r\n\t\t\t\t\t\tonChange={ () => setAttributes( { isLink: ! isLink } ) }\r\n\t\t\t\t\t\tchecked={ isLink }\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t{ isLink && (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<ToggleControl\r\n\t\t\t\t\t\t\t\t__nextHasNoMarginBottom\r\n\t\t\t\t\t\t\t\tlabel={ __( 'Open in new tab' ) }\r\n\t\t\t\t\t\t\t\tonChange={ ( value ) =>\r\n\t\t\t\t\t\t\t\t\tsetAttributes( {\r\n\t\t\t\t\t\t\t\t\t\tlinkTarget: value ? '_blank' : '_self',\r\n\t\t\t\t\t\t\t\t\t} )\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tchecked={ linkTarget === '_blank' }\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t) }\r\n\t\t\t\t\t{ canUserEdit && (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<ToggleControl\r\n\t\t\t\t\t\t\t\t__nextHasNoMarginBottom\r\n\t\t\t\t\t\t\t\tlabel={ __( 'Use as Site Icon' ) }\r\n\t\t\t\t\t\t\t\tonChange={ ( value ) => {\r\n\t\t\t\t\t\t\t\t\tsetAttributes( { shouldSyncIcon: value } );\r\n\t\t\t\t\t\t\t\t\tsetIcon( value ? logoId : undefined );\r\n\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t\tchecked={ !! shouldSyncIcon }\r\n\t\t\t\t\t\t\t\thelp={ syncSiteIconHelpText }\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t) }\r\n\t\t\t\t</PanelBody>\r\n\t\t\t</InspectorControls>\r\n\t\t\t<BlockControls group=\"block\">\r\n\t\t\t\t{ canEditImage && ! isEditingImage && (\r\n\t\t\t\t\t<ToolbarButton\r\n\t\t\t\t\t\tonClick={ () => setIsEditingImage( true ) }\r\n\t\t\t\t\t\ticon={ crop }\r\n\t\t\t\t\t\tlabel={ __( 'Crop' ) }\r\n\t\t\t\t\t/>\r\n\t\t\t\t) }\r\n\t\t\t</BlockControls>\r\n\t\t\t{ imgEdit }\r\n\t\t</>\r\n\t);\r\n};\r\n\r\n// This is a light wrapper around MediaReplaceFlow because the block has two\r\n// different MediaReplaceFlows, one for the inspector and one for the toolbar.\r\nfunction SiteLogoReplaceFlow( {\r\n\tmediaURL,\r\n\tonRemoveLogo,\r\n\t...mediaReplaceProps\r\n} ) {\r\n\treturn (\r\n\t\t<MediaReplaceFlow\r\n\t\t\t{ ...mediaReplaceProps }\r\n\t\t\tmediaURL={ mediaURL }\r\n\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\r\n\t\t\taccept={ ACCEPT_MEDIA_STRING }\r\n\t\t\tonReset={ onRemoveLogo }\r\n\t\t/>\r\n\t);\r\n}\r\n\r\nconst InspectorLogoPreview = ( { mediaItemData = {}, itemGroupProps } ) => {\r\n\tconst {\r\n\t\talt_text: alt,\r\n\t\tsource_url: logoUrl,\r\n\t\tslug: logoSlug,\r\n\t\tmedia_details: logoMediaDetails,\r\n\t} = mediaItemData;\r\n\tconst logoLabel = logoMediaDetails?.sizes?.full?.file || logoSlug;\r\n\treturn (\r\n\t\t<ItemGroup { ...itemGroupProps } as=\"span\">\r\n\t\t\t<HStack justify=\"flex-start\" as=\"span\">\r\n\t\t\t\t<img src={ logoUrl } alt={ alt } />\r\n\t\t\t\t<FlexItem as=\"span\">\r\n\t\t\t\t\t<Truncate\r\n\t\t\t\t\t\tnumberOfLines={ 1 }\r\n\t\t\t\t\t\tclassName=\"block-library-site-logo__inspector-media-replace-title\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{ logoLabel }\r\n\t\t\t\t\t</Truncate>\r\n\t\t\t\t</FlexItem>\r\n\t\t\t</HStack>\r\n\t\t</ItemGroup>\r\n\t);\r\n};\r\n\r\nexport default function LogoEdit( {\r\n\tattributes,\r\n\tclassName,\r\n\tsetAttributes,\r\n\tisSelected,\r\n} ) {\r\n\tconst { width, shouldSyncIcon } = attributes;\r\n\tconst {\r\n\t\tsiteLogoId,\r\n\t\tcanUserEdit,\r\n\t\turl,\r\n\t\tsiteIconId,\r\n\t\tmediaItemData,\r\n\t\tisRequestingMediaItem,\r\n\t} = useSelect( ( select ) => {\r\n\t\tconst { canUser, getEntityRecord, getEditedEntityRecord } =\r\n\t\t\tselect( coreStore );\r\n\t\tconst _canUserEdit = canUser( 'update', {\r\n\t\t\tkind: 'root',\r\n\t\t\tname: 'site',\r\n\t\t} );\r\n\t\tconst siteSettings = _canUserEdit\r\n\t\t\t? getEditedEntityRecord( 'root', 'site' )\r\n\t\t\t: undefined;\r\n\t\tconst siteData = getEntityRecord( 'root', '__unstableBase' );\r\n\t\tconst _siteLogoId = _canUserEdit\r\n\t\t\t? siteSettings?.site_logo\r\n\t\t\t: siteData?.site_logo;\r\n\t\tconst _siteIconId = siteSettings?.site_icon;\r\n\t\tconst mediaItem =\r\n\t\t\t_siteLogoId &&\r\n\t\t\tselect( coreStore ).getMedia( _siteLogoId, {\r\n\t\t\t\tcontext: 'view',\r\n\t\t\t} );\r\n\t\tconst _isRequestingMediaItem =\r\n\t\t\t!! _siteLogoId &&\r\n\t\t\t! select( coreStore ).hasFinishedResolution( 'getMedia', [\r\n\t\t\t\t_siteLogoId,\r\n\t\t\t\t{ context: 'view' },\r\n\t\t\t] );\r\n\r\n\t\treturn {\r\n\t\t\tsiteLogoId: _siteLogoId,\r\n\t\t\tcanUserEdit: _canUserEdit,\r\n\t\t\turl: siteData?.home,\r\n\t\t\tmediaItemData: mediaItem,\r\n\t\t\tisRequestingMediaItem: _isRequestingMediaItem,\r\n\t\t\tsiteIconId: _siteIconId,\r\n\t\t};\r\n\t}, [] );\r\n\tconst { getSettings } = useSelect( blockEditorStore );\r\n\tconst [ temporaryURL, setTemporaryURL ] = useState();\r\n\r\n\tconst { editEntityRecord } = useDispatch( coreStore );\r\n\r\n\tconst setLogo = ( newValue, shouldForceSync = false ) => {\r\n\t\t// `shouldForceSync` is used to force syncing when the attribute\r\n\t\t// may not have updated yet.\r\n\t\tif ( shouldSyncIcon || shouldForceSync ) {\r\n\t\t\tsetIcon( newValue );\r\n\t\t}\r\n\r\n\t\teditEntityRecord( 'root', 'site', undefined, {\r\n\t\t\tsite_logo: newValue,\r\n\t\t} );\r\n\t};\r\n\r\n\tconst setIcon = ( newValue ) =>\r\n\t\t// The new value needs to be `null` to reset the Site Icon.\r\n\t\teditEntityRecord( 'root', 'site', undefined, {\r\n\t\t\tsite_icon: newValue ?? null,\r\n\t\t} );\r\n\r\n\tconst { alt_text: alt, source_url: logoUrl } = mediaItemData ?? {};\r\n\r\n\tconst onInitialSelectLogo = ( media ) => {\r\n\t\t// Initialize the syncSiteIcon toggle. If we currently have no Site logo and no\r\n\t\t// site icon, automatically sync the logo to the icon.\r\n\t\tif ( shouldSyncIcon === undefined ) {\r\n\t\t\tconst shouldForceSync = ! siteIconId;\r\n\t\t\tsetAttributes( { shouldSyncIcon: shouldForceSync } );\r\n\r\n\t\t\t// Because we cannot rely on the `shouldSyncIcon` attribute to have updated by\r\n\t\t\t// the time `setLogo` is called, pass an argument to force the syncing.\r\n\t\t\tonSelectLogo( media, shouldForceSync );\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tonSelectLogo( media );\r\n\t};\r\n\r\n\tconst onSelectLogo = ( media, shouldForceSync = false ) => {\r\n\t\tif ( ! media ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif ( ! media.id && media.url ) {\r\n\t\t\t// This is a temporary blob image.\r\n\t\t\tsetTemporaryURL( media.url );\r\n\t\t\tsetLogo( undefined );\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tsetLogo( media.id, shouldForceSync );\r\n\t};\r\n\r\n\tconst onRemoveLogo = () => {\r\n\t\tsetLogo( null );\r\n\t\tsetAttributes( { width: undefined } );\r\n\t};\r\n\r\n\tconst { createErrorNotice } = useDispatch( noticesStore );\r\n\tconst onUploadError = ( message ) => {\r\n\t\tcreateErrorNotice( message, { type: 'snackbar' } );\r\n\t\tsetTemporaryURL();\r\n\t};\r\n\r\n\tconst onFilesDrop = ( filesList ) => {\r\n\t\tgetSettings().mediaUpload( {\r\n\t\t\tallowedTypes: ALLOWED_MEDIA_TYPES,\r\n\t\t\tfilesList,\r\n\t\t\tonFileChange( [ image ] ) {\r\n\t\t\t\tif ( isBlobURL( image?.url ) ) {\r\n\t\t\t\t\tsetTemporaryURL( image.url );\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tonInitialSelectLogo( image );\r\n\t\t\t},\r\n\t\t\tonError: onUploadError,\r\n\t\t\tonRemoveLogo,\r\n\t\t} );\r\n\t};\r\n\r\n\tconst mediaReplaceFlowProps = {\r\n\t\tmediaURL: logoUrl,\r\n\t\tname: ! logoUrl ? __( 'Choose logo' ) : __( 'Replace' ),\r\n\t\tonSelect: onSelectLogo,\r\n\t\tonError: onUploadError,\r\n\t\tonRemoveLogo,\r\n\t};\r\n\tconst controls = canUserEdit && (\r\n\t\t<BlockControls group=\"other\">\r\n\t\t\t<SiteLogoReplaceFlow { ...mediaReplaceFlowProps } />\r\n\t\t</BlockControls>\r\n\t);\r\n\r\n\tlet logoImage;\r\n\tconst isLoading = siteLogoId === undefined || isRequestingMediaItem;\r\n\tif ( isLoading ) {\r\n\t\tlogoImage = <Spinner />;\r\n\t}\r\n\r\n\t// Reset temporary url when logoUrl is available.\r\n\tuseEffect( () => {\r\n\t\tif ( logoUrl && temporaryURL ) {\r\n\t\t\tsetTemporaryURL();\r\n\t\t}\r\n\t}, [ logoUrl, temporaryURL ] );\r\n\r\n\tif ( !! logoUrl || !! temporaryURL ) {\r\n\t\tlogoImage = (\r\n\t\t\t<>\r\n\t\t\t\t<SiteLogo\r\n\t\t\t\t\talt={ alt }\r\n\t\t\t\t\tattributes={ attributes }\r\n\t\t\t\t\tclassName={ className }\r\n\t\t\t\t\tisSelected={ isSelected }\r\n\t\t\t\t\tsetAttributes={ setAttributes }\r\n\t\t\t\t\tlogoUrl={ temporaryURL || logoUrl }\r\n\t\t\t\t\tsetLogo={ setLogo }\r\n\t\t\t\t\tlogoId={ mediaItemData?.id || siteLogoId }\r\n\t\t\t\t\tsiteUrl={ url }\r\n\t\t\t\t\tsetIcon={ setIcon }\r\n\t\t\t\t\ticonId={ siteIconId }\r\n\t\t\t\t\tcanUserEdit={ canUserEdit }\r\n\t\t\t\t/>\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n\tconst placeholder = ( content ) => {\r\n\t\tconst placeholderClassName = clsx(\r\n\t\t\t'block-editor-media-placeholder',\r\n\t\t\tclassName\r\n\t\t);\r\n\r\n\t\treturn (\r\n\t\t\t<Placeholder\r\n\t\t\t\tclassName={ placeholderClassName }\r\n\t\t\t\tpreview={ logoImage }\r\n\t\t\t\twithIllustration\r\n\t\t\t\tstyle={ {\r\n\t\t\t\t\twidth,\r\n\t\t\t\t} }\r\n\t\t\t>\r\n\t\t\t\t{ content }\r\n\t\t\t</Placeholder>\r\n\t\t);\r\n\t};\r\n\r\n\tconst classes = clsx( className, {\r\n\t\t'is-default-size': ! width,\r\n\t\t'is-transient': temporaryURL,\r\n\t} );\r\n\r\n\tconst blockProps = useBlockProps( { className: classes } );\r\n\r\n\tconst mediaInspectorPanel = ( canUserEdit || logoUrl ) && (\r\n\t\t<InspectorControls>\r\n\t\t\t<PanelBody title={ __( 'Media' ) }>\r\n\t\t\t\t<div className=\"block-library-site-logo__inspector-media-replace-container\">\r\n\t\t\t\t\t{ ! canUserEdit && !! logoUrl && (\r\n\t\t\t\t\t\t<InspectorLogoPreview\r\n\t\t\t\t\t\t\tmediaItemData={ mediaItemData }\r\n\t\t\t\t\t\t\titemGroupProps={ {\r\n\t\t\t\t\t\t\t\tisBordered: true,\r\n\t\t\t\t\t\t\t\tclassName:\r\n\t\t\t\t\t\t\t\t\t'block-library-site-logo__inspector-readonly-logo-preview',\r\n\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t) }\r\n\t\t\t\t\t{ canUserEdit && !! logoUrl && (\r\n\t\t\t\t\t\t<SiteLogoReplaceFlow\r\n\t\t\t\t\t\t\t{ ...mediaReplaceFlowProps }\r\n\t\t\t\t\t\t\tname={\r\n\t\t\t\t\t\t\t\t<InspectorLogoPreview\r\n\t\t\t\t\t\t\t\t\tmediaItemData={ mediaItemData }\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tpopoverProps={ {} }\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t) }\r\n\t\t\t\t\t{ canUserEdit && ! logoUrl && (\r\n\t\t\t\t\t\t<MediaUploadCheck>\r\n\t\t\t\t\t\t\t<MediaUpload\r\n\t\t\t\t\t\t\t\tonSelect={ onInitialSelectLogo }\r\n\t\t\t\t\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\r\n\t\t\t\t\t\t\t\trender={ ( { open } ) => (\r\n\t\t\t\t\t\t\t\t\t<div className=\"block-library-site-logo__inspector-upload-container\">\r\n\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t__next40pxDefaultSize\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={ open }\r\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"secondary\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{ isLoading ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Spinner />\r\n\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t__( 'Choose logo' )\r\n\t\t\t\t\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t<DropZone onFilesDrop={ onFilesDrop } />\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</MediaUploadCheck>\r\n\t\t\t\t\t) }\r\n\t\t\t\t</div>\r\n\t\t\t</PanelBody>\r\n\t\t</InspectorControls>\r\n\t);\r\n\r\n\treturn (\r\n\t\t<div { ...blockProps }>\r\n\t\t\t{ controls }\r\n\t\t\t{ mediaInspectorPanel }\r\n\t\t\t{ ( !! logoUrl || !! temporaryURL ) && logoImage }\r\n\t\t\t{ ( isLoading ||\r\n\t\t\t\t( ! temporaryURL && ! logoUrl && ! canUserEdit ) ) && (\r\n\t\t\t\t<Placeholder className=\"site-logo_placeholder\" withIllustration>\r\n\t\t\t\t\t{ isLoading && (\r\n\t\t\t\t\t\t<span className=\"components-placeholder__preview\">\r\n\t\t\t\t\t\t\t<Spinner />\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t) }\r\n\t\t\t\t</Placeholder>\r\n\t\t\t) }\r\n\t\t\t{ ! isLoading && ! temporaryURL && ! logoUrl && canUserEdit && (\r\n\t\t\t\t<MediaPlaceholder\r\n\t\t\t\t\tonSelect={ onInitialSelectLogo }\r\n\t\t\t\t\taccept={ ACCEPT_MEDIA_STRING }\r\n\t\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\r\n\t\t\t\t\tonError={ onUploadError }\r\n\t\t\t\t\tplaceholder={ placeholder }\r\n\t\t\t\t\tmediaLibraryButton={ ( { open } ) => {\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t__next40pxDefaultSize\r\n\t\t\t\t\t\t\t\ticon={ upload }\r\n\t\t\t\t\t\t\t\tvariant=\"primary\"\r\n\t\t\t\t\t\t\t\tlabel={ __( 'Choose logo' ) }\r\n\t\t\t\t\t\t\t\tshowTooltip\r\n\t\t\t\t\t\t\t\ttooltipPosition=\"middle right\"\r\n\t\t\t\t\t\t\t\tonClick={ () => {\r\n\t\t\t\t\t\t\t\t\topen();\r\n\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t} }\r\n\t\t\t\t/>\r\n\t\t\t) }\r\n\t\t</div>\r\n\t);\r\n}\r\n"],"mappings":"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","ignoreList":[]}