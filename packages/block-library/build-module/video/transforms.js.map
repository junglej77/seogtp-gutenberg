{"version":3,"names":["createBlobURL","isBlobURL","createBlock","transforms","from","type","isMatch","files","length","indexOf","transform","file","block","blob","tag","attributes","src","shortcode","named","mp4","m4v","webm","ogv","flv","poster","loop","autoplay","preload","node","nodeName","children","firstChild","videoElement","hasAttribute","undefined","controls","muted","getAttribute","playsInline"],"sources":["@wordpress/block-library/src/video/transforms.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { createBlobURL, isBlobURL } from '@wordpress/blob';\r\nimport { createBlock } from '@wordpress/blocks';\r\n\r\nconst transforms = {\r\n\tfrom: [\r\n\t\t{\r\n\t\t\ttype: 'files',\r\n\t\t\tisMatch( files ) {\r\n\t\t\t\treturn (\r\n\t\t\t\t\tfiles.length === 1 &&\r\n\t\t\t\t\tfiles[ 0 ].type.indexOf( 'video/' ) === 0\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\ttransform( files ) {\r\n\t\t\t\tconst file = files[ 0 ];\r\n\t\t\t\t// We don't need to upload the media directly here\r\n\t\t\t\t// It's already done as part of the `componentDidMount`\r\n\t\t\t\t// in the video block\r\n\t\t\t\tconst block = createBlock( 'core/video', {\r\n\t\t\t\t\tblob: createBlobURL( file ),\r\n\t\t\t\t} );\r\n\t\t\t\treturn block;\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: 'shortcode',\r\n\t\t\ttag: 'video',\r\n\t\t\tattributes: {\r\n\t\t\t\tsrc: {\r\n\t\t\t\t\ttype: 'string',\r\n\t\t\t\t\tshortcode: ( {\r\n\t\t\t\t\t\tnamed: { src, mp4, m4v, webm, ogv, flv },\r\n\t\t\t\t\t} ) => {\r\n\t\t\t\t\t\treturn src || mp4 || m4v || webm || ogv || flv;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tposter: {\r\n\t\t\t\t\ttype: 'string',\r\n\t\t\t\t\tshortcode: ( { named: { poster } } ) => {\r\n\t\t\t\t\t\treturn poster;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tloop: {\r\n\t\t\t\t\ttype: 'string',\r\n\t\t\t\t\tshortcode: ( { named: { loop } } ) => {\r\n\t\t\t\t\t\treturn loop;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tautoplay: {\r\n\t\t\t\t\ttype: 'string',\r\n\t\t\t\t\tshortcode: ( { named: { autoplay } } ) => {\r\n\t\t\t\t\t\treturn autoplay;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tpreload: {\r\n\t\t\t\t\ttype: 'string',\r\n\t\t\t\t\tshortcode: ( { named: { preload } } ) => {\r\n\t\t\t\t\t\treturn preload;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: 'raw',\r\n\t\t\tisMatch: ( node ) =>\r\n\t\t\t\tnode.nodeName === 'P' &&\r\n\t\t\t\tnode.children.length === 1 &&\r\n\t\t\t\tnode.firstChild.nodeName === 'VIDEO',\r\n\t\t\ttransform: ( node ) => {\r\n\t\t\t\tconst videoElement = node.firstChild;\r\n\t\t\t\tconst attributes = {\r\n\t\t\t\t\tautoplay: videoElement.hasAttribute( 'autoplay' )\r\n\t\t\t\t\t\t? true\r\n\t\t\t\t\t\t: undefined,\r\n\t\t\t\t\tcontrols: videoElement.hasAttribute( 'controls' )\r\n\t\t\t\t\t\t? undefined\r\n\t\t\t\t\t\t: false,\r\n\t\t\t\t\tloop: videoElement.hasAttribute( 'loop' )\r\n\t\t\t\t\t\t? true\r\n\t\t\t\t\t\t: undefined,\r\n\t\t\t\t\tmuted: videoElement.hasAttribute( 'muted' )\r\n\t\t\t\t\t\t? true\r\n\t\t\t\t\t\t: undefined,\r\n\t\t\t\t\tpreload:\r\n\t\t\t\t\t\tvideoElement.getAttribute( 'preload' ) || undefined,\r\n\t\t\t\t\tplaysInline: videoElement.hasAttribute( 'playsinline' )\r\n\t\t\t\t\t\t? true\r\n\t\t\t\t\t\t: undefined,\r\n\t\t\t\t\tposter: videoElement.getAttribute( 'poster' ) || undefined,\r\n\t\t\t\t\tsrc: videoElement.getAttribute( 'src' ) || undefined,\r\n\t\t\t\t};\r\n\t\t\t\tif ( isBlobURL( attributes.src ) ) {\r\n\t\t\t\t\tattributes.blob = attributes.src;\r\n\t\t\t\t\tdelete attributes.src;\r\n\t\t\t\t}\r\n\t\t\t\treturn createBlock( 'core/video', attributes );\r\n\t\t\t},\r\n\t\t},\r\n\t],\r\n};\r\n\r\nexport default transforms;\r\n"],"mappings":"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","ignoreList":[]}