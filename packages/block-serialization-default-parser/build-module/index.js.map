{"version":3,"names":["document","offset","output","stack","tokenizer","Block","blockName","attrs","innerBlocks","innerHTML","innerContent","Freeform","Frame","block","tokenStart","tokenLength","prevOffset","leadingHtmlStart","parse","doc","lastIndex","proceed","stackDepth","length","next","nextToken","tokenType","startOffset","addFreeform","addBlockFromStack","push","substr","addInnerBlock","stackTop","pop","html","parseJSON","input","JSON","e","matches","exec","startedAt","index","match","closerMatch","namespaceMatch","nameMatch","attrsMatch","voidMatch","isCloser","isVoid","namespace","name","hasAttrs","rawLength","lastOffset","parent","endOffset"],"sources":["@wordpress/block-serialization-default-parser/src/index.js"],"sourcesContent":["/**\r\n * @type {string}\r\n */\r\nlet document;\r\n/**\r\n * @type {number}\r\n */\r\nlet offset;\r\n/**\r\n * @type {ParsedBlock[]}\r\n */\r\nlet output;\r\n/**\r\n * @type {ParsedFrame[]}\r\n */\r\nlet stack;\r\n\r\n/**\r\n * @typedef {Object|null} Attributes\r\n */\r\n\r\n/**\r\n * @typedef {Object} ParsedBlock\r\n * @property {string|null}        blockName    Block name.\r\n * @property {Attributes}         attrs        Block attributes.\r\n * @property {ParsedBlock[]}      innerBlocks  Inner blocks.\r\n * @property {string}             innerHTML    Inner HTML.\r\n * @property {Array<string|null>} innerContent Inner content.\r\n */\r\n\r\n/**\r\n * @typedef {Object} ParsedFrame\r\n * @property {ParsedBlock} block            Block.\r\n * @property {number}      tokenStart       Token start.\r\n * @property {number}      tokenLength      Token length.\r\n * @property {number}      prevOffset       Previous offset.\r\n * @property {number|null} leadingHtmlStart Leading HTML start.\r\n */\r\n\r\n/**\r\n * @typedef {'no-more-tokens'|'void-block'|'block-opener'|'block-closer'} TokenType\r\n */\r\n\r\n/**\r\n * @typedef {[TokenType, string, Attributes, number, number]} Token\r\n */\r\n\r\n/**\r\n * Matches block comment delimiters\r\n *\r\n * While most of this pattern is straightforward the attribute parsing\r\n * incorporates a tricks to make sure we don't choke on specific input\r\n *\r\n *  - since JavaScript has no possessive quantifier or atomic grouping\r\n *    we are emulating it with a trick\r\n *\r\n *    we want a possessive quantifier or atomic group to prevent backtracking\r\n *    on the `}`s should we fail to match the remainder of the pattern\r\n *\r\n *    we can emulate this with a positive lookahead and back reference\r\n *    (a++)*c === ((?=(a+))\\1)*c\r\n *\r\n *    let's examine an example:\r\n *      - /(a+)*c/.test('aaaaaaaaaaaaad') fails after over 49,000 steps\r\n *      - /(a++)*c/.test('aaaaaaaaaaaaad') fails after 85 steps\r\n *      - /(?>a+)*c/.test('aaaaaaaaaaaaad') fails after 126 steps\r\n *\r\n *    this is because the possessive `++` and the atomic group `(?>)`\r\n *    tell the engine that all those `a`s belong together as a single group\r\n *    and so it won't split it up when stepping backwards to try and match\r\n *\r\n *    if we use /((?=(a+))\\1)*c/ then we get the same behavior as the atomic group\r\n *    or possessive and prevent the backtracking because the `a+` is matched but\r\n *    not captured. thus, we find the long string of `a`s and remember it, then\r\n *    reference it as a whole unit inside our pattern\r\n *\r\n *    @see http://instanceof.me/post/52245507631/regex-emulate-atomic-grouping-with-lookahead\r\n *    @see http://blog.stevenlevithan.com/archives/mimic-atomic-groups\r\n *    @see https://javascript.info/regexp-infinite-backtracking-problem\r\n *\r\n *    once browsers reliably support atomic grouping or possessive\r\n *    quantifiers natively we should remove this trick and simplify\r\n *\r\n * @type {RegExp}\r\n *\r\n * @since 3.8.0\r\n * @since 4.6.1 added optimization to prevent backtracking on attribute parsing\r\n */\r\nconst tokenizer =\r\n\t/<!--\\s+(\\/)?wp:([a-z][a-z0-9_-]*\\/)?([a-z][a-z0-9_-]*)\\s+({(?:(?=([^}]+|}+(?=})|(?!}\\s+\\/?-->)[^])*)\\5|[^]*?)}\\s+)?(\\/)?-->/g;\r\n\r\n/**\r\n * Constructs a block object.\r\n *\r\n * @param {string|null}   blockName\r\n * @param {Attributes}    attrs\r\n * @param {ParsedBlock[]} innerBlocks\r\n * @param {string}        innerHTML\r\n * @param {string[]}      innerContent\r\n * @return {ParsedBlock} The block object.\r\n */\r\nfunction Block( blockName, attrs, innerBlocks, innerHTML, innerContent ) {\r\n\treturn {\r\n\t\tblockName,\r\n\t\tattrs,\r\n\t\tinnerBlocks,\r\n\t\tinnerHTML,\r\n\t\tinnerContent,\r\n\t};\r\n}\r\n\r\n/**\r\n * Constructs a freeform block object.\r\n *\r\n * @param {string} innerHTML\r\n * @return {ParsedBlock} The freeform block object.\r\n */\r\nfunction Freeform( innerHTML ) {\r\n\treturn Block( null, {}, [], innerHTML, [ innerHTML ] );\r\n}\r\n\r\n/**\r\n * Constructs a frame object.\r\n *\r\n * @param {ParsedBlock} block\r\n * @param {number}      tokenStart\r\n * @param {number}      tokenLength\r\n * @param {number}      prevOffset\r\n * @param {number|null} leadingHtmlStart\r\n * @return {ParsedFrame} The frame object.\r\n */\r\nfunction Frame( block, tokenStart, tokenLength, prevOffset, leadingHtmlStart ) {\r\n\treturn {\r\n\t\tblock,\r\n\t\ttokenStart,\r\n\t\ttokenLength,\r\n\t\tprevOffset: prevOffset || tokenStart + tokenLength,\r\n\t\tleadingHtmlStart,\r\n\t};\r\n}\r\n\r\n/**\r\n * Parser function, that converts input HTML into a block based structure.\r\n *\r\n * @param {string} doc The HTML document to parse.\r\n *\r\n * @example\r\n * Input post:\r\n * ```html\r\n * <!-- wp:columns {\"columns\":3} -->\r\n * <div class=\"wp-block-columns has-3-columns\"><!-- wp:column -->\r\n * <div class=\"wp-block-column\"><!-- wp:paragraph -->\r\n * <p>Left</p>\r\n * <!-- /wp:paragraph --></div>\r\n * <!-- /wp:column -->\r\n *\r\n * <!-- wp:column -->\r\n * <div class=\"wp-block-column\"><!-- wp:paragraph -->\r\n * <p><strong>Middle</strong></p>\r\n * <!-- /wp:paragraph --></div>\r\n * <!-- /wp:column -->\r\n *\r\n * <!-- wp:column -->\r\n * <div class=\"wp-block-column\"></div>\r\n * <!-- /wp:column --></div>\r\n * <!-- /wp:columns -->\r\n * ```\r\n *\r\n * Parsing code:\r\n * ```js\r\n * import { parse } from '@wordpress/block-serialization-default-parser';\r\n *\r\n * parse( post ) === [\r\n *     {\r\n *         blockName: \"core/columns\",\r\n *         attrs: {\r\n *             columns: 3\r\n *         },\r\n *         innerBlocks: [\r\n *             {\r\n *                 blockName: \"core/column\",\r\n *                 attrs: null,\r\n *                 innerBlocks: [\r\n *                     {\r\n *                         blockName: \"core/paragraph\",\r\n *                         attrs: null,\r\n *                         innerBlocks: [],\r\n *                         innerHTML: \"\\n<p>Left</p>\\n\"\r\n *                     }\r\n *                 ],\r\n *                 innerHTML: '\\n<div class=\"wp-block-column\"></div>\\n'\r\n *             },\r\n *             {\r\n *                 blockName: \"core/column\",\r\n *                 attrs: null,\r\n *                 innerBlocks: [\r\n *                     {\r\n *                         blockName: \"core/paragraph\",\r\n *                         attrs: null,\r\n *                         innerBlocks: [],\r\n *                         innerHTML: \"\\n<p><strong>Middle</strong></p>\\n\"\r\n *                     }\r\n *                 ],\r\n *                 innerHTML: '\\n<div class=\"wp-block-column\"></div>\\n'\r\n *             },\r\n *             {\r\n *                 blockName: \"core/column\",\r\n *                 attrs: null,\r\n *                 innerBlocks: [],\r\n *                 innerHTML: '\\n<div class=\"wp-block-column\"></div>\\n'\r\n *             }\r\n *         ],\r\n *         innerHTML: '\\n<div class=\"wp-block-columns has-3-columns\">\\n\\n\\n\\n</div>\\n'\r\n *     }\r\n * ];\r\n * ```\r\n * @return {ParsedBlock[]} A block-based representation of the input HTML.\r\n */\r\nexport const parse = ( doc ) => {\r\n\tdocument = doc;\r\n\toffset = 0;\r\n\toutput = [];\r\n\tstack = [];\r\n\ttokenizer.lastIndex = 0;\r\n\r\n\tdo {\r\n\t\t// twiddle our thumbs\r\n\t} while ( proceed() );\r\n\r\n\treturn output;\r\n};\r\n\r\n/**\r\n * Parses the next token in the input document.\r\n *\r\n * @return {boolean} Returns true when there is more tokens to parse.\r\n */\r\nfunction proceed() {\r\n\tconst stackDepth = stack.length;\r\n\tconst next = nextToken();\r\n\tconst [ tokenType, blockName, attrs, startOffset, tokenLength ] = next;\r\n\r\n\t// We may have some HTML soup before the next block.\r\n\tconst leadingHtmlStart = startOffset > offset ? offset : null;\r\n\r\n\tswitch ( tokenType ) {\r\n\t\tcase 'no-more-tokens':\r\n\t\t\t// If not in a block then flush output.\r\n\t\t\tif ( 0 === stackDepth ) {\r\n\t\t\t\taddFreeform();\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\t// Otherwise we have a problem\r\n\t\t\t// This is an error\r\n\t\t\t// we have options\r\n\t\t\t//  - treat it all as freeform text\r\n\t\t\t//  - assume an implicit closer (easiest when not nesting)\r\n\r\n\t\t\t// For the easy case we'll assume an implicit closer.\r\n\t\t\tif ( 1 === stackDepth ) {\r\n\t\t\t\taddBlockFromStack();\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\t// For the nested case where it's more difficult we'll\r\n\t\t\t// have to assume that multiple closers are missing\r\n\t\t\t// and so we'll collapse the whole stack piecewise.\r\n\t\t\twhile ( 0 < stack.length ) {\r\n\t\t\t\taddBlockFromStack();\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\tcase 'void-block':\r\n\t\t\t// easy case is if we stumbled upon a void block\r\n\t\t\t// in the top-level of the document.\r\n\t\t\tif ( 0 === stackDepth ) {\r\n\t\t\t\tif ( null !== leadingHtmlStart ) {\r\n\t\t\t\t\toutput.push(\r\n\t\t\t\t\t\tFreeform(\r\n\t\t\t\t\t\t\tdocument.substr(\r\n\t\t\t\t\t\t\t\tleadingHtmlStart,\r\n\t\t\t\t\t\t\t\tstartOffset - leadingHtmlStart\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\toutput.push( Block( blockName, attrs, [], '', [] ) );\r\n\t\t\t\toffset = startOffset + tokenLength;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\t// Otherwise we found an inner block.\r\n\t\t\taddInnerBlock(\r\n\t\t\t\tBlock( blockName, attrs, [], '', [] ),\r\n\t\t\t\tstartOffset,\r\n\t\t\t\ttokenLength\r\n\t\t\t);\r\n\t\t\toffset = startOffset + tokenLength;\r\n\t\t\treturn true;\r\n\r\n\t\tcase 'block-opener':\r\n\t\t\t// Track all newly-opened blocks on the stack.\r\n\t\t\tstack.push(\r\n\t\t\t\tFrame(\r\n\t\t\t\t\tBlock( blockName, attrs, [], '', [] ),\r\n\t\t\t\t\tstartOffset,\r\n\t\t\t\t\ttokenLength,\r\n\t\t\t\t\tstartOffset + tokenLength,\r\n\t\t\t\t\tleadingHtmlStart\r\n\t\t\t\t)\r\n\t\t\t);\r\n\t\t\toffset = startOffset + tokenLength;\r\n\t\t\treturn true;\r\n\r\n\t\tcase 'block-closer':\r\n\t\t\t// If we're missing an opener we're in trouble\r\n\t\t\t// This is an error.\r\n\t\t\tif ( 0 === stackDepth ) {\r\n\t\t\t\t// We have options\r\n\t\t\t\t//  - assume an implicit opener\r\n\t\t\t\t//  - assume _this_ is the opener\r\n\t\t\t\t// - give up and close out the document.\r\n\t\t\t\taddFreeform();\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\t// If we're not nesting then this is easy - close the block.\r\n\t\t\tif ( 1 === stackDepth ) {\r\n\t\t\t\taddBlockFromStack( startOffset );\r\n\t\t\t\toffset = startOffset + tokenLength;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\t// Otherwise we're nested and we have to close out the current\r\n\t\t\t// block and add it as a innerBlock to the parent.\r\n\t\t\tconst stackTop = /** @type {ParsedFrame} */ ( stack.pop() );\r\n\t\t\tconst html = document.substr(\r\n\t\t\t\tstackTop.prevOffset,\r\n\t\t\t\tstartOffset - stackTop.prevOffset\r\n\t\t\t);\r\n\t\t\tstackTop.block.innerHTML += html;\r\n\t\t\tstackTop.block.innerContent.push( html );\r\n\t\t\tstackTop.prevOffset = startOffset + tokenLength;\r\n\r\n\t\t\taddInnerBlock(\r\n\t\t\t\tstackTop.block,\r\n\t\t\t\tstackTop.tokenStart,\r\n\t\t\t\tstackTop.tokenLength,\r\n\t\t\t\tstartOffset + tokenLength\r\n\t\t\t);\r\n\t\t\toffset = startOffset + tokenLength;\r\n\t\t\treturn true;\r\n\r\n\t\tdefault:\r\n\t\t\t// This is an error.\r\n\t\t\taddFreeform();\r\n\t\t\treturn false;\r\n\t}\r\n}\r\n\r\n/**\r\n * Parse JSON if valid, otherwise return null\r\n *\r\n * Note that JSON coming from the block comment\r\n * delimiters is constrained to be an object\r\n * and cannot be things like `true` or `null`\r\n *\r\n * @param {string} input JSON input string to parse\r\n * @return {Object|null} parsed JSON if valid\r\n */\r\nfunction parseJSON( input ) {\r\n\ttry {\r\n\t\treturn JSON.parse( input );\r\n\t} catch ( e ) {\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\n/**\r\n * Finds the next token in the document.\r\n *\r\n * @return {Token} The next matched token.\r\n */\r\nfunction nextToken() {\r\n\t// Aye the magic\r\n\t// we're using a single RegExp to tokenize the block comment delimiters\r\n\t// we're also using a trick here because the only difference between a\r\n\t// block opener and a block closer is the leading `/` before `wp:` (and\r\n\t// a closer has no attributes). we can trap them both and process the\r\n\t// match back in JavaScript to see which one it was.\r\n\tconst matches = tokenizer.exec( document );\r\n\r\n\t// We have no more tokens.\r\n\tif ( null === matches ) {\r\n\t\treturn [ 'no-more-tokens', '', null, 0, 0 ];\r\n\t}\r\n\r\n\tconst startedAt = matches.index;\r\n\tconst [\r\n\t\tmatch,\r\n\t\tcloserMatch,\r\n\t\tnamespaceMatch,\r\n\t\tnameMatch,\r\n\t\tattrsMatch /* Internal/unused. */,\r\n\t\t,\r\n\t\tvoidMatch,\r\n\t] = matches;\r\n\r\n\tconst length = match.length;\r\n\tconst isCloser = !! closerMatch;\r\n\tconst isVoid = !! voidMatch;\r\n\tconst namespace = namespaceMatch || 'core/';\r\n\tconst name = namespace + nameMatch;\r\n\tconst hasAttrs = !! attrsMatch;\r\n\tconst attrs = hasAttrs ? parseJSON( attrsMatch ) : {};\r\n\r\n\t// This state isn't allowed\r\n\t// This is an error.\r\n\tif ( isCloser && ( isVoid || hasAttrs ) ) {\r\n\t\t// We can ignore them since they don't hurt anything\r\n\t\t// we may warn against this at some point or reject it.\r\n\t}\r\n\r\n\tif ( isVoid ) {\r\n\t\treturn [ 'void-block', name, attrs, startedAt, length ];\r\n\t}\r\n\r\n\tif ( isCloser ) {\r\n\t\treturn [ 'block-closer', name, null, startedAt, length ];\r\n\t}\r\n\r\n\treturn [ 'block-opener', name, attrs, startedAt, length ];\r\n}\r\n\r\n/**\r\n * Adds a freeform block to the output.\r\n *\r\n * @param {number} [rawLength]\r\n */\r\nfunction addFreeform( rawLength ) {\r\n\tconst length = rawLength ? rawLength : document.length - offset;\r\n\r\n\tif ( 0 === length ) {\r\n\t\treturn;\r\n\t}\r\n\r\n\toutput.push( Freeform( document.substr( offset, length ) ) );\r\n}\r\n\r\n/**\r\n * Adds inner block to the parent block.\r\n *\r\n * @param {ParsedBlock} block\r\n * @param {number}      tokenStart\r\n * @param {number}      tokenLength\r\n * @param {number}      [lastOffset]\r\n */\r\nfunction addInnerBlock( block, tokenStart, tokenLength, lastOffset ) {\r\n\tconst parent = stack[ stack.length - 1 ];\r\n\tparent.block.innerBlocks.push( block );\r\n\tconst html = document.substr(\r\n\t\tparent.prevOffset,\r\n\t\ttokenStart - parent.prevOffset\r\n\t);\r\n\r\n\tif ( html ) {\r\n\t\tparent.block.innerHTML += html;\r\n\t\tparent.block.innerContent.push( html );\r\n\t}\r\n\r\n\tparent.block.innerContent.push( null );\r\n\tparent.prevOffset = lastOffset ? lastOffset : tokenStart + tokenLength;\r\n}\r\n\r\n/**\r\n * Adds block from the stack to the output.\r\n *\r\n * @param {number} [endOffset]\r\n */\r\nfunction addBlockFromStack( endOffset ) {\r\n\tconst { block, leadingHtmlStart, prevOffset, tokenStart } =\r\n\t\t/** @type {ParsedFrame} */ ( stack.pop() );\r\n\r\n\tconst html = endOffset\r\n\t\t? document.substr( prevOffset, endOffset - prevOffset )\r\n\t\t: document.substr( prevOffset );\r\n\r\n\tif ( html ) {\r\n\t\tblock.innerHTML += html;\r\n\t\tblock.innerContent.push( html );\r\n\t}\r\n\r\n\tif ( null !== leadingHtmlStart ) {\r\n\t\toutput.push(\r\n\t\t\tFreeform(\r\n\t\t\t\tdocument.substr(\r\n\t\t\t\t\tleadingHtmlStart,\r\n\t\t\t\t\ttokenStart - leadingHtmlStart\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t);\r\n\t}\r\n\r\n\toutput.push( block );\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,IAAIA,QAAQ;AACZ;AACA;AACA;AACA,IAAIC,MAAM;AACV;AACA;AACA;AACA,IAAIC,MAAM;AACV;AACA;AACA;AACA,IAAIC,KAAK;;AAET;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMC,SAAS,GACd,8HAA8H;;AAE/H;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASC,KAAKA,CAAEC,SAAS,EAAEC,KAAK,EAAEC,WAAW,EAAEC,SAAS,EAAEC,YAAY,EAAG;EACxE,OAAO;IACNJ,SAAS;IACTC,KAAK;IACLC,WAAW;IACXC,SAAS;IACTC;EACD,CAAC;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAASC,QAAQA,CAAEF,SAAS,EAAG;EAC9B,OAAOJ,KAAK,CAAE,IAAI,EAAE,CAAC,CAAC,EAAE,EAAE,EAAEI,SAAS,EAAE,CAAEA,SAAS,CAAG,CAAC;AACvD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASG,KAAKA,CAAEC,KAAK,EAAEC,UAAU,EAAEC,WAAW,EAAEC,UAAU,EAAEC,gBAAgB,EAAG;EAC9E,OAAO;IACNJ,KAAK;IACLC,UAAU;IACVC,WAAW;IACXC,UAAU,EAAEA,UAAU,IAAIF,UAAU,GAAGC,WAAW;IAClDE;EACD,CAAC;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA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","ignoreList":[]}