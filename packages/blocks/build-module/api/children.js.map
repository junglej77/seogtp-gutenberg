{"version":3,"names":["renderToString","deprecated","node","getSerializeCapableElement","children","getChildrenArray","since","version","link","concat","blockNodes","alternative","result","i","length","blockNode","Array","isArray","j","child","canConcatToPreviousString","push","fromDOM","domNodes","error","toHTML","element","matcher","selector","domNode","match","querySelector","childNodes"],"sources":["@wordpress/blocks/src/api/children.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { renderToString } from '@wordpress/element';\r\nimport deprecated from '@wordpress/deprecated';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport * as node from './node';\r\n\r\n/**\r\n * A representation of a block's rich text value.\r\n *\r\n * @typedef {WPBlockNode[]} WPBlockChildren\r\n */\r\n\r\n/**\r\n * Given block children, returns a serialize-capable WordPress element.\r\n *\r\n * @param {WPBlockChildren} children Block children object to convert.\r\n *\r\n * @return {Element} A serialize-capable element.\r\n */\r\nexport function getSerializeCapableElement( children ) {\r\n\t// The fact that block children are compatible with the element serializer is\r\n\t// merely an implementation detail that currently serves to be true, but\r\n\t// should not be mistaken as being a guarantee on the external API. The\r\n\t// public API only offers guarantees to work with strings (toHTML) and DOM\r\n\t// elements (fromDOM), and should provide utilities to manipulate the value\r\n\t// rather than expect consumers to inspect or construct its shape (concat).\r\n\treturn children;\r\n}\r\n\r\n/**\r\n * Given block children, returns an array of block nodes.\r\n *\r\n * @param {WPBlockChildren} children Block children object to convert.\r\n *\r\n * @return {Array<WPBlockNode>} An array of individual block nodes.\r\n */\r\nfunction getChildrenArray( children ) {\r\n\tdeprecated( 'wp.blocks.children.getChildrenArray', {\r\n\t\tsince: '6.1',\r\n\t\tversion: '6.3',\r\n\t\tlink: 'https://developer.wordpress.org/block-editor/how-to-guides/block-tutorial/introducing-attributes-and-editable-fields/',\r\n\t} );\r\n\r\n\t// The fact that block children are compatible with the element serializer\r\n\t// is merely an implementation detail that currently serves to be true, but\r\n\t// should not be mistaken as being a guarantee on the external API.\r\n\treturn children;\r\n}\r\n\r\n/**\r\n * Given two or more block nodes, returns a new block node representing a\r\n * concatenation of its values.\r\n *\r\n * @param {...WPBlockChildren} blockNodes Block nodes to concatenate.\r\n *\r\n * @return {WPBlockChildren} Concatenated block node.\r\n */\r\nexport function concat( ...blockNodes ) {\r\n\tdeprecated( 'wp.blocks.children.concat', {\r\n\t\tsince: '6.1',\r\n\t\tversion: '6.3',\r\n\t\talternative: 'wp.richText.concat',\r\n\t\tlink: 'https://developer.wordpress.org/block-editor/how-to-guides/block-tutorial/introducing-attributes-and-editable-fields/',\r\n\t} );\r\n\r\n\tconst result = [];\r\n\tfor ( let i = 0; i < blockNodes.length; i++ ) {\r\n\t\tconst blockNode = Array.isArray( blockNodes[ i ] )\r\n\t\t\t? blockNodes[ i ]\r\n\t\t\t: [ blockNodes[ i ] ];\r\n\t\tfor ( let j = 0; j < blockNode.length; j++ ) {\r\n\t\t\tconst child = blockNode[ j ];\r\n\t\t\tconst canConcatToPreviousString =\r\n\t\t\t\ttypeof child === 'string' &&\r\n\t\t\t\ttypeof result[ result.length - 1 ] === 'string';\r\n\r\n\t\t\tif ( canConcatToPreviousString ) {\r\n\t\t\t\tresult[ result.length - 1 ] += child;\r\n\t\t\t} else {\r\n\t\t\t\tresult.push( child );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\n/**\r\n * Given an iterable set of DOM nodes, returns equivalent block children.\r\n * Ignores any non-element/text nodes included in set.\r\n *\r\n * @param {Iterable.<Node>} domNodes Iterable set of DOM nodes to convert.\r\n *\r\n * @return {WPBlockChildren} Block children equivalent to DOM nodes.\r\n */\r\nexport function fromDOM( domNodes ) {\r\n\tdeprecated( 'wp.blocks.children.fromDOM', {\r\n\t\tsince: '6.1',\r\n\t\tversion: '6.3',\r\n\t\talternative: 'wp.richText.create',\r\n\t\tlink: 'https://developer.wordpress.org/block-editor/how-to-guides/block-tutorial/introducing-attributes-and-editable-fields/',\r\n\t} );\r\n\r\n\tconst result = [];\r\n\tfor ( let i = 0; i < domNodes.length; i++ ) {\r\n\t\ttry {\r\n\t\t\tresult.push( node.fromDOM( domNodes[ i ] ) );\r\n\t\t} catch ( error ) {\r\n\t\t\t// Simply ignore if DOM node could not be converted.\r\n\t\t}\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\n/**\r\n * Given a block node, returns its HTML string representation.\r\n *\r\n * @param {WPBlockChildren} children Block node(s) to convert to string.\r\n *\r\n * @return {string} String HTML representation of block node.\r\n */\r\nexport function toHTML( children ) {\r\n\tdeprecated( 'wp.blocks.children.toHTML', {\r\n\t\tsince: '6.1',\r\n\t\tversion: '6.3',\r\n\t\talternative: 'wp.richText.toHTMLString',\r\n\t\tlink: 'https://developer.wordpress.org/block-editor/how-to-guides/block-tutorial/introducing-attributes-and-editable-fields/',\r\n\t} );\r\n\r\n\tconst element = getSerializeCapableElement( children );\r\n\r\n\treturn renderToString( element );\r\n}\r\n\r\n/**\r\n * Given a selector, returns an hpq matcher generating a WPBlockChildren value\r\n * matching the selector result.\r\n *\r\n * @param {string} selector DOM selector.\r\n *\r\n * @return {Function} hpq matcher.\r\n */\r\nexport function matcher( selector ) {\r\n\tdeprecated( 'wp.blocks.children.matcher', {\r\n\t\tsince: '6.1',\r\n\t\tversion: '6.3',\r\n\t\talternative: 'html source',\r\n\t\tlink: 'https://developer.wordpress.org/block-editor/how-to-guides/block-tutorial/introducing-attributes-and-editable-fields/',\r\n\t} );\r\n\r\n\treturn ( domNode ) => {\r\n\t\tlet match = domNode;\r\n\r\n\t\tif ( selector ) {\r\n\t\t\tmatch = domNode.querySelector( selector );\r\n\t\t}\r\n\r\n\t\tif ( match ) {\r\n\t\t\treturn fromDOM( match.childNodes );\r\n\t\t}\r\n\r\n\t\treturn [];\r\n\t};\r\n}\r\n\r\n/**\r\n * Object of utility functions used in managing block attribute values of\r\n * source `children`.\r\n *\r\n * @see https://github.com/WordPress/gutenberg/pull/10439\r\n *\r\n * @deprecated since 4.0. The `children` source should not be used, and can be\r\n *             replaced by the `html` source.\r\n *\r\n * @private\r\n */\r\nexport default {\r\n\tconcat,\r\n\tgetChildrenArray,\r\n\tfromDOM,\r\n\ttoHTML,\r\n\tmatcher,\r\n};\r\n"],"mappings":"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","ignoreList":[]}