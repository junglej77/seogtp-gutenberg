{"version":3,"names":["unwrap","isList","node","nodeName","shallowTextContent","element","Array","from","childNodes","map","nodeValue","join","listReducer","list","prevElement","previousElementSibling","children","length","firstChild","appendChild","parentNode","removeChild","parentElement","test","parentListItem","prevListItem","parentList"],"sources":["@wordpress/blocks/src/api/raw-handling/list-reducer.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { unwrap } from '@wordpress/dom';\r\n\r\nfunction isList( node ) {\r\n\treturn node.nodeName === 'OL' || node.nodeName === 'UL';\r\n}\r\n\r\nfunction shallowTextContent( element ) {\r\n\treturn Array.from( element.childNodes )\r\n\t\t.map( ( { nodeValue = '' } ) => nodeValue )\r\n\t\t.join( '' );\r\n}\r\n\r\nexport default function listReducer( node ) {\r\n\tif ( ! isList( node ) ) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tconst list = node;\r\n\tconst prevElement = node.previousElementSibling;\r\n\r\n\t// Merge with previous list if:\r\n\t// * There is a previous list of the same type.\r\n\t// * There is only one list item.\r\n\tif (\r\n\t\tprevElement &&\r\n\t\tprevElement.nodeName === node.nodeName &&\r\n\t\tlist.children.length === 1\r\n\t) {\r\n\t\t// Move all child nodes, including any text nodes, if any.\r\n\t\twhile ( list.firstChild ) {\r\n\t\t\tprevElement.appendChild( list.firstChild );\r\n\t\t}\r\n\r\n\t\tlist.parentNode.removeChild( list );\r\n\t}\r\n\r\n\tconst parentElement = node.parentNode;\r\n\r\n\t// Nested list with empty parent item.\r\n\tif (\r\n\t\tparentElement &&\r\n\t\tparentElement.nodeName === 'LI' &&\r\n\t\tparentElement.children.length === 1 &&\r\n\t\t! /\\S/.test( shallowTextContent( parentElement ) )\r\n\t) {\r\n\t\tconst parentListItem = parentElement;\r\n\t\tconst prevListItem = parentListItem.previousElementSibling;\r\n\t\tconst parentList = parentListItem.parentNode;\r\n\r\n\t\tif ( prevListItem ) {\r\n\t\t\tprevListItem.appendChild( list );\r\n\t\t\tparentList.removeChild( parentListItem );\r\n\t\t}\r\n\t}\r\n\r\n\t// Invalid: OL/UL > OL/UL.\r\n\tif ( parentElement && isList( parentElement ) ) {\r\n\t\tconst prevListItem = node.previousElementSibling;\r\n\r\n\t\tif ( prevListItem ) {\r\n\t\t\tprevListItem.appendChild( node );\r\n\t\t} else {\r\n\t\t\tunwrap( node );\r\n\t\t}\r\n\t}\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,MAAM,QAAQ,gBAAgB;AAEvC,SAASC,MAAMA,CAAEC,IAAI,EAAG;EACvB,OAAOA,IAAI,CAACC,QAAQ,KAAK,IAAI,IAAID,IAAI,CAACC,QAAQ,KAAK,IAAI;AACxD;AAEA,SAASC,kBAAkBA,CAAEC,OAAO,EAAG;EACtC,OAAOC,KAAK,CAACC,IAAI,CAAEF,OAAO,CAACG,UAAW,CAAC,CACrCC,GAAG,CAAE,CAAE;IAAEC,SAAS,GAAG;EAAG,CAAC,KAAMA,SAAU,CAAC,CAC1CC,IAAI,CAAE,EAAG,CAAC;AACb;AAEA,eAAe,SAASC,WAAWA,CAAEV,IAAI,EAAG;EAC3C,IAAK,CAAED,MAAM,CAAEC,IAAK,CAAC,EAAG;IACvB;EACD;EAEA,MAAMW,IAAI,GAAGX,IAAI;EACjB,MAAMY,WAAW,GAAGZ,IAAI,CAACa,sBAAsB;;EAE/C;EACA;EACA;EACA,IACCD,WAAW,IACXA,WAAW,CAACX,QAAQ,KAAKD,IAAI,CAACC,QAAQ,IACtCU,IAAI,CAACG,QAAQ,CAACC,MAAM,KAAK,CAAC,EACzB;IACD;IACA,OAAQJ,IAAI,CAACK,UAAU,EAAG;MACzBJ,WAAW,CAACK,WAAW,CAAEN,IAAI,CAACK,UAAW,CAAC;IAC3C;IAEAL,IAAI,CAACO,UAAU,CAACC,WAAW,CAAER,IAAK,CAAC;EACpC;EAEA,MAAMS,aAAa,GAAGpB,IAAI,CAACkB,UAAU;;EAErC;EACA,IACCE,aAAa,IACbA,aAAa,CAACnB,QAAQ,KAAK,IAAI,IAC/BmB,aAAa,CAACN,QAAQ,CAACC,MAAM,KAAK,CAAC,IACnC,CAAE,IAAI,CAACM,IAAI,CAAEnB,kBAAkB,CAAEkB,aAAc,CAAE,CAAC,EACjD;IACD,MAAME,cAAc,GAAGF,aAAa;IACpC,MAAMG,YAAY,GAAGD,cAAc,CAACT,sBAAsB;IAC1D,MAAMW,UAAU,GAAGF,cAAc,CAACJ,UAAU;IAE5C,IAAKK,YAAY,EAAG;MACnBA,YAAY,CAACN,WAAW,CAAEN,IAAK,CAAC;MAChCa,UAAU,CAACL,WAAW,CAAEG,cAAe,CAAC;IACzC;EACD;;EAEA;EACA,IAAKF,aAAa,IAAIrB,MAAM,CAAEqB,aAAc,CAAC,EAAG;IAC/C,MAAMG,YAAY,GAAGvB,IAAI,CAACa,sBAAsB;IAEhD,IAAKU,YAAY,EAAG;MACnBA,YAAY,CAACN,WAAW,CAAEjB,IAAK,CAAC;IACjC,CAAC,MAAM;MACNF,MAAM,CAAEE,IAAK,CAAC;IACf;EACD;AACD","ignoreList":[]}