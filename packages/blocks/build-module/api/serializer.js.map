{"version":3,"names":["Component","cloneElement","renderToString","RawHTML","hasFilter","applyFilters","isShallowEqual","removep","getBlockType","getFreeformContentHandlerName","getUnregisteredTypeHandlerName","serializeRawBlock","isUnmodifiedDefaultBlock","normalizeBlockType","jsx","_jsx","getBlockDefaultClassName","blockName","className","replace","getBlockMenuDefaultClassName","blockPropsProvider","innerBlocksPropsProvider","getBlockProps","props","blockType","attributes","skipFilters","getInnerBlocksProps","innerBlocks","Array","isArray","children","html","serialize","isInnerBlocks","getSaveElement","blockTypeOrName","save","prototype","instance","render","bind","element","apiVersion","getSaveContent","getCommentAttributes","_blockType$attributes","Object","entries","reduce","accumulator","key","attributeSchema","value","undefined","source","__experimentalRole","JSON","stringify","default","serializeAttributes","getBlockInnerHTML","block","saveContent","originalContent","isValid","length","name","error","getCommentDelimitedContent","rawBlockName","content","serializedAttributes","startsWith","slice","serializeBlock","__unstableBlockSource","saveAttributes","__unstableSerializeAndClean","blocks","options","blocksArray","map","join"],"sources":["@wordpress/blocks/src/api/serializer.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport {\r\n\tComponent,\r\n\tcloneElement,\r\n\trenderToString,\r\n\tRawHTML,\r\n} from '@wordpress/element';\r\nimport { hasFilter, applyFilters } from '@wordpress/hooks';\r\nimport isShallowEqual from '@wordpress/is-shallow-equal';\r\nimport { removep } from '@wordpress/autop';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport {\r\n\tgetBlockType,\r\n\tgetFreeformContentHandlerName,\r\n\tgetUnregisteredTypeHandlerName,\r\n} from './registration';\r\nimport { serializeRawBlock } from './parser/serialize-raw-block';\r\nimport { isUnmodifiedDefaultBlock, normalizeBlockType } from './utils';\r\n\r\n/** @typedef {import('./parser').WPBlock} WPBlock */\r\n\r\n/**\r\n * @typedef {Object} WPBlockSerializationOptions Serialization Options.\r\n *\r\n * @property {boolean} isInnerBlocks Whether we are serializing inner blocks.\r\n */\r\n\r\n/**\r\n * Returns the block's default classname from its name.\r\n *\r\n * @param {string} blockName The block name.\r\n *\r\n * @return {string} The block's default class.\r\n */\r\nexport function getBlockDefaultClassName( blockName ) {\r\n\t// Generated HTML classes for blocks follow the `wp-block-{name}` nomenclature.\r\n\t// Blocks provided by WordPress drop the prefixes 'core/' or 'core-' (historically used in 'core-embed/').\r\n\tconst className =\r\n\t\t'wp-block-' + blockName.replace( /\\//, '-' ).replace( /^core-/, '' );\r\n\r\n\treturn applyFilters(\r\n\t\t'blocks.getBlockDefaultClassName',\r\n\t\tclassName,\r\n\t\tblockName\r\n\t);\r\n}\r\n\r\n/**\r\n * Returns the block's default menu item classname from its name.\r\n *\r\n * @param {string} blockName The block name.\r\n *\r\n * @return {string} The block's default menu item class.\r\n */\r\nexport function getBlockMenuDefaultClassName( blockName ) {\r\n\t// Generated HTML classes for blocks follow the `editor-block-list-item-{name}` nomenclature.\r\n\t// Blocks provided by WordPress drop the prefixes 'core/' or 'core-' (historically used in 'core-embed/').\r\n\tconst className =\r\n\t\t'editor-block-list-item-' +\r\n\t\tblockName.replace( /\\//, '-' ).replace( /^core-/, '' );\r\n\r\n\treturn applyFilters(\r\n\t\t'blocks.getBlockMenuDefaultClassName',\r\n\t\tclassName,\r\n\t\tblockName\r\n\t);\r\n}\r\n\r\nconst blockPropsProvider = {};\r\nconst innerBlocksPropsProvider = {};\r\n\r\n/**\r\n * Call within a save function to get the props for the block wrapper.\r\n *\r\n * @param {Object} props Optional. Props to pass to the element.\r\n */\r\nexport function getBlockProps( props = {} ) {\r\n\tconst { blockType, attributes } = blockPropsProvider;\r\n\treturn getBlockProps.skipFilters\r\n\t\t? props\r\n\t\t: applyFilters(\r\n\t\t\t\t'blocks.getSaveContent.extraProps',\r\n\t\t\t\t{ ...props },\r\n\t\t\t\tblockType,\r\n\t\t\t\tattributes\r\n\t\t  );\r\n}\r\n\r\n/**\r\n * Call within a save function to get the props for the inner blocks wrapper.\r\n *\r\n * @param {Object} props Optional. Props to pass to the element.\r\n */\r\nexport function getInnerBlocksProps( props = {} ) {\r\n\tconst { innerBlocks } = innerBlocksPropsProvider;\r\n\t// Allow a different component to be passed to getSaveElement to handle\r\n\t// inner blocks, bypassing the default serialisation.\r\n\tif ( ! Array.isArray( innerBlocks ) ) {\r\n\t\treturn { ...props, children: innerBlocks };\r\n\t}\r\n\t// Value is an array of blocks, so defer to block serializer.\r\n\tconst html = serialize( innerBlocks, { isInnerBlocks: true } );\r\n\t// Use special-cased raw HTML tag to avoid default escaping.\r\n\tconst children = <RawHTML>{ html }</RawHTML>;\r\n\r\n\treturn { ...props, children };\r\n}\r\n\r\n/**\r\n * Given a block type containing a save render implementation and attributes, returns the\r\n * enhanced element to be saved or string when raw HTML expected.\r\n *\r\n * @param {string|Object} blockTypeOrName Block type or name.\r\n * @param {Object}        attributes      Block attributes.\r\n * @param {?Array}        innerBlocks     Nested blocks.\r\n *\r\n * @return {Object|string} Save element or raw HTML string.\r\n */\r\nexport function getSaveElement(\r\n\tblockTypeOrName,\r\n\tattributes,\r\n\tinnerBlocks = []\r\n) {\r\n\tconst blockType = normalizeBlockType( blockTypeOrName );\r\n\r\n\tif ( ! blockType?.save ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tlet { save } = blockType;\r\n\r\n\t// Component classes are unsupported for save since serialization must\r\n\t// occur synchronously. For improved interoperability with higher-order\r\n\t// components which often return component class, emulate basic support.\r\n\tif ( save.prototype instanceof Component ) {\r\n\t\tconst instance = new save( { attributes } );\r\n\t\tsave = instance.render.bind( instance );\r\n\t}\r\n\r\n\tblockPropsProvider.blockType = blockType;\r\n\tblockPropsProvider.attributes = attributes;\r\n\tinnerBlocksPropsProvider.innerBlocks = innerBlocks;\r\n\r\n\tlet element = save( { attributes, innerBlocks } );\r\n\r\n\tif (\r\n\t\telement !== null &&\r\n\t\ttypeof element === 'object' &&\r\n\t\thasFilter( 'blocks.getSaveContent.extraProps' ) &&\r\n\t\t! ( blockType.apiVersion > 1 )\r\n\t) {\r\n\t\t/**\r\n\t\t * Filters the props applied to the block save result element.\r\n\t\t *\r\n\t\t * @param {Object}  props      Props applied to save element.\r\n\t\t * @param {WPBlock} blockType  Block type definition.\r\n\t\t * @param {Object}  attributes Block attributes.\r\n\t\t */\r\n\t\tconst props = applyFilters(\r\n\t\t\t'blocks.getSaveContent.extraProps',\r\n\t\t\t{ ...element.props },\r\n\t\t\tblockType,\r\n\t\t\tattributes\r\n\t\t);\r\n\r\n\t\tif ( ! isShallowEqual( props, element.props ) ) {\r\n\t\t\telement = cloneElement( element, props );\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Filters the save result of a block during serialization.\r\n\t *\r\n\t * @param {Element} element    Block save result.\r\n\t * @param {WPBlock} blockType  Block type definition.\r\n\t * @param {Object}  attributes Block attributes.\r\n\t */\r\n\treturn applyFilters(\r\n\t\t'blocks.getSaveElement',\r\n\t\telement,\r\n\t\tblockType,\r\n\t\tattributes\r\n\t);\r\n}\r\n\r\n/**\r\n * Given a block type containing a save render implementation and attributes, returns the\r\n * static markup to be saved.\r\n *\r\n * @param {string|Object} blockTypeOrName Block type or name.\r\n * @param {Object}        attributes      Block attributes.\r\n * @param {?Array}        innerBlocks     Nested blocks.\r\n *\r\n * @return {string} Save content.\r\n */\r\nexport function getSaveContent( blockTypeOrName, attributes, innerBlocks ) {\r\n\tconst blockType = normalizeBlockType( blockTypeOrName );\r\n\r\n\treturn renderToString(\r\n\t\tgetSaveElement( blockType, attributes, innerBlocks )\r\n\t);\r\n}\r\n\r\n/**\r\n * Returns attributes which are to be saved and serialized into the block\r\n * comment delimiter.\r\n *\r\n * When a block exists in memory it contains as its attributes both those\r\n * parsed the block comment delimiter _and_ those which matched from the\r\n * contents of the block.\r\n *\r\n * This function returns only those attributes which are needed to persist and\r\n * which cannot be matched from the block content.\r\n *\r\n * @param {Object<string,*>} blockType  Block type.\r\n * @param {Object<string,*>} attributes Attributes from in-memory block data.\r\n *\r\n * @return {Object<string,*>} Subset of attributes for comment serialization.\r\n */\r\nexport function getCommentAttributes( blockType, attributes ) {\r\n\treturn Object.entries( blockType.attributes ?? {} ).reduce(\r\n\t\t( accumulator, [ key, attributeSchema ] ) => {\r\n\t\t\tconst value = attributes[ key ];\r\n\t\t\t// Ignore undefined values.\r\n\t\t\tif ( undefined === value ) {\r\n\t\t\t\treturn accumulator;\r\n\t\t\t}\r\n\r\n\t\t\t// Ignore all attributes but the ones with an \"undefined\" source\r\n\t\t\t// \"undefined\" source refers to attributes saved in the block comment.\r\n\t\t\tif ( attributeSchema.source !== undefined ) {\r\n\t\t\t\treturn accumulator;\r\n\t\t\t}\r\n\r\n\t\t\t// Ignore all local attributes\r\n\t\t\tif ( attributeSchema.__experimentalRole === 'local' ) {\r\n\t\t\t\treturn accumulator;\r\n\t\t\t}\r\n\r\n\t\t\t// Ignore default value.\r\n\t\t\tif (\r\n\t\t\t\t'default' in attributeSchema &&\r\n\t\t\t\tJSON.stringify( attributeSchema.default ) ===\r\n\t\t\t\t\tJSON.stringify( value )\r\n\t\t\t) {\r\n\t\t\t\treturn accumulator;\r\n\t\t\t}\r\n\r\n\t\t\t// Otherwise, include in comment set.\r\n\t\t\taccumulator[ key ] = value;\r\n\t\t\treturn accumulator;\r\n\t\t},\r\n\t\t{}\r\n\t);\r\n}\r\n\r\n/**\r\n * Given an attributes object, returns a string in the serialized attributes\r\n * format prepared for post content.\r\n *\r\n * @param {Object} attributes Attributes object.\r\n *\r\n * @return {string} Serialized attributes.\r\n */\r\nexport function serializeAttributes( attributes ) {\r\n\treturn (\r\n\t\tJSON.stringify( attributes )\r\n\t\t\t// Don't break HTML comments.\r\n\t\t\t.replace( /--/g, '\\\\u002d\\\\u002d' )\r\n\r\n\t\t\t// Don't break non-standard-compliant tools.\r\n\t\t\t.replace( /</g, '\\\\u003c' )\r\n\t\t\t.replace( />/g, '\\\\u003e' )\r\n\t\t\t.replace( /&/g, '\\\\u0026' )\r\n\r\n\t\t\t// Bypass server stripslashes behavior which would unescape stringify's\r\n\t\t\t// escaping of quotation mark.\r\n\t\t\t//\r\n\t\t\t// See: https://developer.wordpress.org/reference/functions/wp_kses_stripslashes/\r\n\t\t\t.replace( /\\\\\"/g, '\\\\u0022' )\r\n\t);\r\n}\r\n\r\n/**\r\n * Given a block object, returns the Block's Inner HTML markup.\r\n *\r\n * @param {Object} block Block instance.\r\n *\r\n * @return {string} HTML.\r\n */\r\nexport function getBlockInnerHTML( block ) {\r\n\t// If block was parsed as invalid or encounters an error while generating\r\n\t// save content, use original content instead to avoid content loss. If a\r\n\t// block contains nested content, exempt it from this condition because we\r\n\t// otherwise have no access to its original content and content loss would\r\n\t// still occur.\r\n\tlet saveContent = block.originalContent;\r\n\tif ( block.isValid || block.innerBlocks.length ) {\r\n\t\ttry {\r\n\t\t\tsaveContent = getSaveContent(\r\n\t\t\t\tblock.name,\r\n\t\t\t\tblock.attributes,\r\n\t\t\t\tblock.innerBlocks\r\n\t\t\t);\r\n\t\t} catch ( error ) {}\r\n\t}\r\n\r\n\treturn saveContent;\r\n}\r\n\r\n/**\r\n * Returns the content of a block, including comment delimiters.\r\n *\r\n * @param {string} rawBlockName Block name.\r\n * @param {Object} attributes   Block attributes.\r\n * @param {string} content      Block save content.\r\n *\r\n * @return {string} Comment-delimited block content.\r\n */\r\nexport function getCommentDelimitedContent(\r\n\trawBlockName,\r\n\tattributes,\r\n\tcontent\r\n) {\r\n\tconst serializedAttributes =\r\n\t\tattributes && Object.entries( attributes ).length\r\n\t\t\t? serializeAttributes( attributes ) + ' '\r\n\t\t\t: '';\r\n\r\n\t// Strip core blocks of their namespace prefix.\r\n\tconst blockName = rawBlockName?.startsWith( 'core/' )\r\n\t\t? rawBlockName.slice( 5 )\r\n\t\t: rawBlockName;\r\n\r\n\t// @todo make the `wp:` prefix potentially configurable.\r\n\r\n\tif ( ! content ) {\r\n\t\treturn `<!-- wp:${ blockName } ${ serializedAttributes }/-->`;\r\n\t}\r\n\r\n\treturn (\r\n\t\t`<!-- wp:${ blockName } ${ serializedAttributes }-->\\n` +\r\n\t\tcontent +\r\n\t\t`\\n<!-- /wp:${ blockName } -->`\r\n\t);\r\n}\r\n\r\n/**\r\n * Returns the content of a block, including comment delimiters, determining\r\n * serialized attributes and content form from the current state of the block.\r\n *\r\n * @param {WPBlock}                     block   Block instance.\r\n * @param {WPBlockSerializationOptions} options Serialization options.\r\n *\r\n * @return {string} Serialized block.\r\n */\r\nexport function serializeBlock( block, { isInnerBlocks = false } = {} ) {\r\n\tif ( ! block.isValid && block.__unstableBlockSource ) {\r\n\t\treturn serializeRawBlock( block.__unstableBlockSource );\r\n\t}\r\n\r\n\tconst blockName = block.name;\r\n\tconst saveContent = getBlockInnerHTML( block );\r\n\r\n\tif (\r\n\t\tblockName === getUnregisteredTypeHandlerName() ||\r\n\t\t( ! isInnerBlocks && blockName === getFreeformContentHandlerName() )\r\n\t) {\r\n\t\treturn saveContent;\r\n\t}\r\n\r\n\tconst blockType = getBlockType( blockName );\r\n\tif ( ! blockType ) {\r\n\t\treturn saveContent;\r\n\t}\r\n\r\n\tconst saveAttributes = getCommentAttributes( blockType, block.attributes );\r\n\treturn getCommentDelimitedContent( blockName, saveAttributes, saveContent );\r\n}\r\n\r\nexport function __unstableSerializeAndClean( blocks ) {\r\n\t// A single unmodified default block is assumed to\r\n\t// be equivalent to an empty post.\r\n\tif ( blocks.length === 1 && isUnmodifiedDefaultBlock( blocks[ 0 ] ) ) {\r\n\t\tblocks = [];\r\n\t}\r\n\r\n\tlet content = serialize( blocks );\r\n\r\n\t// For compatibility, treat a post consisting of a\r\n\t// single freeform block as legacy content and apply\r\n\t// pre-block-editor removep'd content formatting.\r\n\tif (\r\n\t\tblocks.length === 1 &&\r\n\t\tblocks[ 0 ].name === getFreeformContentHandlerName() &&\r\n\t\tblocks[ 0 ].name === 'core/freeform'\r\n\t) {\r\n\t\tcontent = removep( content );\r\n\t}\r\n\r\n\treturn content;\r\n}\r\n\r\n/**\r\n * Takes a block or set of blocks and returns the serialized post content.\r\n *\r\n * @param {Array}                       blocks  Block(s) to serialize.\r\n * @param {WPBlockSerializationOptions} options Serialization options.\r\n *\r\n * @return {string} The post content.\r\n */\r\nexport default function serialize( blocks, options ) {\r\n\tconst blocksArray = Array.isArray( blocks ) ? blocks : [ blocks ];\r\n\treturn blocksArray\r\n\t\t.map( ( block ) => serializeBlock( block, options ) )\r\n\t\t.join( '\\n\\n' );\r\n}\r\n"],"mappings":"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","ignoreList":[]}