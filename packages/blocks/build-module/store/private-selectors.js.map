{"version":3,"names":["createSelector","getBlockType","getValueFromObjectPath","__EXPERIMENTAL_STYLE_PROPERTY","STYLE_PROPERTY","ROOT_BLOCK_SUPPORTS","filterElementBlockSupports","blockSupports","name","element","filter","support","includes","getSupportedStyles","state","blockType","supportKeys","supports","spacing","blockGap","push","shadow","Object","keys","forEach","styleName","requiresOptOut","blockTypes","getBootstrappedBlockType","bootstrappedBlockTypes","getUnprocessedBlockTypes","unprocessedBlockTypes","getAllBlockBindingsSources","blockBindingsSources","getBlockBindingsSource","sourceName"],"sources":["@wordpress/blocks/src/store/private-selectors.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { createSelector } from '@wordpress/data';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { getBlockType } from './selectors';\r\nimport { getValueFromObjectPath } from './utils';\r\nimport { __EXPERIMENTAL_STYLE_PROPERTY as STYLE_PROPERTY } from '../api/constants';\r\n\r\nconst ROOT_BLOCK_SUPPORTS = [\r\n\t'background',\r\n\t'backgroundColor',\r\n\t'color',\r\n\t'linkColor',\r\n\t'captionColor',\r\n\t'buttonColor',\r\n\t'headingColor',\r\n\t'fontFamily',\r\n\t'fontSize',\r\n\t'fontStyle',\r\n\t'fontWeight',\r\n\t'lineHeight',\r\n\t'padding',\r\n\t'contentSize',\r\n\t'wideSize',\r\n\t'blockGap',\r\n\t'textDecoration',\r\n\t'textTransform',\r\n\t'letterSpacing',\r\n];\r\n\r\n/**\r\n * Filters the list of supported styles for a given element.\r\n *\r\n * @param {string[]}         blockSupports list of supported styles.\r\n * @param {string|undefined} name          block name.\r\n * @param {string|undefined} element       element name.\r\n *\r\n * @return {string[]} filtered list of supported styles.\r\n */\r\nfunction filterElementBlockSupports( blockSupports, name, element ) {\r\n\treturn blockSupports.filter( ( support ) => {\r\n\t\tif ( support === 'fontSize' && element === 'heading' ) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// This is only available for links\r\n\t\tif ( support === 'textDecoration' && ! name && element !== 'link' ) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// This is only available for heading, button, caption and text\r\n\t\tif (\r\n\t\t\tsupport === 'textTransform' &&\r\n\t\t\t! name &&\r\n\t\t\t! (\r\n\t\t\t\t[ 'heading', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6' ].includes(\r\n\t\t\t\t\telement\r\n\t\t\t\t) ||\r\n\t\t\t\telement === 'button' ||\r\n\t\t\t\telement === 'caption' ||\r\n\t\t\t\telement === 'text'\r\n\t\t\t)\r\n\t\t) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// This is only available for heading, button, caption and text\r\n\t\tif (\r\n\t\t\tsupport === 'letterSpacing' &&\r\n\t\t\t! name &&\r\n\t\t\t! (\r\n\t\t\t\t[ 'heading', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6' ].includes(\r\n\t\t\t\t\telement\r\n\t\t\t\t) ||\r\n\t\t\t\telement === 'button' ||\r\n\t\t\t\telement === 'caption' ||\r\n\t\t\t\telement === 'text'\r\n\t\t\t)\r\n\t\t) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// Text columns is only available for blocks.\r\n\t\tif ( support === 'textColumns' && ! name ) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t} );\r\n}\r\n\r\n/**\r\n * Returns the list of supported styles for a given block name and element.\r\n */\r\nexport const getSupportedStyles = createSelector(\r\n\t( state, name, element ) => {\r\n\t\tif ( ! name ) {\r\n\t\t\treturn filterElementBlockSupports(\r\n\t\t\t\tROOT_BLOCK_SUPPORTS,\r\n\t\t\t\tname,\r\n\t\t\t\telement\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tconst blockType = getBlockType( state, name );\r\n\r\n\t\tif ( ! blockType ) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\r\n\t\tconst supportKeys = [];\r\n\r\n\t\t// Check for blockGap support.\r\n\t\t// Block spacing support doesn't map directly to a single style property, so needs to be handled separately.\r\n\t\tif ( blockType?.supports?.spacing?.blockGap ) {\r\n\t\t\tsupportKeys.push( 'blockGap' );\r\n\t\t}\r\n\r\n\t\t// check for shadow support\r\n\t\tif ( blockType?.supports?.shadow ) {\r\n\t\t\tsupportKeys.push( 'shadow' );\r\n\t\t}\r\n\r\n\t\tObject.keys( STYLE_PROPERTY ).forEach( ( styleName ) => {\r\n\t\t\tif ( ! STYLE_PROPERTY[ styleName ].support ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Opting out means that, for certain support keys like background color,\r\n\t\t\t// blocks have to explicitly set the support value false. If the key is\r\n\t\t\t// unset, we still enable it.\r\n\t\t\tif ( STYLE_PROPERTY[ styleName ].requiresOptOut ) {\r\n\t\t\t\tif (\r\n\t\t\t\t\tSTYLE_PROPERTY[ styleName ].support[ 0 ] in\r\n\t\t\t\t\t\tblockType.supports &&\r\n\t\t\t\t\tgetValueFromObjectPath(\r\n\t\t\t\t\t\tblockType.supports,\r\n\t\t\t\t\t\tSTYLE_PROPERTY[ styleName ].support\r\n\t\t\t\t\t) !== false\r\n\t\t\t\t) {\r\n\t\t\t\t\tsupportKeys.push( styleName );\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\tgetValueFromObjectPath(\r\n\t\t\t\t\tblockType.supports,\r\n\t\t\t\t\tSTYLE_PROPERTY[ styleName ].support,\r\n\t\t\t\t\tfalse\r\n\t\t\t\t)\r\n\t\t\t) {\r\n\t\t\t\tsupportKeys.push( styleName );\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t\treturn filterElementBlockSupports( supportKeys, name, element );\r\n\t},\r\n\t( state, name ) => [ state.blockTypes[ name ] ]\r\n);\r\n\r\n/**\r\n * Returns the bootstrapped block type metadata for a give block name.\r\n *\r\n * @param {Object} state Data state.\r\n * @param {string} name  Block name.\r\n *\r\n * @return {Object} Bootstrapped block type metadata for a block.\r\n */\r\nexport function getBootstrappedBlockType( state, name ) {\r\n\treturn state.bootstrappedBlockTypes[ name ];\r\n}\r\n\r\n/**\r\n * Returns all the unprocessed (before applying the `registerBlockType` filter)\r\n * block type settings as passed during block registration.\r\n *\r\n * @param {Object} state Data state.\r\n *\r\n * @return {Array} Unprocessed block type settings for all blocks.\r\n */\r\nexport function getUnprocessedBlockTypes( state ) {\r\n\treturn state.unprocessedBlockTypes;\r\n}\r\n\r\n/**\r\n * Returns all the block bindings sources registered.\r\n *\r\n * @param {Object} state Data state.\r\n *\r\n * @return {Object} All the registered sources and their properties.\r\n */\r\nexport function getAllBlockBindingsSources( state ) {\r\n\treturn state.blockBindingsSources;\r\n}\r\n\r\n/**\r\n * Returns a specific block bindings source.\r\n *\r\n * @param {Object} state      Data state.\r\n * @param {string} sourceName Name of the source to get.\r\n *\r\n * @return {Object} The specific block binding source and its properties.\r\n */\r\nexport function getBlockBindingsSource( state, sourceName ) {\r\n\treturn state.blockBindingsSources[ sourceName ];\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,cAAc,QAAQ,iBAAiB;;AAEhD;AACA;AACA;AACA,SAASC,YAAY,QAAQ,aAAa;AAC1C,SAASC,sBAAsB,QAAQ,SAAS;AAChD,SAASC,6BAA6B,IAAIC,cAAc,QAAQ,kBAAkB;AAElF,MAAMC,mBAAmB,GAAG,CAC3B,YAAY,EACZ,iBAAiB,EACjB,OAAO,EACP,WAAW,EACX,cAAc,EACd,aAAa,EACb,cAAc,EACd,YAAY,EACZ,UAAU,EACV,WAAW,EACX,YAAY,EACZ,YAAY,EACZ,SAAS,EACT,aAAa,EACb,UAAU,EACV,UAAU,EACV,gBAAgB,EAChB,eAAe,EACf,eAAe,CACf;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASC,0BAA0BA,CAAEC,aAAa,EAAEC,IAAI,EAAEC,OAAO,EAAG;EACnE,OAAOF,aAAa,CAACG,MAAM,CAAIC,OAAO,IAAM;IAC3C,IAAKA,OAAO,KAAK,UAAU,IAAIF,OAAO,KAAK,SAAS,EAAG;MACtD,OAAO,KAAK;IACb;;IAEA;IACA,IAAKE,OAAO,KAAK,gBAAgB,IAAI,CAAEH,IAAI,IAAIC,OAAO,KAAK,MAAM,EAAG;MACnE,OAAO,KAAK;IACb;;IAEA;IACA,IACCE,OAAO,KAAK,eAAe,IAC3B,CAAEH,IAAI,IACN,EACC,CAAE,SAAS,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAE,CAACI,QAAQ,CACzDH,OACD,CAAC,IACDA,OAAO,KAAK,QAAQ,IACpBA,OAAO,KAAK,SAAS,IACrBA,OAAO,KAAK,MAAM,CAClB,EACA;MACD,OAAO,KAAK;IACb;;IAEA;IACA,IACCE,OAAO,KAAK,eAAe,IAC3B,CAAEH,IAAI,IACN,EACC,CAAE,SAAS,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAE,CAACI,QAAQ,CACzDH,OACD,CAAC,IACDA,OAAO,KAAK,QAAQ,IACpBA,OAAO,KAAK,SAAS,IACrBA,OAAO,KAAK,MAAM,CAClB,EACA;MACD,OAAO,KAAK;IACb;;IAEA;IACA,IAAKE,OAAO,KAAK,aAAa,IAAI,CAAEH,IAAI,EAAG;MAC1C,OAAO,KAAK;IACb;IAEA,OAAO,IAAI;EACZ,CAAE,CAAC;AACJ;;AAEA;AACA;AACA;AACA,OAAO,MAAMK,kBAAkB,GAAGb,cAAc,CAC/C,CAAEc,KAAK,EAAEN,IAAI,EAAEC,OAAO,KAAM;EAC3B,IAAK,CAAED,IAAI,EAAG;IACb,OAAOF,0BAA0B,CAChCD,mBAAmB,EACnBG,IAAI,EACJC,OACD,CAAC;EACF;EAEA,MAAMM,SAAS,GAAGd,YAAY,CAAEa,KAAK,EAAEN,IAAK,CAAC;EAE7C,IAAK,CAAEO,SAAS,EAAG;IAClB,OAAO,EAAE;EACV;EAEA,MAAMC,WAAW,GAAG,EAAE;;EAEtB;EACA;EACA,IAAKD,SAAS,EAAEE,QAAQ,EAAEC,OAAO,EAAEC,QAAQ,EAAG;IAC7CH,WAAW,CAACI,IAAI,CAAE,UAAW,CAAC;EAC/B;;EAEA;EACA,IAAKL,SAAS,EAAEE,QAAQ,EAAEI,MAAM,EAAG;IAClCL,WAAW,CAACI,IAAI,CAAE,QAAS,CAAC;EAC7B;EAEAE,MAAM,CAACC,IAAI,CAAEnB,cAAe,CAAC,CAACoB,OAAO,CAAIC,SAAS,IAAM;IACvD,IAAK,CAAErB,cAAc,CAAEqB,SAAS,CAAE,CAACd,OAAO,EAAG;MAC5C;IACD;;IAEA;IACA;IACA;IACA,IAAKP,cAAc,CAAEqB,SAAS,CAAE,CAACC,cAAc,EAAG;MACjD,IACCtB,cAAc,CAAEqB,SAAS,CAAE,CAACd,OAAO,CAAE,CAAC,CAAE,IACvCI,SAAS,CAACE,QAAQ,IACnBf,sBAAsB,CACrBa,SAAS,CAACE,QAAQ,EAClBb,cAAc,CAAEqB,SAAS,CAAE,CAACd,OAC7B,CAAC,KAAK,KAAK,EACV;QACDK,WAAW,CAACI,IAAI,CAAEK,SAAU,CAAC;QAC7B;MACD;IACD;IAEA,IACCvB,sBAAsB,CACrBa,SAAS,CAACE,QAAQ,EAClBb,cAAc,CAAEqB,SAAS,CAAE,CAACd,OAAO,EACnC,KACD,CAAC,EACA;MACDK,WAAW,CAACI,IAAI,CAAEK,SAAU,CAAC;IAC9B;EACD,CAAE,CAAC;EAEH,OAAOnB,0BAA0B,CAAEU,WAAW,EAAER,IAAI,EAAEC,OAAQ,CAAC;AAChE,CAAC,EACD,CAAEK,KAAK,EAAEN,IAAI,KAAM,CAAEM,KAAK,CAACa,UAAU,CAAEnB,IAAI,CAAE,CAC9C,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASoB,wBAAwBA,CAAEd,KAAK,EAAEN,IAAI,EAAG;EACvD,OAAOM,KAAK,CAACe,sBAAsB,CAAErB,IAAI,CAAE;AAC5C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASsB,wBAAwBA,CAAEhB,KAAK,EAAG;EACjD,OAAOA,KAAK,CAACiB,qBAAqB;AACnC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,0BAA0BA,CAAElB,KAAK,EAAG;EACnD,OAAOA,KAAK,CAACmB,oBAAoB;AAClC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,sBAAsBA,CAAEpB,KAAK,EAAEqB,UAAU,EAAG;EAC3D,OAAOrB,KAAK,CAACmB,oBAAoB,CAAEE,UAAU,CAAE;AAChD","ignoreList":[]}