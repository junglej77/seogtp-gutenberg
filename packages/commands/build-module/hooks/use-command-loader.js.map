{"version":3,"names":["useEffect","useDispatch","store","commandsStore","useCommandLoader","loader","registerCommandLoader","unregisterCommandLoader","disabled","name","hook","context"],"sources":["@wordpress/commands/src/hooks/use-command-loader.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useEffect } from '@wordpress/element';\r\nimport { useDispatch } from '@wordpress/data';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { store as commandsStore } from '../store';\r\n\r\n/**\r\n * Attach a command loader to the command palette. Used for dynamic commands.\r\n *\r\n * @param {import('../store/actions').WPCommandLoaderConfig} loader command loader config.\r\n *\r\n * @example\r\n * ```js\r\n * import { useCommandLoader } from '@wordpress/commands';\r\n * import { post, page, layout, symbolFilled } from '@wordpress/icons';\r\n *\r\n * const icons = {\r\n *     post,\r\n *     page,\r\n *     wp_template: layout,\r\n *     wp_template_part: symbolFilled,\r\n * };\r\n *\r\n * function usePageSearchCommandLoader( { search } ) {\r\n *     // Retrieve the pages for the \"search\" term.\r\n *     const { records, isLoading } = useSelect( ( select ) => {\r\n *         const { getEntityRecords } = select( coreStore );\r\n *         const query = {\r\n *             search: !! search ? search : undefined,\r\n *             per_page: 10,\r\n *             orderby: search ? 'relevance' : 'date',\r\n *         };\r\n *         return {\r\n *             records: getEntityRecords( 'postType', 'page', query ),\r\n *             isLoading: ! select( coreStore ).hasFinishedResolution(\r\n *                 'getEntityRecords',\r\n *                 'postType', 'page', query ]\r\n *             ),\r\n *         };\r\n *     }, [ search ] );\r\n *\r\n *     // Create the commands.\r\n *     const commands = useMemo( () => {\r\n *         return ( records ?? [] ).slice( 0, 10 ).map( ( record ) => {\r\n *             return {\r\n *                 name: record.title?.rendered + ' ' + record.id,\r\n *                 label: record.title?.rendered\r\n *                     ? record.title?.rendered\r\n *                     : __( '(no title)' ),\r\n *                 icon: icons[ postType ],\r\n *                 callback: ( { close } ) => {\r\n *                     const args = {\r\n *                         postType,\r\n *                         postId: record.id,\r\n *                         ...extraArgs,\r\n *                     };\r\n *                     document.location = addQueryArgs( 'site-editor.php', args );\r\n *                     close();\r\n *                 },\r\n *             };\r\n *         } );\r\n *     }, [ records, history ] );\r\n *\r\n *     return {\r\n *         commands,\r\n *         isLoading,\r\n *     };\r\n * }\r\n *\r\n * useCommandLoader( {\r\n *     name: 'myplugin/page-search',\r\n *     hook: usePageSearchCommandLoader,\r\n * } );\r\n * ```\r\n */\r\nexport default function useCommandLoader( loader ) {\r\n\tconst { registerCommandLoader, unregisterCommandLoader } =\r\n\t\tuseDispatch( commandsStore );\r\n\tuseEffect( () => {\r\n\t\tif ( loader.disabled ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tregisterCommandLoader( {\r\n\t\t\tname: loader.name,\r\n\t\t\thook: loader.hook,\r\n\t\t\tcontext: loader.context,\r\n\t\t} );\r\n\t\treturn () => {\r\n\t\t\tunregisterCommandLoader( loader.name );\r\n\t\t};\r\n\t}, [\r\n\t\tloader.name,\r\n\t\tloader.hook,\r\n\t\tloader.context,\r\n\t\tloader.disabled,\r\n\t\tregisterCommandLoader,\r\n\t\tunregisterCommandLoader,\r\n\t] );\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,SAAS,QAAQ,oBAAoB;AAC9C,SAASC,WAAW,QAAQ,iBAAiB;;AAE7C;AACA;AACA;AACA,SAASC,KAAK,IAAIC,aAAa,QAAQ,UAAU;;AAEjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAASC,gBAAgBA,CAAEC,MAAM,EAAG;EAClD,MAAM;IAAEC,qBAAqB;IAAEC;EAAwB,CAAC,GACvDN,WAAW,CAAEE,aAAc,CAAC;EAC7BH,SAAS,CAAE,MAAM;IAChB,IAAKK,MAAM,CAACG,QAAQ,EAAG;MACtB;IACD;IACAF,qBAAqB,CAAE;MACtBG,IAAI,EAAEJ,MAAM,CAACI,IAAI;MACjBC,IAAI,EAAEL,MAAM,CAACK,IAAI;MACjBC,OAAO,EAAEN,MAAM,CAACM;IACjB,CAAE,CAAC;IACH,OAAO,MAAM;MACZJ,uBAAuB,CAAEF,MAAM,CAACI,IAAK,CAAC;IACvC,CAAC;EACF,CAAC,EAAE,CACFJ,MAAM,CAACI,IAAI,EACXJ,MAAM,CAACK,IAAI,EACXL,MAAM,CAACM,OAAO,EACdN,MAAM,CAACG,QAAQ,EACfF,qBAAqB,EACrBC,uBAAuB,CACtB,CAAC;AACJ","ignoreList":[]}