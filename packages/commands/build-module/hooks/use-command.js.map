{"version":3,"names":["useEffect","useRef","useDispatch","store","commandsStore","useCommand","command","registerCommand","unregisterCommand","currentCallbackRef","callback","current","disabled","name","context","label","searchLabel","icon","args"],"sources":["@wordpress/commands/src/hooks/use-command.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useEffect, useRef } from '@wordpress/element';\r\nimport { useDispatch } from '@wordpress/data';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { store as commandsStore } from '../store';\r\n\r\n/**\r\n * Attach a command to the command palette. Used for static commands.\r\n *\r\n * @param {import('../store/actions').WPCommandConfig} command command config.\r\n *\r\n * @example\r\n * ```js\r\n * import { useCommand } from '@wordpress/commands';\r\n * import { plus } from '@wordpress/icons';\r\n *\r\n * useCommand( {\r\n *     name: 'myplugin/my-command-name',\r\n *     label: __( 'Add new post' ),\r\n *\t   icon: plus,\r\n *     callback: ({ close }) => {\r\n *         document.location.href = 'post-new.php';\r\n *         close();\r\n *     },\r\n * } );\r\n * ```\r\n */\r\nexport default function useCommand( command ) {\r\n\tconst { registerCommand, unregisterCommand } = useDispatch( commandsStore );\r\n\tconst currentCallbackRef = useRef( command.callback );\r\n\tuseEffect( () => {\r\n\t\tcurrentCallbackRef.current = command.callback;\r\n\t}, [ command.callback ] );\r\n\r\n\tuseEffect( () => {\r\n\t\tif ( command.disabled ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tregisterCommand( {\r\n\t\t\tname: command.name,\r\n\t\t\tcontext: command.context,\r\n\t\t\tlabel: command.label,\r\n\t\t\tsearchLabel: command.searchLabel,\r\n\t\t\ticon: command.icon,\r\n\t\t\tcallback: ( ...args ) => currentCallbackRef.current( ...args ),\r\n\t\t} );\r\n\t\treturn () => {\r\n\t\t\tunregisterCommand( command.name );\r\n\t\t};\r\n\t}, [\r\n\t\tcommand.name,\r\n\t\tcommand.label,\r\n\t\tcommand.searchLabel,\r\n\t\tcommand.icon,\r\n\t\tcommand.context,\r\n\t\tcommand.disabled,\r\n\t\tregisterCommand,\r\n\t\tunregisterCommand,\r\n\t] );\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,SAAS,EAAEC,MAAM,QAAQ,oBAAoB;AACtD,SAASC,WAAW,QAAQ,iBAAiB;;AAE7C;AACA;AACA;AACA,SAASC,KAAK,IAAIC,aAAa,QAAQ,UAAU;;AAEjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAASC,UAAUA,CAAEC,OAAO,EAAG;EAC7C,MAAM;IAAEC,eAAe;IAAEC;EAAkB,CAAC,GAAGN,WAAW,CAAEE,aAAc,CAAC;EAC3E,MAAMK,kBAAkB,GAAGR,MAAM,CAAEK,OAAO,CAACI,QAAS,CAAC;EACrDV,SAAS,CAAE,MAAM;IAChBS,kBAAkB,CAACE,OAAO,GAAGL,OAAO,CAACI,QAAQ;EAC9C,CAAC,EAAE,CAAEJ,OAAO,CAACI,QAAQ,CAAG,CAAC;EAEzBV,SAAS,CAAE,MAAM;IAChB,IAAKM,OAAO,CAACM,QAAQ,EAAG;MACvB;IACD;IACAL,eAAe,CAAE;MAChBM,IAAI,EAAEP,OAAO,CAACO,IAAI;MAClBC,OAAO,EAAER,OAAO,CAACQ,OAAO;MACxBC,KAAK,EAAET,OAAO,CAACS,KAAK;MACpBC,WAAW,EAAEV,OAAO,CAACU,WAAW;MAChCC,IAAI,EAAEX,OAAO,CAACW,IAAI;MAClBP,QAAQ,EAAEA,CAAE,GAAGQ,IAAI,KAAMT,kBAAkB,CAACE,OAAO,CAAE,GAAGO,IAAK;IAC9D,CAAE,CAAC;IACH,OAAO,MAAM;MACZV,iBAAiB,CAAEF,OAAO,CAACO,IAAK,CAAC;IAClC,CAAC;EACF,CAAC,EAAE,CACFP,OAAO,CAACO,IAAI,EACZP,OAAO,CAACS,KAAK,EACbT,OAAO,CAACU,WAAW,EACnBV,OAAO,CAACW,IAAI,EACZX,OAAO,CAACQ,OAAO,EACfR,OAAO,CAACM,QAAQ,EAChBL,eAAe,EACfC,iBAAiB,CAChB,CAAC;AACJ","ignoreList":[]}