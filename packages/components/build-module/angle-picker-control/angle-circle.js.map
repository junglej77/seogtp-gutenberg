{"version":3,"names":["useEffect","useRef","__experimentalUseDragging","useDragging","CircleRoot","CircleIndicatorWrapper","CircleIndicator","jsx","_jsx","AngleCircle","value","onChange","props","angleCircleRef","angleCircleCenterRef","previousCursorValueRef","setAngleCircleCenter","current","rect","getBoundingClientRect","x","width","y","height","changeAngleToPosition","event","undefined","preventDefault","target","focus","centerX","centerY","getAngle","clientX","clientY","startDrag","isDragging","onDragStart","onDragMove","onDragEnd","document","body","style","cursor","ref","onMouseDown","className","children","transform","tabIndex","pointX","pointY","angleInRadians","Math","atan2","angleInDeg","round","PI"],"sources":["@wordpress/components/src/angle-picker-control/angle-circle.tsx"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useEffect, useRef } from '@wordpress/element';\r\nimport { __experimentalUseDragging as useDragging } from '@wordpress/compose';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport {\r\n\tCircleRoot,\r\n\tCircleIndicatorWrapper,\r\n\tCircleIndicator,\r\n} from './styles/angle-picker-control-styles';\r\n\r\nimport type { WordPressComponentProps } from '../context';\r\nimport type { AngleCircleProps } from './types';\r\n\r\ntype UseDraggingArgumentType = Parameters< typeof useDragging >[ 0 ];\r\ntype UseDraggingCallbackEvent =\r\n\t| Parameters< UseDraggingArgumentType[ 'onDragStart' ] >[ 0 ]\r\n\t| Parameters< UseDraggingArgumentType[ 'onDragMove' ] >[ 0 ]\r\n\t| Parameters< UseDraggingArgumentType[ 'onDragEnd' ] >[ 0 ];\r\n\r\nfunction AngleCircle( {\r\n\tvalue,\r\n\tonChange,\r\n\t...props\r\n}: WordPressComponentProps< AngleCircleProps, 'div' > ) {\r\n\tconst angleCircleRef = useRef< HTMLDivElement | null >( null );\r\n\tconst angleCircleCenterRef = useRef<\r\n\t\t{ x: number; y: number } | undefined\r\n\t>();\r\n\tconst previousCursorValueRef = useRef< CSSStyleDeclaration[ 'cursor' ] >();\r\n\r\n\tconst setAngleCircleCenter = () => {\r\n\t\tif ( angleCircleRef.current === null ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst rect = angleCircleRef.current.getBoundingClientRect();\r\n\t\tangleCircleCenterRef.current = {\r\n\t\t\tx: rect.x + rect.width / 2,\r\n\t\t\ty: rect.y + rect.height / 2,\r\n\t\t};\r\n\t};\r\n\r\n\tconst changeAngleToPosition = ( event: UseDraggingCallbackEvent ) => {\r\n\t\tif ( event === undefined ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Prevent (drag) mouse events from selecting and accidentally\r\n\t\t// triggering actions from other elements.\r\n\t\tevent.preventDefault();\r\n\t\t// Input control needs to lose focus and by preventDefault above, it doesn't.\r\n\t\t( event.target as HTMLDivElement | null )?.focus();\r\n\r\n\t\tif (\r\n\t\t\tangleCircleCenterRef.current !== undefined &&\r\n\t\t\tonChange !== undefined\r\n\t\t) {\r\n\t\t\tconst { x: centerX, y: centerY } = angleCircleCenterRef.current;\r\n\t\t\tonChange(\r\n\t\t\t\tgetAngle( centerX, centerY, event.clientX, event.clientY )\r\n\t\t\t);\r\n\t\t}\r\n\t};\r\n\r\n\tconst { startDrag, isDragging } = useDragging( {\r\n\t\tonDragStart: ( event ) => {\r\n\t\t\tsetAngleCircleCenter();\r\n\t\t\tchangeAngleToPosition( event );\r\n\t\t},\r\n\t\tonDragMove: changeAngleToPosition,\r\n\t\tonDragEnd: changeAngleToPosition,\r\n\t} );\r\n\r\n\tuseEffect( () => {\r\n\t\tif ( isDragging ) {\r\n\t\t\tif ( previousCursorValueRef.current === undefined ) {\r\n\t\t\t\tpreviousCursorValueRef.current = document.body.style.cursor;\r\n\t\t\t}\r\n\t\t\tdocument.body.style.cursor = 'grabbing';\r\n\t\t} else {\r\n\t\t\tdocument.body.style.cursor = previousCursorValueRef.current || '';\r\n\t\t\tpreviousCursorValueRef.current = undefined;\r\n\t\t}\r\n\t}, [ isDragging ] );\r\n\r\n\treturn (\r\n\t\t<CircleRoot\r\n\t\t\tref={ angleCircleRef }\r\n\t\t\tonMouseDown={ startDrag }\r\n\t\t\tclassName=\"components-angle-picker-control__angle-circle\"\r\n\t\t\t{ ...props }\r\n\t\t>\r\n\t\t\t<CircleIndicatorWrapper\r\n\t\t\t\tstyle={\r\n\t\t\t\t\tvalue ? { transform: `rotate(${ value }deg)` } : undefined\r\n\t\t\t\t}\r\n\t\t\t\tclassName=\"components-angle-picker-control__angle-circle-indicator-wrapper\"\r\n\t\t\t\ttabIndex={ -1 }\r\n\t\t\t>\r\n\t\t\t\t<CircleIndicator className=\"components-angle-picker-control__angle-circle-indicator\" />\r\n\t\t\t</CircleIndicatorWrapper>\r\n\t\t</CircleRoot>\r\n\t);\r\n}\r\n\r\nfunction getAngle(\r\n\tcenterX: number,\r\n\tcenterY: number,\r\n\tpointX: number,\r\n\tpointY: number\r\n) {\r\n\tconst y = pointY - centerY;\r\n\tconst x = pointX - centerX;\r\n\r\n\tconst angleInRadians = Math.atan2( y, x );\r\n\tconst angleInDeg = Math.round( angleInRadians * ( 180 / Math.PI ) ) + 90;\r\n\tif ( angleInDeg < 0 ) {\r\n\t\treturn 360 + angleInDeg;\r\n\t}\r\n\treturn angleInDeg;\r\n}\r\n\r\nexport default AngleCircle;\r\n"],"mappings":"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","ignoreList":[]}