{"version":3,"names":["useCallback","useMemo","useState","styles","parseQuantityAndUnitFromRawValue","useContextSystem","useCx","isValidBorder","border","hasWidth","width","undefined","hasColor","color","useBorderControl","props","className","colors","isCompact","onChange","enableAlpha","enableStyle","shouldSanitizeBorder","size","value","__experimentalIsRenderedInSidebar","__next40pxDefaultSize","otherProps","computedSize","widthValue","originalWidthUnit","widthUnit","hadPreviousZeroWidth","colorSelection","setColorSelection","styleSelection","setStyleSelection","isStyleSettable","onBorderChange","newBorder","onWidthChange","newWidth","newWidthValue","parsedValue","hasZeroWidth","updatedBorder","style","onSliderChange","cx","classes","borderControl","wrapperWidth","innerWrapperClassName","widthStyle","heightStyle","wrapperHeight","innerWrapper","sliderClassName","borderSlider","inputWidth","previousStyleSelection"],"sources":["@wordpress/components/src/border-control/border-control/hook.ts"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useCallback, useMemo, useState } from '@wordpress/element';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport * as styles from '../styles';\r\nimport { parseQuantityAndUnitFromRawValue } from '../../unit-control/utils';\r\nimport type { WordPressComponentProps } from '../../context';\r\nimport { useContextSystem } from '../../context';\r\nimport { useCx } from '../../utils/hooks/use-cx';\r\n\r\nimport type { Border, BorderControlProps } from '../types';\r\n\r\n// If either width or color are defined, the border is considered valid\r\n// and a border style can be set as well.\r\nconst isValidBorder = ( border?: Border ) => {\r\n\tconst hasWidth = border?.width !== undefined && border.width !== '';\r\n\tconst hasColor = border?.color !== undefined;\r\n\treturn hasWidth || hasColor;\r\n};\r\n\r\nexport function useBorderControl(\r\n\tprops: WordPressComponentProps< BorderControlProps, 'div' >\r\n) {\r\n\tconst {\r\n\t\tclassName,\r\n\t\tcolors = [],\r\n\t\tisCompact,\r\n\t\tonChange,\r\n\t\tenableAlpha = true,\r\n\t\tenableStyle = true,\r\n\t\tshouldSanitizeBorder = true,\r\n\t\tsize = 'default',\r\n\t\tvalue: border,\r\n\t\twidth,\r\n\t\t__experimentalIsRenderedInSidebar = false,\r\n\t\t__next40pxDefaultSize,\r\n\t\t...otherProps\r\n\t} = useContextSystem( props, 'BorderControl' );\r\n\r\n\tconst computedSize =\r\n\t\tsize === 'default' && __next40pxDefaultSize ? '__unstable-large' : size;\r\n\r\n\tconst [ widthValue, originalWidthUnit ] = parseQuantityAndUnitFromRawValue(\r\n\t\tborder?.width\r\n\t);\r\n\tconst widthUnit = originalWidthUnit || 'px';\r\n\tconst hadPreviousZeroWidth = widthValue === 0;\r\n\r\n\tconst [ colorSelection, setColorSelection ] = useState< string >();\r\n\tconst [ styleSelection, setStyleSelection ] = useState< string >();\r\n\r\n\tconst isStyleSettable = shouldSanitizeBorder\r\n\t\t? isValidBorder( border )\r\n\t\t: true;\r\n\r\n\tconst onBorderChange = useCallback(\r\n\t\t( newBorder?: Border ) => {\r\n\t\t\tif ( shouldSanitizeBorder && ! isValidBorder( newBorder ) ) {\r\n\t\t\t\tonChange( undefined );\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tonChange( newBorder );\r\n\t\t},\r\n\t\t[ onChange, shouldSanitizeBorder ]\r\n\t);\r\n\r\n\tconst onWidthChange = useCallback(\r\n\t\t( newWidth?: string ) => {\r\n\t\t\tconst newWidthValue = newWidth === '' ? undefined : newWidth;\r\n\t\t\tconst [ parsedValue ] =\r\n\t\t\t\tparseQuantityAndUnitFromRawValue( newWidth );\r\n\t\t\tconst hasZeroWidth = parsedValue === 0;\r\n\t\t\tconst updatedBorder = { ...border, width: newWidthValue };\r\n\r\n\t\t\t// Setting the border width explicitly to zero will also set the\r\n\t\t\t// border style to `none` and clear the border color.\r\n\t\t\tif ( hasZeroWidth && ! hadPreviousZeroWidth ) {\r\n\t\t\t\t// Before clearing the color and style selections, keep track of\r\n\t\t\t\t// the current selections so they can be restored when the width\r\n\t\t\t\t// changes to a non-zero value.\r\n\t\t\t\tsetColorSelection( border?.color );\r\n\t\t\t\tsetStyleSelection( border?.style );\r\n\r\n\t\t\t\t// Clear the color and style border properties.\r\n\t\t\t\tupdatedBorder.color = undefined;\r\n\t\t\t\tupdatedBorder.style = 'none';\r\n\t\t\t}\r\n\r\n\t\t\t// Selection has changed from zero border width to non-zero width.\r\n\t\t\tif ( ! hasZeroWidth && hadPreviousZeroWidth ) {\r\n\t\t\t\t// Restore previous border color and style selections if width\r\n\t\t\t\t// is now not zero.\r\n\t\t\t\tif ( updatedBorder.color === undefined ) {\r\n\t\t\t\t\tupdatedBorder.color = colorSelection;\r\n\t\t\t\t}\r\n\t\t\t\tif ( updatedBorder.style === 'none' ) {\r\n\t\t\t\t\tupdatedBorder.style = styleSelection;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tonBorderChange( updatedBorder );\r\n\t\t},\r\n\t\t[\r\n\t\t\tborder,\r\n\t\t\thadPreviousZeroWidth,\r\n\t\t\tcolorSelection,\r\n\t\t\tstyleSelection,\r\n\t\t\tonBorderChange,\r\n\t\t]\r\n\t);\r\n\r\n\tconst onSliderChange = useCallback(\r\n\t\t( value?: number ) => {\r\n\t\t\tonWidthChange( `${ value }${ widthUnit }` );\r\n\t\t},\r\n\t\t[ onWidthChange, widthUnit ]\r\n\t);\r\n\r\n\t// Generate class names.\r\n\tconst cx = useCx();\r\n\tconst classes = useMemo( () => {\r\n\t\treturn cx( styles.borderControl, className );\r\n\t}, [ className, cx ] );\r\n\r\n\tlet wrapperWidth = width;\r\n\tif ( isCompact ) {\r\n\t\t// Widths below represent the minimum usable width for compact controls.\r\n\t\t// Taller controls contain greater internal padding, thus greater width.\r\n\t\twrapperWidth = size === '__unstable-large' ? '116px' : '90px';\r\n\t}\r\n\tconst innerWrapperClassName = useMemo( () => {\r\n\t\tconst widthStyle = !! wrapperWidth && styles.wrapperWidth;\r\n\t\tconst heightStyle = styles.wrapperHeight( computedSize );\r\n\r\n\t\treturn cx( styles.innerWrapper(), widthStyle, heightStyle );\r\n\t}, [ wrapperWidth, cx, computedSize ] );\r\n\r\n\tconst sliderClassName = useMemo( () => {\r\n\t\treturn cx( styles.borderSlider() );\r\n\t}, [ cx ] );\r\n\r\n\treturn {\r\n\t\t...otherProps,\r\n\t\tclassName: classes,\r\n\t\tcolors,\r\n\t\tenableAlpha,\r\n\t\tenableStyle,\r\n\t\tinnerWrapperClassName,\r\n\t\tinputWidth: wrapperWidth,\r\n\t\tisStyleSettable,\r\n\t\tonBorderChange,\r\n\t\tonSliderChange,\r\n\t\tonWidthChange,\r\n\t\tpreviousStyleSelection: styleSelection,\r\n\t\tsliderClassName,\r\n\t\tvalue: border,\r\n\t\twidthUnit,\r\n\t\twidthValue,\r\n\t\tsize: computedSize,\r\n\t\t__experimentalIsRenderedInSidebar,\r\n\t\t__next40pxDefaultSize,\r\n\t};\r\n}\r\n"],"mappings":"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","ignoreList":[]}