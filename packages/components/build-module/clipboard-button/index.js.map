{"version":3,"names":["clsx","useRef","useEffect","useCopyToClipboard","deprecated","Button","jsx","_jsx","TIMEOUT","ClipboardButton","className","children","onCopy","onFinishCopy","text","buttonProps","since","alternative","timeoutIdRef","ref","current","clearTimeout","setTimeout","classes","focusOnCopyEventTarget","event","target","focus"],"sources":["@wordpress/components/src/clipboard-button/index.tsx"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport clsx from 'clsx';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { useRef, useEffect } from '@wordpress/element';\r\nimport { useCopyToClipboard } from '@wordpress/compose';\r\nimport deprecated from '@wordpress/deprecated';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport Button from '../button';\r\nimport type { ClipboardButtonProps } from './types';\r\nimport type { WordPressComponentProps } from '../context';\r\n\r\nconst TIMEOUT = 4000;\r\n\r\nexport default function ClipboardButton( {\r\n\tclassName,\r\n\tchildren,\r\n\tonCopy,\r\n\tonFinishCopy,\r\n\ttext,\r\n\t...buttonProps\r\n}: WordPressComponentProps< ClipboardButtonProps, 'button', false > ) {\r\n\tdeprecated( 'wp.components.ClipboardButton', {\r\n\t\tsince: '5.8',\r\n\t\talternative: 'wp.compose.useCopyToClipboard',\r\n\t} );\r\n\r\n\tconst timeoutIdRef = useRef< NodeJS.Timeout >();\r\n\tconst ref = useCopyToClipboard( text, () => {\r\n\t\tonCopy();\r\n\t\tif ( timeoutIdRef.current ) {\r\n\t\t\tclearTimeout( timeoutIdRef.current );\r\n\t\t}\r\n\r\n\t\tif ( onFinishCopy ) {\r\n\t\t\ttimeoutIdRef.current = setTimeout( () => onFinishCopy(), TIMEOUT );\r\n\t\t}\r\n\t} );\r\n\r\n\tuseEffect( () => {\r\n\t\tif ( timeoutIdRef.current ) {\r\n\t\t\tclearTimeout( timeoutIdRef.current );\r\n\t\t}\r\n\t}, [] );\r\n\r\n\tconst classes = clsx( 'components-clipboard-button', className );\r\n\r\n\t// Workaround for inconsistent behavior in Safari, where <textarea> is not\r\n\t// the document.activeElement at the moment when the copy event fires.\r\n\t// This causes documentHasSelection() in the copy-handler component to\r\n\t// mistakenly override the ClipboardButton, and copy a serialized string\r\n\t// of the current block instead.\r\n\tconst focusOnCopyEventTarget: React.ClipboardEventHandler = ( event ) => {\r\n\t\t// @ts-expect-error: Should be currentTarget, but not changing because this component is deprecated.\r\n\t\tevent.target.focus();\r\n\t};\r\n\r\n\treturn (\r\n\t\t<Button\r\n\t\t\t{ ...buttonProps }\r\n\t\t\tclassName={ classes }\r\n\t\t\tref={ ref }\r\n\t\t\tonCopy={ focusOnCopyEventTarget }\r\n\t\t>\r\n\t\t\t{ children }\r\n\t\t</Button>\r\n\t);\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,OAAOA,IAAI,MAAM,MAAM;;AAEvB;AACA;AACA;AACA,SAASC,MAAM,EAAEC,SAAS,QAAQ,oBAAoB;AACtD,SAASC,kBAAkB,QAAQ,oBAAoB;AACvD,OAAOC,UAAU,MAAM,uBAAuB;;AAE9C;AACA;AACA;AACA,OAAOC,MAAM,MAAM,WAAW;AAAC,SAAAC,GAAA,IAAAC,IAAA;AAI/B,MAAMC,OAAO,GAAG,IAAI;AAEpB,eAAe,SAASC,eAAeA,CAAE;EACxCC,SAAS;EACTC,QAAQ;EACRC,MAAM;EACNC,YAAY;EACZC,IAAI;EACJ,GAAGC;AAC8D,CAAC,EAAG;EACrEX,UAAU,CAAE,+BAA+B,EAAE;IAC5CY,KAAK,EAAE,KAAK;IACZC,WAAW,EAAE;EACd,CAAE,CAAC;EAEH,MAAMC,YAAY,GAAGjB,MAAM,CAAmB,CAAC;EAC/C,MAAMkB,GAAG,GAAGhB,kBAAkB,CAAEW,IAAI,EAAE,MAAM;IAC3CF,MAAM,CAAC,CAAC;IACR,IAAKM,YAAY,CAACE,OAAO,EAAG;MAC3BC,YAAY,CAAEH,YAAY,CAACE,OAAQ,CAAC;IACrC;IAEA,IAAKP,YAAY,EAAG;MACnBK,YAAY,CAACE,OAAO,GAAGE,UAAU,CAAE,MAAMT,YAAY,CAAC,CAAC,EAAEL,OAAQ,CAAC;IACnE;EACD,CAAE,CAAC;EAEHN,SAAS,CAAE,MAAM;IAChB,IAAKgB,YAAY,CAACE,OAAO,EAAG;MAC3BC,YAAY,CAAEH,YAAY,CAACE,OAAQ,CAAC;IACrC;EACD,CAAC,EAAE,EAAG,CAAC;EAEP,MAAMG,OAAO,GAAGvB,IAAI,CAAE,6BAA6B,EAAEU,SAAU,CAAC;;EAEhE;EACA;EACA;EACA;EACA;EACA,MAAMc,sBAAmD,GAAKC,KAAK,IAAM;IACxE;IACAA,KAAK,CAACC,MAAM,CAACC,KAAK,CAAC,CAAC;EACrB,CAAC;EAED,oBACCpB,IAAA,CAACF,MAAM;IAAA,GACDU,WAAW;IAChBL,SAAS,EAAGa,OAAS;IACrBJ,GAAG,EAAGA,GAAK;IACXP,MAAM,EAAGY,sBAAwB;IAAAb,QAAA,EAE/BA;EAAQ,CACH,CAAC;AAEX","ignoreList":[]}