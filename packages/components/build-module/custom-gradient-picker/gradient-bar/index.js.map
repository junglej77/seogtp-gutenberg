{"version":3,"names":["clsx","useRef","useReducer","ControlPoints","getHorizontalRelativeGradientPosition","MINIMUM_DISTANCE_BETWEEN_INSERTER_AND_POINT","jsx","_jsx","jsxs","_jsxs","customGradientBarReducer","state","action","type","id","insertPosition","customGradientBarReducerInitialState","CustomGradientBar","background","hasGradient","value","controlPoints","onChange","disableInserter","disableAlpha","__experimentalIsRenderedInSidebar","gradientMarkersContainerDomRef","gradientBarState","gradientBarStateDispatch","onMouseEnterAndMove","event","current","clientX","some","position","Math","abs","onMouseLeave","isMovingInserter","isInsertingControlPoint","className","onMouseEnter","onMouseMove","children","style","opacity","ref","InsertPoint","onOpenInserter","onCloseInserter","disableRemove","gradientPickerDomRef","ignoreMarkerPosition","undefined","onStartControlPointChange","onStopControlPointChange"],"sources":["@wordpress/components/src/custom-gradient-picker/gradient-bar/index.tsx"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport clsx from 'clsx';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { useRef, useReducer } from '@wordpress/element';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport ControlPoints from './control-points';\r\nimport { getHorizontalRelativeGradientPosition } from './utils';\r\nimport { MINIMUM_DISTANCE_BETWEEN_INSERTER_AND_POINT } from './constants';\r\nimport type {\r\n\tCustomGradientBarProps,\r\n\tCustomGradientBarReducerState,\r\n\tCustomGradientBarReducerAction,\r\n\tCustomGradientBarIdleState,\r\n} from '../types';\r\nimport type { MouseEventHandler } from 'react';\r\n\r\nconst customGradientBarReducer = (\r\n\tstate: CustomGradientBarReducerState,\r\n\taction: CustomGradientBarReducerAction\r\n): CustomGradientBarReducerState => {\r\n\tswitch ( action.type ) {\r\n\t\tcase 'MOVE_INSERTER':\r\n\t\t\tif ( state.id === 'IDLE' || state.id === 'MOVING_INSERTER' ) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tid: 'MOVING_INSERTER',\r\n\t\t\t\t\tinsertPosition: action.insertPosition,\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\tcase 'STOP_INSERTER_MOVE':\r\n\t\t\tif ( state.id === 'MOVING_INSERTER' ) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tid: 'IDLE',\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\tcase 'OPEN_INSERTER':\r\n\t\t\tif ( state.id === 'MOVING_INSERTER' ) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tid: 'INSERTING_CONTROL_POINT',\r\n\t\t\t\t\tinsertPosition: state.insertPosition,\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\tcase 'CLOSE_INSERTER':\r\n\t\t\tif ( state.id === 'INSERTING_CONTROL_POINT' ) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tid: 'IDLE',\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\tcase 'START_CONTROL_CHANGE':\r\n\t\t\tif ( state.id === 'IDLE' ) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tid: 'MOVING_CONTROL_POINT',\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\tcase 'STOP_CONTROL_CHANGE':\r\n\t\t\tif ( state.id === 'MOVING_CONTROL_POINT' ) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tid: 'IDLE',\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t}\r\n\treturn state;\r\n};\r\nconst customGradientBarReducerInitialState: CustomGradientBarIdleState = {\r\n\tid: 'IDLE',\r\n};\r\n\r\nexport default function CustomGradientBar( {\r\n\tbackground,\r\n\thasGradient,\r\n\tvalue: controlPoints,\r\n\tonChange,\r\n\tdisableInserter = false,\r\n\tdisableAlpha = false,\r\n\t__experimentalIsRenderedInSidebar = false,\r\n}: CustomGradientBarProps ) {\r\n\tconst gradientMarkersContainerDomRef = useRef< HTMLDivElement >( null );\r\n\r\n\tconst [ gradientBarState, gradientBarStateDispatch ] = useReducer(\r\n\t\tcustomGradientBarReducer,\r\n\t\tcustomGradientBarReducerInitialState\r\n\t);\r\n\tconst onMouseEnterAndMove: MouseEventHandler< HTMLDivElement > = (\r\n\t\tevent\r\n\t) => {\r\n\t\tif ( ! gradientMarkersContainerDomRef.current ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst insertPosition = getHorizontalRelativeGradientPosition(\r\n\t\t\tevent.clientX,\r\n\t\t\tgradientMarkersContainerDomRef.current\r\n\t\t);\r\n\r\n\t\t// If the insert point is close to an existing control point don't show it.\r\n\t\tif (\r\n\t\t\tcontrolPoints.some( ( { position } ) => {\r\n\t\t\t\treturn (\r\n\t\t\t\t\tMath.abs( insertPosition - position ) <\r\n\t\t\t\t\tMINIMUM_DISTANCE_BETWEEN_INSERTER_AND_POINT\r\n\t\t\t\t);\r\n\t\t\t} )\r\n\t\t) {\r\n\t\t\tif ( gradientBarState.id === 'MOVING_INSERTER' ) {\r\n\t\t\t\tgradientBarStateDispatch( { type: 'STOP_INSERTER_MOVE' } );\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tgradientBarStateDispatch( { type: 'MOVE_INSERTER', insertPosition } );\r\n\t};\r\n\r\n\tconst onMouseLeave = () => {\r\n\t\tgradientBarStateDispatch( { type: 'STOP_INSERTER_MOVE' } );\r\n\t};\r\n\r\n\tconst isMovingInserter = gradientBarState.id === 'MOVING_INSERTER';\r\n\tconst isInsertingControlPoint =\r\n\t\tgradientBarState.id === 'INSERTING_CONTROL_POINT';\r\n\r\n\treturn (\r\n\t\t<div\r\n\t\t\tclassName={ clsx(\r\n\t\t\t\t'components-custom-gradient-picker__gradient-bar',\r\n\t\t\t\t{ 'has-gradient': hasGradient }\r\n\t\t\t) }\r\n\t\t\tonMouseEnter={ onMouseEnterAndMove }\r\n\t\t\tonMouseMove={ onMouseEnterAndMove }\r\n\t\t\tonMouseLeave={ onMouseLeave }\r\n\t\t>\r\n\t\t\t<div\r\n\t\t\t\tclassName=\"components-custom-gradient-picker__gradient-bar-background\"\r\n\t\t\t\tstyle={ {\r\n\t\t\t\t\tbackground,\r\n\t\t\t\t\topacity: hasGradient ? 1 : 0.4,\r\n\t\t\t\t} }\r\n\t\t\t/>\r\n\t\t\t<div\r\n\t\t\t\tref={ gradientMarkersContainerDomRef }\r\n\t\t\t\tclassName=\"components-custom-gradient-picker__markers-container\"\r\n\t\t\t>\r\n\t\t\t\t{ ! disableInserter &&\r\n\t\t\t\t\t( isMovingInserter || isInsertingControlPoint ) && (\r\n\t\t\t\t\t\t<ControlPoints.InsertPoint\r\n\t\t\t\t\t\t\t__experimentalIsRenderedInSidebar={\r\n\t\t\t\t\t\t\t\t__experimentalIsRenderedInSidebar\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdisableAlpha={ disableAlpha }\r\n\t\t\t\t\t\t\tinsertPosition={ gradientBarState.insertPosition }\r\n\t\t\t\t\t\t\tvalue={ controlPoints }\r\n\t\t\t\t\t\t\tonChange={ onChange }\r\n\t\t\t\t\t\t\tonOpenInserter={ () => {\r\n\t\t\t\t\t\t\t\tgradientBarStateDispatch( {\r\n\t\t\t\t\t\t\t\t\ttype: 'OPEN_INSERTER',\r\n\t\t\t\t\t\t\t\t} );\r\n\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\tonCloseInserter={ () => {\r\n\t\t\t\t\t\t\t\tgradientBarStateDispatch( {\r\n\t\t\t\t\t\t\t\t\ttype: 'CLOSE_INSERTER',\r\n\t\t\t\t\t\t\t\t} );\r\n\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t) }\r\n\t\t\t\t<ControlPoints\r\n\t\t\t\t\t__experimentalIsRenderedInSidebar={\r\n\t\t\t\t\t\t__experimentalIsRenderedInSidebar\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdisableAlpha={ disableAlpha }\r\n\t\t\t\t\tdisableRemove={ disableInserter }\r\n\t\t\t\t\tgradientPickerDomRef={ gradientMarkersContainerDomRef }\r\n\t\t\t\t\tignoreMarkerPosition={\r\n\t\t\t\t\t\tisInsertingControlPoint\r\n\t\t\t\t\t\t\t? gradientBarState.insertPosition\r\n\t\t\t\t\t\t\t: undefined\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvalue={ controlPoints }\r\n\t\t\t\t\tonChange={ onChange }\r\n\t\t\t\t\tonStartControlPointChange={ () => {\r\n\t\t\t\t\t\tgradientBarStateDispatch( {\r\n\t\t\t\t\t\t\ttype: 'START_CONTROL_CHANGE',\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t} }\r\n\t\t\t\t\tonStopControlPointChange={ () => {\r\n\t\t\t\t\t\tgradientBarStateDispatch( {\r\n\t\t\t\t\t\t\ttype: 'STOP_CONTROL_CHANGE',\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t} }\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,OAAOA,IAAI,MAAM,MAAM;;AAEvB;AACA;AACA;AACA,SAASC,MAAM,EAAEC,UAAU,QAAQ,oBAAoB;;AAEvD;AACA;AACA;AACA,OAAOC,aAAa,MAAM,kBAAkB;AAC5C,SAASC,qCAAqC,QAAQ,SAAS;AAC/D,SAASC,2CAA2C,QAAQ,aAAa;AAAC,SAAAC,GAAA,IAAAC,IAAA;AAAA,SAAAC,IAAA,IAAAC,KAAA;AAS1E,MAAMC,wBAAwB,GAAGA,CAChCC,KAAoC,EACpCC,MAAsC,KACH;EACnC,QAASA,MAAM,CAACC,IAAI;IACnB,KAAK,eAAe;MACnB,IAAKF,KAAK,CAACG,EAAE,KAAK,MAAM,IAAIH,KAAK,CAACG,EAAE,KAAK,iBAAiB,EAAG;QAC5D,OAAO;UACNA,EAAE,EAAE,iBAAiB;UACrBC,cAAc,EAAEH,MAAM,CAACG;QACxB,CAAC;MACF;MACA;IACD,KAAK,oBAAoB;MACxB,IAAKJ,KAAK,CAACG,EAAE,KAAK,iBAAiB,EAAG;QACrC,OAAO;UACNA,EAAE,EAAE;QACL,CAAC;MACF;MACA;IACD,KAAK,eAAe;MACnB,IAAKH,KAAK,CAACG,EAAE,KAAK,iBAAiB,EAAG;QACrC,OAAO;UACNA,EAAE,EAAE,yBAAyB;UAC7BC,cAAc,EAAEJ,KAAK,CAACI;QACvB,CAAC;MACF;MACA;IACD,KAAK,gBAAgB;MACpB,IAAKJ,KAAK,CAACG,EAAE,KAAK,yBAAyB,EAAG;QAC7C,OAAO;UACNA,EAAE,EAAE;QACL,CAAC;MACF;MACA;IACD,KAAK,sBAAsB;MAC1B,IAAKH,KAAK,CAACG,EAAE,KAAK,MAAM,EAAG;QAC1B,OAAO;UACNA,EAAE,EAAE;QACL,CAAC;MACF;MACA;IACD,KAAK,qBAAqB;MACzB,IAAKH,KAAK,CAACG,EAAE,KAAK,sBAAsB,EAAG;QAC1C,OAAO;UACNA,EAAE,EAAE;QACL,CAAC;MACF;MACA;EACF;EACA,OAAOH,KAAK;AACb,CAAC;AACD,MAAMK,oCAAgE,GAAG;EACxEF,EAAE,EAAE;AACL,CAAC;AAED,eAAe,SAASG,iBAAiBA,CAAE;EAC1CC,UAAU;EACVC,WAAW;EACXC,KAAK,EAAEC,aAAa;EACpBC,QAAQ;EACRC,eAAe,GAAG,KAAK;EACvBC,YAAY,GAAG,KAAK;EACpBC,iCAAiC,GAAG;AACb,CAAC,EAAG;EAC3B,MAAMC,8BAA8B,GAAGzB,MAAM,CAAoB,IAAK,CAAC;EAEvE,MAAM,CAAE0B,gBAAgB,EAAEC,wBAAwB,CAAE,GAAG1B,UAAU,CAChEQ,wBAAwB,EACxBM,oCACD,CAAC;EACD,MAAMa,mBAAwD,GAC7DC,KAAK,IACD;IACJ,IAAK,CAAEJ,8BAA8B,CAACK,OAAO,EAAG;MAC/C;IACD;IAEA,MAAMhB,cAAc,GAAGX,qCAAqC,CAC3D0B,KAAK,CAACE,OAAO,EACbN,8BAA8B,CAACK,OAChC,CAAC;;IAED;IACA,IACCV,aAAa,CAACY,IAAI,CAAE,CAAE;MAAEC;IAAS,CAAC,KAAM;MACvC,OACCC,IAAI,CAACC,GAAG,CAAErB,cAAc,GAAGmB,QAAS,CAAC,GACrC7B,2CAA2C;IAE7C,CAAE,CAAC,EACF;MACD,IAAKsB,gBAAgB,CAACb,EAAE,KAAK,iBAAiB,EAAG;QAChDc,wBAAwB,CAAE;UAAEf,IAAI,EAAE;QAAqB,CAAE,CAAC;MAC3D;MACA;IACD;IAEAe,wBAAwB,CAAE;MAAEf,IAAI,EAAE,eAAe;MAAEE;IAAe,CAAE,CAAC;EACtE,CAAC;EAED,MAAMsB,YAAY,GAAGA,CAAA,KAAM;IAC1BT,wBAAwB,CAAE;MAAEf,IAAI,EAAE;IAAqB,CAAE,CAAC;EAC3D,CAAC;EAED,MAAMyB,gBAAgB,GAAGX,gBAAgB,CAACb,EAAE,KAAK,iBAAiB;EAClE,MAAMyB,uBAAuB,GAC5BZ,gBAAgB,CAACb,EAAE,KAAK,yBAAyB;EAElD,oBACCL,KAAA;IACC+B,SAAS,EAAGxC,IAAI,CACf,iDAAiD,EACjD;MAAE,cAAc,EAAEmB;IAAY,CAC/B,CAAG;IACHsB,YAAY,EAAGZ,mBAAqB;IACpCa,WAAW,EAAGb,mBAAqB;IACnCQ,YAAY,EAAGA,YAAc;IAAAM,QAAA,gBAE7BpC,IAAA;MACCiC,SAAS,EAAC,4DAA4D;MACtEI,KAAK,EAAG;QACP1B,UAAU;QACV2B,OAAO,EAAE1B,WAAW,GAAG,CAAC,GAAG;MAC5B;IAAG,CACH,CAAC,eACFV,KAAA;MACCqC,GAAG,EAAGpB,8BAAgC;MACtCc,SAAS,EAAC,sDAAsD;MAAAG,QAAA,GAE9D,CAAEpB,eAAe,KAChBe,gBAAgB,IAAIC,uBAAuB,CAAE,iBAC9ChC,IAAA,CAACJ,aAAa,CAAC4C,WAAW;QACzBtB,iCAAiC,EAChCA,iCACA;QACDD,YAAY,EAAGA,YAAc;QAC7BT,cAAc,EAAGY,gBAAgB,CAACZ,cAAgB;QAClDK,KAAK,EAAGC,aAAe;QACvBC,QAAQ,EAAGA,QAAU;QACrB0B,cAAc,EAAGA,CAAA,KAAM;UACtBpB,wBAAwB,CAAE;YACzBf,IAAI,EAAE;UACP,CAAE,CAAC;QACJ,CAAG;QACHoC,eAAe,EAAGA,CAAA,KAAM;UACvBrB,wBAAwB,CAAE;YACzBf,IAAI,EAAE;UACP,CAAE,CAAC;QACJ;MAAG,CACH,CACD,eACFN,IAAA,CAACJ,aAAa;QACbsB,iCAAiC,EAChCA,iCACA;QACDD,YAAY,EAAGA,YAAc;QAC7B0B,aAAa,EAAG3B,eAAiB;QACjC4B,oBAAoB,EAAGzB,8BAAgC;QACvD0B,oBAAoB,EACnBb,uBAAuB,GACpBZ,gBAAgB,CAACZ,cAAc,GAC/BsC,SACH;QACDjC,KAAK,EAAGC,aAAe;QACvBC,QAAQ,EAAGA,QAAU;QACrBgC,yBAAyB,EAAGA,CAAA,KAAM;UACjC1B,wBAAwB,CAAE;YACzBf,IAAI,EAAE;UACP,CAAE,CAAC;QACJ,CAAG;QACH0C,wBAAwB,EAAGA,CAAA,KAAM;UAChC3B,wBAAwB,CAAE;YACzBf,IAAI,EAAE;UACP,CAAE,CAAC;QACJ;MAAG,CACH,CAAC;IAAA,CACE,CAAC;EAAA,CACF,CAAC;AAER","ignoreList":[]}