{"version":3,"names":["clsx","useRef","useState","useMergeRefs","deprecated","contextConnect","useContextSystem","useControlledValue","Popover","jsx","_jsx","jsxs","_jsxs","UnconnectedDropdown","props","forwardedRef","renderContent","renderToggle","className","contentClassName","expandOnMobile","headerTitle","focusOnMount","popoverProps","onClose","onToggle","style","open","defaultOpen","position","variant","undefined","since","alternative","hint","fallbackPopoverAnchor","setFallbackPopoverAnchor","containerRef","isOpen","setIsOpen","defaultValue","value","onChange","closeIfFocusOutside","current","ownerDocument","dialog","activeElement","closest","contains","close","args","popoverPropsHaveAnchor","anchor","anchorRef","getAnchorRect","anchorRect","ref","tabIndex","children","onFocusOutside","offset","Dropdown"],"sources":["@wordpress/components/src/dropdown/index.tsx"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport clsx from 'clsx';\r\nimport type { ForwardedRef } from 'react';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { useRef, useState } from '@wordpress/element';\r\nimport { useMergeRefs } from '@wordpress/compose';\r\nimport deprecated from '@wordpress/deprecated';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { contextConnect, useContextSystem } from '../context';\r\nimport { useControlledValue } from '../utils/hooks';\r\nimport Popover from '../popover';\r\nimport type { DropdownProps, DropdownInternalContext } from './types';\r\n\r\nconst UnconnectedDropdown = (\r\n\tprops: DropdownProps,\r\n\tforwardedRef: ForwardedRef< any >\r\n) => {\r\n\tconst {\r\n\t\trenderContent,\r\n\t\trenderToggle,\r\n\t\tclassName,\r\n\t\tcontentClassName,\r\n\t\texpandOnMobile,\r\n\t\theaderTitle,\r\n\t\tfocusOnMount,\r\n\t\tpopoverProps,\r\n\t\tonClose,\r\n\t\tonToggle,\r\n\t\tstyle,\r\n\r\n\t\topen,\r\n\t\tdefaultOpen,\r\n\r\n\t\t// Deprecated props\r\n\t\tposition,\r\n\r\n\t\t// From context system\r\n\t\tvariant,\r\n\t} = useContextSystem< DropdownProps & DropdownInternalContext >(\r\n\t\tprops,\r\n\t\t'Dropdown'\r\n\t);\r\n\r\n\tif ( position !== undefined ) {\r\n\t\tdeprecated( '`position` prop in wp.components.Dropdown', {\r\n\t\t\tsince: '6.2',\r\n\t\t\talternative: '`popoverProps.placement` prop',\r\n\t\t\thint: 'Note that the `position` prop will override any values passed through the `popoverProps.placement` prop.',\r\n\t\t} );\r\n\t}\r\n\r\n\t// Use internal state instead of a ref to make sure that the component\r\n\t// re-renders when the popover's anchor updates.\r\n\tconst [ fallbackPopoverAnchor, setFallbackPopoverAnchor ] =\r\n\t\tuseState< HTMLDivElement | null >( null );\r\n\tconst containerRef = useRef< HTMLDivElement >();\r\n\r\n\tconst [ isOpen, setIsOpen ] = useControlledValue( {\r\n\t\tdefaultValue: defaultOpen,\r\n\t\tvalue: open,\r\n\t\tonChange: onToggle,\r\n\t} );\r\n\r\n\t/**\r\n\t * Closes the popover when focus leaves it unless the toggle was pressed or\r\n\t * focus has moved to a separate dialog. The former is to let the toggle\r\n\t * handle closing the popover and the latter is to preserve presence in\r\n\t * case a dialog has opened, allowing focus to return when it's dismissed.\r\n\t */\r\n\tfunction closeIfFocusOutside() {\r\n\t\tif ( ! containerRef.current ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst { ownerDocument } = containerRef.current;\r\n\t\tconst dialog =\r\n\t\t\townerDocument?.activeElement?.closest( '[role=\"dialog\"]' );\r\n\t\tif (\r\n\t\t\t! containerRef.current.contains( ownerDocument.activeElement ) &&\r\n\t\t\t( ! dialog || dialog.contains( containerRef.current ) )\r\n\t\t) {\r\n\t\t\tclose();\r\n\t\t}\r\n\t}\r\n\r\n\tfunction close() {\r\n\t\tonClose?.();\r\n\t\tsetIsOpen( false );\r\n\t}\r\n\r\n\tconst args = {\r\n\t\tisOpen: !! isOpen,\r\n\t\tonToggle: () => setIsOpen( ! isOpen ),\r\n\t\tonClose: close,\r\n\t};\r\n\tconst popoverPropsHaveAnchor =\r\n\t\t!! popoverProps?.anchor ||\r\n\t\t// Note: `anchorRef`, `getAnchorRect` and `anchorRect` are deprecated and\r\n\t\t// be removed from `Popover` from WordPress 6.3\r\n\t\t!! popoverProps?.anchorRef ||\r\n\t\t!! popoverProps?.getAnchorRect ||\r\n\t\t!! popoverProps?.anchorRect;\r\n\r\n\treturn (\r\n\t\t<div\r\n\t\t\tclassName={ className }\r\n\t\t\tref={ useMergeRefs( [\r\n\t\t\t\tcontainerRef,\r\n\t\t\t\tforwardedRef,\r\n\t\t\t\tsetFallbackPopoverAnchor,\r\n\t\t\t] ) }\r\n\t\t\t// Some UAs focus the closest focusable parent when the toggle is\r\n\t\t\t// clicked. Making this div focusable ensures such UAs will focus\r\n\t\t\t// it and `closeIfFocusOutside` can tell if the toggle was clicked.\r\n\t\t\ttabIndex={ -1 }\r\n\t\t\tstyle={ style }\r\n\t\t>\r\n\t\t\t{ renderToggle( args ) }\r\n\t\t\t{ isOpen && (\r\n\t\t\t\t<Popover\r\n\t\t\t\t\tposition={ position }\r\n\t\t\t\t\tonClose={ close }\r\n\t\t\t\t\tonFocusOutside={ closeIfFocusOutside }\r\n\t\t\t\t\texpandOnMobile={ expandOnMobile }\r\n\t\t\t\t\theaderTitle={ headerTitle }\r\n\t\t\t\t\tfocusOnMount={ focusOnMount }\r\n\t\t\t\t\t// This value is used to ensure that the dropdowns\r\n\t\t\t\t\t// align with the editor header by default.\r\n\t\t\t\t\toffset={ 13 }\r\n\t\t\t\t\tanchor={\r\n\t\t\t\t\t\t! popoverPropsHaveAnchor\r\n\t\t\t\t\t\t\t? fallbackPopoverAnchor\r\n\t\t\t\t\t\t\t: undefined\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvariant={ variant }\r\n\t\t\t\t\t{ ...popoverProps }\r\n\t\t\t\t\tclassName={ clsx(\r\n\t\t\t\t\t\t'components-dropdown__content',\r\n\t\t\t\t\t\tpopoverProps?.className,\r\n\t\t\t\t\t\tcontentClassName\r\n\t\t\t\t\t) }\r\n\t\t\t\t>\r\n\t\t\t\t\t{ renderContent( args ) }\r\n\t\t\t\t</Popover>\r\n\t\t\t) }\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\n/**\r\n * Renders a button that opens a floating content modal when clicked.\r\n *\r\n * ```jsx\r\n * import { Button, Dropdown } from '@wordpress/components';\r\n *\r\n * const MyDropdown = () => (\r\n *   <Dropdown\r\n *     className=\"my-container-class-name\"\r\n *     contentClassName=\"my-dropdown-content-classname\"\r\n *     popoverProps={ { placement: 'bottom-start' } }\r\n *     renderToggle={ ( { isOpen, onToggle } ) => (\r\n *       <Button\r\n *         variant=\"primary\"\r\n *         onClick={ onToggle }\r\n *         aria-expanded={ isOpen }\r\n *       >\r\n *         Toggle Dropdown!\r\n *       </Button>\r\n *     ) }\r\n *     renderContent={ () => <div>This is the content of the dropdown.</div> }\r\n *   />\r\n * );\r\n * ```\r\n */\r\nexport const Dropdown = contextConnect( UnconnectedDropdown, 'Dropdown' );\r\n\r\nexport default Dropdown;\r\n"],"mappings":"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","ignoreList":[]}