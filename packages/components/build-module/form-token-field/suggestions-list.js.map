{"version":3,"names":["clsx","useRefEffect","jsx","_jsx","jsxs","_jsxs","handleMouseDown","e","preventDefault","SuggestionsList","selectedIndex","scrollIntoView","match","onHover","onSelect","suggestions","displayTransform","instanceId","__experimentalRenderItem","listRef","listNode","rafId","children","behavior","block","inline","undefined","cancelAnimationFrame","handleHover","suggestion","handleClick","computeSuggestionMatch","matchText","toLocaleLowerCase","length","transformedSuggestion","indexOfMatch","indexOf","suggestionBeforeMatch","substring","suggestionMatch","suggestionAfterMatch","ref","className","id","role","map","index","isSelected","isDisabled","disabled","key","value","output","item","onMouseDown","onClick","onMouseEnter"],"sources":["@wordpress/components/src/form-token-field/suggestions-list.tsx"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport clsx from 'clsx';\r\nimport type { MouseEventHandler, ReactNode } from 'react';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { useRefEffect } from '@wordpress/compose';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport type { SuggestionsListProps } from './types';\r\n\r\nconst handleMouseDown: MouseEventHandler = ( e ) => {\r\n\t// By preventing default here, we will not lose focus of <input> when clicking a suggestion.\r\n\te.preventDefault();\r\n};\r\n\r\nexport function SuggestionsList<\r\n\tT extends string | { value: string; disabled?: boolean },\r\n>( {\r\n\tselectedIndex,\r\n\tscrollIntoView,\r\n\tmatch,\r\n\tonHover,\r\n\tonSelect,\r\n\tsuggestions = [],\r\n\tdisplayTransform,\r\n\tinstanceId,\r\n\t__experimentalRenderItem,\r\n}: SuggestionsListProps< T > ) {\r\n\tconst listRef = useRefEffect< HTMLUListElement >(\r\n\t\t( listNode ) => {\r\n\t\t\t// only have to worry about scrolling selected suggestion into view\r\n\t\t\t// when already expanded.\r\n\t\t\tlet rafId: number | undefined;\r\n\t\t\tif (\r\n\t\t\t\tselectedIndex > -1 &&\r\n\t\t\t\tscrollIntoView &&\r\n\t\t\t\tlistNode.children[ selectedIndex ]\r\n\t\t\t) {\r\n\t\t\t\tlistNode.children[ selectedIndex ].scrollIntoView( {\r\n\t\t\t\t\tbehavior: 'instant',\r\n\t\t\t\t\tblock: 'nearest',\r\n\t\t\t\t\tinline: 'nearest',\r\n\t\t\t\t} );\r\n\t\t\t}\r\n\r\n\t\t\treturn () => {\r\n\t\t\t\tif ( rafId !== undefined ) {\r\n\t\t\t\t\tcancelAnimationFrame( rafId );\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\t[ selectedIndex, scrollIntoView ]\r\n\t);\r\n\r\n\tconst handleHover = ( suggestion: T ) => {\r\n\t\treturn () => {\r\n\t\t\tonHover?.( suggestion );\r\n\t\t};\r\n\t};\r\n\r\n\tconst handleClick = ( suggestion: T ) => {\r\n\t\treturn () => {\r\n\t\t\tonSelect?.( suggestion );\r\n\t\t};\r\n\t};\r\n\r\n\tconst computeSuggestionMatch = ( suggestion: T ) => {\r\n\t\tconst matchText = displayTransform( match ).toLocaleLowerCase();\r\n\t\tif ( matchText.length === 0 ) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst transformedSuggestion = displayTransform( suggestion );\r\n\t\tconst indexOfMatch = transformedSuggestion\r\n\t\t\t.toLocaleLowerCase()\r\n\t\t\t.indexOf( matchText );\r\n\r\n\t\treturn {\r\n\t\t\tsuggestionBeforeMatch: transformedSuggestion.substring(\r\n\t\t\t\t0,\r\n\t\t\t\tindexOfMatch\r\n\t\t\t),\r\n\t\t\tsuggestionMatch: transformedSuggestion.substring(\r\n\t\t\t\tindexOfMatch,\r\n\t\t\t\tindexOfMatch + matchText.length\r\n\t\t\t),\r\n\t\t\tsuggestionAfterMatch: transformedSuggestion.substring(\r\n\t\t\t\tindexOfMatch + matchText.length\r\n\t\t\t),\r\n\t\t};\r\n\t};\r\n\r\n\treturn (\r\n\t\t<ul\r\n\t\t\tref={ listRef }\r\n\t\t\tclassName=\"components-form-token-field__suggestions-list\"\r\n\t\t\tid={ `components-form-token-suggestions-${ instanceId }` }\r\n\t\t\trole=\"listbox\"\r\n\t\t>\r\n\t\t\t{ suggestions.map( ( suggestion, index ) => {\r\n\t\t\t\tconst matchText = computeSuggestionMatch( suggestion );\r\n\t\t\t\tconst isSelected = index === selectedIndex;\r\n\t\t\t\tconst isDisabled =\r\n\t\t\t\t\ttypeof suggestion === 'object' && suggestion?.disabled;\r\n\t\t\t\tconst key =\r\n\t\t\t\t\ttypeof suggestion === 'object' && 'value' in suggestion\r\n\t\t\t\t\t\t? suggestion?.value\r\n\t\t\t\t\t\t: displayTransform( suggestion );\r\n\r\n\t\t\t\tconst className = clsx(\r\n\t\t\t\t\t'components-form-token-field__suggestion',\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t'is-selected': isSelected,\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\r\n\t\t\t\tlet output: ReactNode;\r\n\r\n\t\t\t\tif ( typeof __experimentalRenderItem === 'function' ) {\r\n\t\t\t\t\toutput = __experimentalRenderItem( { item: suggestion } );\r\n\t\t\t\t} else if ( matchText ) {\r\n\t\t\t\t\toutput = (\r\n\t\t\t\t\t\t<span aria-label={ displayTransform( suggestion ) }>\r\n\t\t\t\t\t\t\t{ matchText.suggestionBeforeMatch }\r\n\t\t\t\t\t\t\t<strong className=\"components-form-token-field__suggestion-match\">\r\n\t\t\t\t\t\t\t\t{ matchText.suggestionMatch }\r\n\t\t\t\t\t\t\t</strong>\r\n\t\t\t\t\t\t\t{ matchText.suggestionAfterMatch }\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\toutput = displayTransform( suggestion );\r\n\t\t\t\t}\r\n\r\n\t\t\t\t/* eslint-disable jsx-a11y/click-events-have-key-events */\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<li\r\n\t\t\t\t\t\tid={ `components-form-token-suggestions-${ instanceId }-${ index }` }\r\n\t\t\t\t\t\trole=\"option\"\r\n\t\t\t\t\t\tclassName={ className }\r\n\t\t\t\t\t\tkey={ key }\r\n\t\t\t\t\t\tonMouseDown={ handleMouseDown }\r\n\t\t\t\t\t\tonClick={ handleClick( suggestion ) }\r\n\t\t\t\t\t\tonMouseEnter={ handleHover( suggestion ) }\r\n\t\t\t\t\t\taria-selected={ index === selectedIndex }\r\n\t\t\t\t\t\taria-disabled={ isDisabled }\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{ output }\r\n\t\t\t\t\t</li>\r\n\t\t\t\t);\r\n\t\t\t\t/* eslint-enable jsx-a11y/click-events-have-key-events */\r\n\t\t\t} ) }\r\n\t\t</ul>\r\n\t);\r\n}\r\n\r\nexport default SuggestionsList;\r\n"],"mappings":"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","ignoreList":[]}