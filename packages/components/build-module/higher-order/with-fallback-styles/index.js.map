{"version":3,"names":["fastDeepEqual","Component","createHigherOrderComponent","jsx","_jsx","jsxs","_jsxs","mapNodeToProps","WrappedComponent","constructor","props","nodeRef","node","state","fallbackStyles","undefined","grabStylesCompleted","bindRef","bind","componentDidMount","grabFallbackStyles","componentDidUpdate","newFallbackStyles","setState","Object","values","every","Boolean","render","wrappedComponent","ref","children"],"sources":["@wordpress/components/src/higher-order/with-fallback-styles/index.tsx"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport fastDeepEqual from 'fast-deep-equal/es6';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { Component } from '@wordpress/element';\r\nimport { createHigherOrderComponent } from '@wordpress/compose';\r\n\r\ntype Props = {\r\n\tnode?: HTMLElement;\r\n\t[ key: string ]: any;\r\n};\r\n\r\ntype State = {\r\n\tfallbackStyles?: { [ key: string ]: any };\r\n\tgrabStylesCompleted: boolean;\r\n};\r\n\r\nexport default (\r\n\tmapNodeToProps: (\r\n\t\tnode: HTMLElement,\r\n\t\tprops: Props\r\n\t) => { [ key: string ]: any }\r\n) =>\r\n\tcreateHigherOrderComponent( ( WrappedComponent ) => {\r\n\t\treturn class extends Component< Props, State > {\r\n\t\t\tnodeRef?: HTMLElement;\r\n\r\n\t\t\tconstructor( props: Props ) {\r\n\t\t\t\tsuper( props );\r\n\t\t\t\tthis.nodeRef = this.props.node;\r\n\t\t\t\tthis.state = {\r\n\t\t\t\t\tfallbackStyles: undefined,\r\n\t\t\t\t\tgrabStylesCompleted: false,\r\n\t\t\t\t};\r\n\r\n\t\t\t\tthis.bindRef = this.bindRef.bind( this );\r\n\t\t\t}\r\n\r\n\t\t\tbindRef( node: HTMLDivElement ) {\r\n\t\t\t\tif ( ! node ) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tthis.nodeRef = node;\r\n\t\t\t}\r\n\r\n\t\t\tcomponentDidMount() {\r\n\t\t\t\tthis.grabFallbackStyles();\r\n\t\t\t}\r\n\r\n\t\t\tcomponentDidUpdate() {\r\n\t\t\t\tthis.grabFallbackStyles();\r\n\t\t\t}\r\n\r\n\t\t\tgrabFallbackStyles() {\r\n\t\t\t\tconst { grabStylesCompleted, fallbackStyles } = this.state;\r\n\t\t\t\tif ( this.nodeRef && ! grabStylesCompleted ) {\r\n\t\t\t\t\tconst newFallbackStyles = mapNodeToProps(\r\n\t\t\t\t\t\tthis.nodeRef,\r\n\t\t\t\t\t\tthis.props\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\t! fastDeepEqual( newFallbackStyles, fallbackStyles )\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tthis.setState( {\r\n\t\t\t\t\t\t\tfallbackStyles: newFallbackStyles,\r\n\t\t\t\t\t\t\tgrabStylesCompleted:\r\n\t\t\t\t\t\t\t\tObject.values( newFallbackStyles ).every(\r\n\t\t\t\t\t\t\t\t\tBoolean\r\n\t\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\trender() {\r\n\t\t\t\tconst wrappedComponent = (\r\n\t\t\t\t\t<WrappedComponent\r\n\t\t\t\t\t\t{ ...this.props }\r\n\t\t\t\t\t\t{ ...this.state.fallbackStyles }\r\n\t\t\t\t\t/>\r\n\t\t\t\t);\r\n\t\t\t\treturn this.props.node ? (\r\n\t\t\t\t\twrappedComponent\r\n\t\t\t\t) : (\r\n\t\t\t\t\t<div ref={ this.bindRef }> { wrappedComponent } </div>\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t};\r\n\t}, 'withFallbackStyles' );\r\n"],"mappings":"AAAA;AACA;AACA;AACA,OAAOA,aAAa,MAAM,qBAAqB;;AAE/C;AACA;AACA;AACA,SAASC,SAAS,QAAQ,oBAAoB;AAC9C,SAASC,0BAA0B,QAAQ,oBAAoB;AAAC,SAAAC,GAAA,IAAAC,IAAA;AAAA,SAAAC,IAAA,IAAAC,KAAA;AAYhE,gBACCC,cAG6B,IAE7BL,0BAA0B,CAAIM,gBAAgB,IAAM;EACnD,OAAO,cAAcP,SAAS,CAAiB;IAG9CQ,WAAWA,CAAEC,KAAY,EAAG;MAC3B,KAAK,CAAEA,KAAM,CAAC;MACd,IAAI,CAACC,OAAO,GAAG,IAAI,CAACD,KAAK,CAACE,IAAI;MAC9B,IAAI,CAACC,KAAK,GAAG;QACZC,cAAc,EAAEC,SAAS;QACzBC,mBAAmB,EAAE;MACtB,CAAC;MAED,IAAI,CAACC,OAAO,GAAG,IAAI,CAACA,OAAO,CAACC,IAAI,CAAE,IAAK,CAAC;IACzC;IAEAD,OAAOA,CAAEL,IAAoB,EAAG;MAC/B,IAAK,CAAEA,IAAI,EAAG;QACb;MACD;MACA,IAAI,CAACD,OAAO,GAAGC,IAAI;IACpB;IAEAO,iBAAiBA,CAAA,EAAG;MACnB,IAAI,CAACC,kBAAkB,CAAC,CAAC;IAC1B;IAEAC,kBAAkBA,CAAA,EAAG;MACpB,IAAI,CAACD,kBAAkB,CAAC,CAAC;IAC1B;IAEAA,kBAAkBA,CAAA,EAAG;MACpB,MAAM;QAAEJ,mBAAmB;QAAEF;MAAe,CAAC,GAAG,IAAI,CAACD,KAAK;MAC1D,IAAK,IAAI,CAACF,OAAO,IAAI,CAAEK,mBAAmB,EAAG;QAC5C,MAAMM,iBAAiB,GAAGf,cAAc,CACvC,IAAI,CAACI,OAAO,EACZ,IAAI,CAACD,KACN,CAAC;QAED,IACC,CAAEV,aAAa,CAAEsB,iBAAiB,EAAER,cAAe,CAAC,EACnD;UACD,IAAI,CAACS,QAAQ,CAAE;YACdT,cAAc,EAAEQ,iBAAiB;YACjCN,mBAAmB,EAClBQ,MAAM,CAACC,MAAM,CAAEH,iBAAkB,CAAC,CAACI,KAAK,CACvCC,OACD;UACF,CAAE,CAAC;QACJ;MACD;IACD;IAEAC,MAAMA,CAAA,EAAG;MACR,MAAMC,gBAAgB,gBACrBzB,IAAA,CAACI,gBAAgB;QAAA,GACX,IAAI,CAACE,KAAK;QAAA,GACV,IAAI,CAACG,KAAK,CAACC;MAAc,CAC9B,CACD;MACD,OAAO,IAAI,CAACJ,KAAK,CAACE,IAAI,GACrBiB,gBAAgB,gBAEhBvB,KAAA;QAAKwB,GAAG,EAAG,IAAI,CAACb,OAAS;QAAAc,QAAA,GAAC,GAAC,EAAEF,gBAAgB,EAAE,GAAC;MAAA,CAAK,CACrD;IACF;EACD,CAAC;AACF,CAAC,EAAE,oBAAqB,CAAC","ignoreList":[]}