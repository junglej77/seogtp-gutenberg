{"version":3,"names":["v4","uuid","forwardRef","useState","useMemo","createHigherOrderComponent","NoticeList","jsx","_jsx","OriginalComponent","Component","props","ref","noticeList","setNoticeList","noticeOperations","createNotice","notice","noticeToAdd","id","current","createErrorNotice","msg","status","content","removeNotice","filter","removeAllNotices","propsOut","noticeUI","length","className","notices","onRemove","isForwardRef","render"],"sources":["@wordpress/components/src/higher-order/with-notices/index.tsx"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport { v4 as uuid } from 'uuid';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { forwardRef, useState, useMemo } from '@wordpress/element';\r\nimport { createHigherOrderComponent } from '@wordpress/compose';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport NoticeList from '../../notice/list';\r\nimport type { WithNoticeProps } from './types';\r\n\r\n/**\r\n * Override the default edit UI to include notices if supported.\r\n *\r\n * Wrapping the original component with `withNotices` encapsulates the component\r\n * with the additional props `noticeOperations` and `noticeUI`.\r\n *\r\n * ```jsx\r\n * import { withNotices, Button } from '@wordpress/components';\r\n *\r\n * const MyComponentWithNotices = withNotices(\r\n * \t( { noticeOperations, noticeUI } ) => {\r\n * \t\tconst addError = () =>\r\n * \t\t\tnoticeOperations.createErrorNotice( 'Error message' );\r\n * \t\treturn (\r\n * \t\t\t<div>\r\n * \t\t\t\t{ noticeUI }\r\n * \t\t\t\t<Button variant=\"secondary\" onClick={ addError }>\r\n * \t\t\t\t\tAdd error\r\n * \t\t\t\t</Button>\r\n * \t\t\t</div>\r\n * \t\t);\r\n * \t}\r\n * );\r\n * ```\r\n *\r\n * @param OriginalComponent Original component.\r\n *\r\n * @return Wrapped component.\r\n */\r\nexport default createHigherOrderComponent( ( OriginalComponent ) => {\r\n\tfunction Component(\r\n\t\tprops: { [ key: string ]: any },\r\n\t\tref: React.ForwardedRef< any >\r\n\t) {\r\n\t\tconst [ noticeList, setNoticeList ] = useState<\r\n\t\t\tWithNoticeProps[ 'noticeList' ]\r\n\t\t>( [] );\r\n\r\n\t\tconst noticeOperations = useMemo<\r\n\t\t\tWithNoticeProps[ 'noticeOperations' ]\r\n\t\t>( () => {\r\n\t\t\tconst createNotice: WithNoticeProps[ 'noticeOperations' ][ 'createNotice' ] =\r\n\t\t\t\t( notice ) => {\r\n\t\t\t\t\tconst noticeToAdd = notice.id\r\n\t\t\t\t\t\t? notice\r\n\t\t\t\t\t\t: { ...notice, id: uuid() };\r\n\t\t\t\t\tsetNoticeList( ( current ) => [ ...current, noticeToAdd ] );\r\n\t\t\t\t};\r\n\r\n\t\t\treturn {\r\n\t\t\t\tcreateNotice,\r\n\t\t\t\tcreateErrorNotice: ( msg ) => {\r\n\t\t\t\t\t// @ts-expect-error TODO: Missing `id`, potentially a bug\r\n\t\t\t\t\tcreateNotice( {\r\n\t\t\t\t\t\tstatus: 'error',\r\n\t\t\t\t\t\tcontent: msg,\r\n\t\t\t\t\t} );\r\n\t\t\t\t},\r\n\t\t\t\tremoveNotice: ( id ) => {\r\n\t\t\t\t\tsetNoticeList( ( current ) =>\r\n\t\t\t\t\t\tcurrent.filter( ( notice ) => notice.id !== id )\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t\tremoveAllNotices: () => {\r\n\t\t\t\t\tsetNoticeList( [] );\r\n\t\t\t\t},\r\n\t\t\t};\r\n\t\t}, [] );\r\n\r\n\t\tconst propsOut = {\r\n\t\t\t...props,\r\n\t\t\tnoticeList,\r\n\t\t\tnoticeOperations,\r\n\t\t\tnoticeUI: noticeList.length > 0 && (\r\n\t\t\t\t<NoticeList\r\n\t\t\t\t\tclassName=\"components-with-notices-ui\"\r\n\t\t\t\t\tnotices={ noticeList }\r\n\t\t\t\t\tonRemove={ noticeOperations.removeNotice }\r\n\t\t\t\t/>\r\n\t\t\t),\r\n\t\t};\r\n\r\n\t\treturn isForwardRef ? (\r\n\t\t\t<OriginalComponent { ...propsOut } ref={ ref } />\r\n\t\t) : (\r\n\t\t\t<OriginalComponent { ...propsOut } />\r\n\t\t);\r\n\t}\r\n\r\n\tlet isForwardRef: boolean;\r\n\t// @ts-expect-error - `render` will only be present when OriginalComponent was wrapped with forwardRef().\r\n\tconst { render } = OriginalComponent;\r\n\t// Returns a forwardRef if OriginalComponent appears to be a forwardRef.\r\n\tif ( typeof render === 'function' ) {\r\n\t\tisForwardRef = true;\r\n\t\treturn forwardRef( Component );\r\n\t}\r\n\treturn Component;\r\n}, 'withNotices' );\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,EAAE,IAAIC,IAAI,QAAQ,MAAM;;AAEjC;AACA;AACA;AACA,SAASC,UAAU,EAAEC,QAAQ,EAAEC,OAAO,QAAQ,oBAAoB;AAClE,SAASC,0BAA0B,QAAQ,oBAAoB;;AAE/D;AACA;AACA;AACA,OAAOC,UAAU,MAAM,mBAAmB;AAAC,SAAAC,GAAA,IAAAC,IAAA;AAG3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAeH,0BAA0B,CAAII,iBAAiB,IAAM;EACnE,SAASC,SAASA,CACjBC,KAA+B,EAC/BC,GAA8B,EAC7B;IACD,MAAM,CAAEC,UAAU,EAAEC,aAAa,CAAE,GAAGX,QAAQ,CAE3C,EAAG,CAAC;IAEP,MAAMY,gBAAgB,GAAGX,OAAO,CAE7B,MAAM;MACR,MAAMY,YAAqE,GACxEC,MAAM,IAAM;QACb,MAAMC,WAAW,GAAGD,MAAM,CAACE,EAAE,GAC1BF,MAAM,GACN;UAAE,GAAGA,MAAM;UAAEE,EAAE,EAAElB,IAAI,CAAC;QAAE,CAAC;QAC5Ba,aAAa,CAAIM,OAAO,IAAM,CAAE,GAAGA,OAAO,EAAEF,WAAW,CAAG,CAAC;MAC5D,CAAC;MAEF,OAAO;QACNF,YAAY;QACZK,iBAAiB,EAAIC,GAAG,IAAM;UAC7B;UACAN,YAAY,CAAE;YACbO,MAAM,EAAE,OAAO;YACfC,OAAO,EAAEF;UACV,CAAE,CAAC;QACJ,CAAC;QACDG,YAAY,EAAIN,EAAE,IAAM;UACvBL,aAAa,CAAIM,OAAO,IACvBA,OAAO,CAACM,MAAM,CAAIT,MAAM,IAAMA,MAAM,CAACE,EAAE,KAAKA,EAAG,CAChD,CAAC;QACF,CAAC;QACDQ,gBAAgB,EAAEA,CAAA,KAAM;UACvBb,aAAa,CAAE,EAAG,CAAC;QACpB;MACD,CAAC;IACF,CAAC,EAAE,EAAG,CAAC;IAEP,MAAMc,QAAQ,GAAG;MAChB,GAAGjB,KAAK;MACRE,UAAU;MACVE,gBAAgB;MAChBc,QAAQ,EAAEhB,UAAU,CAACiB,MAAM,GAAG,CAAC,iBAC9BtB,IAAA,CAACF,UAAU;QACVyB,SAAS,EAAC,4BAA4B;QACtCC,OAAO,EAAGnB,UAAY;QACtBoB,QAAQ,EAAGlB,gBAAgB,CAACU;MAAc,CAC1C;IAEH,CAAC;IAED,OAAOS,YAAY,gBAClB1B,IAAA,CAACC,iBAAiB;MAAA,GAAMmB,QAAQ;MAAGhB,GAAG,EAAGA;IAAK,CAAE,CAAC,gBAEjDJ,IAAA,CAACC,iBAAiB;MAAA,GAAMmB;IAAQ,CAAI,CACpC;EACF;EAEA,IAAIM,YAAqB;EACzB;EACA,MAAM;IAAEC;EAAO,CAAC,GAAG1B,iBAAiB;EACpC;EACA,IAAK,OAAO0B,MAAM,KAAK,UAAU,EAAG;IACnCD,YAAY,GAAG,IAAI;IACnB,OAAOhC,UAAU,CAAEQ,SAAU,CAAC;EAC/B;EACA,OAAOA,SAAS;AACjB,CAAC,EAAE,aAAc,CAAC","ignoreList":[]}