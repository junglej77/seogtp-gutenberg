{"version":3,"names":["useEffect","useLayoutEffect","useRef","useState","getDragCursor","dragDirection","dragCursor","useDragCursor","isDragging","document","documentElement","style","cursor","useDraft","props","previousValueRef","value","draft","setDraft","undefined","current","previousValue","isStale","onChange","nextValue","extra","Object","assign","onBlur","event"],"sources":["@wordpress/components/src/input-control/utils.ts"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport type { FocusEventHandler } from 'react';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport {\r\n\tuseEffect,\r\n\tuseLayoutEffect,\r\n\tuseRef,\r\n\tuseState,\r\n} from '@wordpress/element';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport type { InputChangeCallback } from './types';\r\n\r\n/**\r\n * Gets a CSS cursor value based on a drag direction.\r\n *\r\n * @param dragDirection The drag direction.\r\n * @return  The CSS cursor value.\r\n */\r\nexport function getDragCursor( dragDirection: string ): string {\r\n\tlet dragCursor = 'ns-resize';\r\n\r\n\tswitch ( dragDirection ) {\r\n\t\tcase 'n':\r\n\t\tcase 's':\r\n\t\t\tdragCursor = 'ns-resize';\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'e':\r\n\t\tcase 'w':\r\n\t\t\tdragCursor = 'ew-resize';\r\n\t\t\tbreak;\r\n\t}\r\n\r\n\treturn dragCursor;\r\n}\r\n\r\n/**\r\n * Custom hook that renders a drag cursor when dragging.\r\n *\r\n * @param {boolean} isDragging    The dragging state.\r\n * @param {string}  dragDirection The drag direction.\r\n *\r\n * @return {string} The CSS cursor value.\r\n */\r\nexport function useDragCursor(\r\n\tisDragging: boolean,\r\n\tdragDirection: string\r\n): string {\r\n\tconst dragCursor = getDragCursor( dragDirection );\r\n\r\n\tuseEffect( () => {\r\n\t\tif ( isDragging ) {\r\n\t\t\tdocument.documentElement.style.cursor = dragCursor;\r\n\t\t} else {\r\n\t\t\t// @ts-expect-error\r\n\t\t\tdocument.documentElement.style.cursor = null;\r\n\t\t}\r\n\t}, [ isDragging, dragCursor ] );\r\n\r\n\treturn dragCursor;\r\n}\r\n\r\nexport function useDraft( props: {\r\n\tvalue: string | undefined;\r\n\tonBlur?: FocusEventHandler;\r\n\tonChange: InputChangeCallback;\r\n} ) {\r\n\tconst previousValueRef = useRef( props.value );\r\n\tconst [ draft, setDraft ] = useState< {\r\n\t\tvalue?: string;\r\n\t\tisStale?: boolean;\r\n\t} >( {} );\r\n\tconst value = draft.value !== undefined ? draft.value : props.value;\r\n\r\n\t// Determines when to discard the draft value to restore controlled status.\r\n\t// To do so, it tracks the previous value and marks the draft value as stale\r\n\t// after each render.\r\n\tuseLayoutEffect( () => {\r\n\t\tconst { current: previousValue } = previousValueRef;\r\n\t\tpreviousValueRef.current = props.value;\r\n\t\tif ( draft.value !== undefined && ! draft.isStale ) {\r\n\t\t\tsetDraft( { ...draft, isStale: true } );\r\n\t\t} else if ( draft.isStale && props.value !== previousValue ) {\r\n\t\t\tsetDraft( {} );\r\n\t\t}\r\n\t}, [ props.value, draft ] );\r\n\r\n\tconst onChange: InputChangeCallback = ( nextValue, extra ) => {\r\n\t\t// Mutates the draft value to avoid an extra effect run.\r\n\t\tsetDraft( ( current ) =>\r\n\t\t\tObject.assign( current, { value: nextValue, isStale: false } )\r\n\t\t);\r\n\t\tprops.onChange( nextValue, extra );\r\n\t};\r\n\tconst onBlur: FocusEventHandler = ( event ) => {\r\n\t\tsetDraft( {} );\r\n\t\tprops.onBlur?.( event );\r\n\t};\r\n\r\n\treturn { value, onBlur, onChange };\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;;AAGA;AACA;AACA;AACA,SACCA,SAAS,EACTC,eAAe,EACfC,MAAM,EACNC,QAAQ,QACF,oBAAoB;;AAE3B;AACA;AACA;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,aAAaA,CAAEC,aAAqB,EAAW;EAC9D,IAAIC,UAAU,GAAG,WAAW;EAE5B,QAASD,aAAa;IACrB,KAAK,GAAG;IACR,KAAK,GAAG;MACPC,UAAU,GAAG,WAAW;MACxB;IAED,KAAK,GAAG;IACR,KAAK,GAAG;MACPA,UAAU,GAAG,WAAW;MACxB;EACF;EAEA,OAAOA,UAAU;AAClB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,aAAaA,CAC5BC,UAAmB,EACnBH,aAAqB,EACZ;EACT,MAAMC,UAAU,GAAGF,aAAa,CAAEC,aAAc,CAAC;EAEjDL,SAAS,CAAE,MAAM;IAChB,IAAKQ,UAAU,EAAG;MACjBC,QAAQ,CAACC,eAAe,CAACC,KAAK,CAACC,MAAM,GAAGN,UAAU;IACnD,CAAC,MAAM;MACN;MACAG,QAAQ,CAACC,eAAe,CAACC,KAAK,CAACC,MAAM,GAAG,IAAI;IAC7C;EACD,CAAC,EAAE,CAAEJ,UAAU,EAAEF,UAAU,CAAG,CAAC;EAE/B,OAAOA,UAAU;AAClB;AAEA,OAAO,SAASO,QAAQA,CAAEC,KAIzB,EAAG;EACH,MAAMC,gBAAgB,GAAGb,MAAM,CAAEY,KAAK,CAACE,KAAM,CAAC;EAC9C,MAAM,CAAEC,KAAK,EAAEC,QAAQ,CAAE,GAAGf,QAAQ,CAG/B,CAAC,CAAE,CAAC;EACT,MAAMa,KAAK,GAAGC,KAAK,CAACD,KAAK,KAAKG,SAAS,GAAGF,KAAK,CAACD,KAAK,GAAGF,KAAK,CAACE,KAAK;;EAEnE;EACA;EACA;EACAf,eAAe,CAAE,MAAM;IACtB,MAAM;MAAEmB,OAAO,EAAEC;IAAc,CAAC,GAAGN,gBAAgB;IACnDA,gBAAgB,CAACK,OAAO,GAAGN,KAAK,CAACE,KAAK;IACtC,IAAKC,KAAK,CAACD,KAAK,KAAKG,SAAS,IAAI,CAAEF,KAAK,CAACK,OAAO,EAAG;MACnDJ,QAAQ,CAAE;QAAE,GAAGD,KAAK;QAAEK,OAAO,EAAE;MAAK,CAAE,CAAC;IACxC,CAAC,MAAM,IAAKL,KAAK,CAACK,OAAO,IAAIR,KAAK,CAACE,KAAK,KAAKK,aAAa,EAAG;MAC5DH,QAAQ,CAAE,CAAC,CAAE,CAAC;IACf;EACD,CAAC,EAAE,CAAEJ,KAAK,CAACE,KAAK,EAAEC,KAAK,CAAG,CAAC;EAE3B,MAAMM,QAA6B,GAAGA,CAAEC,SAAS,EAAEC,KAAK,KAAM;IAC7D;IACAP,QAAQ,CAAIE,OAAO,IAClBM,MAAM,CAACC,MAAM,CAAEP,OAAO,EAAE;MAAEJ,KAAK,EAAEQ,SAAS;MAAEF,OAAO,EAAE;IAAM,CAAE,CAC9D,CAAC;IACDR,KAAK,CAACS,QAAQ,CAAEC,SAAS,EAAEC,KAAM,CAAC;EACnC,CAAC;EACD,MAAMG,MAAyB,GAAKC,KAAK,IAAM;IAC9CX,QAAQ,CAAE,CAAC,CAAE,CAAC;IACdJ,KAAK,CAACc,MAAM,GAAIC,KAAM,CAAC;EACxB,CAAC;EAED,OAAO;IAAEb,KAAK;IAAEY,MAAM;IAAEL;EAAS,CAAC;AACnC","ignoreList":[]}