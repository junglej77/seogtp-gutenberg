{"version":3,"names":["NavigationContainer","DefaultTheme","createStackNavigator","Animated","Easing","useAnimatedStyle","useSharedValue","withTiming","useContext","useMemo","useCallback","Children","useRef","cloneElement","usePreferredColorSchemeStyle","BottomSheetNavigationContext","BottomSheetNavigationProvider","BottomSheetContext","styles","jsx","_jsx","AnimationSpec","animation","config","duration","easing","ease","fadeConfig","current","cardStyle","opacity","progress","options","transitionSpec","open","close","headerShown","gestureEnabled","cardStyleInterpolator","keyboardHandlingEnabled","HEIGHT_ANIMATION_DURATION","DEFAULT_HEIGHT","BottomSheetNavigationContainer","children","animate","main","theme","style","testID","Stack","navigationContext","maxHeight","sheetMaxHeight","isMaxHeightSet","isSheetMaxHeightSet","currentHeight","value","backgroundStyle","background","backgroundDark","defaultTheme","colors","backgroundColor","_theme","setHeight","height","Math","round","newHeight","min","shouldAnimate","out","cubic","animatedStyles","screens","map","child","screen","name","otherProps","props","isNested","Screen","View","Navigator","screenOptions","detachInactiveScreens"],"sources":["@wordpress/components/src/mobile/bottom-sheet/bottom-sheet-navigation/navigation-container.native.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport { NavigationContainer, DefaultTheme } from '@react-navigation/native';\r\nimport { createStackNavigator } from '@react-navigation/stack';\r\nimport Animated, {\r\n\tEasing,\r\n\tuseAnimatedStyle,\r\n\tuseSharedValue,\r\n\twithTiming,\r\n} from 'react-native-reanimated';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport {\r\n\tuseContext,\r\n\tuseMemo,\r\n\tuseCallback,\r\n\tChildren,\r\n\tuseRef,\r\n\tcloneElement,\r\n} from '@wordpress/element';\r\n\r\nimport { usePreferredColorSchemeStyle } from '@wordpress/compose';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport {\r\n\tBottomSheetNavigationContext,\r\n\tBottomSheetNavigationProvider,\r\n} from './bottom-sheet-navigation-context';\r\nimport { BottomSheetContext } from '../bottom-sheet-context';\r\n\r\nimport styles from './styles.scss';\r\n\r\nconst AnimationSpec = {\r\n\tanimation: 'timing',\r\n\tconfig: {\r\n\t\tduration: 200,\r\n\t\teasing: Easing.ease,\r\n\t},\r\n};\r\n\r\nconst fadeConfig = ( { current } ) => {\r\n\treturn {\r\n\t\tcardStyle: {\r\n\t\t\topacity: current.progress,\r\n\t\t},\r\n\t};\r\n};\r\n\r\nconst options = {\r\n\ttransitionSpec: {\r\n\t\topen: AnimationSpec,\r\n\t\tclose: AnimationSpec,\r\n\t},\r\n\theaderShown: false,\r\n\tgestureEnabled: false,\r\n\tcardStyleInterpolator: fadeConfig,\r\n\tkeyboardHandlingEnabled: false,\r\n};\r\n\r\nconst HEIGHT_ANIMATION_DURATION = 300;\r\nconst DEFAULT_HEIGHT = 1;\r\n\r\nfunction BottomSheetNavigationContainer( {\r\n\tchildren,\r\n\tanimate,\r\n\tmain,\r\n\ttheme,\r\n\tstyle,\r\n\ttestID,\r\n} ) {\r\n\tconst Stack = useRef( createStackNavigator() ).current;\r\n\tconst navigationContext = useContext( BottomSheetNavigationContext );\r\n\tconst { maxHeight: sheetMaxHeight, isMaxHeightSet: isSheetMaxHeightSet } =\r\n\t\tuseContext( BottomSheetContext );\r\n\tconst currentHeight = useSharedValue(\r\n\t\tnavigationContext.currentHeight?.value || DEFAULT_HEIGHT\r\n\t);\r\n\r\n\tconst backgroundStyle = usePreferredColorSchemeStyle(\r\n\t\tstyles.background,\r\n\t\tstyles.backgroundDark\r\n\t);\r\n\r\n\tconst defaultTheme = useMemo(\r\n\t\t() => ( {\r\n\t\t\t...DefaultTheme,\r\n\t\t\tcolors: {\r\n\t\t\t\t...DefaultTheme.colors,\r\n\t\t\t\tbackground: backgroundStyle.backgroundColor,\r\n\t\t\t},\r\n\t\t} ),\r\n\t\t[ backgroundStyle.backgroundColor ]\r\n\t);\r\n\tconst _theme = theme || defaultTheme;\r\n\r\n\tconst setHeight = useCallback(\r\n\t\t( height ) => {\r\n\t\t\tif (\r\n\t\t\t\theight > DEFAULT_HEIGHT &&\r\n\t\t\t\tMath.round( height ) !== Math.round( currentHeight.value )\r\n\t\t\t) {\r\n\t\t\t\t// If max height is set in the bottom sheet, we clamp\r\n\t\t\t\t// the new height using that value.\r\n\t\t\t\tconst newHeight = isSheetMaxHeightSet\r\n\t\t\t\t\t? Math.min( sheetMaxHeight, height )\r\n\t\t\t\t\t: height;\r\n\t\t\t\tconst shouldAnimate =\r\n\t\t\t\t\tanimate && currentHeight.value !== DEFAULT_HEIGHT;\r\n\r\n\t\t\t\tif ( shouldAnimate ) {\r\n\t\t\t\t\tcurrentHeight.value = withTiming( newHeight, {\r\n\t\t\t\t\t\tduration: HEIGHT_ANIMATION_DURATION,\r\n\t\t\t\t\t\teasing: Easing.out( Easing.cubic ),\r\n\t\t\t\t\t} );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcurrentHeight.value = newHeight;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t[ animate, currentHeight, isSheetMaxHeightSet, sheetMaxHeight ]\r\n\t);\r\n\r\n\tconst animatedStyles = useAnimatedStyle( () => ( {\r\n\t\theight: currentHeight.value,\r\n\t} ) );\r\n\r\n\tconst screens = useMemo( () => {\r\n\t\treturn Children.map( children, ( child ) => {\r\n\t\t\tlet screen = child;\r\n\t\t\tconst { name, ...otherProps } = child.props;\r\n\t\t\tif ( ! main ) {\r\n\t\t\t\tscreen = cloneElement( child, {\r\n\t\t\t\t\t...child.props,\r\n\t\t\t\t\tisNested: true,\r\n\t\t\t\t} );\r\n\t\t\t}\r\n\t\t\treturn (\r\n\t\t\t\t<Stack.Screen\r\n\t\t\t\t\tname={ name }\r\n\t\t\t\t\t{ ...otherProps }\r\n\t\t\t\t\tchildren={ () => screen }\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t} );\r\n\t}, [ children, main ] );\r\n\r\n\treturn useMemo( () => {\r\n\t\treturn (\r\n\t\t\t<Animated.View\r\n\t\t\t\tstyle={ [ style, animatedStyles ] }\r\n\t\t\t\ttestID={ testID }\r\n\t\t\t>\r\n\t\t\t\t<BottomSheetNavigationProvider\r\n\t\t\t\t\tvalue={ { setHeight, currentHeight } }\r\n\t\t\t\t>\r\n\t\t\t\t\t{ main ? (\r\n\t\t\t\t\t\t<NavigationContainer theme={ _theme }>\r\n\t\t\t\t\t\t\t<Stack.Navigator\r\n\t\t\t\t\t\t\t\tscreenOptions={ options }\r\n\t\t\t\t\t\t\t\tdetachInactiveScreens={ false }\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{ screens }\r\n\t\t\t\t\t\t\t</Stack.Navigator>\r\n\t\t\t\t\t\t</NavigationContainer>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<Stack.Navigator\r\n\t\t\t\t\t\t\tscreenOptions={ options }\r\n\t\t\t\t\t\t\tdetachInactiveScreens={ false }\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{ screens }\r\n\t\t\t\t\t\t</Stack.Navigator>\r\n\t\t\t\t\t) }\r\n\t\t\t\t</BottomSheetNavigationProvider>\r\n\t\t\t</Animated.View>\r\n\t\t);\r\n\t}, [\r\n\t\t_theme,\r\n\t\tanimatedStyles,\r\n\t\tcurrentHeight,\r\n\t\tmain,\r\n\t\tscreens,\r\n\t\tsetHeight,\r\n\t\tstyle,\r\n\t\ttestID,\r\n\t] );\r\n}\r\n\r\nexport default BottomSheetNavigationContainer;\r\n"],"mappings":"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","ignoreList":[]}