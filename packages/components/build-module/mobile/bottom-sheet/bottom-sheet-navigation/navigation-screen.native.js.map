{"version":3,"names":["useIsFocused","useNavigation","useFocusEffect","ScrollView","TouchableHighlight","useWindowDimensions","View","useRef","useCallback","useContext","useMemo","BottomSheetNavigationContext","BottomSheetContext","styles","jsx","_jsx","jsxs","_jsxs","BottomSheetNavigationScreen","children","fullScreen","isScrollable","isNested","name","navigation","maxHeight","isFocused","onHandleHardwareButtonPress","shouldEnableBottomSheetMaxHeight","setIsFullScreen","listProps","safeAreaBottomInset","height","windowHeight","setHeight","canGoBack","goBack","current","onLayout","nativeEvent","layout","testID","accessible","style","scrollableContent","paddingBottom"],"sources":["@wordpress/components/src/mobile/bottom-sheet/bottom-sheet-navigation/navigation-screen.native.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport {\r\n\tuseIsFocused,\r\n\tuseNavigation,\r\n\tuseFocusEffect,\r\n} from '@react-navigation/native';\r\nimport {\r\n\tScrollView,\r\n\tTouchableHighlight,\r\n\tuseWindowDimensions,\r\n\tView,\r\n} from 'react-native';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\n\r\nimport { useRef, useCallback, useContext, useMemo } from '@wordpress/element';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { BottomSheetNavigationContext } from './bottom-sheet-navigation-context';\r\nimport { BottomSheetContext } from '../bottom-sheet-context';\r\nimport styles from './styles.scss';\r\n\r\nconst BottomSheetNavigationScreen = ( {\r\n\tchildren,\r\n\tfullScreen,\r\n\tisScrollable,\r\n\tisNested,\r\n\tname,\r\n} ) => {\r\n\tconst navigation = useNavigation();\r\n\tconst maxHeight = useRef( 0 );\r\n\tconst isFocused = useIsFocused();\r\n\tconst {\r\n\t\tonHandleHardwareButtonPress,\r\n\t\tshouldEnableBottomSheetMaxHeight,\r\n\t\tsetIsFullScreen,\r\n\t\tlistProps,\r\n\t\tsafeAreaBottomInset,\r\n\t} = useContext( BottomSheetContext );\r\n\tconst { height: windowHeight } = useWindowDimensions();\r\n\r\n\tconst { setHeight } = useContext( BottomSheetNavigationContext );\r\n\r\n\tuseFocusEffect(\r\n\t\tuseCallback( () => {\r\n\t\t\tonHandleHardwareButtonPress( () => {\r\n\t\t\t\tif ( navigation.canGoBack() ) {\r\n\t\t\t\t\tshouldEnableBottomSheetMaxHeight( true );\r\n\t\t\t\t\tnavigation.goBack();\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\tonHandleHardwareButtonPress( null );\r\n\t\t\t\treturn false;\r\n\t\t\t} );\r\n\t\t\t/**\r\n\t\t\t * TODO: onHandleHardwareButtonPress stores a single value, which means\r\n\t\t\t * future invocations from sibling screens can replace the callback for\r\n\t\t\t * the currently active screen. Currently, the empty dependency array\r\n\t\t\t * passed to useCallback here is what prevents erroneous callback\r\n\t\t\t * replacements, but leveraging memoization to achieve this is brittle and\r\n\t\t\t * explicitly discouraged in the React documentation.\r\n\t\t\t * https://react.dev/reference/react/useMemo\r\n\t\t\t *\r\n\t\t\t * Ideally, we refactor onHandleHardwareButtonPress to manage multiple\r\n\t\t\t * callbacks triggered based upon which screen is currently active.\r\n\t\t\t *\r\n\t\t\t * Related: https://github.com/WordPress/gutenberg/pull/36328#discussion_r768897546\r\n\t\t\t */\r\n\t\t\t// see https://github.com/WordPress/gutenberg/pull/41166\r\n\t\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t\t}, [] )\r\n\t);\r\n\r\n\tuseFocusEffect(\r\n\t\tuseCallback( () => {\r\n\t\t\tif ( fullScreen ) {\r\n\t\t\t\tsetHeight( windowHeight );\r\n\t\t\t\tsetIsFullScreen( true );\r\n\t\t\t} else if ( maxHeight.current !== 0 ) {\r\n\t\t\t\tsetIsFullScreen( false );\r\n\t\t\t\tsetHeight( maxHeight.current );\r\n\t\t\t}\r\n\t\t\treturn () => {};\r\n\t\t}, [ fullScreen, setHeight, setIsFullScreen, windowHeight ] )\r\n\t);\r\n\r\n\tconst onLayout = ( { nativeEvent } ) => {\r\n\t\tif ( fullScreen ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst { height } = nativeEvent.layout;\r\n\t\tif ( maxHeight.current !== height && isFocused ) {\r\n\t\t\tmaxHeight.current = height;\r\n\t\t\tsetHeight( height );\r\n\t\t}\r\n\t};\r\n\r\n\treturn useMemo( () => {\r\n\t\treturn isScrollable || isNested ? (\r\n\t\t\t<View\r\n\t\t\t\tonLayout={ onLayout }\r\n\t\t\t\ttestID={ `navigation-screen-${ name }` }\r\n\t\t\t>\r\n\t\t\t\t{ children }\r\n\t\t\t</View>\r\n\t\t) : (\r\n\t\t\t<ScrollView { ...listProps }>\r\n\t\t\t\t<TouchableHighlight accessible={ false }>\r\n\t\t\t\t\t<View\r\n\t\t\t\t\t\tonLayout={ onLayout }\r\n\t\t\t\t\t\ttestID={ `navigation-screen-${ name }` }\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{ children }\r\n\t\t\t\t\t\t{ ! isNested && (\r\n\t\t\t\t\t\t\t<View\r\n\t\t\t\t\t\t\t\tstyle={ {\r\n\t\t\t\t\t\t\t\t\theight:\r\n\t\t\t\t\t\t\t\t\t\tsafeAreaBottomInset ||\r\n\t\t\t\t\t\t\t\t\t\tstyles.scrollableContent.paddingBottom,\r\n\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t) }\r\n\t\t\t\t\t</View>\r\n\t\t\t\t</TouchableHighlight>\r\n\t\t\t</ScrollView>\r\n\t\t);\r\n\t\t// Disable reason: deferring this refactor to the native team.\r\n\t\t// see https://github.com/WordPress/gutenberg/pull/41166\r\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, [\r\n\t\tchildren,\r\n\t\tisFocused,\r\n\t\tsafeAreaBottomInset,\r\n\t\tlistProps,\r\n\t\tname,\r\n\t\tisScrollable,\r\n\t\tisNested,\r\n\t\tonLayout,\r\n\t] );\r\n};\r\n\r\nexport default BottomSheetNavigationScreen;\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SACCA,YAAY,EACZC,aAAa,EACbC,cAAc,QACR,0BAA0B;AACjC,SACCC,UAAU,EACVC,kBAAkB,EAClBC,mBAAmB,EACnBC,IAAI,QACE,cAAc;;AAErB;AACA;AACA;;AAEA,SAASC,MAAM,EAAEC,WAAW,EAAEC,UAAU,EAAEC,OAAO,QAAQ,oBAAoB;;AAE7E;AACA;AACA;AACA,SAASC,4BAA4B,QAAQ,mCAAmC;AAChF,SAASC,kBAAkB,QAAQ,yBAAyB;AAC5D,OAAOC,MAAM,MAAM,eAAe;AAAC,SAAAC,GAAA,IAAAC,IAAA;AAAA,SAAAC,IAAA,IAAAC,KAAA;AAEnC,MAAMC,2BAA2B,GAAGA,CAAE;EACrCC,QAAQ;EACRC,UAAU;EACVC,YAAY;EACZC,QAAQ;EACRC;AACD,CAAC,KAAM;EACN,MAAMC,UAAU,GAAGvB,aAAa,CAAC,CAAC;EAClC,MAAMwB,SAAS,GAAGlB,MAAM,CAAE,CAAE,CAAC;EAC7B,MAAMmB,SAAS,GAAG1B,YAAY,CAAC,CAAC;EAChC,MAAM;IACL2B,2BAA2B;IAC3BC,gCAAgC;IAChCC,eAAe;IACfC,SAAS;IACTC;EACD,CAAC,GAAGtB,UAAU,CAAEG,kBAAmB,CAAC;EACpC,MAAM;IAAEoB,MAAM,EAAEC;EAAa,CAAC,GAAG5B,mBAAmB,CAAC,CAAC;EAEtD,MAAM;IAAE6B;EAAU,CAAC,GAAGzB,UAAU,CAAEE,4BAA6B,CAAC;EAEhET,cAAc,CACbM,WAAW,CAAE,MAAM;IAClBmB,2BAA2B,CAAE,MAAM;MAClC,IAAKH,UAAU,CAACW,SAAS,CAAC,CAAC,EAAG;QAC7BP,gCAAgC,CAAE,IAAK,CAAC;QACxCJ,UAAU,CAACY,MAAM,CAAC,CAAC;QACnB,OAAO,IAAI;MACZ;MACAT,2BAA2B,CAAE,IAAK,CAAC;MACnC,OAAO,KAAK;IACb,CAAE,CAAC;IACH;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IACG;IACA;EACD,CAAC,EAAE,EAAG,CACP,CAAC;EAEDzB,cAAc,CACbM,WAAW,CAAE,MAAM;IAClB,IAAKY,UAAU,EAAG;MACjBc,SAAS,CAAED,YAAa,CAAC;MACzBJ,eAAe,CAAE,IAAK,CAAC;IACxB,CAAC,MAAM,IAAKJ,SAAS,CAACY,OAAO,KAAK,CAAC,EAAG;MACrCR,eAAe,CAAE,KAAM,CAAC;MACxBK,SAAS,CAAET,SAAS,CAACY,OAAQ,CAAC;IAC/B;IACA,OAAO,MAAM,CAAC,CAAC;EAChB,CAAC,EAAE,CAAEjB,UAAU,EAAEc,SAAS,EAAEL,eAAe,EAAEI,YAAY,CAAG,CAC7D,CAAC;EAED,MAAMK,QAAQ,GAAGA,CAAE;IAAEC;EAAY,CAAC,KAAM;IACvC,IAAKnB,UAAU,EAAG;MACjB;IACD;IACA,MAAM;MAAEY;IAAO,CAAC,GAAGO,WAAW,CAACC,MAAM;IACrC,IAAKf,SAAS,CAACY,OAAO,KAAKL,MAAM,IAAIN,SAAS,EAAG;MAChDD,SAAS,CAACY,OAAO,GAAGL,MAAM;MAC1BE,SAAS,CAAEF,MAAO,CAAC;IACpB;EACD,CAAC;EAED,OAAOtB,OAAO,CAAE,MAAM;IACrB,OAAOW,YAAY,IAAIC,QAAQ,gBAC9BP,IAAA,CAACT,IAAI;MACJgC,QAAQ,EAAGA,QAAU;MACrBG,MAAM,EAAI,qBAAqBlB,IAAM,EAAG;MAAAJ,QAAA,EAEtCA;IAAQ,CACL,CAAC,gBAEPJ,IAAA,CAACZ,UAAU;MAAA,GAAM2B,SAAS;MAAAX,QAAA,eACzBJ,IAAA,CAACX,kBAAkB;QAACsC,UAAU,EAAG,KAAO;QAAAvB,QAAA,eACvCF,KAAA,CAACX,IAAI;UACJgC,QAAQ,EAAGA,QAAU;UACrBG,MAAM,EAAI,qBAAqBlB,IAAM,EAAG;UAAAJ,QAAA,GAEtCA,QAAQ,EACR,CAAEG,QAAQ,iBACXP,IAAA,CAACT,IAAI;YACJqC,KAAK,EAAG;cACPX,MAAM,EACLD,mBAAmB,IACnBlB,MAAM,CAAC+B,iBAAiB,CAACC;YAC3B;UAAG,CACH,CACD;QAAA,CACI;MAAC,CACY;IAAC,CACV,CACZ;IACD;IACA;IACA;EACD,CAAC,EAAE,CACF1B,QAAQ,EACRO,SAAS,EACTK,mBAAmB,EACnBD,SAAS,EACTP,IAAI,EACJF,YAAY,EACZC,QAAQ,EACRgB,QAAQ,CACP,CAAC;AACJ,CAAC;AAED,eAAepB,2BAA2B","ignoreList":[]}