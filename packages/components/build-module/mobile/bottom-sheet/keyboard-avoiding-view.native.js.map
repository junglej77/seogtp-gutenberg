{"version":3,"names":["Keyboard","LayoutAnimation","Platform","StyleSheet","View","Dimensions","Component","jsx","_jsx","KeyboardAvoidingView","constructor","arguments","_onKeyboardChange","bind","_subscriptions","state","bottom","_relativeKeyboardHeight","keyboardFrame","windowWidth","get","width","isFloatingKeyboard","windowHeight","height","keyboardY","screenY","props","keyboardVerticalOffset","final","Math","max","event","setState","duration","easing","endCoordinates","configureNext","update","type","Types","componentDidMount","OS","addListener","componentWillUnmount","forEach","subscription","remove","render","children","enabled","style","finalStyle","bottomHeight","compose","paddingBottom","defaultProps"],"sources":["@wordpress/components/src/mobile/bottom-sheet/keyboard-avoiding-view.native.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport {\r\n\tKeyboard,\r\n\tLayoutAnimation,\r\n\tPlatform,\r\n\tStyleSheet,\r\n\tView,\r\n\tDimensions,\r\n} from 'react-native';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { Component } from '@wordpress/element';\r\n\r\n/**\r\n * This is a simplified version of Facebook's KeyboardAvoidingView.\r\n * It's meant to work specifically with BottomSheets.\r\n * This fixes an issue in the bottom padding calculation, when the\r\n * BottomSheet was presented on Landscape, with the keyboard already present,\r\n * and a TextField on Autofocus (situation present on Links UI)\r\n */\r\nclass KeyboardAvoidingView extends Component {\r\n\tconstructor() {\r\n\t\tsuper( ...arguments );\r\n\r\n\t\tthis._onKeyboardChange = this._onKeyboardChange.bind( this );\r\n\t\tthis._subscriptions = [];\r\n\t\tthis.state = {\r\n\t\t\tbottom: 0,\r\n\t\t};\r\n\t}\r\n\r\n\t_relativeKeyboardHeight( keyboardFrame ) {\r\n\t\tif ( ! keyboardFrame ) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\tconst windowWidth = Dimensions.get( 'window' ).width;\r\n\t\tconst isFloatingKeyboard = keyboardFrame.width !== windowWidth;\r\n\t\tif ( isFloatingKeyboard ) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\tconst windowHeight = Dimensions.get( 'window' ).height;\r\n\t\tconst keyboardY =\r\n\t\t\tkeyboardFrame.screenY - this.props.keyboardVerticalOffset;\r\n\r\n\t\tconst final = Math.max( windowHeight - keyboardY, 0 );\r\n\t\treturn final;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {Object} event Keyboard event.\r\n\t */\r\n\t_onKeyboardChange( event ) {\r\n\t\tif ( event === null ) {\r\n\t\t\tthis.setState( { bottom: 0 } );\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst { duration, easing, endCoordinates } = event;\r\n\t\tconst height = this._relativeKeyboardHeight( endCoordinates );\r\n\r\n\t\tif ( this.state.bottom === height ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif ( duration && easing ) {\r\n\t\t\tLayoutAnimation.configureNext( {\r\n\t\t\t\tduration,\r\n\t\t\t\tupdate: {\r\n\t\t\t\t\tduration,\r\n\t\t\t\t\ttype: LayoutAnimation.Types[ easing ] || 'keyboard',\r\n\t\t\t\t},\r\n\t\t\t} );\r\n\t\t}\r\n\t\tthis.setState( { bottom: height } );\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tif ( Platform.OS === 'ios' ) {\r\n\t\t\tthis._subscriptions = [\r\n\t\t\t\tKeyboard.addListener(\r\n\t\t\t\t\t'keyboardWillChangeFrame',\r\n\t\t\t\t\tthis._onKeyboardChange\r\n\t\t\t\t),\r\n\t\t\t];\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tthis._subscriptions.forEach( ( subscription ) => {\r\n\t\t\tsubscription.remove();\r\n\t\t} );\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { children, enabled, keyboardVerticalOffset, style, ...props } =\r\n\t\t\tthis.props;\r\n\r\n\t\tlet finalStyle = style;\r\n\t\tif ( Platform.OS === 'ios' ) {\r\n\t\t\tconst bottomHeight = enabled ? this.state.bottom : 0;\r\n\t\t\tfinalStyle = StyleSheet.compose( style, {\r\n\t\t\t\tpaddingBottom: bottomHeight,\r\n\t\t\t} );\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<View style={ finalStyle } { ...props }>\r\n\t\t\t\t{ children }\r\n\t\t\t</View>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nKeyboardAvoidingView.defaultProps = {\r\n\tenabled: true,\r\n\tkeyboardVerticalOffset: 0,\r\n};\r\n\r\nexport default KeyboardAvoidingView;\r\n"],"mappings":"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","ignoreList":[]}