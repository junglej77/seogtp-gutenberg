{"version":3,"names":["ScrollView","TextInput","Component","__","parse","withDispatch","withSelect","addFilter","removeFilter","withInstanceId","compose","withPreferredColorScheme","KeyboardAvoidingView","styles","jsx","_jsx","jsxs","_jsxs","HTMLTextInput","constructor","arguments","edit","bind","stopEditing","getHTMLForParent","state","getDerivedStateFromProps","props","isDirty","value","componentWillUnmount","html","onChange","setState","onPersist","render","editTitle","getStylesFromColorScheme","parentHeight","style","title","titleStyle","htmlViewTitle","htmlViewTitleDark","text","color","htmlStyle","htmlView","htmlViewDark","placeholderStyle","placeholder","placeholderDark","keyboardAvoidingView","children","scrollView","autoCorrect","accessibilityLabel","textAlignVertical","numberOfLines","placeholderTextColor","onChangeText","ref","contentTextInputRef","multiline","onBlur","scrollEnabled","rejectResponderTermination","select","getEditedPostAttribute","getEditedPostContent","dispatch","editPost","resetEditorBlocks","content","blocks"],"sources":["@wordpress/components/src/mobile/html-text-input/index.native.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport { ScrollView, TextInput } from 'react-native';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { Component } from '@wordpress/element';\r\nimport { __ } from '@wordpress/i18n';\r\nimport { parse } from '@wordpress/blocks';\r\nimport { withDispatch, withSelect } from '@wordpress/data';\r\nimport { addFilter, removeFilter } from '@wordpress/hooks';\r\nimport {\r\n\twithInstanceId,\r\n\tcompose,\r\n\twithPreferredColorScheme,\r\n} from '@wordpress/compose';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport KeyboardAvoidingView from '../keyboard-avoiding-view';\r\nimport styles from './style.scss';\r\n\r\nexport class HTMLTextInput extends Component {\r\n\tconstructor() {\r\n\t\tsuper( ...arguments );\r\n\r\n\t\tthis.edit = this.edit.bind( this );\r\n\t\tthis.stopEditing = this.stopEditing.bind( this );\r\n\t\tthis.getHTMLForParent = this.getHTMLForParent.bind( this );\r\n\t\taddFilter(\r\n\t\t\t'native.persist-html',\r\n\t\t\t'html-text-input',\r\n\t\t\tthis.getHTMLForParent\r\n\t\t);\r\n\r\n\t\tthis.state = {};\r\n\t}\r\n\r\n\tstatic getDerivedStateFromProps( props, state ) {\r\n\t\tif ( state.isDirty ) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tvalue: props.value,\r\n\t\t\tisDirty: false,\r\n\t\t};\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tremoveFilter( 'native.persist-html', 'html-text-input' );\r\n\t\t// TODO: Blocking main thread.\r\n\t\tthis.stopEditing();\r\n\t}\r\n\r\n\tedit( html ) {\r\n\t\tthis.props.onChange( html );\r\n\t\tthis.setState( { value: html, isDirty: true } );\r\n\t}\r\n\r\n\tgetHTMLForParent() {\r\n\t\treturn this.state.value;\r\n\t}\r\n\r\n\tstopEditing() {\r\n\t\tif ( this.state.isDirty ) {\r\n\t\t\tthis.props.onPersist( this.state.value );\r\n\t\t\tthis.setState( { isDirty: false } );\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst {\r\n\t\t\teditTitle,\r\n\t\t\tgetStylesFromColorScheme,\r\n\t\t\tparentHeight,\r\n\t\t\tstyle,\r\n\t\t\ttitle,\r\n\t\t} = this.props;\r\n\t\tconst titleStyle = [\r\n\t\t\tgetStylesFromColorScheme(\r\n\t\t\t\tstyles.htmlViewTitle,\r\n\t\t\t\tstyles.htmlViewTitleDark\r\n\t\t\t),\r\n\t\t\tstyle?.text && { color: style.text },\r\n\t\t];\r\n\t\tconst htmlStyle = [\r\n\t\t\tgetStylesFromColorScheme( styles.htmlView, styles.htmlViewDark ),\r\n\t\t\tstyle?.text && { color: style.text },\r\n\t\t];\r\n\t\tconst placeholderStyle = {\r\n\t\t\t...getStylesFromColorScheme(\r\n\t\t\t\tstyles.placeholder,\r\n\t\t\t\tstyles.placeholderDark\r\n\t\t\t),\r\n\t\t\t...( style?.text && { color: style.text } ),\r\n\t\t};\r\n\t\treturn (\r\n\t\t\t<KeyboardAvoidingView\r\n\t\t\t\tstyle={ styles.keyboardAvoidingView }\r\n\t\t\t\tparentHeight={ parentHeight }\r\n\t\t\t>\r\n\t\t\t\t<ScrollView style={ styles.scrollView }>\r\n\t\t\t\t\t<TextInput\r\n\t\t\t\t\t\tautoCorrect={ false }\r\n\t\t\t\t\t\taccessibilityLabel=\"html-view-title\"\r\n\t\t\t\t\t\ttextAlignVertical=\"center\"\r\n\t\t\t\t\t\tnumberOfLines={ 1 }\r\n\t\t\t\t\t\tstyle={ titleStyle }\r\n\t\t\t\t\t\tvalue={ title }\r\n\t\t\t\t\t\tplaceholder={ __( 'Add title' ) }\r\n\t\t\t\t\t\tplaceholderTextColor={ placeholderStyle.color }\r\n\t\t\t\t\t\tonChangeText={ editTitle }\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<TextInput\r\n\t\t\t\t\t\tref={ this.contentTextInputRef }\r\n\t\t\t\t\t\tautoCorrect={ false }\r\n\t\t\t\t\t\taccessibilityLabel=\"html-view-content\"\r\n\t\t\t\t\t\ttextAlignVertical=\"top\"\r\n\t\t\t\t\t\tmultiline\r\n\t\t\t\t\t\tstyle={ htmlStyle }\r\n\t\t\t\t\t\tvalue={ this.state.value }\r\n\t\t\t\t\t\tonChangeText={ this.edit }\r\n\t\t\t\t\t\tonBlur={ this.stopEditing }\r\n\t\t\t\t\t\tplaceholder={ __( 'Start writingâ€¦' ) }\r\n\t\t\t\t\t\tplaceholderTextColor={ placeholderStyle.color }\r\n\t\t\t\t\t\tscrollEnabled={ false }\r\n\t\t\t\t\t\t// [Only iOS] This prop prevents the text input from\r\n\t\t\t\t\t\t// automatically getting focused after scrolling\r\n\t\t\t\t\t\t// content.\r\n\t\t\t\t\t\trejectResponderTermination={ false }\r\n\t\t\t\t\t/>\r\n\t\t\t\t</ScrollView>\r\n\t\t\t</KeyboardAvoidingView>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default compose( [\r\n\twithSelect( ( select ) => {\r\n\t\tconst { getEditedPostAttribute, getEditedPostContent } =\r\n\t\t\tselect( 'core/editor' );\r\n\r\n\t\treturn {\r\n\t\t\ttitle: getEditedPostAttribute( 'title' ),\r\n\t\t\tvalue: getEditedPostContent(),\r\n\t\t};\r\n\t} ),\r\n\twithDispatch( ( dispatch ) => {\r\n\t\tconst { editPost, resetEditorBlocks } = dispatch( 'core/editor' );\r\n\t\treturn {\r\n\t\t\teditTitle( title ) {\r\n\t\t\t\teditPost( { title } );\r\n\t\t\t},\r\n\t\t\tonChange( content ) {\r\n\t\t\t\teditPost( { content } );\r\n\t\t\t},\r\n\t\t\tonPersist( content ) {\r\n\t\t\t\tconst blocks = parse( content );\r\n\t\t\t\tresetEditorBlocks( blocks );\r\n\t\t\t},\r\n\t\t};\r\n\t} ),\r\n\twithInstanceId,\r\n\twithPreferredColorScheme,\r\n] )( HTMLTextInput );\r\n"],"mappings":"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","ignoreList":[]}