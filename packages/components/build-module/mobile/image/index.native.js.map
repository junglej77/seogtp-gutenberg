{"version":3,"names":["Image","RNImage","Text","View","FastImage","__","image","offline","usePreferredColorSchemeStyle","useEffect","useState","Platform","getImageWithFocalPointStyles","styles","SvgIconRetry","ImageEditingButton","Icon","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","ICON_TYPE","OFFLINE","PLACEHOLDER","RETRY","UPLOAD","ImageComponent","align","alt","editButton","focalPoint","height","imageHeight","highlightSelected","isSelected","shouldUseFastImage","isUploadFailed","isUploadPaused","isUploadInProgress","mediaPickerOptions","onImageDataLoad","onSelectMediaUploadOption","openMediaOptions","resizeMode","retryMessage","retryIcon","url","shapeStyle","style","width","imageWidth","imageData","setImageData","containerSize","setContainerSize","localURL","setLocalURL","networkURL","setNetworkURL","networkImageLoaded","setNetworkImageLoaded","isAndroid","imageResizeMode","isCurrent","getSize","imgWidth","imgHeight","metaData","aspectRatio","startsWith","isIOS","prefetch","then","onContainerLayout","event","nativeEvent","layout","getIcon","iconType","icon","iconStyle","iconRetryStyles","iconOfflineStyles","iconPlaceholderStyles","iconUploadStyles","iconPlaceholder","iconPlaceholderDark","iconUpload","iconUploadDark","iconOffline","iconOfflineDark","retryIconStyles","retryIconDark","iconRetry","iconRetryDark","retryContainerStyles","retryContainer","retryContainerDark","uploadFailedTextStyles","uploadFailedText","uploadFailedTextDark","placeholderStyles","imageContainerUpload","imageContainerUploadDark","imageContainerUploadWithFocalpoint","customWidth","wide","imageContainerStyles","imageContent","focalPointContainer","imageStyles","undefined","calculatedSelectedHeight","isNaN","imageSelectedStyles","imageBorder","imageBorderDark","container","alignItems","onLayout","children","accessible","disabled","accessibilityLabel","accessibilityHint","accessibilityRole","imageUploadingIconContainer","focalPointContent","fadeDuration","source","uri","resizeMethod","testID","nonVisibleImage","onLoad","imageContainer","customRetryIcon","pickerOptions"],"sources":["@wordpress/components/src/mobile/image/index.native.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport { Image as RNImage, Text, View } from 'react-native';\r\nimport FastImage from 'react-native-fast-image';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { __ } from '@wordpress/i18n';\r\nimport { image, offline } from '@wordpress/icons';\r\nimport { usePreferredColorSchemeStyle } from '@wordpress/compose';\r\nimport { useEffect, useState, Platform } from '@wordpress/element';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { getImageWithFocalPointStyles } from './utils';\r\nimport styles from './style.scss';\r\nimport SvgIconRetry from './icon-retry';\r\nimport ImageEditingButton from './image-editing-button';\r\nimport Icon from '../../icon';\r\n\r\nconst ICON_TYPE = {\r\n\tOFFLINE: 'offline',\r\n\tPLACEHOLDER: 'placeholder',\r\n\tRETRY: 'retry',\r\n\tUPLOAD: 'upload',\r\n};\r\n\r\nconst ImageComponent = ( {\r\n\talign,\r\n\talt,\r\n\teditButton = true,\r\n\tfocalPoint,\r\n\theight: imageHeight,\r\n\thighlightSelected = true,\r\n\tisSelected,\r\n\tshouldUseFastImage,\r\n\tisUploadFailed,\r\n\tisUploadPaused,\r\n\tisUploadInProgress,\r\n\tmediaPickerOptions,\r\n\tonImageDataLoad,\r\n\tonSelectMediaUploadOption,\r\n\topenMediaOptions,\r\n\tresizeMode,\r\n\tretryMessage,\r\n\tretryIcon,\r\n\turl,\r\n\tshapeStyle,\r\n\tstyle,\r\n\twidth: imageWidth,\r\n} ) => {\r\n\tconst [ imageData, setImageData ] = useState( null );\r\n\tconst [ containerSize, setContainerSize ] = useState( null );\r\n\tconst [ localURL, setLocalURL ] = useState( null );\r\n\tconst [ networkURL, setNetworkURL ] = useState( null );\r\n\tconst [ networkImageLoaded, setNetworkImageLoaded ] = useState( false );\r\n\r\n\t// Disabled for Android due to https://github.com/WordPress/gutenberg/issues/43149\r\n\tconst Image =\r\n\t\t! shouldUseFastImage || Platform.isAndroid ? RNImage : FastImage;\r\n\tconst imageResizeMode =\r\n\t\t! shouldUseFastImage || Platform.isAndroid\r\n\t\t\t? resizeMode\r\n\t\t\t: FastImage.resizeMode[ resizeMode ];\r\n\r\n\tuseEffect( () => {\r\n\t\tlet isCurrent = true;\r\n\t\tif ( url ) {\r\n\t\t\tRNImage.getSize( url, ( imgWidth, imgHeight ) => {\r\n\t\t\t\tif ( ! isCurrent ) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tconst metaData = {\r\n\t\t\t\t\taspectRatio: imgWidth / imgHeight,\r\n\t\t\t\t\twidth: imgWidth,\r\n\t\t\t\t\theight: imgHeight,\r\n\t\t\t\t};\r\n\t\t\t\tsetImageData( metaData );\r\n\t\t\t\tif ( onImageDataLoad ) {\r\n\t\t\t\t\tonImageDataLoad( metaData );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\r\n\t\t\tif ( url.startsWith( 'file:///' ) ) {\r\n\t\t\t\tsetLocalURL( url );\r\n\t\t\t\tsetNetworkURL( null );\r\n\t\t\t\tsetNetworkImageLoaded( false );\r\n\t\t\t} else if ( url.startsWith( 'https://' ) ) {\r\n\t\t\t\tif ( Platform.isIOS ) {\r\n\t\t\t\t\tsetNetworkURL( url );\r\n\t\t\t\t} else if ( Platform.isAndroid ) {\r\n\t\t\t\t\tRNImage.prefetch( url ).then(\r\n\t\t\t\t\t\t() => {\r\n\t\t\t\t\t\t\tif ( ! isCurrent ) {\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tsetNetworkURL( url );\r\n\t\t\t\t\t\t\tsetNetworkImageLoaded( true );\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t() => {\r\n\t\t\t\t\t\t\t// This callback is called when the image fails to load,\r\n\t\t\t\t\t\t\t// but these events are handled by `isUploadFailed`\r\n\t\t\t\t\t\t\t// and `isUploadPaused` events instead.\r\n\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t\t// Ignoring the error event will persist the local image URI.\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn () => ( isCurrent = false );\r\n\t\t// Disable reason: deferring this refactor to the native team.\r\n\t\t// see https://github.com/WordPress/gutenberg/pull/41166\r\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, [ url ] );\r\n\r\n\tconst onContainerLayout = ( event ) => {\r\n\t\tconst { height, width } = event.nativeEvent.layout;\r\n\r\n\t\tif (\r\n\t\t\twidth !== 0 &&\r\n\t\t\theight !== 0 &&\r\n\t\t\t( containerSize?.width !== width ||\r\n\t\t\t\tcontainerSize?.height !== height )\r\n\t\t) {\r\n\t\t\tsetContainerSize( { width, height } );\r\n\t\t}\r\n\t};\r\n\r\n\tconst getIcon = ( iconType ) => {\r\n\t\tlet icon;\r\n\t\tlet iconStyle;\r\n\t\tswitch ( iconType ) {\r\n\t\t\tcase ICON_TYPE.RETRY:\r\n\t\t\t\ticon = retryIcon || SvgIconRetry;\r\n\t\t\t\ticonStyle = iconRetryStyles;\r\n\t\t\t\tbreak;\r\n\t\t\tcase ICON_TYPE.OFFLINE:\r\n\t\t\t\ticon = offline;\r\n\t\t\t\ticonStyle = iconOfflineStyles;\r\n\t\t\t\tbreak;\r\n\t\t\tcase ICON_TYPE.PLACEHOLDER:\r\n\t\t\t\ticon = image;\r\n\t\t\t\ticonStyle = iconPlaceholderStyles;\r\n\t\t\t\tbreak;\r\n\t\t\tcase ICON_TYPE.UPLOAD:\r\n\t\t\t\ticon = image;\r\n\t\t\t\ticonStyle = iconUploadStyles;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn <Icon icon={ icon } { ...iconStyle } />;\r\n\t};\r\n\r\n\tconst iconPlaceholderStyles = usePreferredColorSchemeStyle(\r\n\t\tstyles.iconPlaceholder,\r\n\t\tstyles.iconPlaceholderDark\r\n\t);\r\n\r\n\tconst iconUploadStyles = usePreferredColorSchemeStyle(\r\n\t\tstyles.iconUpload,\r\n\t\tstyles.iconUploadDark\r\n\t);\r\n\r\n\tconst iconOfflineStyles = usePreferredColorSchemeStyle(\r\n\t\tstyles.iconOffline,\r\n\t\tstyles.iconOfflineDark\r\n\t);\r\n\r\n\tconst retryIconStyles = usePreferredColorSchemeStyle(\r\n\t\tstyles.retryIcon,\r\n\t\tstyles.retryIconDark\r\n\t);\r\n\r\n\tconst iconRetryStyles = usePreferredColorSchemeStyle(\r\n\t\tstyles.iconRetry,\r\n\t\tstyles.iconRetryDark\r\n\t);\r\n\r\n\tconst retryContainerStyles = usePreferredColorSchemeStyle(\r\n\t\tstyles.retryContainer,\r\n\t\tstyles.retryContainerDark\r\n\t);\r\n\r\n\tconst uploadFailedTextStyles = usePreferredColorSchemeStyle(\r\n\t\tstyles.uploadFailedText,\r\n\t\tstyles.uploadFailedTextDark\r\n\t);\r\n\r\n\tconst placeholderStyles = [\r\n\t\tusePreferredColorSchemeStyle(\r\n\t\t\tstyles.imageContainerUpload,\r\n\t\t\tstyles.imageContainerUploadDark\r\n\t\t),\r\n\t\tfocalPoint && styles.imageContainerUploadWithFocalpoint,\r\n\t\timageHeight && { height: imageHeight },\r\n\t];\r\n\r\n\tconst customWidth =\r\n\t\timageData?.width < containerSize?.width\r\n\t\t\t? imageData?.width\r\n\t\t\t: styles.wide?.width;\r\n\r\n\tconst imageContainerStyles = [\r\n\t\tstyles.imageContent,\r\n\t\t{\r\n\t\t\twidth:\r\n\t\t\t\timageWidth === styles.wide?.width ||\r\n\t\t\t\t( imageData &&\r\n\t\t\t\t\timageWidth > 0 &&\r\n\t\t\t\t\timageWidth < containerSize?.width )\r\n\t\t\t\t\t? imageWidth\r\n\t\t\t\t\t: customWidth,\r\n\t\t},\r\n\t\tresizeMode && { width: styles.wide?.width },\r\n\t\tfocalPoint && styles.focalPointContainer,\r\n\t];\r\n\r\n\tconst imageStyles = [\r\n\t\t{\r\n\t\t\theight: containerSize?.height,\r\n\t\t},\r\n\t\t! resizeMode && {\r\n\t\t\taspectRatio: imageData?.aspectRatio,\r\n\t\t},\r\n\t\tfocalPoint && styles.focalPoint,\r\n\t\tfocalPoint &&\r\n\t\t\tgetImageWithFocalPointStyles(\r\n\t\t\t\tfocalPoint,\r\n\t\t\t\tcontainerSize,\r\n\t\t\t\timageData\r\n\t\t\t),\r\n\t\t! focalPoint &&\r\n\t\t\timageData &&\r\n\t\t\tcontainerSize && {\r\n\t\t\t\theight:\r\n\t\t\t\t\timageData?.width > containerSize?.width && ! imageWidth\r\n\t\t\t\t\t\t? containerSize?.width / imageData?.aspectRatio\r\n\t\t\t\t\t\t: undefined,\r\n\t\t\t},\r\n\t\timageHeight && { height: imageHeight },\r\n\t\tshapeStyle,\r\n\t];\r\n\r\n\t// On iOS, add 1 to height to account for the 1px non-visible image\r\n\t// that is used to determine when the network image has loaded\r\n\t// We also must verify that it is not NaN, as it can be NaN when the image is loading.\r\n\t// This is not necessary on Android as the non-visible image is not used.\r\n\tlet calculatedSelectedHeight;\r\n\tif ( Platform.isIOS ) {\r\n\t\tcalculatedSelectedHeight =\r\n\t\t\tcontainerSize && ! isNaN( containerSize.height )\r\n\t\t\t\t? containerSize.height + 1\r\n\t\t\t\t: 0;\r\n\t} else {\r\n\t\tcalculatedSelectedHeight = containerSize?.height;\r\n\t}\r\n\r\n\tconst imageSelectedStyles = [\r\n\t\tusePreferredColorSchemeStyle(\r\n\t\t\tstyles.imageBorder,\r\n\t\t\tstyles.imageBorderDark\r\n\t\t),\r\n\t\t{\r\n\t\t\theight: calculatedSelectedHeight,\r\n\t\t},\r\n\t];\r\n\r\n\treturn (\r\n\t\t<View\r\n\t\t\tstyle={ [\r\n\t\t\t\tstyles.container,\r\n\t\t\t\t// Only set alignItems if an image exists because alignItems causes the placeholder\r\n\t\t\t\t// to disappear when an aligned image can't be downloaded\r\n\t\t\t\t// https://github.com/wordpress-mobile/gutenberg-mobile/issues/1592\r\n\t\t\t\timageData && align && { alignItems: align },\r\n\t\t\t\tstyle,\r\n\t\t\t] }\r\n\t\t\tonLayout={ onContainerLayout }\r\n\t\t>\r\n\t\t\t<View\r\n\t\t\t\taccessible\r\n\t\t\t\tdisabled={ ! isSelected }\r\n\t\t\t\taccessibilityLabel={ alt }\r\n\t\t\t\taccessibilityHint={ __( 'Double tap and hold to edit' ) }\r\n\t\t\t\taccessibilityRole=\"imagebutton\"\r\n\t\t\t\tkey={ url }\r\n\t\t\t\tstyle={ imageContainerStyles }\r\n\t\t\t>\r\n\t\t\t\t{ isSelected && highlightSelected && (\r\n\t\t\t\t\t<View style={ imageSelectedStyles } />\r\n\t\t\t\t) }\r\n\r\n\t\t\t\t{ ! imageData ? (\r\n\t\t\t\t\t<View style={ placeholderStyles }>\r\n\t\t\t\t\t\t<View style={ styles.imageUploadingIconContainer }>\r\n\t\t\t\t\t\t\t{ getIcon( ICON_TYPE.UPLOAD ) }\r\n\t\t\t\t\t\t</View>\r\n\t\t\t\t\t</View>\r\n\t\t\t\t) : (\r\n\t\t\t\t\t<View style={ focalPoint && styles.focalPointContent }>\r\n\t\t\t\t\t\t{ Platform.isAndroid && (\r\n\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t{ networkImageLoaded && networkURL && (\r\n\t\t\t\t\t\t\t\t\t<Image\r\n\t\t\t\t\t\t\t\t\t\tstyle={ imageStyles }\r\n\t\t\t\t\t\t\t\t\t\tfadeDuration={ 0 }\r\n\t\t\t\t\t\t\t\t\t\tsource={ { uri: networkURL } }\r\n\t\t\t\t\t\t\t\t\t\t{ ...( ! focalPoint && {\r\n\t\t\t\t\t\t\t\t\t\t\tresizeMethod: 'scale',\r\n\t\t\t\t\t\t\t\t\t\t} ) }\r\n\t\t\t\t\t\t\t\t\t\tresizeMode={ imageResizeMode }\r\n\t\t\t\t\t\t\t\t\t\ttestID={ `network-image-${ url }` }\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\t\t{ ! networkImageLoaded && ! networkURL && (\r\n\t\t\t\t\t\t\t\t\t<Image\r\n\t\t\t\t\t\t\t\t\t\tstyle={ imageStyles }\r\n\t\t\t\t\t\t\t\t\t\tfadeDuration={ 0 }\r\n\t\t\t\t\t\t\t\t\t\tsource={ { uri: localURL } }\r\n\t\t\t\t\t\t\t\t\t\t{ ...( ! focalPoint && {\r\n\t\t\t\t\t\t\t\t\t\t\tresizeMethod: 'scale',\r\n\t\t\t\t\t\t\t\t\t\t} ) }\r\n\t\t\t\t\t\t\t\t\t\tresizeMode={ imageResizeMode }\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t{ Platform.isIOS && (\r\n\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t<Image\r\n\t\t\t\t\t\t\t\t\tstyle={ imageStyles }\r\n\t\t\t\t\t\t\t\t\tsource={ {\r\n\t\t\t\t\t\t\t\t\t\turi:\r\n\t\t\t\t\t\t\t\t\t\t\tnetworkURL && networkImageLoaded\r\n\t\t\t\t\t\t\t\t\t\t\t\t? networkURL\r\n\t\t\t\t\t\t\t\t\t\t\t\t: localURL || url,\r\n\t\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t\t\t{ ...( ! focalPoint && {\r\n\t\t\t\t\t\t\t\t\t\tresizeMethod: 'scale',\r\n\t\t\t\t\t\t\t\t\t} ) }\r\n\t\t\t\t\t\t\t\t\tresizeMode={ imageResizeMode }\r\n\t\t\t\t\t\t\t\t\ttestID={ `network-image-${\r\n\t\t\t\t\t\t\t\t\t\tnetworkURL && networkImageLoaded\r\n\t\t\t\t\t\t\t\t\t\t\t? networkURL\r\n\t\t\t\t\t\t\t\t\t\t\t: localURL || url\r\n\t\t\t\t\t\t\t\t\t}` }\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t<Image\r\n\t\t\t\t\t\t\t\t\tsource={ { uri: networkURL } }\r\n\t\t\t\t\t\t\t\t\tstyle={ styles.nonVisibleImage }\r\n\t\t\t\t\t\t\t\t\tonLoad={ () => {\r\n\t\t\t\t\t\t\t\t\t\tsetNetworkImageLoaded( true );\r\n\t\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t) }\r\n\t\t\t\t\t</View>\r\n\t\t\t\t) }\r\n\r\n\t\t\t\t{ ( isUploadFailed || isUploadPaused ) && retryMessage && (\r\n\t\t\t\t\t<View\r\n\t\t\t\t\t\tstyle={ [\r\n\t\t\t\t\t\t\tstyles.imageContainer,\r\n\t\t\t\t\t\t\tretryContainerStyles,\r\n\t\t\t\t\t\t] }\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<View\r\n\t\t\t\t\t\t\tstyle={ [\r\n\t\t\t\t\t\t\t\tretryIconStyles,\r\n\t\t\t\t\t\t\t\tretryIcon && styles.customRetryIcon,\r\n\t\t\t\t\t\t\t] }\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{ isUploadPaused\r\n\t\t\t\t\t\t\t\t? getIcon( ICON_TYPE.OFFLINE )\r\n\t\t\t\t\t\t\t\t: getIcon( ICON_TYPE.RETRY ) }\r\n\t\t\t\t\t\t</View>\r\n\t\t\t\t\t\t<Text style={ uploadFailedTextStyles }>\r\n\t\t\t\t\t\t\t{ retryMessage }\r\n\t\t\t\t\t\t</Text>\r\n\t\t\t\t\t</View>\r\n\t\t\t\t) }\r\n\t\t\t</View>\r\n\r\n\t\t\t{ editButton && isSelected && ! isUploadInProgress && (\r\n\t\t\t\t<ImageEditingButton\r\n\t\t\t\t\tonSelectMediaUploadOption={ onSelectMediaUploadOption }\r\n\t\t\t\t\topenMediaOptions={ openMediaOptions }\r\n\t\t\t\t\turl={\r\n\t\t\t\t\t\t! ( isUploadFailed || isUploadPaused ) &&\r\n\t\t\t\t\t\timageData &&\r\n\t\t\t\t\t\turl\r\n\t\t\t\t\t}\r\n\t\t\t\t\tpickerOptions={ mediaPickerOptions }\r\n\t\t\t\t/>\r\n\t\t\t) }\r\n\t\t</View>\r\n\t);\r\n};\r\n\r\nexport default ImageComponent;\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,KAAK,IAAIC,OAAO,EAAEC,IAAI,EAAEC,IAAI,QAAQ,cAAc;AAC3D,OAAOC,SAAS,MAAM,yBAAyB;;AAE/C;AACA;AACA;AACA,SAASC,EAAE,QAAQ,iBAAiB;AACpC,SAASC,KAAK,EAAEC,OAAO,QAAQ,kBAAkB;AACjD,SAASC,4BAA4B,QAAQ,oBAAoB;AACjE,SAASC,SAAS,EAAEC,QAAQ,EAAEC,QAAQ,QAAQ,oBAAoB;;AAElE;AACA;AACA;AACA,SAASC,4BAA4B,QAAQ,SAAS;AACtD,OAAOC,MAAM,MAAM,cAAc;AACjC,OAAOC,YAAY,MAAM,cAAc;AACvC,OAAOC,kBAAkB,MAAM,wBAAwB;AACvD,OAAOC,IAAI,MAAM,YAAY;AAAC,SAAAC,GAAA,IAAAC,IAAA;AAAA,SAAAC,QAAA,IAAAC,SAAA;AAAA,SAAAC,IAAA,IAAAC,KAAA;AAE9B,MAAMC,SAAS,GAAG;EACjBC,OAAO,EAAE,SAAS;EAClBC,WAAW,EAAE,aAAa;EAC1BC,KAAK,EAAE,OAAO;EACdC,MAAM,EAAE;AACT,CAAC;AAED,MAAMC,cAAc,GAAGA,CAAE;EACxBC,KAAK;EACLC,GAAG;EACHC,UAAU,GAAG,IAAI;EACjBC,UAAU;EACVC,MAAM,EAAEC,WAAW;EACnBC,iBAAiB,GAAG,IAAI;EACxBC,UAAU;EACVC,kBAAkB;EAClBC,cAAc;EACdC,cAAc;EACdC,kBAAkB;EAClBC,kBAAkB;EAClBC,eAAe;EACfC,yBAAyB;EACzBC,gBAAgB;EAChBC,UAAU;EACVC,YAAY;EACZC,SAAS;EACTC,GAAG;EACHC,UAAU;EACVC,KAAK;EACLC,KAAK,EAAEC;AACR,CAAC,KAAM;EACN,MAAM,CAAEC,SAAS,EAAEC,YAAY,CAAE,GAAG5C,QAAQ,CAAE,IAAK,CAAC;EACpD,MAAM,CAAE6C,aAAa,EAAEC,gBAAgB,CAAE,GAAG9C,QAAQ,CAAE,IAAK,CAAC;EAC5D,MAAM,CAAE+C,QAAQ,EAAEC,WAAW,CAAE,GAAGhD,QAAQ,CAAE,IAAK,CAAC;EAClD,MAAM,CAAEiD,UAAU,EAAEC,aAAa,CAAE,GAAGlD,QAAQ,CAAE,IAAK,CAAC;EACtD,MAAM,CAAEmD,kBAAkB,EAAEC,qBAAqB,CAAE,GAAGpD,QAAQ,CAAE,KAAM,CAAC;;EAEvE;EACA,MAAMV,KAAK,GACV,CAAEqC,kBAAkB,IAAI1B,QAAQ,CAACoD,SAAS,GAAG9D,OAAO,GAAGG,SAAS;EACjE,MAAM4D,eAAe,GACpB,CAAE3B,kBAAkB,IAAI1B,QAAQ,CAACoD,SAAS,GACvClB,UAAU,GACVzC,SAAS,CAACyC,UAAU,CAAEA,UAAU,CAAE;EAEtCpC,SAAS,CAAE,MAAM;IAChB,IAAIwD,SAAS,GAAG,IAAI;IACpB,IAAKjB,GAAG,EAAG;MACV/C,OAAO,CAACiE,OAAO,CAAElB,GAAG,EAAE,CAAEmB,QAAQ,EAAEC,SAAS,KAAM;QAChD,IAAK,CAAEH,SAAS,EAAG;UAClB;QACD;QACA,MAAMI,QAAQ,GAAG;UAChBC,WAAW,EAAEH,QAAQ,GAAGC,SAAS;UACjCjB,KAAK,EAAEgB,QAAQ;UACflC,MAAM,EAAEmC;QACT,CAAC;QACDd,YAAY,CAAEe,QAAS,CAAC;QACxB,IAAK3B,eAAe,EAAG;UACtBA,eAAe,CAAE2B,QAAS,CAAC;QAC5B;MACD,CAAE,CAAC;MAEH,IAAKrB,GAAG,CAACuB,UAAU,CAAE,UAAW,CAAC,EAAG;QACnCb,WAAW,CAAEV,GAAI,CAAC;QAClBY,aAAa,CAAE,IAAK,CAAC;QACrBE,qBAAqB,CAAE,KAAM,CAAC;MAC/B,CAAC,MAAM,IAAKd,GAAG,CAACuB,UAAU,CAAE,UAAW,CAAC,EAAG;QAC1C,IAAK5D,QAAQ,CAAC6D,KAAK,EAAG;UACrBZ,aAAa,CAAEZ,GAAI,CAAC;QACrB,CAAC,MAAM,IAAKrC,QAAQ,CAACoD,SAAS,EAAG;UAChC9D,OAAO,CAACwE,QAAQ,CAAEzB,GAAI,CAAC,CAAC0B,IAAI,CAC3B,MAAM;YACL,IAAK,CAAET,SAAS,EAAG;cAClB;YACD;YACAL,aAAa,CAAEZ,GAAI,CAAC;YACpBc,qBAAqB,CAAE,IAAK,CAAC;UAC9B,CAAC,EACD,MAAM;YACL;YACA;YACA;YACA;YACA;UAAA,CAEF,CAAC;QACF;MACD;IACD;IACA,OAAO,MAAQG,SAAS,GAAG,KAAO;IAClC;IACA;IACA;EACD,CAAC,EAAE,CAAEjB,GAAG,CAAG,CAAC;EAEZ,MAAM2B,iBAAiB,GAAKC,KAAK,IAAM;IACtC,MAAM;MAAE3C,MAAM;MAAEkB;IAAM,CAAC,GAAGyB,KAAK,CAACC,WAAW,CAACC,MAAM;IAElD,IACC3B,KAAK,KAAK,CAAC,IACXlB,MAAM,KAAK,CAAC,KACVsB,aAAa,EAAEJ,KAAK,KAAKA,KAAK,IAC/BI,aAAa,EAAEtB,MAAM,KAAKA,MAAM,CAAE,EAClC;MACDuB,gBAAgB,CAAE;QAAEL,KAAK;QAAElB;MAAO,CAAE,CAAC;IACtC;EACD,CAAC;EAED,MAAM8C,OAAO,GAAKC,QAAQ,IAAM;IAC/B,IAAIC,IAAI;IACR,IAAIC,SAAS;IACb,QAASF,QAAQ;MAChB,KAAKzD,SAAS,CAACG,KAAK;QACnBuD,IAAI,GAAGlC,SAAS,IAAIjC,YAAY;QAChCoE,SAAS,GAAGC,eAAe;QAC3B;MACD,KAAK5D,SAAS,CAACC,OAAO;QACrByD,IAAI,GAAG1E,OAAO;QACd2E,SAAS,GAAGE,iBAAiB;QAC7B;MACD,KAAK7D,SAAS,CAACE,WAAW;QACzBwD,IAAI,GAAG3E,KAAK;QACZ4E,SAAS,GAAGG,qBAAqB;QACjC;MACD,KAAK9D,SAAS,CAACI,MAAM;QACpBsD,IAAI,GAAG3E,KAAK;QACZ4E,SAAS,GAAGI,gBAAgB;QAC5B;IACF;IACA,oBAAOpE,IAAA,CAACF,IAAI;MAACiE,IAAI,EAAGA,IAAM;MAAA,GAAMC;IAAS,CAAI,CAAC;EAC/C,CAAC;EAED,MAAMG,qBAAqB,GAAG7E,4BAA4B,CACzDK,MAAM,CAAC0E,eAAe,EACtB1E,MAAM,CAAC2E,mBACR,CAAC;EAED,MAAMF,gBAAgB,GAAG9E,4BAA4B,CACpDK,MAAM,CAAC4E,UAAU,EACjB5E,MAAM,CAAC6E,cACR,CAAC;EAED,MAAMN,iBAAiB,GAAG5E,4BAA4B,CACrDK,MAAM,CAAC8E,WAAW,EAClB9E,MAAM,CAAC+E,eACR,CAAC;EAED,MAAMC,eAAe,GAAGrF,4BAA4B,CACnDK,MAAM,CAACkC,SAAS,EAChBlC,MAAM,CAACiF,aACR,CAAC;EAED,MAAMX,eAAe,GAAG3E,4BAA4B,CACnDK,MAAM,CAACkF,SAAS,EAChBlF,MAAM,CAACmF,aACR,CAAC;EAED,MAAMC,oBAAoB,GAAGzF,4BAA4B,CACxDK,MAAM,CAACqF,cAAc,EACrBrF,MAAM,CAACsF,kBACR,CAAC;EAED,MAAMC,sBAAsB,GAAG5F,4BAA4B,CAC1DK,MAAM,CAACwF,gBAAgB,EACvBxF,MAAM,CAACyF,oBACR,CAAC;EAED,MAAMC,iBAAiB,GAAG,CACzB/F,4BAA4B,CAC3BK,MAAM,CAAC2F,oBAAoB,EAC3B3F,MAAM,CAAC4F,wBACR,CAAC,EACDzE,UAAU,IAAInB,MAAM,CAAC6F,kCAAkC,EACvDxE,WAAW,IAAI;IAAED,MAAM,EAAEC;EAAY,CAAC,CACtC;EAED,MAAMyE,WAAW,GAChBtD,SAAS,EAAEF,KAAK,GAAGI,aAAa,EAAEJ,KAAK,GACpCE,SAAS,EAAEF,KAAK,GAChBtC,MAAM,CAAC+F,IAAI,EAAEzD,KAAK;EAEtB,MAAM0D,oBAAoB,GAAG,CAC5BhG,MAAM,CAACiG,YAAY,EACnB;IACC3D,KAAK,EACJC,UAAU,KAAKvC,MAAM,CAAC+F,IAAI,EAAEzD,KAAK,IAC/BE,SAAS,IACVD,UAAU,GAAG,CAAC,IACdA,UAAU,GAAGG,aAAa,EAAEJ,KAAO,GACjCC,UAAU,GACVuD;EACL,CAAC,EACD9D,UAAU,IAAI;IAAEM,KAAK,EAAEtC,MAAM,CAAC+F,IAAI,EAAEzD;EAAM,CAAC,EAC3CnB,UAAU,IAAInB,MAAM,CAACkG,mBAAmB,CACxC;EAED,MAAMC,WAAW,GAAG,CACnB;IACC/E,MAAM,EAAEsB,aAAa,EAAEtB;EACxB,CAAC,EACD,CAAEY,UAAU,IAAI;IACfyB,WAAW,EAAEjB,SAAS,EAAEiB;EACzB,CAAC,EACDtC,UAAU,IAAInB,MAAM,CAACmB,UAAU,EAC/BA,UAAU,IACTpB,4BAA4B,CAC3BoB,UAAU,EACVuB,aAAa,EACbF,SACD,CAAC,EACF,CAAErB,UAAU,IACXqB,SAAS,IACTE,aAAa,IAAI;IAChBtB,MAAM,EACLoB,SAAS,EAAEF,KAAK,GAAGI,aAAa,EAAEJ,KAAK,IAAI,CAAEC,UAAU,GACpDG,aAAa,EAAEJ,KAAK,GAAGE,SAAS,EAAEiB,WAAW,GAC7C2C;EACL,CAAC,EACF/E,WAAW,IAAI;IAAED,MAAM,EAAEC;EAAY,CAAC,EACtCe,UAAU,CACV;;EAED;EACA;EACA;EACA;EACA,IAAIiE,wBAAwB;EAC5B,IAAKvG,QAAQ,CAAC6D,KAAK,EAAG;IACrB0C,wBAAwB,GACvB3D,aAAa,IAAI,CAAE4D,KAAK,CAAE5D,aAAa,CAACtB,MAAO,CAAC,GAC7CsB,aAAa,CAACtB,MAAM,GAAG,CAAC,GACxB,CAAC;EACN,CAAC,MAAM;IACNiF,wBAAwB,GAAG3D,aAAa,EAAEtB,MAAM;EACjD;EAEA,MAAMmF,mBAAmB,GAAG,CAC3B5G,4BAA4B,CAC3BK,MAAM,CAACwG,WAAW,EAClBxG,MAAM,CAACyG,eACR,CAAC,EACD;IACCrF,MAAM,EAAEiF;EACT,CAAC,CACD;EAED,oBACC5F,KAAA,CAACnB,IAAI;IACJ+C,KAAK,EAAG,CACPrC,MAAM,CAAC0G,SAAS;IAChB;IACA;IACA;IACAlE,SAAS,IAAIxB,KAAK,IAAI;MAAE2F,UAAU,EAAE3F;IAAM,CAAC,EAC3CqB,KAAK,CACH;IACHuE,QAAQ,EAAG9C,iBAAmB;IAAA+C,QAAA,gBAE9BpG,KAAA,CAACnB,IAAI;MACJwH,UAAU;MACVC,QAAQ,EAAG,CAAExF,UAAY;MACzByF,kBAAkB,EAAG/F,GAAK;MAC1BgG,iBAAiB,EAAGzH,EAAE,CAAE,6BAA8B,CAAG;MACzD0H,iBAAiB,EAAC,aAAa;MAE/B7E,KAAK,EAAG2D,oBAAsB;MAAAa,QAAA,GAE5BtF,UAAU,IAAID,iBAAiB,iBAChCjB,IAAA,CAACf,IAAI;QAAC+C,KAAK,EAAGkE;MAAqB,CAAE,CACrC,EAEC,CAAE/D,SAAS,gBACZnC,IAAA,CAACf,IAAI;QAAC+C,KAAK,EAAGqD,iBAAmB;QAAAmB,QAAA,eAChCxG,IAAA,CAACf,IAAI;UAAC+C,KAAK,EAAGrC,MAAM,CAACmH,2BAA6B;UAAAN,QAAA,EAC/C3C,OAAO,CAAExD,SAAS,CAACI,MAAO;QAAC,CACxB;MAAC,CACF,CAAC,gBAEPL,KAAA,CAACnB,IAAI;QAAC+C,KAAK,EAAGlB,UAAU,IAAInB,MAAM,CAACoH,iBAAmB;QAAAP,QAAA,GACnD/G,QAAQ,CAACoD,SAAS,iBACnBzC,KAAA,CAAAF,SAAA;UAAAsG,QAAA,GACG7D,kBAAkB,IAAIF,UAAU,iBACjCzC,IAAA,CAAClB,KAAK;YACLkD,KAAK,EAAG8D,WAAa;YACrBkB,YAAY,EAAG,CAAG;YAClBC,MAAM,EAAG;cAAEC,GAAG,EAAEzE;YAAW,CAAG;YAAA,IACvB,CAAE3B,UAAU,IAAI;cACtBqG,YAAY,EAAE;YACf,CAAC;YACDxF,UAAU,EAAGmB,eAAiB;YAC9BsE,MAAM,EAAI,iBAAiBtF,GAAK;UAAG,CACnC,CACD,EACC,CAAEa,kBAAkB,IAAI,CAAEF,UAAU,iBACrCzC,IAAA,CAAClB,KAAK;YACLkD,KAAK,EAAG8D,WAAa;YACrBkB,YAAY,EAAG,CAAG;YAClBC,MAAM,EAAG;cAAEC,GAAG,EAAE3E;YAAS,CAAG;YAAA,IACrB,CAAEzB,UAAU,IAAI;cACtBqG,YAAY,EAAE;YACf,CAAC;YACDxF,UAAU,EAAGmB;UAAiB,CAC9B,CACD;QAAA,CACA,CACF,EACCrD,QAAQ,CAAC6D,KAAK,iBACflD,KAAA,CAAAF,SAAA;UAAAsG,QAAA,gBACCxG,IAAA,CAAClB,KAAK;YACLkD,KAAK,EAAG8D,WAAa;YACrBmB,MAAM,EAAG;cACRC,GAAG,EACFzE,UAAU,IAAIE,kBAAkB,GAC7BF,UAAU,GACVF,QAAQ,IAAIT;YACjB,CAAG;YAAA,IACI,CAAEhB,UAAU,IAAI;cACtBqG,YAAY,EAAE;YACf,CAAC;YACDxF,UAAU,EAAGmB,eAAiB;YAC9BsE,MAAM,EAAI,iBACT3E,UAAU,IAAIE,kBAAkB,GAC7BF,UAAU,GACVF,QAAQ,IAAIT,GACf;UAAG,CACJ,CAAC,eACF9B,IAAA,CAAClB,KAAK;YACLmI,MAAM,EAAG;cAAEC,GAAG,EAAEzE;YAAW,CAAG;YAC9BT,KAAK,EAAGrC,MAAM,CAAC0H,eAAiB;YAChCC,MAAM,EAAGA,CAAA,KAAM;cACd1E,qBAAqB,CAAE,IAAK,CAAC;YAC9B;UAAG,CACH,CAAC;QAAA,CACD,CACF;MAAA,CACI,CACN,EAEC,CAAExB,cAAc,IAAIC,cAAc,KAAMO,YAAY,iBACrDxB,KAAA,CAACnB,IAAI;QACJ+C,KAAK,EAAG,CACPrC,MAAM,CAAC4H,cAAc,EACrBxC,oBAAoB,CAClB;QAAAyB,QAAA,gBAEHxG,IAAA,CAACf,IAAI;UACJ+C,KAAK,EAAG,CACP2C,eAAe,EACf9C,SAAS,IAAIlC,MAAM,CAAC6H,eAAe,CACjC;UAAAhB,QAAA,EAEDnF,cAAc,GACbwC,OAAO,CAAExD,SAAS,CAACC,OAAQ,CAAC,GAC5BuD,OAAO,CAAExD,SAAS,CAACG,KAAM;QAAC,CACxB,CAAC,eACPR,IAAA,CAAChB,IAAI;UAACgD,KAAK,EAAGkD,sBAAwB;UAAAsB,QAAA,EACnC5E;QAAY,CACT,CAAC;MAAA,CACF,CACN;IAAA,GA/FKE,GAgGD,CAAC,EAELjB,UAAU,IAAIK,UAAU,IAAI,CAAEI,kBAAkB,iBACjDtB,IAAA,CAACH,kBAAkB;MAClB4B,yBAAyB,EAAGA,yBAA2B;MACvDC,gBAAgB,EAAGA,gBAAkB;MACrCI,GAAG,EACF,EAAIV,cAAc,IAAIC,cAAc,CAAE,IACtCc,SAAS,IACTL,GACA;MACD2F,aAAa,EAAGlG;IAAoB,CACpC,CACD;EAAA,CACI,CAAC;AAET,CAAC;AAED,eAAeb,cAAc","ignoreList":[]}