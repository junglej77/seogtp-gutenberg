{"version":3,"names":["Keyboard","useEffect","useCallback","useState","useRef","useKeyboardOffset","scrollEnabled","shouldPreventAutomaticScroll","keyboardOffset","setKeyboardOffset","timeoutRef","onKeyboardDidHide","clearTimeout","current","setTimeout","onKeyboardDidShow","endCoordinates","height","onKeyboardWillShow","willShowSubscription","showSubscription","hideSubscription","addListener","remove"],"sources":["@wordpress/components/src/mobile/keyboard-aware-flat-list/use-keyboard-offset.native.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\n\r\nimport { Keyboard } from 'react-native';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { useEffect, useCallback, useState, useRef } from '@wordpress/element';\r\n\r\n/**\r\n * Hook that adds Keyboard listeners to get the offset space\r\n * when the keyboard is opened, taking into account focused AztecViews.\r\n *\r\n * @param {boolean}  scrollEnabled                Whether the scroll is enabled or not.\r\n * @param {Function} shouldPreventAutomaticScroll Whether to prevent scrolling when there's a Keyboard offset set.\r\n * @return {[number]} Keyboard offset.\r\n */\r\nexport default function useKeyboardOffset(\r\n\tscrollEnabled,\r\n\tshouldPreventAutomaticScroll\r\n) {\r\n\tconst [ keyboardOffset, setKeyboardOffset ] = useState( 0 );\r\n\tconst timeoutRef = useRef();\r\n\r\n\tconst onKeyboardDidHide = useCallback( () => {\r\n\t\tif ( shouldPreventAutomaticScroll() ) {\r\n\t\t\tclearTimeout( timeoutRef.current );\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// A timeout is being used to delay resetting the offset in cases\r\n\t\t// where the focus is changed to a different TextInput.\r\n\t\tclearTimeout( timeoutRef.current );\r\n\t\ttimeoutRef.current = setTimeout( () => {\r\n\t\t\tsetKeyboardOffset( 0 );\r\n\t\t}, 200 );\r\n\t}, [ shouldPreventAutomaticScroll ] );\r\n\r\n\tconst onKeyboardDidShow = useCallback( ( { endCoordinates } ) => {\r\n\t\tclearTimeout( timeoutRef.current );\r\n\t\tsetKeyboardOffset( endCoordinates.height );\r\n\t}, [] );\r\n\r\n\tconst onKeyboardWillShow = useCallback( () => {\r\n\t\tclearTimeout( timeoutRef.current );\r\n\t}, [] );\r\n\r\n\tuseEffect( () => {\r\n\t\tlet willShowSubscription;\r\n\t\tlet showSubscription;\r\n\t\tlet hideSubscription;\r\n\r\n\t\tif ( scrollEnabled ) {\r\n\t\t\twillShowSubscription = Keyboard.addListener(\r\n\t\t\t\t'keyboardWillShow',\r\n\t\t\t\tonKeyboardWillShow\r\n\t\t\t);\r\n\t\t\tshowSubscription = Keyboard.addListener(\r\n\t\t\t\t'keyboardDidShow',\r\n\t\t\t\tonKeyboardDidShow\r\n\t\t\t);\r\n\t\t\thideSubscription = Keyboard.addListener(\r\n\t\t\t\t'keyboardDidHide',\r\n\t\t\t\tonKeyboardDidHide\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\twillShowSubscription?.remove();\r\n\t\t\tshowSubscription?.remove();\r\n\t\t\thideSubscription?.remove();\r\n\t\t}\r\n\r\n\t\treturn () => {\r\n\t\t\tclearTimeout( timeoutRef.current );\r\n\t\t\twillShowSubscription?.remove();\r\n\t\t\tshowSubscription?.remove();\r\n\t\t\thideSubscription?.remove();\r\n\t\t};\r\n\t}, [\r\n\t\tonKeyboardDidHide,\r\n\t\tonKeyboardDidShow,\r\n\t\tonKeyboardWillShow,\r\n\t\tscrollEnabled,\r\n\t] );\r\n\treturn [ keyboardOffset ];\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;;AAEA,SAASA,QAAQ,QAAQ,cAAc;;AAEvC;AACA;AACA;AACA,SAASC,SAAS,EAAEC,WAAW,EAAEC,QAAQ,EAAEC,MAAM,QAAQ,oBAAoB;;AAE7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAASC,iBAAiBA,CACxCC,aAAa,EACbC,4BAA4B,EAC3B;EACD,MAAM,CAAEC,cAAc,EAAEC,iBAAiB,CAAE,GAAGN,QAAQ,CAAE,CAAE,CAAC;EAC3D,MAAMO,UAAU,GAAGN,MAAM,CAAC,CAAC;EAE3B,MAAMO,iBAAiB,GAAGT,WAAW,CAAE,MAAM;IAC5C,IAAKK,4BAA4B,CAAC,CAAC,EAAG;MACrCK,YAAY,CAAEF,UAAU,CAACG,OAAQ,CAAC;MAClC;IACD;;IAEA;IACA;IACAD,YAAY,CAAEF,UAAU,CAACG,OAAQ,CAAC;IAClCH,UAAU,CAACG,OAAO,GAAGC,UAAU,CAAE,MAAM;MACtCL,iBAAiB,CAAE,CAAE,CAAC;IACvB,CAAC,EAAE,GAAI,CAAC;EACT,CAAC,EAAE,CAAEF,4BAA4B,CAAG,CAAC;EAErC,MAAMQ,iBAAiB,GAAGb,WAAW,CAAE,CAAE;IAAEc;EAAe,CAAC,KAAM;IAChEJ,YAAY,CAAEF,UAAU,CAACG,OAAQ,CAAC;IAClCJ,iBAAiB,CAAEO,cAAc,CAACC,MAAO,CAAC;EAC3C,CAAC,EAAE,EAAG,CAAC;EAEP,MAAMC,kBAAkB,GAAGhB,WAAW,CAAE,MAAM;IAC7CU,YAAY,CAAEF,UAAU,CAACG,OAAQ,CAAC;EACnC,CAAC,EAAE,EAAG,CAAC;EAEPZ,SAAS,CAAE,MAAM;IAChB,IAAIkB,oBAAoB;IACxB,IAAIC,gBAAgB;IACpB,IAAIC,gBAAgB;IAEpB,IAAKf,aAAa,EAAG;MACpBa,oBAAoB,GAAGnB,QAAQ,CAACsB,WAAW,CAC1C,kBAAkB,EAClBJ,kBACD,CAAC;MACDE,gBAAgB,GAAGpB,QAAQ,CAACsB,WAAW,CACtC,iBAAiB,EACjBP,iBACD,CAAC;MACDM,gBAAgB,GAAGrB,QAAQ,CAACsB,WAAW,CACtC,iBAAiB,EACjBX,iBACD,CAAC;IACF,CAAC,MAAM;MACNQ,oBAAoB,EAAEI,MAAM,CAAC,CAAC;MAC9BH,gBAAgB,EAAEG,MAAM,CAAC,CAAC;MAC1BF,gBAAgB,EAAEE,MAAM,CAAC,CAAC;IAC3B;IAEA,OAAO,MAAM;MACZX,YAAY,CAAEF,UAAU,CAACG,OAAQ,CAAC;MAClCM,oBAAoB,EAAEI,MAAM,CAAC,CAAC;MAC9BH,gBAAgB,EAAEG,MAAM,CAAC,CAAC;MAC1BF,gBAAgB,EAAEE,MAAM,CAAC,CAAC;IAC3B,CAAC;EACF,CAAC,EAAE,CACFZ,iBAAiB,EACjBI,iBAAiB,EACjBG,kBAAkB,EAClBZ,aAAa,CACZ,CAAC;EACH,OAAO,CAAEE,cAAc,CAAE;AAC1B","ignoreList":[]}