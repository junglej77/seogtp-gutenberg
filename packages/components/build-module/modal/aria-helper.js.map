{"version":3,"names":["LIVE_REGION_ARIA_ROLES","Set","hiddenElementsByDepth","modalize","modalElement","elements","Array","from","document","body","children","hiddenElements","push","element","elementShouldBeHidden","setAttribute","role","getAttribute","tagName","hasAttribute","has","unmodalize","pop","removeAttribute"],"sources":["@wordpress/components/src/modal/aria-helper.ts"],"sourcesContent":["const LIVE_REGION_ARIA_ROLES = new Set( [\r\n\t'alert',\r\n\t'status',\r\n\t'log',\r\n\t'marquee',\r\n\t'timer',\r\n] );\r\n\r\nconst hiddenElementsByDepth: Element[][] = [];\r\n\r\n/**\r\n * Hides all elements in the body element from screen-readers except\r\n * the provided element and elements that should not be hidden from\r\n * screen-readers.\r\n *\r\n * The reason we do this is because `aria-modal=\"true\"` currently is bugged\r\n * in Safari, and support is spotty in other browsers overall. In the future\r\n * we should consider removing these helper functions in favor of\r\n * `aria-modal=\"true\"`.\r\n *\r\n * @param modalElement The element that should not be hidden.\r\n */\r\nexport function modalize( modalElement?: HTMLDivElement ) {\r\n\tconst elements = Array.from( document.body.children );\r\n\tconst hiddenElements: Element[] = [];\r\n\thiddenElementsByDepth.push( hiddenElements );\r\n\tfor ( const element of elements ) {\r\n\t\tif ( element === modalElement ) {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tif ( elementShouldBeHidden( element ) ) {\r\n\t\t\telement.setAttribute( 'aria-hidden', 'true' );\r\n\t\t\thiddenElements.push( element );\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Determines if the passed element should not be hidden from screen readers.\r\n *\r\n * @param element The element that should be checked.\r\n *\r\n * @return Whether the element should not be hidden from screen-readers.\r\n */\r\nexport function elementShouldBeHidden( element: Element ) {\r\n\tconst role = element.getAttribute( 'role' );\r\n\treturn ! (\r\n\t\telement.tagName === 'SCRIPT' ||\r\n\t\telement.hasAttribute( 'aria-hidden' ) ||\r\n\t\telement.hasAttribute( 'aria-live' ) ||\r\n\t\t( role && LIVE_REGION_ARIA_ROLES.has( role ) )\r\n\t);\r\n}\r\n\r\n/**\r\n * Accessibly reveals the elements hidden by the latest modal.\r\n */\r\nexport function unmodalize() {\r\n\tconst hiddenElements = hiddenElementsByDepth.pop();\r\n\tif ( ! hiddenElements ) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tfor ( const element of hiddenElements ) {\r\n\t\telement.removeAttribute( 'aria-hidden' );\r\n\t}\r\n}\r\n"],"mappings":"AAAA,MAAMA,sBAAsB,GAAG,IAAIC,GAAG,CAAE,CACvC,OAAO,EACP,QAAQ,EACR,KAAK,EACL,SAAS,EACT,OAAO,CACN,CAAC;AAEH,MAAMC,qBAAkC,GAAG,EAAE;;AAE7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,QAAQA,CAAEC,YAA6B,EAAG;EACzD,MAAMC,QAAQ,GAAGC,KAAK,CAACC,IAAI,CAAEC,QAAQ,CAACC,IAAI,CAACC,QAAS,CAAC;EACrD,MAAMC,cAAyB,GAAG,EAAE;EACpCT,qBAAqB,CAACU,IAAI,CAAED,cAAe,CAAC;EAC5C,KAAM,MAAME,OAAO,IAAIR,QAAQ,EAAG;IACjC,IAAKQ,OAAO,KAAKT,YAAY,EAAG;MAC/B;IACD;IAEA,IAAKU,qBAAqB,CAAED,OAAQ,CAAC,EAAG;MACvCA,OAAO,CAACE,YAAY,CAAE,aAAa,EAAE,MAAO,CAAC;MAC7CJ,cAAc,CAACC,IAAI,CAAEC,OAAQ,CAAC;IAC/B;EACD;AACD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,qBAAqBA,CAAED,OAAgB,EAAG;EACzD,MAAMG,IAAI,GAAGH,OAAO,CAACI,YAAY,CAAE,MAAO,CAAC;EAC3C,OAAO,EACNJ,OAAO,CAACK,OAAO,KAAK,QAAQ,IAC5BL,OAAO,CAACM,YAAY,CAAE,aAAc,CAAC,IACrCN,OAAO,CAACM,YAAY,CAAE,WAAY,CAAC,IACjCH,IAAI,IAAIhB,sBAAsB,CAACoB,GAAG,CAAEJ,IAAK,CAAG,CAC9C;AACF;;AAEA;AACA;AACA;AACA,OAAO,SAASK,UAAUA,CAAA,EAAG;EAC5B,MAAMV,cAAc,GAAGT,qBAAqB,CAACoB,GAAG,CAAC,CAAC;EAClD,IAAK,CAAEX,cAAc,EAAG;IACvB;EACD;EAEA,KAAM,MAAME,OAAO,IAAIF,cAAc,EAAG;IACvCE,OAAO,CAACU,eAAe,CAAE,aAAc,CAAC;EACzC;AACD","ignoreList":[]}