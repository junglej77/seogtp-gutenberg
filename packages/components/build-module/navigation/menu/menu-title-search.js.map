{"version":3,"names":["useEffect","useRef","__","_n","sprintf","withSpokenMessages","useNavigationMenuContext","useNavigationContext","SEARCH_FOCUS_DELAY","SearchControl","MenuTitleSearchControlWrapper","jsx","_jsx","MenuTitleSearch","debouncedSpeak","onCloseSearch","onSearch","search","title","navigationTree","items","menu","inputRef","delayedFocus","setTimeout","current","focus","clearTimeout","count","Object","values","filter","item","_isVisible","length","resultsFoundMessage","onClose","onKeyDown","event","code","defaultPrevented","preventDefault","inputId","placeholder","toLowerCase","trim","children","__nextHasNoMarginBottom","className","id","onChange","value","ref"],"sources":["@wordpress/components/src/navigation/menu/menu-title-search.tsx"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useEffect, useRef } from '@wordpress/element';\r\nimport { __, _n, sprintf } from '@wordpress/i18n';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport withSpokenMessages from '../../higher-order/with-spoken-messages';\r\nimport { useNavigationMenuContext } from './context';\r\nimport { useNavigationContext } from '../context';\r\nimport { SEARCH_FOCUS_DELAY } from '../constants';\r\n\r\nimport type { NavigationMenuTitleSearchProps } from '../types';\r\nimport SearchControl from '../../search-control';\r\nimport { MenuTitleSearchControlWrapper } from '../styles/navigation-styles';\r\n\r\nfunction MenuTitleSearch( {\r\n\tdebouncedSpeak,\r\n\tonCloseSearch,\r\n\tonSearch,\r\n\tsearch,\r\n\ttitle,\r\n}: NavigationMenuTitleSearchProps ) {\r\n\tconst {\r\n\t\tnavigationTree: { items },\r\n\t} = useNavigationContext();\r\n\tconst { menu } = useNavigationMenuContext();\r\n\tconst inputRef = useRef< HTMLInputElement >( null );\r\n\r\n\t// Wait for the slide-in animation to complete before autofocusing the input.\r\n\t// This prevents scrolling to the input during the animation.\r\n\tuseEffect( () => {\r\n\t\tconst delayedFocus = setTimeout( () => {\r\n\t\t\tinputRef.current?.focus();\r\n\t\t}, SEARCH_FOCUS_DELAY );\r\n\r\n\t\treturn () => {\r\n\t\t\tclearTimeout( delayedFocus );\r\n\t\t};\r\n\t}, [] );\r\n\r\n\tuseEffect( () => {\r\n\t\tif ( ! search ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst count = Object.values( items ).filter(\r\n\t\t\t( item ) => item._isVisible\r\n\t\t).length;\r\n\t\tconst resultsFoundMessage = sprintf(\r\n\t\t\t/* translators: %d: number of results. */\r\n\t\t\t_n( '%d result found.', '%d results found.', count ),\r\n\t\t\tcount\r\n\t\t);\r\n\t\tdebouncedSpeak( resultsFoundMessage );\r\n\t\t// Ignore exhaustive-deps rule for now. See https://github.com/WordPress/gutenberg/pull/44090\r\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, [ items, search ] );\r\n\r\n\tconst onClose = () => {\r\n\t\tonSearch?.( '' );\r\n\t\tonCloseSearch();\r\n\t};\r\n\r\n\tconst onKeyDown: React.KeyboardEventHandler< HTMLInputElement > = (\r\n\t\tevent\r\n\t) => {\r\n\t\tif ( event.code === 'Escape' && ! event.defaultPrevented ) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tonClose();\r\n\t\t}\r\n\t};\r\n\r\n\tconst inputId = `components-navigation__menu-title-search-${ menu }`;\r\n\tconst placeholder = sprintf(\r\n\t\t/* translators: placeholder for menu search box. %s: menu title */\r\n\t\t__( 'Search %s' ),\r\n\t\ttitle?.toLowerCase()\r\n\t).trim();\r\n\r\n\treturn (\r\n\t\t<MenuTitleSearchControlWrapper>\r\n\t\t\t<SearchControl\r\n\t\t\t\t__nextHasNoMarginBottom\r\n\t\t\t\tclassName=\"components-navigation__menu-search-input\"\r\n\t\t\t\tid={ inputId }\r\n\t\t\t\tonChange={ ( value ) => onSearch?.( value ) }\r\n\t\t\t\tonKeyDown={ onKeyDown }\r\n\t\t\t\tplaceholder={ placeholder }\r\n\t\t\t\tonClose={ onClose }\r\n\t\t\t\tref={ inputRef }\r\n\t\t\t\tvalue={ search }\r\n\t\t\t/>\r\n\t\t</MenuTitleSearchControlWrapper>\r\n\t);\r\n}\r\n\r\nexport default withSpokenMessages( MenuTitleSearch );\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,SAAS,EAAEC,MAAM,QAAQ,oBAAoB;AACtD,SAASC,EAAE,EAAEC,EAAE,EAAEC,OAAO,QAAQ,iBAAiB;;AAEjD;AACA;AACA;AACA,OAAOC,kBAAkB,MAAM,yCAAyC;AACxE,SAASC,wBAAwB,QAAQ,WAAW;AACpD,SAASC,oBAAoB,QAAQ,YAAY;AACjD,SAASC,kBAAkB,QAAQ,cAAc;AAGjD,OAAOC,aAAa,MAAM,sBAAsB;AAChD,SAASC,6BAA6B,QAAQ,6BAA6B;AAAC,SAAAC,GAAA,IAAAC,IAAA;AAE5E,SAASC,eAAeA,CAAE;EACzBC,cAAc;EACdC,aAAa;EACbC,QAAQ;EACRC,MAAM;EACNC;AAC+B,CAAC,EAAG;EACnC,MAAM;IACLC,cAAc,EAAE;MAAEC;IAAM;EACzB,CAAC,GAAGb,oBAAoB,CAAC,CAAC;EAC1B,MAAM;IAAEc;EAAK,CAAC,GAAGf,wBAAwB,CAAC,CAAC;EAC3C,MAAMgB,QAAQ,GAAGrB,MAAM,CAAsB,IAAK,CAAC;;EAEnD;EACA;EACAD,SAAS,CAAE,MAAM;IAChB,MAAMuB,YAAY,GAAGC,UAAU,CAAE,MAAM;MACtCF,QAAQ,CAACG,OAAO,EAAEC,KAAK,CAAC,CAAC;IAC1B,CAAC,EAAElB,kBAAmB,CAAC;IAEvB,OAAO,MAAM;MACZmB,YAAY,CAAEJ,YAAa,CAAC;IAC7B,CAAC;EACF,CAAC,EAAE,EAAG,CAAC;EAEPvB,SAAS,CAAE,MAAM;IAChB,IAAK,CAAEiB,MAAM,EAAG;MACf;IACD;IAEA,MAAMW,KAAK,GAAGC,MAAM,CAACC,MAAM,CAAEV,KAAM,CAAC,CAACW,MAAM,CACxCC,IAAI,IAAMA,IAAI,CAACC,UAClB,CAAC,CAACC,MAAM;IACR,MAAMC,mBAAmB,GAAG/B,OAAO,EAClC;IACAD,EAAE,CAAE,kBAAkB,EAAE,mBAAmB,EAAEyB,KAAM,CAAC,EACpDA,KACD,CAAC;IACDd,cAAc,CAAEqB,mBAAoB,CAAC;IACrC;IACA;EACD,CAAC,EAAE,CAAEf,KAAK,EAAEH,MAAM,CAAG,CAAC;EAEtB,MAAMmB,OAAO,GAAGA,CAAA,KAAM;IACrBpB,QAAQ,GAAI,EAAG,CAAC;IAChBD,aAAa,CAAC,CAAC;EAChB,CAAC;EAED,MAAMsB,SAAyD,GAC9DC,KAAK,IACD;IACJ,IAAKA,KAAK,CAACC,IAAI,KAAK,QAAQ,IAAI,CAAED,KAAK,CAACE,gBAAgB,EAAG;MAC1DF,KAAK,CAACG,cAAc,CAAC,CAAC;MACtBL,OAAO,CAAC,CAAC;IACV;EACD,CAAC;EAED,MAAMM,OAAO,GAAI,4CAA4CrB,IAAM,EAAC;EACpE,MAAMsB,WAAW,GAAGvC,OAAO,EAC1B;EACAF,EAAE,CAAE,WAAY,CAAC,EACjBgB,KAAK,EAAE0B,WAAW,CAAC,CACpB,CAAC,CAACC,IAAI,CAAC,CAAC;EAER,oBACCjC,IAAA,CAACF,6BAA6B;IAAAoC,QAAA,eAC7BlC,IAAA,CAACH,aAAa;MACbsC,uBAAuB;MACvBC,SAAS,EAAC,0CAA0C;MACpDC,EAAE,EAAGP,OAAS;MACdQ,QAAQ,EAAKC,KAAK,IAAMnC,QAAQ,GAAImC,KAAM,CAAG;MAC7Cd,SAAS,EAAGA,SAAW;MACvBM,WAAW,EAAGA,WAAa;MAC3BP,OAAO,EAAGA,OAAS;MACnBgB,GAAG,EAAG9B,QAAU;MAChB6B,KAAK,EAAGlC;IAAQ,CAChB;EAAC,CAC4B,CAAC;AAElC;AAEA,eAAeZ,kBAAkB,CAAEQ,eAAgB,CAAC","ignoreList":[]}