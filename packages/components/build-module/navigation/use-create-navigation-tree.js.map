{"version":3,"names":["useState","useNavigationTreeNodes","useCreateNavigationTree","nodes","items","getNode","getItem","addNode","addItem","removeNode","removeItem","menus","getMenu","addMenu","removeMenu","childMenu","setChildMenu","getChildMenu","menu","traverseMenu","startMenu","callback","visited","queue","current","length","shift","includes","push","isMenuEmpty","menuToCheck","isEmpty","undefined","key","value","state","newState","parentMenu"],"sources":["@wordpress/components/src/navigation/use-create-navigation-tree.tsx"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useState } from '@wordpress/element';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { useNavigationTreeNodes } from './use-navigation-tree-nodes';\r\n\r\nimport type { NavigationContext, Item, Menu } from './types';\r\n\r\nexport const useCreateNavigationTree = () => {\r\n\tconst {\r\n\t\tnodes: items,\r\n\t\tgetNode: getItem,\r\n\t\taddNode: addItem,\r\n\t\tremoveNode: removeItem,\r\n\t} = useNavigationTreeNodes< Item >();\r\n\r\n\tconst {\r\n\t\tnodes: menus,\r\n\t\tgetNode: getMenu,\r\n\t\taddNode: addMenu,\r\n\t\tremoveNode: removeMenu,\r\n\t} = useNavigationTreeNodes< Menu >();\r\n\r\n\t/**\r\n\t * Stores direct nested menus of menus\r\n\t * This makes it easy to traverse menu tree\r\n\t *\r\n\t * Key is the menu prop of the menu\r\n\t * Value is an array of menu keys\r\n\t */\r\n\tconst [ childMenu, setChildMenu ] = useState< Record< string, string[] > >(\r\n\t\t{}\r\n\t);\r\n\tconst getChildMenu = ( menu: string ) => childMenu[ menu ] || [];\r\n\r\n\tconst traverseMenu: NavigationContext[ 'navigationTree' ][ 'traverseMenu' ] =\r\n\t\t( startMenu, callback ) => {\r\n\t\t\tconst visited: string[] = [];\r\n\t\t\tlet queue = [ startMenu ];\r\n\t\t\tlet current: Menu;\r\n\r\n\t\t\twhile ( queue.length > 0 ) {\r\n\t\t\t\t// Type cast to string is safe because of the `length > 0` check above.\r\n\t\t\t\tcurrent = getMenu( queue.shift() as string );\r\n\r\n\t\t\t\tif ( ! current || visited.includes( current.menu ) ) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvisited.push( current.menu );\r\n\t\t\t\tqueue = [ ...queue, ...getChildMenu( current.menu ) ];\r\n\r\n\t\t\t\tif ( callback( current ) === false ) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\tconst isMenuEmpty = ( menuToCheck: string ) => {\r\n\t\tlet isEmpty = true;\r\n\r\n\t\ttraverseMenu( menuToCheck, ( current: Menu ) => {\r\n\t\t\tif ( ! current.isEmpty ) {\r\n\t\t\t\tisEmpty = false;\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\treturn undefined;\r\n\t\t} );\r\n\r\n\t\treturn isEmpty;\r\n\t};\r\n\r\n\treturn {\r\n\t\titems,\r\n\t\tgetItem,\r\n\t\taddItem,\r\n\t\tremoveItem,\r\n\r\n\t\tmenus,\r\n\t\tgetMenu,\r\n\t\taddMenu: ( key: string, value: Menu ) => {\r\n\t\t\tsetChildMenu( ( state ) => {\r\n\t\t\t\tconst newState = { ...state };\r\n\r\n\t\t\t\tif ( ! value.parentMenu ) {\r\n\t\t\t\t\treturn newState;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( ! newState[ value.parentMenu ] ) {\r\n\t\t\t\t\tnewState[ value.parentMenu ] = [];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tnewState[ value.parentMenu ].push( key );\r\n\r\n\t\t\t\treturn newState;\r\n\t\t\t} );\r\n\r\n\t\t\taddMenu( key, value );\r\n\t\t},\r\n\t\tremoveMenu,\r\n\t\tchildMenu,\r\n\t\ttraverseMenu,\r\n\t\tisMenuEmpty,\r\n\t};\r\n};\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,QAAQ,QAAQ,oBAAoB;;AAE7C;AACA;AACA;AACA,SAASC,sBAAsB,QAAQ,6BAA6B;AAIpE,OAAO,MAAMC,uBAAuB,GAAGA,CAAA,KAAM;EAC5C,MAAM;IACLC,KAAK,EAAEC,KAAK;IACZC,OAAO,EAAEC,OAAO;IAChBC,OAAO,EAAEC,OAAO;IAChBC,UAAU,EAAEC;EACb,CAAC,GAAGT,sBAAsB,CAAS,CAAC;EAEpC,MAAM;IACLE,KAAK,EAAEQ,KAAK;IACZN,OAAO,EAAEO,OAAO;IAChBL,OAAO,EAAEM,OAAO;IAChBJ,UAAU,EAAEK;EACb,CAAC,GAAGb,sBAAsB,CAAS,CAAC;;EAEpC;AACD;AACA;AACA;AACA;AACA;AACA;EACC,MAAM,CAAEc,SAAS,EAAEC,YAAY,CAAE,GAAGhB,QAAQ,CAC3C,CAAC,CACF,CAAC;EACD,MAAMiB,YAAY,GAAKC,IAAY,IAAMH,SAAS,CAAEG,IAAI,CAAE,IAAI,EAAE;EAEhE,MAAMC,YAAqE,GAC1EA,CAAEC,SAAS,EAAEC,QAAQ,KAAM;IAC1B,MAAMC,OAAiB,GAAG,EAAE;IAC5B,IAAIC,KAAK,GAAG,CAAEH,SAAS,CAAE;IACzB,IAAII,OAAa;IAEjB,OAAQD,KAAK,CAACE,MAAM,GAAG,CAAC,EAAG;MAC1B;MACAD,OAAO,GAAGZ,OAAO,CAAEW,KAAK,CAACG,KAAK,CAAC,CAAY,CAAC;MAE5C,IAAK,CAAEF,OAAO,IAAIF,OAAO,CAACK,QAAQ,CAAEH,OAAO,CAACN,IAAK,CAAC,EAAG;QACpD;MACD;MAEAI,OAAO,CAACM,IAAI,CAAEJ,OAAO,CAACN,IAAK,CAAC;MAC5BK,KAAK,GAAG,CAAE,GAAGA,KAAK,EAAE,GAAGN,YAAY,CAAEO,OAAO,CAACN,IAAK,CAAC,CAAE;MAErD,IAAKG,QAAQ,CAAEG,OAAQ,CAAC,KAAK,KAAK,EAAG;QACpC;MACD;IACD;EACD,CAAC;EAEF,MAAMK,WAAW,GAAKC,WAAmB,IAAM;IAC9C,IAAIC,OAAO,GAAG,IAAI;IAElBZ,YAAY,CAAEW,WAAW,EAAIN,OAAa,IAAM;MAC/C,IAAK,CAAEA,OAAO,CAACO,OAAO,EAAG;QACxBA,OAAO,GAAG,KAAK;QACf,OAAO,KAAK;MACb;MAEA,OAAOC,SAAS;IACjB,CAAE,CAAC;IAEH,OAAOD,OAAO;EACf,CAAC;EAED,OAAO;IACN3B,KAAK;IACLE,OAAO;IACPE,OAAO;IACPE,UAAU;IAEVC,KAAK;IACLC,OAAO;IACPC,OAAO,EAAEA,CAAEoB,GAAW,EAAEC,KAAW,KAAM;MACxClB,YAAY,CAAImB,KAAK,IAAM;QAC1B,MAAMC,QAAQ,GAAG;UAAE,GAAGD;QAAM,CAAC;QAE7B,IAAK,CAAED,KAAK,CAACG,UAAU,EAAG;UACzB,OAAOD,QAAQ;QAChB;QAEA,IAAK,CAAEA,QAAQ,CAAEF,KAAK,CAACG,UAAU,CAAE,EAAG;UACrCD,QAAQ,CAAEF,KAAK,CAACG,UAAU,CAAE,GAAG,EAAE;QAClC;QAEAD,QAAQ,CAAEF,KAAK,CAACG,UAAU,CAAE,CAACT,IAAI,CAAEK,GAAI,CAAC;QAExC,OAAOG,QAAQ;MAChB,CAAE,CAAC;MAEHvB,OAAO,CAAEoB,GAAG,EAAEC,KAAM,CAAC;IACtB,CAAC;IACDpB,UAAU;IACVC,SAAS;IACTI,YAAY;IACZU;EACD,CAAC;AACF,CAAC","ignoreList":[]}