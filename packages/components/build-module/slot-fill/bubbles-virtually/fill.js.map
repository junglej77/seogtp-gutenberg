{"version":3,"names":["useRef","useState","useEffect","createPortal","useSlot","StyleProvider","jsx","_jsx","useForceUpdate","setState","mountedRef","current","Fill","props","_slot$fillProps","name","children","registerFill","unregisterFill","slot","rerender","ref","wrappedChildren","document","ownerDocument","fillProps"],"sources":["@wordpress/components/src/slot-fill/bubbles-virtually/fill.tsx"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useRef, useState, useEffect, createPortal } from '@wordpress/element';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport useSlot from './use-slot';\r\nimport StyleProvider from '../../style-provider';\r\nimport type { FillComponentProps } from '../types';\r\n\r\nfunction useForceUpdate() {\r\n\tconst [ , setState ] = useState( {} );\r\n\tconst mountedRef = useRef( true );\r\n\r\n\tuseEffect( () => {\r\n\t\tmountedRef.current = true;\r\n\t\treturn () => {\r\n\t\t\tmountedRef.current = false;\r\n\t\t};\r\n\t}, [] );\r\n\r\n\treturn () => {\r\n\t\tif ( mountedRef.current ) {\r\n\t\t\tsetState( {} );\r\n\t\t}\r\n\t};\r\n}\r\n\r\nexport default function Fill( props: FillComponentProps ) {\r\n\tconst { name, children } = props;\r\n\tconst { registerFill, unregisterFill, ...slot } = useSlot( name );\r\n\tconst rerender = useForceUpdate();\r\n\tconst ref = useRef( { rerender } );\r\n\r\n\tuseEffect( () => {\r\n\t\t// We register fills so we can keep track of their existence.\r\n\t\t// Some Slot implementations need to know if there're already fills\r\n\t\t// registered so they can choose to render themselves or not.\r\n\t\tregisterFill( ref );\r\n\t\treturn () => {\r\n\t\t\tunregisterFill( ref );\r\n\t\t};\r\n\t}, [ registerFill, unregisterFill ] );\r\n\r\n\tif ( ! slot.ref || ! slot.ref.current ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\t// When using a `Fill`, the `children` will be rendered in the document of the\r\n\t// `Slot`. This means that we need to wrap the `children` in a `StyleProvider`\r\n\t// to make sure we're referencing the right document/iframe (instead of the\r\n\t// context of the `Fill`'s parent).\r\n\tconst wrappedChildren = (\r\n\t\t<StyleProvider document={ slot.ref.current.ownerDocument }>\r\n\t\t\t{ typeof children === 'function'\r\n\t\t\t\t? children( slot.fillProps ?? {} )\r\n\t\t\t\t: children }\r\n\t\t</StyleProvider>\r\n\t);\r\n\r\n\treturn createPortal( wrappedChildren, slot.ref.current );\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,MAAM,EAAEC,QAAQ,EAAEC,SAAS,EAAEC,YAAY,QAAQ,oBAAoB;;AAE9E;AACA;AACA;AACA,OAAOC,OAAO,MAAM,YAAY;AAChC,OAAOC,aAAa,MAAM,sBAAsB;AAAC,SAAAC,GAAA,IAAAC,IAAA;AAGjD,SAASC,cAAcA,CAAA,EAAG;EACzB,MAAM,GAAIC,QAAQ,CAAE,GAAGR,QAAQ,CAAE,CAAC,CAAE,CAAC;EACrC,MAAMS,UAAU,GAAGV,MAAM,CAAE,IAAK,CAAC;EAEjCE,SAAS,CAAE,MAAM;IAChBQ,UAAU,CAACC,OAAO,GAAG,IAAI;IACzB,OAAO,MAAM;MACZD,UAAU,CAACC,OAAO,GAAG,KAAK;IAC3B,CAAC;EACF,CAAC,EAAE,EAAG,CAAC;EAEP,OAAO,MAAM;IACZ,IAAKD,UAAU,CAACC,OAAO,EAAG;MACzBF,QAAQ,CAAE,CAAC,CAAE,CAAC;IACf;EACD,CAAC;AACF;AAEA,eAAe,SAASG,IAAIA,CAAEC,KAAyB,EAAG;EAAA,IAAAC,eAAA;EACzD,MAAM;IAAEC,IAAI;IAAEC;EAAS,CAAC,GAAGH,KAAK;EAChC,MAAM;IAAEI,YAAY;IAAEC,cAAc;IAAE,GAAGC;EAAK,CAAC,GAAGf,OAAO,CAAEW,IAAK,CAAC;EACjE,MAAMK,QAAQ,GAAGZ,cAAc,CAAC,CAAC;EACjC,MAAMa,GAAG,GAAGrB,MAAM,CAAE;IAAEoB;EAAS,CAAE,CAAC;EAElClB,SAAS,CAAE,MAAM;IAChB;IACA;IACA;IACAe,YAAY,CAAEI,GAAI,CAAC;IACnB,OAAO,MAAM;MACZH,cAAc,CAAEG,GAAI,CAAC;IACtB,CAAC;EACF,CAAC,EAAE,CAAEJ,YAAY,EAAEC,cAAc,CAAG,CAAC;EAErC,IAAK,CAAEC,IAAI,CAACE,GAAG,IAAI,CAAEF,IAAI,CAACE,GAAG,CAACV,OAAO,EAAG;IACvC,OAAO,IAAI;EACZ;;EAEA;EACA;EACA;EACA;EACA,MAAMW,eAAe,gBACpBf,IAAA,CAACF,aAAa;IAACkB,QAAQ,EAAGJ,IAAI,CAACE,GAAG,CAACV,OAAO,CAACa,aAAe;IAAAR,QAAA,EACvD,OAAOA,QAAQ,KAAK,UAAU,GAC7BA,QAAQ,EAAAF,eAAA,GAAEK,IAAI,CAACM,SAAS,cAAAX,eAAA,cAAAA,eAAA,GAAI,CAAC,CAAE,CAAC,GAChCE;EAAQ,CACG,CACf;EAED,OAAOb,YAAY,CAAEmB,eAAe,EAAEH,IAAI,CAACE,GAAG,CAACV,OAAQ,CAAC;AACzD","ignoreList":[]}