{"version":3,"names":["clsx","speak","useEffect","useLayoutEffect","useRef","forwardRef","renderToString","__","warning","Button","jsx","_jsx","jsxs","_jsxs","NOTICE_TIMEOUT","useSpokenMessage","message","politeness","spokenMessage","UnforwardedSnackbar","className","children","actions","onRemove","icon","explicitDismiss","onDismiss","listRef","ref","dismissMe","event","preventDefault","current","focus","onActionClick","onClick","stopPropagation","callbacksRef","timeoutHandle","setTimeout","clearTimeout","classes","length","globalThis","SCRIPT_DEBUG","snackbarContentClassnames","undefined","tabIndex","role","onKeyPress","map","label","url","index","href","variant","Snackbar"],"sources":["@wordpress/components/src/snackbar/index.tsx"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport type { ForwardedRef, KeyboardEvent, MouseEvent } from 'react';\r\nimport clsx from 'clsx';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { speak } from '@wordpress/a11y';\r\nimport {\r\n\tuseEffect,\r\n\tuseLayoutEffect,\r\n\tuseRef,\r\n\tforwardRef,\r\n\trenderToString,\r\n} from '@wordpress/element';\r\nimport { __ } from '@wordpress/i18n';\r\nimport warning from '@wordpress/warning';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport Button from '../button';\r\nimport type { SnackbarProps } from './types';\r\nimport type { NoticeAction } from '../notice/types';\r\nimport type { WordPressComponentProps } from '../context';\r\n\r\nconst NOTICE_TIMEOUT = 10000;\r\n\r\n/**\r\n * Custom hook which announces the message with the given politeness, if a\r\n * valid message is provided.\r\n *\r\n * @param message    Message to announce.\r\n * @param politeness Politeness to announce.\r\n */\r\nfunction useSpokenMessage(\r\n\tmessage: SnackbarProps[ 'spokenMessage' ],\r\n\tpoliteness: NonNullable< SnackbarProps[ 'politeness' ] >\r\n) {\r\n\tconst spokenMessage =\r\n\t\ttypeof message === 'string' ? message : renderToString( message );\r\n\r\n\tuseEffect( () => {\r\n\t\tif ( spokenMessage ) {\r\n\t\t\tspeak( spokenMessage, politeness );\r\n\t\t}\r\n\t}, [ spokenMessage, politeness ] );\r\n}\r\n\r\nfunction UnforwardedSnackbar(\r\n\t{\r\n\t\tclassName,\r\n\t\tchildren,\r\n\t\tspokenMessage = children,\r\n\t\tpoliteness = 'polite',\r\n\t\tactions = [],\r\n\t\tonRemove,\r\n\t\ticon = null,\r\n\t\texplicitDismiss = false,\r\n\t\t// onDismiss is a callback executed when the snackbar is dismissed.\r\n\t\t// It is distinct from onRemove, which _looks_ like a callback but is\r\n\t\t// actually the function to call to remove the snackbar from the UI.\r\n\t\tonDismiss,\r\n\t\tlistRef,\r\n\t}: WordPressComponentProps< SnackbarProps, 'div' >,\r\n\tref: ForwardedRef< any >\r\n) {\r\n\tfunction dismissMe( event: KeyboardEvent | MouseEvent ) {\r\n\t\tif ( event && event.preventDefault ) {\r\n\t\t\tevent.preventDefault();\r\n\t\t}\r\n\r\n\t\t// Prevent focus loss by moving it to the list element.\r\n\t\tlistRef?.current?.focus();\r\n\r\n\t\tonDismiss?.();\r\n\t\tonRemove?.();\r\n\t}\r\n\r\n\tfunction onActionClick(\r\n\t\tevent: MouseEvent< HTMLButtonElement >,\r\n\t\tonClick: NoticeAction[ 'onClick' ]\r\n\t) {\r\n\t\tevent.stopPropagation();\r\n\r\n\t\tonRemove?.();\r\n\r\n\t\tif ( onClick ) {\r\n\t\t\tonClick( event );\r\n\t\t}\r\n\t}\r\n\r\n\tuseSpokenMessage( spokenMessage, politeness );\r\n\r\n\t// The `onDismiss/onRemove` can have unstable references,\r\n\t// trigger side-effect cleanup, and reset timers.\r\n\tconst callbacksRef = useRef( { onDismiss, onRemove } );\r\n\tuseLayoutEffect( () => {\r\n\t\tcallbacksRef.current = { onDismiss, onRemove };\r\n\t} );\r\n\r\n\tuseEffect( () => {\r\n\t\t// Only set up the timeout dismiss if we're not explicitly dismissing.\r\n\t\tconst timeoutHandle = setTimeout( () => {\r\n\t\t\tif ( ! explicitDismiss ) {\r\n\t\t\t\tcallbacksRef.current.onDismiss?.();\r\n\t\t\t\tcallbacksRef.current.onRemove?.();\r\n\t\t\t}\r\n\t\t}, NOTICE_TIMEOUT );\r\n\r\n\t\treturn () => clearTimeout( timeoutHandle );\r\n\t}, [ explicitDismiss ] );\r\n\r\n\tconst classes = clsx( className, 'components-snackbar', {\r\n\t\t'components-snackbar-explicit-dismiss': !! explicitDismiss,\r\n\t} );\r\n\tif ( actions && actions.length > 1 ) {\r\n\t\t// We need to inform developers that snackbar only accepts 1 action.\r\n\t\twarning(\r\n\t\t\t'Snackbar can only have one action. Use Notice if your message requires many actions.'\r\n\t\t);\r\n\t\t// return first element only while keeping it inside an array\r\n\t\tactions = [ actions[ 0 ] ];\r\n\t}\r\n\r\n\tconst snackbarContentClassnames = clsx( 'components-snackbar__content', {\r\n\t\t'components-snackbar__content-with-icon': !! icon,\r\n\t} );\r\n\r\n\treturn (\r\n\t\t<div\r\n\t\t\tref={ ref }\r\n\t\t\tclassName={ classes }\r\n\t\t\tonClick={ ! explicitDismiss ? dismissMe : undefined }\r\n\t\t\ttabIndex={ 0 }\r\n\t\t\trole={ ! explicitDismiss ? 'button' : undefined }\r\n\t\t\tonKeyPress={ ! explicitDismiss ? dismissMe : undefined }\r\n\t\t\taria-label={\r\n\t\t\t\t! explicitDismiss ? __( 'Dismiss this notice' ) : undefined\r\n\t\t\t}\r\n\t\t\tdata-testid=\"snackbar\"\r\n\t\t>\r\n\t\t\t<div className={ snackbarContentClassnames }>\r\n\t\t\t\t{ icon && (\r\n\t\t\t\t\t<div className=\"components-snackbar__icon\">{ icon }</div>\r\n\t\t\t\t) }\r\n\t\t\t\t{ children }\r\n\t\t\t\t{ actions.map( ( { label, onClick, url }, index ) => {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tkey={ index }\r\n\t\t\t\t\t\t\thref={ url }\r\n\t\t\t\t\t\t\tvariant=\"tertiary\"\r\n\t\t\t\t\t\t\tonClick={ (\r\n\t\t\t\t\t\t\t\tevent: MouseEvent< HTMLButtonElement >\r\n\t\t\t\t\t\t\t) => onActionClick( event, onClick ) }\r\n\t\t\t\t\t\t\tclassName=\"components-snackbar__action\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{ label }\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t);\r\n\t\t\t\t} ) }\r\n\t\t\t\t{ explicitDismiss && (\r\n\t\t\t\t\t<span\r\n\t\t\t\t\t\trole=\"button\"\r\n\t\t\t\t\t\taria-label={ __( 'Dismiss this notice' ) }\r\n\t\t\t\t\t\ttabIndex={ 0 }\r\n\t\t\t\t\t\tclassName=\"components-snackbar__dismiss-button\"\r\n\t\t\t\t\t\tonClick={ dismissMe }\r\n\t\t\t\t\t\tonKeyPress={ dismissMe }\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t&#x2715;\r\n\t\t\t\t\t</span>\r\n\t\t\t\t) }\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\n/**\r\n * A Snackbar displays a succinct message that is cleared out after a small delay.\r\n *\r\n * It can also offer the user options, like viewing a published post.\r\n * But these options should also be available elsewhere in the UI.\r\n *\r\n * ```jsx\r\n * const MySnackbarNotice = () => (\r\n *   <Snackbar>Post published successfully.</Snackbar>\r\n * );\r\n * ```\r\n */\r\nexport const Snackbar = forwardRef( UnforwardedSnackbar );\r\n\r\nexport default Snackbar;\r\n"],"mappings":"AAAA;AACA;AACA;;AAEA,OAAOA,IAAI,MAAM,MAAM;;AAEvB;AACA;AACA;AACA,SAASC,KAAK,QAAQ,iBAAiB;AACvC,SACCC,SAAS,EACTC,eAAe,EACfC,MAAM,EACNC,UAAU,EACVC,cAAc,QACR,oBAAoB;AAC3B,SAASC,EAAE,QAAQ,iBAAiB;AACpC,OAAOC,OAAO,MAAM,oBAAoB;;AAExC;AACA;AACA;AACA,OAAOC,MAAM,MAAM,WAAW;AAAC,SAAAC,GAAA,IAAAC,IAAA;AAAA,SAAAC,IAAA,IAAAC,KAAA;AAK/B,MAAMC,cAAc,GAAG,KAAK;;AAE5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASC,gBAAgBA,CACxBC,OAAyC,EACzCC,UAAwD,EACvD;EACD,MAAMC,aAAa,GAClB,OAAOF,OAAO,KAAK,QAAQ,GAAGA,OAAO,GAAGV,cAAc,CAAEU,OAAQ,CAAC;EAElEd,SAAS,CAAE,MAAM;IAChB,IAAKgB,aAAa,EAAG;MACpBjB,KAAK,CAAEiB,aAAa,EAAED,UAAW,CAAC;IACnC;EACD,CAAC,EAAE,CAAEC,aAAa,EAAED,UAAU,CAAG,CAAC;AACnC;AAEA,SAASE,mBAAmBA,CAC3B;EACCC,SAAS;EACTC,QAAQ;EACRH,aAAa,GAAGG,QAAQ;EACxBJ,UAAU,GAAG,QAAQ;EACrBK,OAAO,GAAG,EAAE;EACZC,QAAQ;EACRC,IAAI,GAAG,IAAI;EACXC,eAAe,GAAG,KAAK;EACvB;EACA;EACA;EACAC,SAAS;EACTC;AACgD,CAAC,EAClDC,GAAwB,EACvB;EACD,SAASC,SAASA,CAAEC,KAAiC,EAAG;IACvD,IAAKA,KAAK,IAAIA,KAAK,CAACC,cAAc,EAAG;MACpCD,KAAK,CAACC,cAAc,CAAC,CAAC;IACvB;;IAEA;IACAJ,OAAO,EAAEK,OAAO,EAAEC,KAAK,CAAC,CAAC;IAEzBP,SAAS,GAAG,CAAC;IACbH,QAAQ,GAAG,CAAC;EACb;EAEA,SAASW,aAAaA,CACrBJ,KAAsC,EACtCK,OAAkC,EACjC;IACDL,KAAK,CAACM,eAAe,CAAC,CAAC;IAEvBb,QAAQ,GAAG,CAAC;IAEZ,IAAKY,OAAO,EAAG;MACdA,OAAO,CAAEL,KAAM,CAAC;IACjB;EACD;EAEAf,gBAAgB,CAAEG,aAAa,EAAED,UAAW,CAAC;;EAE7C;EACA;EACA,MAAMoB,YAAY,GAAGjC,MAAM,CAAE;IAAEsB,SAAS;IAAEH;EAAS,CAAE,CAAC;EACtDpB,eAAe,CAAE,MAAM;IACtBkC,YAAY,CAACL,OAAO,GAAG;MAAEN,SAAS;MAAEH;IAAS,CAAC;EAC/C,CAAE,CAAC;EAEHrB,SAAS,CAAE,MAAM;IAChB;IACA,MAAMoC,aAAa,GAAGC,UAAU,CAAE,MAAM;MACvC,IAAK,CAAEd,eAAe,EAAG;QACxBY,YAAY,CAACL,OAAO,CAACN,SAAS,GAAG,CAAC;QAClCW,YAAY,CAACL,OAAO,CAACT,QAAQ,GAAG,CAAC;MAClC;IACD,CAAC,EAAET,cAAe,CAAC;IAEnB,OAAO,MAAM0B,YAAY,CAAEF,aAAc,CAAC;EAC3C,CAAC,EAAE,CAAEb,eAAe,CAAG,CAAC;EAExB,MAAMgB,OAAO,GAAGzC,IAAI,CAAEoB,SAAS,EAAE,qBAAqB,EAAE;IACvD,sCAAsC,EAAE,CAAC,CAAEK;EAC5C,CAAE,CAAC;EACH,IAAKH,OAAO,IAAIA,OAAO,CAACoB,MAAM,GAAG,CAAC,EAAG;IACpC;IACAC,UAAA,CAAAC,YAAA,YAAApC,OAAO,CACN,sFACD,CAAC;IACD;IACAc,OAAO,GAAG,CAAEA,OAAO,CAAE,CAAC,CAAE,CAAE;EAC3B;EAEA,MAAMuB,yBAAyB,GAAG7C,IAAI,CAAE,8BAA8B,EAAE;IACvE,wCAAwC,EAAE,CAAC,CAAEwB;EAC9C,CAAE,CAAC;EAEH,oBACCb,IAAA;IACCiB,GAAG,EAAGA,GAAK;IACXR,SAAS,EAAGqB,OAAS;IACrBN,OAAO,EAAG,CAAEV,eAAe,GAAGI,SAAS,GAAGiB,SAAW;IACrDC,QAAQ,EAAG,CAAG;IACdC,IAAI,EAAG,CAAEvB,eAAe,GAAG,QAAQ,GAAGqB,SAAW;IACjDG,UAAU,EAAG,CAAExB,eAAe,GAAGI,SAAS,GAAGiB,SAAW;IACxD,cACC,CAAErB,eAAe,GAAGlB,EAAE,CAAE,qBAAsB,CAAC,GAAGuC,SAClD;IACD,eAAY,UAAU;IAAAzB,QAAA,eAEtBR,KAAA;MAAKO,SAAS,EAAGyB,yBAA2B;MAAAxB,QAAA,GACzCG,IAAI,iBACLb,IAAA;QAAKS,SAAS,EAAC,2BAA2B;QAAAC,QAAA,EAAGG;MAAI,CAAO,CACxD,EACCH,QAAQ,EACRC,OAAO,CAAC4B,GAAG,CAAE,CAAE;QAAEC,KAAK;QAAEhB,OAAO;QAAEiB;MAAI,CAAC,EAAEC,KAAK,KAAM;QACpD,oBACC1C,IAAA,CAACF,MAAM;UAEN6C,IAAI,EAAGF,GAAK;UACZG,OAAO,EAAC,UAAU;UAClBpB,OAAO,EACNL,KAAsC,IAClCI,aAAa,CAAEJ,KAAK,EAAEK,OAAQ,CAAG;UACtCf,SAAS,EAAC,6BAA6B;UAAAC,QAAA,EAErC8B;QAAK,GARDE,KASC,CAAC;MAEX,CAAE,CAAC,EACD5B,eAAe,iBAChBd,IAAA;QACCqC,IAAI,EAAC,QAAQ;QACb,cAAazC,EAAE,CAAE,qBAAsB,CAAG;QAC1CwC,QAAQ,EAAG,CAAG;QACd3B,SAAS,EAAC,qCAAqC;QAC/Ce,OAAO,EAAGN,SAAW;QACrBoB,UAAU,EAAGpB,SAAW;QAAAR,QAAA,EACxB;MAED,CAAM,CACN;IAAA,CACG;EAAC,CACF,CAAC;AAER;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,MAAMmC,QAAQ,GAAGnD,UAAU,CAAEc,mBAAoB,CAAC;AAEzD,eAAeqC,QAAQ","ignoreList":[]}