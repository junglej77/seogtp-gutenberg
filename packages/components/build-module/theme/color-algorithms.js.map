{"version":3,"names":["colord","extend","a11yPlugin","namesPlugin","warning","COLORS","generateThemeVariables","inputs","validateInputs","generatedColors","generateAccentDependentColors","accent","generateBackgroundDependentColors","background","warnContrastIssues","checkContrasts","colors","key","value","Object","entries","isValid","globalThis","SCRIPT_DEBUG","outputs","white","foreground","gray","isReadable","undefined","grays","contrast","issues","error","values","accentDarker10","darken","toHex","accentDarker20","accentInverted","getForegroundForColor","foregroundInverted","generateShades","color","isDark","SHADES","limit","direction","range","Math","abs","toHsl","l","result","forEach","parseInt"],"sources":["@wordpress/components/src/theme/color-algorithms.ts"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport { colord, extend } from 'colord';\r\nimport a11yPlugin from 'colord/plugins/a11y';\r\nimport namesPlugin from 'colord/plugins/names';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport warning from '@wordpress/warning';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport type { ThemeInputValues, ThemeOutputValues } from './types';\r\nimport { COLORS } from '../utils';\r\n\r\nextend( [ namesPlugin, a11yPlugin ] );\r\n\r\nexport function generateThemeVariables(\r\n\tinputs: ThemeInputValues\r\n): ThemeOutputValues {\r\n\tvalidateInputs( inputs );\r\n\r\n\tconst generatedColors = {\r\n\t\t...generateAccentDependentColors( inputs.accent ),\r\n\t\t...generateBackgroundDependentColors( inputs.background ),\r\n\t};\r\n\r\n\twarnContrastIssues( checkContrasts( inputs, generatedColors ) );\r\n\r\n\treturn { colors: generatedColors };\r\n}\r\n\r\nfunction validateInputs( inputs: ThemeInputValues ) {\r\n\tfor ( const [ key, value ] of Object.entries( inputs ) ) {\r\n\t\tif ( typeof value !== 'undefined' && ! colord( value ).isValid() ) {\r\n\t\t\twarning(\r\n\t\t\t\t`wp.components.Theme: \"${ value }\" is not a valid color value for the '${ key }' prop.`\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport function checkContrasts(\r\n\tinputs: ThemeInputValues,\r\n\toutputs: ThemeOutputValues[ 'colors' ]\r\n) {\r\n\tconst background = inputs.background || COLORS.white;\r\n\tconst accent = inputs.accent || '#3858e9';\r\n\tconst foreground = outputs.foreground || COLORS.gray[ 900 ];\r\n\tconst gray = outputs.gray || COLORS.gray;\r\n\r\n\treturn {\r\n\t\taccent: colord( background ).isReadable( accent )\r\n\t\t\t? undefined\r\n\t\t\t: `The background color (\"${ background }\") does not have sufficient contrast against the accent color (\"${ accent }\").`,\r\n\t\tforeground: colord( background ).isReadable( foreground )\r\n\t\t\t? undefined\r\n\t\t\t: `The background color provided (\"${ background }\") does not have sufficient contrast against the standard foreground colors.`,\r\n\t\tgrays:\r\n\t\t\tcolord( background ).contrast( gray[ 600 ] ) >= 3 &&\r\n\t\t\tcolord( background ).contrast( gray[ 700 ] ) >= 4.5\r\n\t\t\t\t? undefined\r\n\t\t\t\t: `The background color provided (\"${ background }\") cannot generate a set of grayscale foreground colors with sufficient contrast. Try adjusting the color to be lighter or darker.`,\r\n\t};\r\n}\r\n\r\nfunction warnContrastIssues( issues: ReturnType< typeof checkContrasts > ) {\r\n\tfor ( const error of Object.values( issues ) ) {\r\n\t\tif ( error ) {\r\n\t\t\twarning( 'wp.components.Theme: ' + error );\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction generateAccentDependentColors( accent?: string ) {\r\n\tif ( ! accent ) {\r\n\t\treturn {};\r\n\t}\r\n\r\n\treturn {\r\n\t\taccent,\r\n\t\taccentDarker10: colord( accent ).darken( 0.1 ).toHex(),\r\n\t\taccentDarker20: colord( accent ).darken( 0.2 ).toHex(),\r\n\t\taccentInverted: getForegroundForColor( accent ),\r\n\t};\r\n}\r\n\r\nfunction generateBackgroundDependentColors( background?: string ) {\r\n\tif ( ! background ) {\r\n\t\treturn {};\r\n\t}\r\n\r\n\tconst foreground = getForegroundForColor( background );\r\n\r\n\treturn {\r\n\t\tbackground,\r\n\t\tforeground,\r\n\t\tforegroundInverted: getForegroundForColor( foreground ),\r\n\t\tgray: generateShades( background, foreground ),\r\n\t};\r\n}\r\n\r\nfunction getForegroundForColor( color: string ) {\r\n\treturn colord( color ).isDark() ? COLORS.white : COLORS.gray[ 900 ];\r\n}\r\n\r\nexport function generateShades( background: string, foreground: string ) {\r\n\t// How much darkness you need to add to #fff to get the COLORS.gray[n] color\r\n\tconst SHADES = {\r\n\t\t100: 0.06,\r\n\t\t200: 0.121,\r\n\t\t300: 0.132,\r\n\t\t400: 0.2,\r\n\t\t600: 0.42,\r\n\t\t700: 0.543,\r\n\t\t800: 0.821,\r\n\t};\r\n\r\n\t// Darkness of COLORS.gray[ 900 ], relative to #fff\r\n\tconst limit = 0.884;\r\n\r\n\tconst direction = colord( background ).isDark() ? 'lighten' : 'darken';\r\n\r\n\t// Lightness delta between the background and foreground colors\r\n\tconst range =\r\n\t\tMath.abs(\r\n\t\t\tcolord( background ).toHsl().l - colord( foreground ).toHsl().l\r\n\t\t) / 100;\r\n\r\n\tconst result: Record< number, string > = {};\r\n\r\n\tObject.entries( SHADES ).forEach( ( [ key, value ] ) => {\r\n\t\tresult[ parseInt( key ) ] = colord( background )\r\n\t\t\t[ direction ]( ( value / limit ) * range )\r\n\t\t\t.toHex();\r\n\t} );\r\n\r\n\treturn result as NonNullable< ThemeOutputValues[ 'colors' ][ 'gray' ] >;\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,MAAM,EAAEC,MAAM,QAAQ,QAAQ;AACvC,OAAOC,UAAU,MAAM,qBAAqB;AAC5C,OAAOC,WAAW,MAAM,sBAAsB;;AAE9C;AACA;AACA;AACA,OAAOC,OAAO,MAAM,oBAAoB;;AAExC;AACA;AACA;;AAEA,SAASC,MAAM,QAAQ,UAAU;AAEjCJ,MAAM,CAAE,CAAEE,WAAW,EAAED,UAAU,CAAG,CAAC;AAErC,OAAO,SAASI,sBAAsBA,CACrCC,MAAwB,EACJ;EACpBC,cAAc,CAAED,MAAO,CAAC;EAExB,MAAME,eAAe,GAAG;IACvB,GAAGC,6BAA6B,CAAEH,MAAM,CAACI,MAAO,CAAC;IACjD,GAAGC,iCAAiC,CAAEL,MAAM,CAACM,UAAW;EACzD,CAAC;EAEDC,kBAAkB,CAAEC,cAAc,CAAER,MAAM,EAAEE,eAAgB,CAAE,CAAC;EAE/D,OAAO;IAAEO,MAAM,EAAEP;EAAgB,CAAC;AACnC;AAEA,SAASD,cAAcA,CAAED,MAAwB,EAAG;EACnD,KAAM,MAAM,CAAEU,GAAG,EAAEC,KAAK,CAAE,IAAIC,MAAM,CAACC,OAAO,CAAEb,MAAO,CAAC,EAAG;IACxD,IAAK,OAAOW,KAAK,KAAK,WAAW,IAAI,CAAElB,MAAM,CAAEkB,KAAM,CAAC,CAACG,OAAO,CAAC,CAAC,EAAG;MAClEC,UAAA,CAAAC,YAAA,YAAAnB,OAAO,CACL,yBAAyBc,KAAO,yCAAyCD,GAAK,SAChF,CAAC;IACF;EACD;AACD;AAEA,OAAO,SAASF,cAAcA,CAC7BR,MAAwB,EACxBiB,OAAsC,EACrC;EACD,MAAMX,UAAU,GAAGN,MAAM,CAACM,UAAU,IAAIR,MAAM,CAACoB,KAAK;EACpD,MAAMd,MAAM,GAAGJ,MAAM,CAACI,MAAM,IAAI,SAAS;EACzC,MAAMe,UAAU,GAAGF,OAAO,CAACE,UAAU,IAAIrB,MAAM,CAACsB,IAAI,CAAE,GAAG,CAAE;EAC3D,MAAMA,IAAI,GAAGH,OAAO,CAACG,IAAI,IAAItB,MAAM,CAACsB,IAAI;EAExC,OAAO;IACNhB,MAAM,EAAEX,MAAM,CAAEa,UAAW,CAAC,CAACe,UAAU,CAAEjB,MAAO,CAAC,GAC9CkB,SAAS,GACR,0BAA0BhB,UAAY,mEAAmEF,MAAQ,KAAI;IACzHe,UAAU,EAAE1B,MAAM,CAAEa,UAAW,CAAC,CAACe,UAAU,CAAEF,UAAW,CAAC,GACtDG,SAAS,GACR,mCAAmChB,UAAY,8EAA6E;IAChIiB,KAAK,EACJ9B,MAAM,CAAEa,UAAW,CAAC,CAACkB,QAAQ,CAAEJ,IAAI,CAAE,GAAG,CAAG,CAAC,IAAI,CAAC,IACjD3B,MAAM,CAAEa,UAAW,CAAC,CAACkB,QAAQ,CAAEJ,IAAI,CAAE,GAAG,CAAG,CAAC,IAAI,GAAG,GAChDE,SAAS,GACR,mCAAmChB,UAAY;EACrD,CAAC;AACF;AAEA,SAASC,kBAAkBA,CAAEkB,MAA2C,EAAG;EAC1E,KAAM,MAAMC,KAAK,IAAId,MAAM,CAACe,MAAM,CAAEF,MAAO,CAAC,EAAG;IAC9C,IAAKC,KAAK,EAAG;MACZX,UAAA,CAAAC,YAAA,YAAAnB,OAAO,CAAE,uBAAuB,GAAG6B,KAAM,CAAC;IAC3C;EACD;AACD;AAEA,SAASvB,6BAA6BA,CAAEC,MAAe,EAAG;EACzD,IAAK,CAAEA,MAAM,EAAG;IACf,OAAO,CAAC,CAAC;EACV;EAEA,OAAO;IACNA,MAAM;IACNwB,cAAc,EAAEnC,MAAM,CAAEW,MAAO,CAAC,CAACyB,MAAM,CAAE,GAAI,CAAC,CAACC,KAAK,CAAC,CAAC;IACtDC,cAAc,EAAEtC,MAAM,CAAEW,MAAO,CAAC,CAACyB,MAAM,CAAE,GAAI,CAAC,CAACC,KAAK,CAAC,CAAC;IACtDE,cAAc,EAAEC,qBAAqB,CAAE7B,MAAO;EAC/C,CAAC;AACF;AAEA,SAASC,iCAAiCA,CAAEC,UAAmB,EAAG;EACjE,IAAK,CAAEA,UAAU,EAAG;IACnB,OAAO,CAAC,CAAC;EACV;EAEA,MAAMa,UAAU,GAAGc,qBAAqB,CAAE3B,UAAW,CAAC;EAEtD,OAAO;IACNA,UAAU;IACVa,UAAU;IACVe,kBAAkB,EAAED,qBAAqB,CAAEd,UAAW,CAAC;IACvDC,IAAI,EAAEe,cAAc,CAAE7B,UAAU,EAAEa,UAAW;EAC9C,CAAC;AACF;AAEA,SAASc,qBAAqBA,CAAEG,KAAa,EAAG;EAC/C,OAAO3C,MAAM,CAAE2C,KAAM,CAAC,CAACC,MAAM,CAAC,CAAC,GAAGvC,MAAM,CAACoB,KAAK,GAAGpB,MAAM,CAACsB,IAAI,CAAE,GAAG,CAAE;AACpE;AAEA,OAAO,SAASe,cAAcA,CAAE7B,UAAkB,EAAEa,UAAkB,EAAG;EACxE;EACA,MAAMmB,MAAM,GAAG;IACd,GAAG,EAAE,IAAI;IACT,GAAG,EAAE,KAAK;IACV,GAAG,EAAE,KAAK;IACV,GAAG,EAAE,GAAG;IACR,GAAG,EAAE,IAAI;IACT,GAAG,EAAE,KAAK;IACV,GAAG,EAAE;EACN,CAAC;;EAED;EACA,MAAMC,KAAK,GAAG,KAAK;EAEnB,MAAMC,SAAS,GAAG/C,MAAM,CAAEa,UAAW,CAAC,CAAC+B,MAAM,CAAC,CAAC,GAAG,SAAS,GAAG,QAAQ;;EAEtE;EACA,MAAMI,KAAK,GACVC,IAAI,CAACC,GAAG,CACPlD,MAAM,CAAEa,UAAW,CAAC,CAACsC,KAAK,CAAC,CAAC,CAACC,CAAC,GAAGpD,MAAM,CAAE0B,UAAW,CAAC,CAACyB,KAAK,CAAC,CAAC,CAACC,CAC/D,CAAC,GAAG,GAAG;EAER,MAAMC,MAAgC,GAAG,CAAC,CAAC;EAE3ClC,MAAM,CAACC,OAAO,CAAEyB,MAAO,CAAC,CAACS,OAAO,CAAE,CAAE,CAAErC,GAAG,EAAEC,KAAK,CAAE,KAAM;IACvDmC,MAAM,CAAEE,QAAQ,CAAEtC,GAAI,CAAC,CAAE,GAAGjB,MAAM,CAAEa,UAAW,CAAC,CAC7CkC,SAAS,CAAE,CAAI7B,KAAK,GAAG4B,KAAK,GAAKE,KAAM,CAAC,CACzCX,KAAK,CAAC,CAAC;EACV,CAAE,CAAC;EAEH,OAAOgB,MAAM;AACd","ignoreList":[]}