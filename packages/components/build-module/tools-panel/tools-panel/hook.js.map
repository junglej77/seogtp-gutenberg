{"version":3,"names":["useCallback","useEffect","useMemo","useRef","useState","styles","useContextSystem","useCx","DEFAULT_COLUMNS","generateMenuItems","panelItems","shouldReset","currentMenuItems","menuItemOrder","newMenuItems","default","optional","menuItems","forEach","hasValue","isShownByDefault","label","group","existingItemValue","value","key","hasOwnProperty","Object","keys","isMenuItemTypeEmpty","obj","length","useToolsPanel","props","className","headingLevel","resetAll","panelId","hasInnerWrapper","shouldRenderPlaceholderItems","__experimentalFirstVisibleItemClass","__experimentalLastVisibleItemClass","otherProps","isResettingRef","wasResetting","current","setPanelItems","setMenuItemOrder","resetAllFilters","setResetAllFilters","registerPanelItem","item","items","newItems","existingIndex","findIndex","oldItem","splice","includes","deregisterPanelItem","index","registerResetAllFilter","newFilter","filters","deregisterResetAllFilter","filterToRemove","filter","setMenuItems","prevState","flagItemCustomization","newState","areAllOptionalControlsHidden","setAreAllOptionalControlsHidden","allControlsHidden","entries","some","isSelected","cx","classes","wrapperStyle","ToolsPanelWithInnerWrapper","emptyStyle","ToolsPanelHiddenInnerWrapper","ToolsPanel","toggleItem","currentItem","find","menuGroup","resetAllItems","resetMenuItems","getFirstVisibleItemLabel","optionalItems","firstItem","firstDisplayedItem","lastDisplayedItem","reverse","panelContext","hasMenuItems","isResetting"],"sources":["@wordpress/components/src/tools-panel/tools-panel/hook.ts"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport {\r\n\tuseCallback,\r\n\tuseEffect,\r\n\tuseMemo,\r\n\tuseRef,\r\n\tuseState,\r\n} from '@wordpress/element';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport * as styles from '../styles';\r\nimport type { WordPressComponentProps } from '../../context';\r\nimport { useContextSystem } from '../../context';\r\nimport { useCx } from '../../utils/hooks/use-cx';\r\nimport type {\r\n\tToolsPanelItem,\r\n\tToolsPanelMenuItemKey,\r\n\tToolsPanelMenuItems,\r\n\tToolsPanelMenuItemsConfig,\r\n\tToolsPanelProps,\r\n\tResetAllFilter,\r\n} from '../types';\r\n\r\nconst DEFAULT_COLUMNS = 2;\r\n\r\nconst generateMenuItems = ( {\r\n\tpanelItems,\r\n\tshouldReset,\r\n\tcurrentMenuItems,\r\n\tmenuItemOrder,\r\n}: ToolsPanelMenuItemsConfig ) => {\r\n\tconst newMenuItems: ToolsPanelMenuItems = { default: {}, optional: {} };\r\n\tconst menuItems: ToolsPanelMenuItems = { default: {}, optional: {} };\r\n\r\n\tpanelItems.forEach( ( { hasValue, isShownByDefault, label } ) => {\r\n\t\tconst group = isShownByDefault ? 'default' : 'optional';\r\n\r\n\t\t// If a menu item for this label has already been flagged as customized\r\n\t\t// (for default controls), or toggled on (for optional controls), do not\r\n\t\t// overwrite its value as those controls would lose that state.\r\n\t\tconst existingItemValue = currentMenuItems?.[ group ]?.[ label ];\r\n\t\tconst value = existingItemValue ? existingItemValue : hasValue();\r\n\r\n\t\tnewMenuItems[ group ][ label ] = shouldReset ? false : value;\r\n\t} );\r\n\r\n\t// Loop the known, previously registered items first to maintain menu order.\r\n\tmenuItemOrder.forEach( ( key ) => {\r\n\t\tif ( newMenuItems.default.hasOwnProperty( key ) ) {\r\n\t\t\tmenuItems.default[ key ] = newMenuItems.default[ key ];\r\n\t\t}\r\n\r\n\t\tif ( newMenuItems.optional.hasOwnProperty( key ) ) {\r\n\t\t\tmenuItems.optional[ key ] = newMenuItems.optional[ key ];\r\n\t\t}\r\n\t} );\r\n\r\n\t// Loop newMenuItems object adding any that aren't in the known items order.\r\n\tObject.keys( newMenuItems.default ).forEach( ( key ) => {\r\n\t\tif ( ! menuItems.default.hasOwnProperty( key ) ) {\r\n\t\t\tmenuItems.default[ key ] = newMenuItems.default[ key ];\r\n\t\t}\r\n\t} );\r\n\r\n\tObject.keys( newMenuItems.optional ).forEach( ( key ) => {\r\n\t\tif ( ! menuItems.optional.hasOwnProperty( key ) ) {\r\n\t\t\tmenuItems.optional[ key ] = newMenuItems.optional[ key ];\r\n\t\t}\r\n\t} );\r\n\r\n\treturn menuItems;\r\n};\r\n\r\nconst isMenuItemTypeEmpty = (\r\n\tobj?: ToolsPanelMenuItems[ ToolsPanelMenuItemKey ]\r\n) => obj && Object.keys( obj ).length === 0;\r\n\r\nexport function useToolsPanel(\r\n\tprops: WordPressComponentProps< ToolsPanelProps, 'div' >\r\n) {\r\n\tconst {\r\n\t\tclassName,\r\n\t\theadingLevel = 2,\r\n\t\tresetAll,\r\n\t\tpanelId,\r\n\t\thasInnerWrapper = false,\r\n\t\tshouldRenderPlaceholderItems = false,\r\n\t\t__experimentalFirstVisibleItemClass,\r\n\t\t__experimentalLastVisibleItemClass,\r\n\t\t...otherProps\r\n\t} = useContextSystem( props, 'ToolsPanel' );\r\n\r\n\tconst isResettingRef = useRef( false );\r\n\tconst wasResetting = isResettingRef.current;\r\n\r\n\t// `isResettingRef` is cleared via this hook to effectively batch together\r\n\t// the resetAll task. Without this, the flag is cleared after the first\r\n\t// control updates and forces a rerender with subsequent controls then\r\n\t// believing they need to reset, unfortunately using stale data.\r\n\tuseEffect( () => {\r\n\t\tif ( wasResetting ) {\r\n\t\t\tisResettingRef.current = false;\r\n\t\t}\r\n\t}, [ wasResetting ] );\r\n\r\n\t// Allow panel items to register themselves.\r\n\tconst [ panelItems, setPanelItems ] = useState< ToolsPanelItem[] >( [] );\r\n\tconst [ menuItemOrder, setMenuItemOrder ] = useState< string[] >( [] );\r\n\tconst [ resetAllFilters, setResetAllFilters ] = useState<\r\n\t\tResetAllFilter[]\r\n\t>( [] );\r\n\r\n\tconst registerPanelItem = useCallback(\r\n\t\t( item: ToolsPanelItem ) => {\r\n\t\t\t// Add item to panel items.\r\n\t\t\tsetPanelItems( ( items ) => {\r\n\t\t\t\tconst newItems = [ ...items ];\r\n\t\t\t\t// If an item with this label has already been registered, remove it\r\n\t\t\t\t// first. This can happen when an item is moved between the default\r\n\t\t\t\t// and optional groups.\r\n\t\t\t\tconst existingIndex = newItems.findIndex(\r\n\t\t\t\t\t( oldItem ) => oldItem.label === item.label\r\n\t\t\t\t);\r\n\t\t\t\tif ( existingIndex !== -1 ) {\r\n\t\t\t\t\tnewItems.splice( existingIndex, 1 );\r\n\t\t\t\t}\r\n\t\t\t\treturn [ ...newItems, item ];\r\n\t\t\t} );\r\n\r\n\t\t\t// Track the initial order of item registration. This is used for\r\n\t\t\t// maintaining menu item order later.\r\n\t\t\tsetMenuItemOrder( ( items ) => {\r\n\t\t\t\tif ( items.includes( item.label ) ) {\r\n\t\t\t\t\treturn items;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn [ ...items, item.label ];\r\n\t\t\t} );\r\n\t\t},\r\n\t\t[ setPanelItems, setMenuItemOrder ]\r\n\t);\r\n\r\n\t// Panels need to deregister on unmount to avoid orphans in menu state.\r\n\t// This is an issue when panel items are being injected via SlotFills.\r\n\tconst deregisterPanelItem = useCallback(\r\n\t\t( label: string ) => {\r\n\t\t\t// When switching selections between components injecting matching\r\n\t\t\t// controls, e.g. both panels have a \"padding\" control, the\r\n\t\t\t// deregistration of the first panel doesn't occur until after the\r\n\t\t\t// registration of the next.\r\n\t\t\tsetPanelItems( ( items ) => {\r\n\t\t\t\tconst newItems = [ ...items ];\r\n\t\t\t\tconst index = newItems.findIndex(\r\n\t\t\t\t\t( item ) => item.label === label\r\n\t\t\t\t);\r\n\t\t\t\tif ( index !== -1 ) {\r\n\t\t\t\t\tnewItems.splice( index, 1 );\r\n\t\t\t\t}\r\n\t\t\t\treturn newItems;\r\n\t\t\t} );\r\n\t\t},\r\n\t\t[ setPanelItems ]\r\n\t);\r\n\r\n\tconst registerResetAllFilter = useCallback(\r\n\t\t( newFilter: ResetAllFilter ) => {\r\n\t\t\tsetResetAllFilters( ( filters ) => {\r\n\t\t\t\treturn [ ...filters, newFilter ];\r\n\t\t\t} );\r\n\t\t},\r\n\t\t[ setResetAllFilters ]\r\n\t);\r\n\r\n\tconst deregisterResetAllFilter = useCallback(\r\n\t\t( filterToRemove: ResetAllFilter ) => {\r\n\t\t\tsetResetAllFilters( ( filters ) => {\r\n\t\t\t\treturn filters.filter(\r\n\t\t\t\t\t( filter ) => filter !== filterToRemove\r\n\t\t\t\t);\r\n\t\t\t} );\r\n\t\t},\r\n\t\t[ setResetAllFilters ]\r\n\t);\r\n\r\n\t// Manage and share display state of menu items representing child controls.\r\n\tconst [ menuItems, setMenuItems ] = useState< ToolsPanelMenuItems >( {\r\n\t\tdefault: {},\r\n\t\toptional: {},\r\n\t} );\r\n\r\n\t// Setup menuItems state as panel items register themselves.\r\n\tuseEffect( () => {\r\n\t\tsetMenuItems( ( prevState ) => {\r\n\t\t\tconst items = generateMenuItems( {\r\n\t\t\t\tpanelItems,\r\n\t\t\t\tshouldReset: false,\r\n\t\t\t\tcurrentMenuItems: prevState,\r\n\t\t\t\tmenuItemOrder,\r\n\t\t\t} );\r\n\t\t\treturn items;\r\n\t\t} );\r\n\t}, [ panelItems, setMenuItems, menuItemOrder ] );\r\n\r\n\t// Updates the status of the panelâ€™s menu items. For default items the\r\n\t// value represents whether it differs from the default and for optional\r\n\t// items whether the item is shown.\r\n\tconst flagItemCustomization = useCallback(\r\n\t\t(\r\n\t\t\tvalue: boolean,\r\n\t\t\tlabel: string,\r\n\t\t\tgroup: ToolsPanelMenuItemKey = 'default'\r\n\t\t) => {\r\n\t\t\tsetMenuItems( ( items ) => {\r\n\t\t\t\tconst newState = {\r\n\t\t\t\t\t...items,\r\n\t\t\t\t\t[ group ]: {\r\n\t\t\t\t\t\t...items[ group ],\r\n\t\t\t\t\t\t[ label ]: value,\r\n\t\t\t\t\t},\r\n\t\t\t\t};\r\n\t\t\t\treturn newState;\r\n\t\t\t} );\r\n\t\t},\r\n\t\t[ setMenuItems ]\r\n\t);\r\n\r\n\t// Whether all optional menu items are hidden or not must be tracked\r\n\t// in order to later determine if the panel display is empty and handle\r\n\t// conditional display of a plus icon to indicate the presence of further\r\n\t// menu items.\r\n\tconst [ areAllOptionalControlsHidden, setAreAllOptionalControlsHidden ] =\r\n\t\tuseState( false );\r\n\r\n\tuseEffect( () => {\r\n\t\tif (\r\n\t\t\tisMenuItemTypeEmpty( menuItems?.default ) &&\r\n\t\t\t! isMenuItemTypeEmpty( menuItems?.optional )\r\n\t\t) {\r\n\t\t\tconst allControlsHidden = ! Object.entries(\r\n\t\t\t\tmenuItems.optional\r\n\t\t\t).some( ( [ , isSelected ] ) => isSelected );\r\n\t\t\tsetAreAllOptionalControlsHidden( allControlsHidden );\r\n\t\t}\r\n\t}, [ menuItems, setAreAllOptionalControlsHidden ] );\r\n\r\n\tconst cx = useCx();\r\n\tconst classes = useMemo( () => {\r\n\t\tconst wrapperStyle =\r\n\t\t\thasInnerWrapper &&\r\n\t\t\tstyles.ToolsPanelWithInnerWrapper( DEFAULT_COLUMNS );\r\n\t\tconst emptyStyle =\r\n\t\t\tisMenuItemTypeEmpty( menuItems?.default ) &&\r\n\t\t\tareAllOptionalControlsHidden &&\r\n\t\t\tstyles.ToolsPanelHiddenInnerWrapper;\r\n\r\n\t\treturn cx(\r\n\t\t\tstyles.ToolsPanel( DEFAULT_COLUMNS ),\r\n\t\t\twrapperStyle,\r\n\t\t\temptyStyle,\r\n\t\t\tclassName\r\n\t\t);\r\n\t}, [\r\n\t\tareAllOptionalControlsHidden,\r\n\t\tclassName,\r\n\t\tcx,\r\n\t\thasInnerWrapper,\r\n\t\tmenuItems,\r\n\t] );\r\n\r\n\t// Toggle the checked state of a menu item which is then used to determine\r\n\t// display of the item within the panel.\r\n\tconst toggleItem = useCallback(\r\n\t\t( label: string ) => {\r\n\t\t\tconst currentItem = panelItems.find(\r\n\t\t\t\t( item ) => item.label === label\r\n\t\t\t);\r\n\r\n\t\t\tif ( ! currentItem ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst menuGroup = currentItem.isShownByDefault\r\n\t\t\t\t? 'default'\r\n\t\t\t\t: 'optional';\r\n\r\n\t\t\tconst newMenuItems = {\r\n\t\t\t\t...menuItems,\r\n\t\t\t\t[ menuGroup ]: {\r\n\t\t\t\t\t...menuItems[ menuGroup ],\r\n\t\t\t\t\t[ label ]: ! menuItems[ menuGroup ][ label ],\r\n\t\t\t\t},\r\n\t\t\t};\r\n\r\n\t\t\tsetMenuItems( newMenuItems );\r\n\t\t},\r\n\t\t[ menuItems, panelItems, setMenuItems ]\r\n\t);\r\n\r\n\t// Resets display of children and executes resetAll callback if available.\r\n\tconst resetAllItems = useCallback( () => {\r\n\t\tif ( typeof resetAll === 'function' ) {\r\n\t\t\tisResettingRef.current = true;\r\n\t\t\tresetAll( resetAllFilters );\r\n\t\t}\r\n\r\n\t\t// Turn off display of all non-default items.\r\n\t\tconst resetMenuItems = generateMenuItems( {\r\n\t\t\tpanelItems,\r\n\t\t\tmenuItemOrder,\r\n\t\t\tshouldReset: true,\r\n\t\t} );\r\n\t\tsetMenuItems( resetMenuItems );\r\n\t}, [ panelItems, resetAllFilters, resetAll, setMenuItems, menuItemOrder ] );\r\n\r\n\t// Assist ItemGroup styling when there are potentially hidden placeholder\r\n\t// items by identifying first & last items that are toggled on for display.\r\n\tconst getFirstVisibleItemLabel = ( items: ToolsPanelItem[] ) => {\r\n\t\tconst optionalItems = menuItems.optional || {};\r\n\t\tconst firstItem = items.find(\r\n\t\t\t( item ) => item.isShownByDefault || !! optionalItems[ item.label ]\r\n\t\t);\r\n\r\n\t\treturn firstItem?.label;\r\n\t};\r\n\r\n\tconst firstDisplayedItem = getFirstVisibleItemLabel( panelItems );\r\n\tconst lastDisplayedItem = getFirstVisibleItemLabel(\r\n\t\t[ ...panelItems ].reverse()\r\n\t);\r\n\r\n\tconst panelContext = useMemo(\r\n\t\t() => ( {\r\n\t\t\tareAllOptionalControlsHidden,\r\n\t\t\tderegisterPanelItem,\r\n\t\t\tderegisterResetAllFilter,\r\n\t\t\tfirstDisplayedItem,\r\n\t\t\tflagItemCustomization,\r\n\t\t\thasMenuItems: !! panelItems.length,\r\n\t\t\tisResetting: isResettingRef.current,\r\n\t\t\tlastDisplayedItem,\r\n\t\t\tmenuItems,\r\n\t\t\tpanelId,\r\n\t\t\tregisterPanelItem,\r\n\t\t\tregisterResetAllFilter,\r\n\t\t\tshouldRenderPlaceholderItems,\r\n\t\t\t__experimentalFirstVisibleItemClass,\r\n\t\t\t__experimentalLastVisibleItemClass,\r\n\t\t} ),\r\n\t\t[\r\n\t\t\tareAllOptionalControlsHidden,\r\n\t\t\tderegisterPanelItem,\r\n\t\t\tderegisterResetAllFilter,\r\n\t\t\tfirstDisplayedItem,\r\n\t\t\tflagItemCustomization,\r\n\t\t\tlastDisplayedItem,\r\n\t\t\tmenuItems,\r\n\t\t\tpanelId,\r\n\t\t\tpanelItems,\r\n\t\t\tregisterResetAllFilter,\r\n\t\t\tregisterPanelItem,\r\n\t\t\tshouldRenderPlaceholderItems,\r\n\t\t\t__experimentalFirstVisibleItemClass,\r\n\t\t\t__experimentalLastVisibleItemClass,\r\n\t\t]\r\n\t);\r\n\r\n\treturn {\r\n\t\t...otherProps,\r\n\t\theadingLevel,\r\n\t\tpanelContext,\r\n\t\tresetAllItems,\r\n\t\ttoggleItem,\r\n\t\tclassName: classes,\r\n\t};\r\n}\r\n"],"mappings":"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","ignoreList":[]}