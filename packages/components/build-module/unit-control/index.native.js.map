{"version":3,"names":["Text","View","TouchableWithoutFeedback","Platform","findNodeHandle","RangeCell","StepperCell","Picker","styles","CSS_UNITS","hasUnits","getAccessibleLabelForUnit","useRef","useCallback","useMemo","memo","withPreferredColorScheme","__","sprintf","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","UnitControl","currentInput","label","value","onChange","onUnitChange","initialPosition","min","max","separatorType","units","unit","getStylesFromColorScheme","props","pickerRef","anchorNodeRef","onPickerPresent","current","presentPicker","currentInputValue","initialControlValue","isFinite","unitButtonTextStyle","unitButtonText","unitButtonTextDark","accessibilityLabel","accessibilityHint","OS","renderUnitButton","unitButton","style","children","length","onPress","accessibilityRole","getAnchor","undefined","getDecimal","step","stepToString","splitStep","toString","split","renderUnitPicker","unitMenu","ref","options","hideCancelButton","leftAlign","_activeUnit$step","activeUnit","find","option","decimalNum","defaultValue","shouldDisplayTextInput","openUnitPicker","unitLabel","minimumValue","maximumValue","useCustomUnits"],"sources":["@wordpress/components/src/unit-control/index.native.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport {\r\n\tText,\r\n\tView,\r\n\tTouchableWithoutFeedback,\r\n\tPlatform,\r\n\tfindNodeHandle,\r\n} from 'react-native';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport RangeCell from '../mobile/bottom-sheet/range-cell';\r\nimport StepperCell from '../mobile/bottom-sheet/stepper-cell';\r\nimport Picker from '../mobile/picker';\r\nimport styles from './style.scss';\r\nimport { CSS_UNITS, hasUnits, getAccessibleLabelForUnit } from './utils';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { useRef, useCallback, useMemo, memo } from '@wordpress/element';\r\nimport { withPreferredColorScheme } from '@wordpress/compose';\r\nimport { __, sprintf } from '@wordpress/i18n';\r\n\r\nfunction UnitControl( {\r\n\tcurrentInput,\r\n\tlabel,\r\n\tvalue,\r\n\tonChange,\r\n\tonUnitChange,\r\n\tinitialPosition,\r\n\tmin,\r\n\tmax,\r\n\tseparatorType,\r\n\tunits = CSS_UNITS,\r\n\tunit,\r\n\tgetStylesFromColorScheme,\r\n\t...props\r\n} ) {\r\n\tconst pickerRef = useRef();\r\n\tconst anchorNodeRef = useRef();\r\n\r\n\tconst onPickerPresent = useCallback( () => {\r\n\t\tif ( pickerRef?.current ) {\r\n\t\t\tpickerRef.current.presentPicker();\r\n\t\t}\r\n\t\t// Disable reason: this should be fixed by the native team.\r\n\t\t// It would be great if this could be done in the context of\r\n\t\t// https://github.com/WordPress/gutenberg/pull/39218\r\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, [ pickerRef?.current ] );\r\n\r\n\tconst currentInputValue = currentInput === null ? value : currentInput;\r\n\tconst initialControlValue = isFinite( currentInputValue )\r\n\t\t? currentInputValue\r\n\t\t: initialPosition;\r\n\r\n\tconst unitButtonTextStyle = getStylesFromColorScheme(\r\n\t\tstyles.unitButtonText,\r\n\t\tstyles.unitButtonTextDark\r\n\t);\r\n\r\n\t/* translators: accessibility text. Inform about current unit value. %s: Current unit value. */\r\n\tconst accessibilityLabel = sprintf( __( 'Current unit is %s' ), unit );\r\n\r\n\tconst accessibilityHint =\r\n\t\tPlatform.OS === 'ios'\r\n\t\t\t? __( 'Double tap to open Action Sheet with available options' )\r\n\t\t\t: __( 'Double tap to open Bottom Sheet with available options' );\r\n\r\n\tconst renderUnitButton = useMemo( () => {\r\n\t\tconst unitButton = (\r\n\t\t\t<View style={ styles.unitButton }>\r\n\t\t\t\t<Text style={ unitButtonTextStyle }>{ unit }</Text>\r\n\t\t\t</View>\r\n\t\t);\r\n\r\n\t\tif ( hasUnits( units ) && units?.length > 1 ) {\r\n\t\t\treturn (\r\n\t\t\t\t<TouchableWithoutFeedback\r\n\t\t\t\t\tonPress={ onPickerPresent }\r\n\t\t\t\t\taccessibilityLabel={ accessibilityLabel }\r\n\t\t\t\t\taccessibilityRole=\"button\"\r\n\t\t\t\t\taccessibilityHint={ accessibilityHint }\r\n\t\t\t\t>\r\n\t\t\t\t\t{ unitButton }\r\n\t\t\t\t</TouchableWithoutFeedback>\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn unitButton;\r\n\t}, [\r\n\t\tonPickerPresent,\r\n\t\taccessibilityLabel,\r\n\t\taccessibilityHint,\r\n\t\tunitButtonTextStyle,\r\n\t\tunit,\r\n\t\tunits,\r\n\t] );\r\n\r\n\tconst getAnchor = useCallback(\r\n\t\t() =>\r\n\t\t\tanchorNodeRef?.current\r\n\t\t\t\t? findNodeHandle( anchorNodeRef?.current )\r\n\t\t\t\t: undefined,\r\n\t\t// Disable reason: this should be fixed by the native team.\r\n\t\t// It would be great if this could be done in the context of\r\n\t\t// https://github.com/WordPress/gutenberg/pull/39218\r\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t\t[ anchorNodeRef?.current ]\r\n\t);\r\n\r\n\tconst getDecimal = ( step ) => {\r\n\t\t// Return the decimal offset based on the step size.\r\n\t\t// if step size is 0.1 we expect the offset to be 1.\r\n\t\t// for example 12 + 0.1 we would expect the see 12.1 (not 12.10 or 12 );\r\n\t\t// steps are defined in the CSS_UNITS and they vary from unit to unit.\r\n\t\tconst stepToString = step;\r\n\t\tconst splitStep = stepToString.toString().split( '.' );\r\n\t\treturn splitStep[ 1 ] ? splitStep[ 1 ].length : 0;\r\n\t};\r\n\r\n\tconst renderUnitPicker = useCallback( () => {\r\n\t\t// Keeping for legacy reasons, although `false` should not be a valid\r\n\t\t// value for the `units` prop anymore.\r\n\t\tif ( units === false ) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<View style={ styles.unitMenu } ref={ anchorNodeRef }>\r\n\t\t\t\t{ renderUnitButton }\r\n\t\t\t\t{ hasUnits( units ) && units?.length > 1 ? (\r\n\t\t\t\t\t<Picker\r\n\t\t\t\t\t\tref={ pickerRef }\r\n\t\t\t\t\t\toptions={ units }\r\n\t\t\t\t\t\tonChange={ onUnitChange }\r\n\t\t\t\t\t\thideCancelButton\r\n\t\t\t\t\t\tleftAlign\r\n\t\t\t\t\t\tgetAnchor={ getAnchor }\r\n\t\t\t\t\t/>\r\n\t\t\t\t) : null }\r\n\t\t\t</View>\r\n\t\t);\r\n\t}, [ pickerRef, units, onUnitChange, getAnchor, renderUnitButton ] );\r\n\r\n\tlet step = props.step;\r\n\r\n\t/*\r\n\t * If no step prop has been passed, lookup the active unit and\r\n\t * try to get step from `units`, or default to a value of `1`\r\n\t */\r\n\tif ( ! step && units ) {\r\n\t\tconst activeUnit = units.find( ( option ) => option.value === unit );\r\n\t\tstep = activeUnit?.step ?? 1;\r\n\t}\r\n\r\n\tconst decimalNum = getDecimal( step );\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{ unit !== '%' ? (\r\n\t\t\t\t<StepperCell\r\n\t\t\t\t\tlabel={ label }\r\n\t\t\t\t\tmax={ max }\r\n\t\t\t\t\tmin={ min }\r\n\t\t\t\t\tonChange={ onChange }\r\n\t\t\t\t\tseparatorType={ separatorType }\r\n\t\t\t\t\tvalue={ value }\r\n\t\t\t\t\tstep={ step }\r\n\t\t\t\t\tdefaultValue={ initialControlValue }\r\n\t\t\t\t\tshouldDisplayTextInput\r\n\t\t\t\t\tdecimalNum={ decimalNum }\r\n\t\t\t\t\topenUnitPicker={ onPickerPresent }\r\n\t\t\t\t\tunitLabel={ getAccessibleLabelForUnit( unit ) }\r\n\t\t\t\t\t{ ...props }\r\n\t\t\t\t>\r\n\t\t\t\t\t{ renderUnitPicker() }\r\n\t\t\t\t</StepperCell>\r\n\t\t\t) : (\r\n\t\t\t\t<RangeCell\r\n\t\t\t\t\tlabel={ label }\r\n\t\t\t\t\tonChange={ onChange }\r\n\t\t\t\t\tminimumValue={ min }\r\n\t\t\t\t\tmaximumValue={ max }\r\n\t\t\t\t\tvalue={ value }\r\n\t\t\t\t\tstep={ step }\r\n\t\t\t\t\tunit={ unit }\r\n\t\t\t\t\tdefaultValue={ initialControlValue }\r\n\t\t\t\t\tseparatorType={ separatorType }\r\n\t\t\t\t\tdecimalNum={ decimalNum }\r\n\t\t\t\t\topenUnitPicker={ onPickerPresent }\r\n\t\t\t\t\tunitLabel={ getAccessibleLabelForUnit( unit ) }\r\n\t\t\t\t\t{ ...props }\r\n\t\t\t\t>\r\n\t\t\t\t\t{ renderUnitPicker() }\r\n\t\t\t\t</RangeCell>\r\n\t\t\t) }\r\n\t\t</>\r\n\t);\r\n}\r\n\r\nexport { useCustomUnits } from './utils';\r\nexport default memo( withPreferredColorScheme( UnitControl ) );\r\n"],"mappings":"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","ignoreList":[]}