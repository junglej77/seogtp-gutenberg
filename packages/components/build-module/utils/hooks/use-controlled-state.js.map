{"version":3,"names":["useEffect","useState","useCallback","isValueDefined","getDefinedValue","defaultOptions","initial","undefined","fallback","useControlledState","currentState","options","internalState","setInternalState","hasCurrentState","state","setState","nextState"],"sources":["@wordpress/components/src/utils/hooks/use-controlled-state.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useEffect, useState, useCallback } from '@wordpress/element';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { isValueDefined, getDefinedValue } from '../values';\r\n\r\n/**\r\n * @template T\r\n * @typedef Options\r\n * @property {T}      [initial] Initial value\r\n * @property {T | \"\"} fallback  Fallback value\r\n */\r\n\r\n/** @type {Readonly<{ initial: undefined, fallback: '' }>} */\r\nconst defaultOptions = {\r\n\tinitial: undefined,\r\n\t/**\r\n\t * Defaults to empty string, as that is preferred for usage with\r\n\t * <input />, <textarea />, and <select /> form elements.\r\n\t */\r\n\tfallback: '',\r\n};\r\n\r\n/**\r\n * Custom hooks for \"controlled\" components to track and consolidate internal\r\n * state and incoming values. This is useful for components that render\r\n * `input`, `textarea`, or `select` HTML elements.\r\n *\r\n * https://reactjs.org/docs/forms.html#controlled-components\r\n *\r\n * At first, a component using useControlledState receives an initial prop\r\n * value, which is used as initial internal state.\r\n *\r\n * This internal state can be maintained and updated without\r\n * relying on new incoming prop values.\r\n *\r\n * Unlike the basic useState hook, useControlledState's state can\r\n * be updated if a new incoming prop value is changed.\r\n *\r\n * @template T\r\n *\r\n * @param {T | undefined} currentState             The current value.\r\n * @param {Options<T>}    [options=defaultOptions] Additional options for the hook.\r\n *\r\n * @return {[T | \"\", (nextState: T) => void]} The controlled value and the value setter.\r\n */\r\nfunction useControlledState( currentState, options = defaultOptions ) {\r\n\tconst { initial, fallback } = { ...defaultOptions, ...options };\r\n\r\n\tconst [ internalState, setInternalState ] = useState( currentState );\r\n\tconst hasCurrentState = isValueDefined( currentState );\r\n\r\n\t/*\r\n\t * Resets internal state if value every changes from uncontrolled <-> controlled.\r\n\t */\r\n\tuseEffect( () => {\r\n\t\tif ( hasCurrentState && internalState ) {\r\n\t\t\tsetInternalState( undefined );\r\n\t\t}\r\n\t}, [ hasCurrentState, internalState ] );\r\n\r\n\tconst state = getDefinedValue(\r\n\t\t[ currentState, internalState, initial ],\r\n\t\tfallback\r\n\t);\r\n\r\n\t/* eslint-disable jsdoc/no-undefined-types */\r\n\t/** @type {(nextState: T) => void} */\r\n\tconst setState = useCallback(\r\n\t\t( nextState ) => {\r\n\t\t\tif ( ! hasCurrentState ) {\r\n\t\t\t\tsetInternalState( nextState );\r\n\t\t\t}\r\n\t\t},\r\n\t\t[ hasCurrentState ]\r\n\t);\r\n\t/* eslint-enable jsdoc/no-undefined-types */\r\n\r\n\treturn [ state, setState ];\r\n}\r\n\r\nexport default useControlledState;\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,SAAS,EAAEC,QAAQ,EAAEC,WAAW,QAAQ,oBAAoB;;AAErE;AACA;AACA;AACA,SAASC,cAAc,EAAEC,eAAe,QAAQ,WAAW;;AAE3D;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAMC,cAAc,GAAG;EACtBC,OAAO,EAAEC,SAAS;EAClB;AACD;AACA;AACA;EACCC,QAAQ,EAAE;AACX,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASC,kBAAkBA,CAAEC,YAAY,EAAEC,OAAO,GAAGN,cAAc,EAAG;EACrE,MAAM;IAAEC,OAAO;IAAEE;EAAS,CAAC,GAAG;IAAE,GAAGH,cAAc;IAAE,GAAGM;EAAQ,CAAC;EAE/D,MAAM,CAAEC,aAAa,EAAEC,gBAAgB,CAAE,GAAGZ,QAAQ,CAAES,YAAa,CAAC;EACpE,MAAMI,eAAe,GAAGX,cAAc,CAAEO,YAAa,CAAC;;EAEtD;AACD;AACA;EACCV,SAAS,CAAE,MAAM;IAChB,IAAKc,eAAe,IAAIF,aAAa,EAAG;MACvCC,gBAAgB,CAAEN,SAAU,CAAC;IAC9B;EACD,CAAC,EAAE,CAAEO,eAAe,EAAEF,aAAa,CAAG,CAAC;EAEvC,MAAMG,KAAK,GAAGX,eAAe,CAC5B,CAAEM,YAAY,EAAEE,aAAa,EAAEN,OAAO,CAAE,EACxCE,QACD,CAAC;;EAED;EACA;EACA,MAAMQ,QAAQ,GAAGd,WAAW,CACzBe,SAAS,IAAM;IAChB,IAAK,CAAEH,eAAe,EAAG;MACxBD,gBAAgB,CAAEI,SAAU,CAAC;IAC9B;EACD,CAAC,EACD,CAAEH,eAAe,CAClB,CAAC;EACD;;EAEA,OAAO,CAAEC,KAAK,EAAEC,QAAQ,CAAE;AAC3B;AAEA,eAAeP,kBAAkB","ignoreList":[]}