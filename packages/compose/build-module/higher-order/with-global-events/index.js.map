{"version":3,"names":["Component","forwardRef","deprecated","createHigherOrderComponent","Listener","jsx","_jsx","listener","withGlobalEvents","eventTypesToHandlers","since","alternative","WrappedComponent","Wrapper","constructor","props","handleEvent","bind","handleRef","componentDidMount","Object","keys","forEach","eventType","add","componentWillUnmount","remove","event","handler","type","wrappedRef","el","forwardedRef","render","ownProps","ref"],"sources":["@wordpress/compose/src/higher-order/with-global-events/index.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { Component, forwardRef } from '@wordpress/element';\r\nimport deprecated from '@wordpress/deprecated';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { createHigherOrderComponent } from '../../utils/create-higher-order-component';\r\nimport Listener from './listener';\r\n\r\n/**\r\n * Listener instance responsible for managing document event handling.\r\n */\r\nconst listener = new Listener();\r\n\r\n/* eslint-disable jsdoc/no-undefined-types */\r\n/**\r\n * Higher-order component creator which, given an object of DOM event types and\r\n * values corresponding to a callback function name on the component, will\r\n * create or update a window event handler to invoke the callback when an event\r\n * occurs. On behalf of the consuming developer, the higher-order component\r\n * manages unbinding when the component unmounts, and binding at most a single\r\n * event handler for the entire application.\r\n *\r\n * @deprecated\r\n *\r\n * @param {Record<keyof GlobalEventHandlersEventMap, string>} eventTypesToHandlers Object with keys of DOM\r\n *                                                                                 event type, the value a\r\n *                                                                                 name of the function on\r\n *                                                                                 the original component's\r\n *                                                                                 instance which handles\r\n *                                                                                 the event.\r\n *\r\n * @return {any} Higher-order component.\r\n */\r\nexport default function withGlobalEvents( eventTypesToHandlers ) {\r\n\tdeprecated( 'wp.compose.withGlobalEvents', {\r\n\t\tsince: '5.7',\r\n\t\talternative: 'useEffect',\r\n\t} );\r\n\r\n\t// @ts-ignore We don't need to fix the type-related issues because this is deprecated.\r\n\treturn createHigherOrderComponent( ( WrappedComponent ) => {\r\n\t\tclass Wrapper extends Component {\r\n\t\t\tconstructor( /** @type {any} */ props ) {\r\n\t\t\t\tsuper( props );\r\n\r\n\t\t\t\tthis.handleEvent = this.handleEvent.bind( this );\r\n\t\t\t\tthis.handleRef = this.handleRef.bind( this );\r\n\t\t\t}\r\n\r\n\t\t\tcomponentDidMount() {\r\n\t\t\t\tObject.keys( eventTypesToHandlers ).forEach( ( eventType ) => {\r\n\t\t\t\t\tlistener.add( eventType, this );\r\n\t\t\t\t} );\r\n\t\t\t}\r\n\r\n\t\t\tcomponentWillUnmount() {\r\n\t\t\t\tObject.keys( eventTypesToHandlers ).forEach( ( eventType ) => {\r\n\t\t\t\t\tlistener.remove( eventType, this );\r\n\t\t\t\t} );\r\n\t\t\t}\r\n\r\n\t\t\thandleEvent( /** @type {any} */ event ) {\r\n\t\t\t\tconst handler =\r\n\t\t\t\t\teventTypesToHandlers[\r\n\t\t\t\t\t\t/** @type {keyof GlobalEventHandlersEventMap} */ (\r\n\t\t\t\t\t\t\tevent.type\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t/* eslint-enable jsdoc/no-undefined-types */\r\n\t\t\t\t\t];\r\n\t\t\t\tif ( typeof this.wrappedRef[ handler ] === 'function' ) {\r\n\t\t\t\t\tthis.wrappedRef[ handler ]( event );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\thandleRef( /** @type {any} */ el ) {\r\n\t\t\t\tthis.wrappedRef = el;\r\n\t\t\t\t// Any component using `withGlobalEvents` that is not setting a `ref`\r\n\t\t\t\t// will cause `this.props.forwardedRef` to be `null`, so we need this\r\n\t\t\t\t// check.\r\n\t\t\t\tif ( this.props.forwardedRef ) {\r\n\t\t\t\t\tthis.props.forwardedRef( el );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\trender() {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<WrappedComponent\r\n\t\t\t\t\t\t{ ...this.props.ownProps }\r\n\t\t\t\t\t\tref={ this.handleRef }\r\n\t\t\t\t\t/>\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn forwardRef( ( props, ref ) => {\r\n\t\t\treturn <Wrapper ownProps={ props } forwardedRef={ ref } />;\r\n\t\t} );\r\n\t}, 'withGlobalEvents' );\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,SAAS,EAAEC,UAAU,QAAQ,oBAAoB;AAC1D,OAAOC,UAAU,MAAM,uBAAuB;;AAE9C;AACA;AACA;AACA,SAASC,0BAA0B,QAAQ,2CAA2C;AACtF,OAAOC,QAAQ,MAAM,YAAY;;AAEjC;AACA;AACA;AAFA,SAAAC,GAAA,IAAAC,IAAA;AAGA,MAAMC,QAAQ,GAAG,IAAIH,QAAQ,CAAC,CAAC;;AAE/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAASI,gBAAgBA,CAAEC,oBAAoB,EAAG;EAChEP,UAAU,CAAE,6BAA6B,EAAE;IAC1CQ,KAAK,EAAE,KAAK;IACZC,WAAW,EAAE;EACd,CAAE,CAAC;;EAEH;EACA,OAAOR,0BAA0B,CAAIS,gBAAgB,IAAM;IAC1D,MAAMC,OAAO,SAASb,SAAS,CAAC;MAC/Bc,WAAWA,CAAA,CAAE,kBAAmBC,KAAK,EAAG;QACvC,KAAK,CAAEA,KAAM,CAAC;QAEd,IAAI,CAACC,WAAW,GAAG,IAAI,CAACA,WAAW,CAACC,IAAI,CAAE,IAAK,CAAC;QAChD,IAAI,CAACC,SAAS,GAAG,IAAI,CAACA,SAAS,CAACD,IAAI,CAAE,IAAK,CAAC;MAC7C;MAEAE,iBAAiBA,CAAA,EAAG;QACnBC,MAAM,CAACC,IAAI,CAAEZ,oBAAqB,CAAC,CAACa,OAAO,CAAIC,SAAS,IAAM;UAC7DhB,QAAQ,CAACiB,GAAG,CAAED,SAAS,EAAE,IAAK,CAAC;QAChC,CAAE,CAAC;MACJ;MAEAE,oBAAoBA,CAAA,EAAG;QACtBL,MAAM,CAACC,IAAI,CAAEZ,oBAAqB,CAAC,CAACa,OAAO,CAAIC,SAAS,IAAM;UAC7DhB,QAAQ,CAACmB,MAAM,CAAEH,SAAS,EAAE,IAAK,CAAC;QACnC,CAAE,CAAC;MACJ;MAEAP,WAAWA,CAAA,CAAE,kBAAmBW,KAAK,EAAG;QACvC,MAAMC,OAAO,GACZnB,oBAAoB,GACnB;QACCkB,KAAK,CAACE;;QAEP,8CACA;QACF,IAAK,OAAO,IAAI,CAACC,UAAU,CAAEF,OAAO,CAAE,KAAK,UAAU,EAAG;UACvD,IAAI,CAACE,UAAU,CAAEF,OAAO,CAAE,CAAED,KAAM,CAAC;QACpC;MACD;MAEAT,SAASA,CAAA,CAAE,kBAAmBa,EAAE,EAAG;QAClC,IAAI,CAACD,UAAU,GAAGC,EAAE;QACpB;QACA;QACA;QACA,IAAK,IAAI,CAAChB,KAAK,CAACiB,YAAY,EAAG;UAC9B,IAAI,CAACjB,KAAK,CAACiB,YAAY,CAAED,EAAG,CAAC;QAC9B;MACD;MAEAE,MAAMA,CAAA,EAAG;QACR,oBACC3B,IAAA,CAACM,gBAAgB;UAAA,GACX,IAAI,CAACG,KAAK,CAACmB,QAAQ;UACxBC,GAAG,EAAG,IAAI,CAACjB;QAAW,CACtB,CAAC;MAEJ;IACD;IAEA,OAAOjB,UAAU,CAAE,CAAEc,KAAK,EAAEoB,GAAG,KAAM;MACpC,oBAAO7B,IAAA,CAACO,OAAO;QAACqB,QAAQ,EAAGnB,KAAO;QAACiB,YAAY,EAAGG;MAAK,CAAE,CAAC;IAC3D,CAAE,CAAC;EACJ,CAAC,EAAE,kBAAmB,CAAC;AACxB","ignoreList":[]}