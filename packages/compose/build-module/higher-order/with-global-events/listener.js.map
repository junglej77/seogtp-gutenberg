{"version":3,"names":["Listener","constructor","listeners","handleEvent","bind","add","eventType","instance","window","addEventListener","push","remove","filter","listener","length","removeEventListener","event","type","forEach"],"sources":["@wordpress/compose/src/higher-order/with-global-events/listener.js"],"sourcesContent":["/**\r\n * Class responsible for orchestrating event handling on the global window,\r\n * binding a single event to be shared across all handling instances, and\r\n * removing the handler when no instances are listening for the event.\r\n */\r\nclass Listener {\r\n\tconstructor() {\r\n\t\t/** @type {any} */\r\n\t\tthis.listeners = {};\r\n\r\n\t\tthis.handleEvent = this.handleEvent.bind( this );\r\n\t}\r\n\r\n\tadd( /** @type {any} */ eventType, /** @type {any} */ instance ) {\r\n\t\tif ( ! this.listeners[ eventType ] ) {\r\n\t\t\t// Adding first listener for this type, so bind event.\r\n\t\t\twindow.addEventListener( eventType, this.handleEvent );\r\n\t\t\tthis.listeners[ eventType ] = [];\r\n\t\t}\r\n\r\n\t\tthis.listeners[ eventType ].push( instance );\r\n\t}\r\n\r\n\tremove( /** @type {any} */ eventType, /** @type {any} */ instance ) {\r\n\t\tif ( ! this.listeners[ eventType ] ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.listeners[ eventType ] = this.listeners[ eventType ].filter(\r\n\t\t\t( /** @type {any} */ listener ) => listener !== instance\r\n\t\t);\r\n\r\n\t\tif ( ! this.listeners[ eventType ].length ) {\r\n\t\t\t// Removing last listener for this type, so unbind event.\r\n\t\t\twindow.removeEventListener( eventType, this.handleEvent );\r\n\t\t\tdelete this.listeners[ eventType ];\r\n\t\t}\r\n\t}\r\n\r\n\thandleEvent( /** @type {any} */ event ) {\r\n\t\tthis.listeners[ event.type ]?.forEach(\r\n\t\t\t( /** @type {any} */ instance ) => {\r\n\t\t\t\tinstance.handleEvent( event );\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default Listener;\r\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA,MAAMA,QAAQ,CAAC;EACdC,WAAWA,CAAA,EAAG;IACb;IACA,IAAI,CAACC,SAAS,GAAG,CAAC,CAAC;IAEnB,IAAI,CAACC,WAAW,GAAG,IAAI,CAACA,WAAW,CAACC,IAAI,CAAE,IAAK,CAAC;EACjD;EAEAC,GAAGA,CAAA,CAAE,kBAAmBC,SAAS,EAAE,kBAAmBC,QAAQ,EAAG;IAChE,IAAK,CAAE,IAAI,CAACL,SAAS,CAAEI,SAAS,CAAE,EAAG;MACpC;MACAE,MAAM,CAACC,gBAAgB,CAAEH,SAAS,EAAE,IAAI,CAACH,WAAY,CAAC;MACtD,IAAI,CAACD,SAAS,CAAEI,SAAS,CAAE,GAAG,EAAE;IACjC;IAEA,IAAI,CAACJ,SAAS,CAAEI,SAAS,CAAE,CAACI,IAAI,CAAEH,QAAS,CAAC;EAC7C;EAEAI,MAAMA,CAAA,CAAE,kBAAmBL,SAAS,EAAE,kBAAmBC,QAAQ,EAAG;IACnE,IAAK,CAAE,IAAI,CAACL,SAAS,CAAEI,SAAS,CAAE,EAAG;MACpC;IACD;IAEA,IAAI,CAACJ,SAAS,CAAEI,SAAS,CAAE,GAAG,IAAI,CAACJ,SAAS,CAAEI,SAAS,CAAE,CAACM,MAAM,CAC/D,EAAE,kBAAmBC,QAAQ,KAAMA,QAAQ,KAAKN,QACjD,CAAC;IAED,IAAK,CAAE,IAAI,CAACL,SAAS,CAAEI,SAAS,CAAE,CAACQ,MAAM,EAAG;MAC3C;MACAN,MAAM,CAACO,mBAAmB,CAAET,SAAS,EAAE,IAAI,CAACH,WAAY,CAAC;MACzD,OAAO,IAAI,CAACD,SAAS,CAAEI,SAAS,CAAE;IACnC;EACD;EAEAH,WAAWA,CAAA,CAAE,kBAAmBa,KAAK,EAAG;IACvC,IAAI,CAACd,SAAS,CAAEc,KAAK,CAACC,IAAI,CAAE,EAAEC,OAAO,CACpC,EAAE,kBAAmBX,QAAQ,KAAM;MAClCA,QAAQ,CAACJ,WAAW,CAAEa,KAAM,CAAC;IAC9B,CACD,CAAC;EACF;AACD;AAEA,eAAehB,QAAQ","ignoreList":[]}