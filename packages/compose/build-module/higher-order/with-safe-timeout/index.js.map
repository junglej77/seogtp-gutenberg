{"version":3,"names":["Component","createHigherOrderComponent","jsx","_jsx","withSafeTimeout","OriginalComponent","WrappedComponent","constructor","props","timeouts","setTimeout","bind","clearTimeout","componentWillUnmount","forEach","fn","delay","id","push","filter","timeoutId","render"],"sources":["@wordpress/compose/src/higher-order/with-safe-timeout/index.tsx"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { Component } from '@wordpress/element';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport type {\r\n\tWithInjectedProps,\r\n\tWithoutInjectedProps,\r\n} from '../../utils/create-higher-order-component';\r\nimport { createHigherOrderComponent } from '../../utils/create-higher-order-component';\r\n\r\n/**\r\n * We cannot use the `Window['setTimeout']` and `Window['clearTimeout']`\r\n * types here because those functions include functionality that is not handled\r\n * by this component, like the ability to pass extra arguments.\r\n *\r\n * In the case of this component, we only handle the simplest case where\r\n * `setTimeout` only accepts a function (not a string) and an optional delay.\r\n */\r\ninterface TimeoutProps {\r\n\tsetTimeout: ( fn: () => void, delay: number ) => number;\r\n\tclearTimeout: ( id: number ) => void;\r\n}\r\n\r\n/**\r\n * A higher-order component used to provide and manage delayed function calls\r\n * that ought to be bound to a component's lifecycle.\r\n */\r\nconst withSafeTimeout = createHigherOrderComponent(\r\n\t< C extends WithInjectedProps< C, TimeoutProps > >(\r\n\t\tOriginalComponent: C\r\n\t) => {\r\n\t\ttype WrappedProps = WithoutInjectedProps< C, TimeoutProps >;\r\n\t\treturn class WrappedComponent extends Component< WrappedProps > {\r\n\t\t\ttimeouts: number[];\r\n\r\n\t\t\tconstructor( props: WrappedProps ) {\r\n\t\t\t\tsuper( props );\r\n\t\t\t\tthis.timeouts = [];\r\n\t\t\t\tthis.setTimeout = this.setTimeout.bind( this );\r\n\t\t\t\tthis.clearTimeout = this.clearTimeout.bind( this );\r\n\t\t\t}\r\n\r\n\t\t\tcomponentWillUnmount() {\r\n\t\t\t\tthis.timeouts.forEach( clearTimeout );\r\n\t\t\t}\r\n\r\n\t\t\tsetTimeout( fn: () => void, delay: number ) {\r\n\t\t\t\tconst id = setTimeout( () => {\r\n\t\t\t\t\tfn();\r\n\t\t\t\t\tthis.clearTimeout( id );\r\n\t\t\t\t}, delay );\r\n\t\t\t\tthis.timeouts.push( id );\r\n\t\t\t\treturn id;\r\n\t\t\t}\r\n\r\n\t\t\tclearTimeout( id: number ) {\r\n\t\t\t\tclearTimeout( id );\r\n\t\t\t\tthis.timeouts = this.timeouts.filter(\r\n\t\t\t\t\t( timeoutId ) => timeoutId !== id\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\trender() {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t// @ts-ignore\r\n\t\t\t\t\t<OriginalComponent\r\n\t\t\t\t\t\t{ ...this.props }\r\n\t\t\t\t\t\tsetTimeout={ this.setTimeout }\r\n\t\t\t\t\t\tclearTimeout={ this.clearTimeout }\r\n\t\t\t\t\t/>\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t};\r\n\t},\r\n\t'withSafeTimeout'\r\n);\r\n\r\nexport default withSafeTimeout;\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,SAAS,QAAQ,oBAAoB;;AAE9C;AACA;AACA;;AAKA,SAASC,0BAA0B,QAAQ,2CAA2C;;AAEtF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA,SAAAC,GAAA,IAAAC,IAAA;AAaA;AACA;AACA;AACA;AACA,MAAMC,eAAe,GAAGH,0BAA0B,CAEhDI,iBAAoB,IAChB;EAEJ,OAAO,MAAMC,gBAAgB,SAASN,SAAS,CAAiB;IAG/DO,WAAWA,CAAEC,KAAmB,EAAG;MAClC,KAAK,CAAEA,KAAM,CAAC;MACd,IAAI,CAACC,QAAQ,GAAG,EAAE;MAClB,IAAI,CAACC,UAAU,GAAG,IAAI,CAACA,UAAU,CAACC,IAAI,CAAE,IAAK,CAAC;MAC9C,IAAI,CAACC,YAAY,GAAG,IAAI,CAACA,YAAY,CAACD,IAAI,CAAE,IAAK,CAAC;IACnD;IAEAE,oBAAoBA,CAAA,EAAG;MACtB,IAAI,CAACJ,QAAQ,CAACK,OAAO,CAAEF,YAAa,CAAC;IACtC;IAEAF,UAAUA,CAAEK,EAAc,EAAEC,KAAa,EAAG;MAC3C,MAAMC,EAAE,GAAGP,UAAU,CAAE,MAAM;QAC5BK,EAAE,CAAC,CAAC;QACJ,IAAI,CAACH,YAAY,CAAEK,EAAG,CAAC;MACxB,CAAC,EAAED,KAAM,CAAC;MACV,IAAI,CAACP,QAAQ,CAACS,IAAI,CAAED,EAAG,CAAC;MACxB,OAAOA,EAAE;IACV;IAEAL,YAAYA,CAAEK,EAAU,EAAG;MAC1BL,YAAY,CAAEK,EAAG,CAAC;MAClB,IAAI,CAACR,QAAQ,GAAG,IAAI,CAACA,QAAQ,CAACU,MAAM,CACjCC,SAAS,IAAMA,SAAS,KAAKH,EAChC,CAAC;IACF;IAEAI,MAAMA,CAAA,EAAG;MACR;QAAA;QACC;QACAlB,IAAA,CAACE,iBAAiB;UAAA,GACZ,IAAI,CAACG,KAAK;UACfE,UAAU,EAAG,IAAI,CAACA,UAAY;UAC9BE,YAAY,EAAG,IAAI,CAACA;QAAc,CAClC;MAAC;IAEJ;EACD,CAAC;AACF,CAAC,EACD,iBACD,CAAC;AAED,eAAeR,eAAe","ignoreList":[]}