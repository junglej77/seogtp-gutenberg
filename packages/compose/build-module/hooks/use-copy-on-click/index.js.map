{"version":3,"names":["Clipboard","useRef","useEffect","useState","deprecated","useCopyOnClick","ref","text","timeout","since","alternative","clipboardRef","hasCopied","setHasCopied","timeoutId","current","on","clearSelection","trigger","focus","clearTimeout","setTimeout","destroy"],"sources":["@wordpress/compose/src/hooks/use-copy-on-click/index.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport Clipboard from 'clipboard';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { useRef, useEffect, useState } from '@wordpress/element';\r\nimport deprecated from '@wordpress/deprecated';\r\n\r\n/* eslint-disable jsdoc/no-undefined-types */\r\n/**\r\n * Copies the text to the clipboard when the element is clicked.\r\n *\r\n * @deprecated\r\n *\r\n * @param {import('react').RefObject<string | Element | NodeListOf<Element>>} ref       Reference with the element.\r\n * @param {string|Function}                                                   text      The text to copy.\r\n * @param {number}                                                            [timeout] Optional timeout to reset the returned\r\n *                                                                                      state. 4 seconds by default.\r\n *\r\n * @return {boolean} Whether or not the text has been copied. Resets after the\r\n *                   timeout.\r\n */\r\nexport default function useCopyOnClick( ref, text, timeout = 4000 ) {\r\n\t/* eslint-enable jsdoc/no-undefined-types */\r\n\tdeprecated( 'wp.compose.useCopyOnClick', {\r\n\t\tsince: '5.8',\r\n\t\talternative: 'wp.compose.useCopyToClipboard',\r\n\t} );\r\n\r\n\t/** @type {import('react').MutableRefObject<Clipboard | undefined>} */\r\n\tconst clipboardRef = useRef();\r\n\tconst [ hasCopied, setHasCopied ] = useState( false );\r\n\r\n\tuseEffect( () => {\r\n\t\t/** @type {number | undefined} */\r\n\t\tlet timeoutId;\r\n\r\n\t\tif ( ! ref.current ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Clipboard listens to click events.\r\n\t\tclipboardRef.current = new Clipboard( ref.current, {\r\n\t\t\ttext: () => ( typeof text === 'function' ? text() : text ),\r\n\t\t} );\r\n\r\n\t\tclipboardRef.current.on( 'success', ( { clearSelection, trigger } ) => {\r\n\t\t\t// Clearing selection will move focus back to the triggering button,\r\n\t\t\t// ensuring that it is not reset to the body, and further that it is\r\n\t\t\t// kept within the rendered node.\r\n\t\t\tclearSelection();\r\n\r\n\t\t\t// Handle ClipboardJS focus bug, see https://github.com/zenorocha/clipboard.js/issues/680\r\n\t\t\tif ( trigger ) {\r\n\t\t\t\t/** @type {HTMLElement} */ ( trigger ).focus();\r\n\t\t\t}\r\n\r\n\t\t\tif ( timeout ) {\r\n\t\t\t\tsetHasCopied( true );\r\n\t\t\t\tclearTimeout( timeoutId );\r\n\t\t\t\ttimeoutId = setTimeout( () => setHasCopied( false ), timeout );\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t\treturn () => {\r\n\t\t\tif ( clipboardRef.current ) {\r\n\t\t\t\tclipboardRef.current.destroy();\r\n\t\t\t}\r\n\t\t\tclearTimeout( timeoutId );\r\n\t\t};\r\n\t}, [ text, timeout, setHasCopied ] );\r\n\r\n\treturn hasCopied;\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,OAAOA,SAAS,MAAM,WAAW;;AAEjC;AACA;AACA;AACA,SAASC,MAAM,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,oBAAoB;AAChE,OAAOC,UAAU,MAAM,uBAAuB;;AAE9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAASC,cAAcA,CAAEC,GAAG,EAAEC,IAAI,EAAEC,OAAO,GAAG,IAAI,EAAG;EACnE;EACAJ,UAAU,CAAE,2BAA2B,EAAE;IACxCK,KAAK,EAAE,KAAK;IACZC,WAAW,EAAE;EACd,CAAE,CAAC;;EAEH;EACA,MAAMC,YAAY,GAAGV,MAAM,CAAC,CAAC;EAC7B,MAAM,CAAEW,SAAS,EAAEC,YAAY,CAAE,GAAGV,QAAQ,CAAE,KAAM,CAAC;EAErDD,SAAS,CAAE,MAAM;IAChB;IACA,IAAIY,SAAS;IAEb,IAAK,CAAER,GAAG,CAACS,OAAO,EAAG;MACpB;IACD;;IAEA;IACAJ,YAAY,CAACI,OAAO,GAAG,IAAIf,SAAS,CAAEM,GAAG,CAACS,OAAO,EAAE;MAClDR,IAAI,EAAEA,CAAA,KAAQ,OAAOA,IAAI,KAAK,UAAU,GAAGA,IAAI,CAAC,CAAC,GAAGA;IACrD,CAAE,CAAC;IAEHI,YAAY,CAACI,OAAO,CAACC,EAAE,CAAE,SAAS,EAAE,CAAE;MAAEC,cAAc;MAAEC;IAAQ,CAAC,KAAM;MACtE;MACA;MACA;MACAD,cAAc,CAAC,CAAC;;MAEhB;MACA,IAAKC,OAAO,EAAG;QACd,0BAA6BA,OAAO,CAAGC,KAAK,CAAC,CAAC;MAC/C;MAEA,IAAKX,OAAO,EAAG;QACdK,YAAY,CAAE,IAAK,CAAC;QACpBO,YAAY,CAAEN,SAAU,CAAC;QACzBA,SAAS,GAAGO,UAAU,CAAE,MAAMR,YAAY,CAAE,KAAM,CAAC,EAAEL,OAAQ,CAAC;MAC/D;IACD,CAAE,CAAC;IAEH,OAAO,MAAM;MACZ,IAAKG,YAAY,CAACI,OAAO,EAAG;QAC3BJ,YAAY,CAACI,OAAO,CAACO,OAAO,CAAC,CAAC;MAC/B;MACAF,YAAY,CAAEN,SAAU,CAAC;IAC1B,CAAC;EACF,CAAC,EAAE,CAAEP,IAAI,EAAEC,OAAO,EAAEK,YAAY,CAAG,CAAC;EAEpC,OAAOD,SAAS;AACjB","ignoreList":[]}