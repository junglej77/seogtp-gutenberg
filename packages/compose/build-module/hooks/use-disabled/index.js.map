{"version":3,"names":["debounce","useRefEffect","useDisabled","isDisabled","isDisabledProp","node","defaultView","ownerDocument","updates","disable","childNodes","forEach","child","HTMLElement","getAttribute","setAttribute","push","removeAttribute","debouncedDisable","leading","observer","window","MutationObserver","observe","childList","disconnect","cancel","update"],"sources":["@wordpress/compose/src/hooks/use-disabled/index.ts"],"sourcesContent":["/**\r\n * Internal dependencies\r\n */\r\nimport { debounce } from '../../utils/debounce';\r\nimport useRefEffect from '../use-ref-effect';\r\n\r\n/**\r\n * In some circumstances, such as block previews, all focusable DOM elements\r\n * (input fields, links, buttons, etc.) need to be disabled. This hook adds the\r\n * behavior to disable nested DOM elements to the returned ref.\r\n *\r\n * If you can, prefer the use of the inert HTML attribute.\r\n *\r\n * @param {Object}   config            Configuration object.\r\n * @param {boolean=} config.isDisabled Whether the element should be disabled.\r\n * @return {import('react').RefCallback<HTMLElement>} Element Ref.\r\n *\r\n * @example\r\n * ```js\r\n * import { useDisabled } from '@wordpress/compose';\r\n *\r\n * const DisabledExample = () => {\r\n * \tconst disabledRef = useDisabled();\r\n *\treturn (\r\n *\t\t<div ref={ disabledRef }>\r\n *\t\t\t<a href=\"#\">This link will have tabindex set to -1</a>\r\n *\t\t\t<input placeholder=\"This input will have the disabled attribute added to it.\" type=\"text\" />\r\n *\t\t</div>\r\n *\t);\r\n * };\r\n * ```\r\n */\r\nexport default function useDisabled( {\r\n\tisDisabled: isDisabledProp = false,\r\n} = {} ) {\r\n\treturn useRefEffect(\r\n\t\t( node ) => {\r\n\t\t\tif ( isDisabledProp ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst defaultView = node?.ownerDocument?.defaultView;\r\n\t\t\tif ( ! defaultView ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t/** A variable keeping track of the previous updates in order to restore them. */\r\n\t\t\tconst updates: Function[] = [];\r\n\t\t\tconst disable = () => {\r\n\t\t\t\tnode.childNodes.forEach( ( child ) => {\r\n\t\t\t\t\tif ( ! ( child instanceof defaultView.HTMLElement ) ) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( ! child.getAttribute( 'inert' ) ) {\r\n\t\t\t\t\t\tchild.setAttribute( 'inert', 'true' );\r\n\t\t\t\t\t\tupdates.push( () => {\r\n\t\t\t\t\t\t\tchild.removeAttribute( 'inert' );\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t}\r\n\t\t\t\t} );\r\n\t\t\t};\r\n\r\n\t\t\t// Debounce re-disable since disabling process itself will incur\r\n\t\t\t// additional mutations which should be ignored.\r\n\t\t\tconst debouncedDisable = debounce( disable, 0, {\r\n\t\t\t\tleading: true,\r\n\t\t\t} );\r\n\t\t\tdisable();\r\n\r\n\t\t\t/** @type {MutationObserver | undefined} */\r\n\t\t\tconst observer = new window.MutationObserver( debouncedDisable );\r\n\t\t\tobserver.observe( node, {\r\n\t\t\t\tchildList: true,\r\n\t\t\t} );\r\n\r\n\t\t\treturn () => {\r\n\t\t\t\tif ( observer ) {\r\n\t\t\t\t\tobserver.disconnect();\r\n\t\t\t\t}\r\n\t\t\t\tdebouncedDisable.cancel();\r\n\t\t\t\tupdates.forEach( ( update ) => update() );\r\n\t\t\t};\r\n\t\t},\r\n\t\t[ isDisabledProp ]\r\n\t);\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,QAAQ,QAAQ,sBAAsB;AAC/C,OAAOC,YAAY,MAAM,mBAAmB;;AAE5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAASC,WAAWA,CAAE;EACpCC,UAAU,EAAEC,cAAc,GAAG;AAC9B,CAAC,GAAG,CAAC,CAAC,EAAG;EACR,OAAOH,YAAY,CAChBI,IAAI,IAAM;IACX,IAAKD,cAAc,EAAG;MACrB;IACD;IAEA,MAAME,WAAW,GAAGD,IAAI,EAAEE,aAAa,EAAED,WAAW;IACpD,IAAK,CAAEA,WAAW,EAAG;MACpB;IACD;;IAEA;IACA,MAAME,OAAmB,GAAG,EAAE;IAC9B,MAAMC,OAAO,GAAGA,CAAA,KAAM;MACrBJ,IAAI,CAACK,UAAU,CAACC,OAAO,CAAIC,KAAK,IAAM;QACrC,IAAK,EAAIA,KAAK,YAAYN,WAAW,CAACO,WAAW,CAAE,EAAG;UACrD;QACD;QACA,IAAK,CAAED,KAAK,CAACE,YAAY,CAAE,OAAQ,CAAC,EAAG;UACtCF,KAAK,CAACG,YAAY,CAAE,OAAO,EAAE,MAAO,CAAC;UACrCP,OAAO,CAACQ,IAAI,CAAE,MAAM;YACnBJ,KAAK,CAACK,eAAe,CAAE,OAAQ,CAAC;UACjC,CAAE,CAAC;QACJ;MACD,CAAE,CAAC;IACJ,CAAC;;IAED;IACA;IACA,MAAMC,gBAAgB,GAAGlB,QAAQ,CAAES,OAAO,EAAE,CAAC,EAAE;MAC9CU,OAAO,EAAE;IACV,CAAE,CAAC;IACHV,OAAO,CAAC,CAAC;;IAET;IACA,MAAMW,QAAQ,GAAG,IAAIC,MAAM,CAACC,gBAAgB,CAAEJ,gBAAiB,CAAC;IAChEE,QAAQ,CAACG,OAAO,CAAElB,IAAI,EAAE;MACvBmB,SAAS,EAAE;IACZ,CAAE,CAAC;IAEH,OAAO,MAAM;MACZ,IAAKJ,QAAQ,EAAG;QACfA,QAAQ,CAACK,UAAU,CAAC,CAAC;MACtB;MACAP,gBAAgB,CAACQ,MAAM,CAAC,CAAC;MACzBlB,OAAO,CAACG,OAAO,CAAIgB,MAAM,IAAMA,MAAM,CAAC,CAAE,CAAC;IAC1C,CAAC;EACF,CAAC,EACD,CAAEvB,cAAc,CACjB,CAAC;AACF","ignoreList":[]}