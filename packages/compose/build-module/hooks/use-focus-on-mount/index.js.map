{"version":3,"names":["useRef","useEffect","focus","useRefEffect","useFocusOnMount","focusOnMount","focusOnMountRef","setFocus","target","preventScroll","timerIdRef","current","node","_node$ownerDocument$a","contains","ownerDocument","activeElement","setTimeout","firstTabbable","tabbable","find","clearTimeout"],"sources":["@wordpress/compose/src/hooks/use-focus-on-mount/index.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useRef, useEffect } from '@wordpress/element';\r\nimport { focus } from '@wordpress/dom';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport useRefEffect from '../use-ref-effect';\r\n\r\n/**\r\n * Hook used to focus the first tabbable element on mount.\r\n *\r\n * @param {boolean | 'firstElement'} focusOnMount Focus on mount mode.\r\n * @return {import('react').RefCallback<HTMLElement>} Ref callback.\r\n *\r\n * @example\r\n * ```js\r\n * import { useFocusOnMount } from '@wordpress/compose';\r\n *\r\n * const WithFocusOnMount = () => {\r\n *     const ref = useFocusOnMount()\r\n *     return (\r\n *         <div ref={ ref }>\r\n *             <Button />\r\n *             <Button />\r\n *         </div>\r\n *     );\r\n * }\r\n * ```\r\n */\r\nexport default function useFocusOnMount( focusOnMount = 'firstElement' ) {\r\n\tconst focusOnMountRef = useRef( focusOnMount );\r\n\r\n\t/**\r\n\t * Sets focus on a DOM element.\r\n\t *\r\n\t * @param {HTMLElement} target The DOM element to set focus to.\r\n\t * @return {void}\r\n\t */\r\n\tconst setFocus = ( target ) => {\r\n\t\ttarget.focus( {\r\n\t\t\t// When focusing newly mounted dialogs,\r\n\t\t\t// the position of the popover is often not right on the first render\r\n\t\t\t// This prevents the layout shifts when focusing the dialogs.\r\n\t\t\tpreventScroll: true,\r\n\t\t} );\r\n\t};\r\n\r\n\t/** @type {import('react').MutableRefObject<ReturnType<setTimeout> | undefined>} */\r\n\tconst timerIdRef = useRef();\r\n\r\n\tuseEffect( () => {\r\n\t\tfocusOnMountRef.current = focusOnMount;\r\n\t}, [ focusOnMount ] );\r\n\r\n\treturn useRefEffect( ( node ) => {\r\n\t\tif ( ! node || focusOnMountRef.current === false ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif ( node.contains( node.ownerDocument?.activeElement ?? null ) ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif ( focusOnMountRef.current === 'firstElement' ) {\r\n\t\t\ttimerIdRef.current = setTimeout( () => {\r\n\t\t\t\tconst firstTabbable = focus.tabbable.find( node )[ 0 ];\r\n\r\n\t\t\t\tif ( firstTabbable ) {\r\n\t\t\t\t\tsetFocus( firstTabbable );\r\n\t\t\t\t}\r\n\t\t\t}, 0 );\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tsetFocus( node );\r\n\r\n\t\treturn () => {\r\n\t\t\tif ( timerIdRef.current ) {\r\n\t\t\t\tclearTimeout( timerIdRef.current );\r\n\t\t\t}\r\n\t\t};\r\n\t}, [] );\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,MAAM,EAAEC,SAAS,QAAQ,oBAAoB;AACtD,SAASC,KAAK,QAAQ,gBAAgB;;AAEtC;AACA;AACA;AACA,OAAOC,YAAY,MAAM,mBAAmB;;AAE5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAASC,eAAeA,CAAEC,YAAY,GAAG,cAAc,EAAG;EACxE,MAAMC,eAAe,GAAGN,MAAM,CAAEK,YAAa,CAAC;;EAE9C;AACD;AACA;AACA;AACA;AACA;EACC,MAAME,QAAQ,GAAKC,MAAM,IAAM;IAC9BA,MAAM,CAACN,KAAK,CAAE;MACb;MACA;MACA;MACAO,aAAa,EAAE;IAChB,CAAE,CAAC;EACJ,CAAC;;EAED;EACA,MAAMC,UAAU,GAAGV,MAAM,CAAC,CAAC;EAE3BC,SAAS,CAAE,MAAM;IAChBK,eAAe,CAACK,OAAO,GAAGN,YAAY;EACvC,CAAC,EAAE,CAAEA,YAAY,CAAG,CAAC;EAErB,OAAOF,YAAY,CAAIS,IAAI,IAAM;IAAA,IAAAC,qBAAA;IAChC,IAAK,CAAED,IAAI,IAAIN,eAAe,CAACK,OAAO,KAAK,KAAK,EAAG;MAClD;IACD;IAEA,IAAKC,IAAI,CAACE,QAAQ,EAAAD,qBAAA,GAAED,IAAI,CAACG,aAAa,EAAEC,aAAa,cAAAH,qBAAA,cAAAA,qBAAA,GAAI,IAAK,CAAC,EAAG;MACjE;IACD;IAEA,IAAKP,eAAe,CAACK,OAAO,KAAK,cAAc,EAAG;MACjDD,UAAU,CAACC,OAAO,GAAGM,UAAU,CAAE,MAAM;QACtC,MAAMC,aAAa,GAAGhB,KAAK,CAACiB,QAAQ,CAACC,IAAI,CAAER,IAAK,CAAC,CAAE,CAAC,CAAE;QAEtD,IAAKM,aAAa,EAAG;UACpBX,QAAQ,CAAEW,aAAc,CAAC;QAC1B;MACD,CAAC,EAAE,CAAE,CAAC;MAEN;IACD;IAEAX,QAAQ,CAAEK,IAAK,CAAC;IAEhB,OAAO,MAAM;MACZ,IAAKF,UAAU,CAACC,OAAO,EAAG;QACzBU,YAAY,CAAEX,UAAU,CAACC,OAAQ,CAAC;MACnC;IACD,CAAC;EACF,CAAC,EAAE,EAAG,CAAC;AACR","ignoreList":[]}