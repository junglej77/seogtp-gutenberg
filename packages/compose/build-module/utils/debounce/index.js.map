{"version":3,"names":["debounce","func","wait","options","lastArgs","lastThis","maxWait","result","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","undefined","Math","max","invokeFunc","time","args","thisArg","apply","startTimer","pendingFunc","waitTime","setTimeout","cancelTimer","clearTimeout","leadingEdge","timerExpired","getTimeSinceLastCall","remainingWait","timeSinceLastCall","timeSinceLastInvoke","timeWaiting","min","shouldInvoke","Date","now","trailingEdge","clearTimer","cancel","flush","pending","debounced","isInvoking"],"sources":["@wordpress/compose/src/utils/debounce/index.ts"],"sourcesContent":["/**\r\n * Parts of this source were derived and modified from lodash,\r\n * released under the MIT license.\r\n *\r\n * https://github.com/lodash/lodash\r\n *\r\n * Copyright JS Foundation and other contributors <https://js.foundation/>\r\n *\r\n * Based on Underscore.js, copyright Jeremy Ashkenas,\r\n * DocumentCloud and Investigative Reporters & Editors <http://underscorejs.org/>\r\n *\r\n * This software consists of voluntary contributions made by many\r\n * individuals. For exact contribution history, see the revision history\r\n * available at https://github.com/lodash/lodash\r\n *\r\n * The following license applies to all parts of this software except as\r\n * documented below:\r\n *\r\n * ====\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining\r\n * a copy of this software and associated documentation files (the\r\n * \"Software\"), to deal in the Software without restriction, including\r\n * without limitation the rights to use, copy, modify, merge, publish,\r\n * distribute, sublicense, and/or sell copies of the Software, and to\r\n * permit persons to whom the Software is furnished to do so, subject to\r\n * the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be\r\n * included in all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\r\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\n * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\r\n * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\r\n * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\r\n * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n\r\nexport interface DebounceOptions {\r\n\tleading: boolean;\r\n\tmaxWait: number;\r\n\ttrailing: boolean;\r\n}\r\n\r\nexport interface DebouncedFunc< T extends ( ...args: any[] ) => any > {\r\n\t/**\r\n\t * Call the original function, but applying the debounce rules.\r\n\t *\r\n\t * If the debounced function can be run immediately, this calls it and returns its return\r\n\t * value.\r\n\t *\r\n\t * Otherwise, it returns the return value of the last invocation, or undefined if the debounced\r\n\t * function was not invoked yet.\r\n\t */\r\n\t( ...args: Parameters< T > ): ReturnType< T > | undefined;\r\n\r\n\t/**\r\n\t * Throw away any pending invocation of the debounced function.\r\n\t */\r\n\tcancel: () => void;\r\n\r\n\t/**\r\n\t * If there is a pending invocation of the debounced function, invoke it immediately and return\r\n\t * its return value.\r\n\t *\r\n\t * Otherwise, return the value from the last invocation, or undefined if the debounced function\r\n\t * was never invoked.\r\n\t */\r\n\tflush: () => ReturnType< T > | undefined;\r\n}\r\n\r\n/**\r\n * A simplified and properly typed version of lodash's `debounce`, that\r\n * always uses timers instead of sometimes using rAF.\r\n *\r\n * Creates a debounced function that delays invoking `func` until after `wait`\r\n * milliseconds have elapsed since the last time the debounced function was\r\n * invoked. The debounced function comes with a `cancel` method to cancel delayed\r\n * `func` invocations and a `flush` method to immediately invoke them. Provide\r\n * `options` to indicate whether `func` should be invoked on the leading and/or\r\n * trailing edge of the `wait` timeout. The `func` is invoked with the last\r\n * arguments provided to the debounced function. Subsequent calls to the debounced\r\n * function return the result of the last `func` invocation.\r\n *\r\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\r\n * invoked on the trailing edge of the timeout only if the debounced function\r\n * is invoked more than once during the `wait` timeout.\r\n *\r\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\r\n * until the next tick, similar to `setTimeout` with a timeout of `0`.\r\n *\r\n * @param {Function}                   func             The function to debounce.\r\n * @param {number}                     wait             The number of milliseconds to delay.\r\n * @param {Partial< DebounceOptions >} options          The options object.\r\n * @param {boolean}                    options.leading  Specify invoking on the leading edge of the timeout.\r\n * @param {number}                     options.maxWait  The maximum time `func` is allowed to be delayed before it's invoked.\r\n * @param {boolean}                    options.trailing Specify invoking on the trailing edge of the timeout.\r\n *\r\n * @return Returns the new debounced function.\r\n */\r\nexport const debounce = < FunctionT extends ( ...args: unknown[] ) => unknown >(\r\n\tfunc: FunctionT,\r\n\twait: number,\r\n\toptions?: Partial< DebounceOptions >\r\n) => {\r\n\tlet lastArgs: Parameters< FunctionT > | undefined;\r\n\tlet lastThis: unknown | undefined;\r\n\tlet maxWait = 0;\r\n\tlet result: ReturnType< FunctionT >;\r\n\tlet timerId: ReturnType< typeof setTimeout > | undefined;\r\n\tlet lastCallTime: number | undefined;\r\n\r\n\tlet lastInvokeTime = 0;\r\n\tlet leading = false;\r\n\tlet maxing = false;\r\n\tlet trailing = true;\r\n\r\n\tif ( options ) {\r\n\t\tleading = !! options.leading;\r\n\t\tmaxing = 'maxWait' in options;\r\n\t\tif ( options.maxWait !== undefined ) {\r\n\t\t\tmaxWait = Math.max( options.maxWait, wait );\r\n\t\t}\r\n\t\ttrailing = 'trailing' in options ? !! options.trailing : trailing;\r\n\t}\r\n\r\n\tfunction invokeFunc( time: number ) {\r\n\t\tconst args = lastArgs;\r\n\t\tconst thisArg = lastThis;\r\n\r\n\t\tlastArgs = undefined;\r\n\t\tlastThis = undefined;\r\n\t\tlastInvokeTime = time;\r\n\r\n\t\tresult = func.apply( thisArg, args! ) as ReturnType< FunctionT >;\r\n\t\treturn result;\r\n\t}\r\n\r\n\tfunction startTimer(\r\n\t\tpendingFunc: () => void,\r\n\t\twaitTime: number | undefined\r\n\t) {\r\n\t\ttimerId = setTimeout( pendingFunc, waitTime );\r\n\t}\r\n\r\n\tfunction cancelTimer() {\r\n\t\tif ( timerId !== undefined ) {\r\n\t\t\tclearTimeout( timerId );\r\n\t\t}\r\n\t}\r\n\r\n\tfunction leadingEdge( time: number ) {\r\n\t\t// Reset any `maxWait` timer.\r\n\t\tlastInvokeTime = time;\r\n\t\t// Start the timer for the trailing edge.\r\n\t\tstartTimer( timerExpired, wait );\r\n\t\t// Invoke the leading edge.\r\n\t\treturn leading ? invokeFunc( time ) : result;\r\n\t}\r\n\r\n\tfunction getTimeSinceLastCall( time: number ) {\r\n\t\treturn time - ( lastCallTime || 0 );\r\n\t}\r\n\r\n\tfunction remainingWait( time: number ) {\r\n\t\tconst timeSinceLastCall = getTimeSinceLastCall( time );\r\n\t\tconst timeSinceLastInvoke = time - lastInvokeTime;\r\n\t\tconst timeWaiting = wait - timeSinceLastCall;\r\n\r\n\t\treturn maxing\r\n\t\t\t? Math.min( timeWaiting, maxWait - timeSinceLastInvoke )\r\n\t\t\t: timeWaiting;\r\n\t}\r\n\r\n\tfunction shouldInvoke( time: number ) {\r\n\t\tconst timeSinceLastCall = getTimeSinceLastCall( time );\r\n\t\tconst timeSinceLastInvoke = time - lastInvokeTime;\r\n\r\n\t\t// Either this is the first call, activity has stopped and we're at the\r\n\t\t// trailing edge, the system time has gone backwards and we're treating\r\n\t\t// it as the trailing edge, or we've hit the `maxWait` limit.\r\n\t\treturn (\r\n\t\t\tlastCallTime === undefined ||\r\n\t\t\ttimeSinceLastCall >= wait ||\r\n\t\t\ttimeSinceLastCall < 0 ||\r\n\t\t\t( maxing && timeSinceLastInvoke >= maxWait )\r\n\t\t);\r\n\t}\r\n\r\n\tfunction timerExpired() {\r\n\t\tconst time = Date.now();\r\n\t\tif ( shouldInvoke( time ) ) {\r\n\t\t\treturn trailingEdge( time );\r\n\t\t}\r\n\t\t// Restart the timer.\r\n\t\tstartTimer( timerExpired, remainingWait( time ) );\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tfunction clearTimer() {\r\n\t\ttimerId = undefined;\r\n\t}\r\n\r\n\tfunction trailingEdge( time: number ) {\r\n\t\tclearTimer();\r\n\r\n\t\t// Only invoke if we have `lastArgs` which means `func` has been\r\n\t\t// debounced at least once.\r\n\t\tif ( trailing && lastArgs ) {\r\n\t\t\treturn invokeFunc( time );\r\n\t\t}\r\n\t\tlastArgs = lastThis = undefined;\r\n\t\treturn result;\r\n\t}\r\n\r\n\tfunction cancel() {\r\n\t\tcancelTimer();\r\n\t\tlastInvokeTime = 0;\r\n\t\tclearTimer();\r\n\t\tlastArgs = lastCallTime = lastThis = undefined;\r\n\t}\r\n\r\n\tfunction flush() {\r\n\t\treturn pending() ? trailingEdge( Date.now() ) : result;\r\n\t}\r\n\r\n\tfunction pending() {\r\n\t\treturn timerId !== undefined;\r\n\t}\r\n\r\n\tfunction debounced( this: unknown, ...args: Parameters< FunctionT > ) {\r\n\t\tconst time = Date.now();\r\n\t\tconst isInvoking = shouldInvoke( time );\r\n\r\n\t\tlastArgs = args;\r\n\t\tlastThis = this;\r\n\t\tlastCallTime = time;\r\n\r\n\t\tif ( isInvoking ) {\r\n\t\t\tif ( ! pending() ) {\r\n\t\t\t\treturn leadingEdge( lastCallTime );\r\n\t\t\t}\r\n\t\t\tif ( maxing ) {\r\n\t\t\t\t// Handle invocations in a tight loop.\r\n\t\t\t\tstartTimer( timerExpired, wait );\r\n\t\t\t\treturn invokeFunc( lastCallTime );\r\n\t\t\t}\r\n\t\t}\r\n\t\tif ( ! pending() ) {\r\n\t\t\tstartTimer( timerExpired, wait );\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\tdebounced.cancel = cancel;\r\n\tdebounced.flush = flush;\r\n\tdebounced.pending = pending;\r\n\treturn debounced;\r\n};\r\n"],"mappings":"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","ignoreList":[]}