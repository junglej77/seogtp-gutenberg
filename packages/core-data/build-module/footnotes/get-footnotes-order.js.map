{"version":3,"names":["getRichTextValuesCached","cache","WeakMap","getBlockFootnotesOrder","block","has","order","value","replacements","forEach","type","attributes","push","set","get","getFootnotesOrder","blocks","flatMap"],"sources":["@wordpress/core-data/src/footnotes/get-footnotes-order.js"],"sourcesContent":["/**\r\n * Internal dependencies\r\n */\r\nimport getRichTextValuesCached from './get-rich-text-values-cached';\r\n\r\nconst cache = new WeakMap();\r\n\r\nfunction getBlockFootnotesOrder( block ) {\r\n\tif ( ! cache.has( block ) ) {\r\n\t\tconst order = [];\r\n\t\tfor ( const value of getRichTextValuesCached( block ) ) {\r\n\t\t\tif ( ! value ) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\t// replacements is a sparse array, use forEach to skip empty slots.\r\n\t\t\tvalue.replacements.forEach( ( { type, attributes } ) => {\r\n\t\t\t\tif ( type === 'core/footnote' ) {\r\n\t\t\t\t\torder.push( attributes[ 'data-fn' ] );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t}\r\n\t\tcache.set( block, order );\r\n\t}\r\n\r\n\treturn cache.get( block );\r\n}\r\n\r\nexport default function getFootnotesOrder( blocks ) {\r\n\t// We can only separate getting order from blocks at the root level. For\r\n\t// deeper inner blocks, this will not work since it's possible to have both\r\n\t// inner blocks and block attributes, so order needs to be computed from the\r\n\t// Edit functions as a whole.\r\n\treturn blocks.flatMap( getBlockFootnotesOrder );\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,OAAOA,uBAAuB,MAAM,+BAA+B;AAEnE,MAAMC,KAAK,GAAG,IAAIC,OAAO,CAAC,CAAC;AAE3B,SAASC,sBAAsBA,CAAEC,KAAK,EAAG;EACxC,IAAK,CAAEH,KAAK,CAACI,GAAG,CAAED,KAAM,CAAC,EAAG;IAC3B,MAAME,KAAK,GAAG,EAAE;IAChB,KAAM,MAAMC,KAAK,IAAIP,uBAAuB,CAAEI,KAAM,CAAC,EAAG;MACvD,IAAK,CAAEG,KAAK,EAAG;QACd;MACD;;MAEA;MACAA,KAAK,CAACC,YAAY,CAACC,OAAO,CAAE,CAAE;QAAEC,IAAI;QAAEC;MAAW,CAAC,KAAM;QACvD,IAAKD,IAAI,KAAK,eAAe,EAAG;UAC/BJ,KAAK,CAACM,IAAI,CAAED,UAAU,CAAE,SAAS,CAAG,CAAC;QACtC;MACD,CAAE,CAAC;IACJ;IACAV,KAAK,CAACY,GAAG,CAAET,KAAK,EAAEE,KAAM,CAAC;EAC1B;EAEA,OAAOL,KAAK,CAACa,GAAG,CAAEV,KAAM,CAAC;AAC1B;AAEA,eAAe,SAASW,iBAAiBA,CAAEC,MAAM,EAAG;EACnD;EACA;EACA;EACA;EACA,OAAOA,MAAM,CAACC,OAAO,CAAEd,sBAAuB,CAAC;AAChD","ignoreList":[]}