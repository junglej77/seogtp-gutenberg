{"version":3,"names":["getNode","deepCopyLocksTreePath","DEFAULT_STATE","requests","tree","locks","children","state","action","type","request","lock","store","path","storePath","newTree","node","filter","r","l"],"sources":["@wordpress/core-data/src/locks/reducer.js"],"sourcesContent":["/**\r\n * Internal dependencies\r\n */\r\nimport { getNode, deepCopyLocksTreePath } from './utils';\r\n\r\nconst DEFAULT_STATE = {\r\n\trequests: [],\r\n\ttree: {\r\n\t\tlocks: [],\r\n\t\tchildren: {},\r\n\t},\r\n};\r\n\r\n/**\r\n * Reducer returning locks.\r\n *\r\n * @param {Object} state  Current state.\r\n * @param {Object} action Dispatched action.\r\n *\r\n * @return {Object} Updated state.\r\n */\r\nexport default function locks( state = DEFAULT_STATE, action ) {\r\n\tswitch ( action.type ) {\r\n\t\tcase 'ENQUEUE_LOCK_REQUEST': {\r\n\t\t\tconst { request } = action;\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\trequests: [ request, ...state.requests ],\r\n\t\t\t};\r\n\t\t}\r\n\t\tcase 'GRANT_LOCK_REQUEST': {\r\n\t\t\tconst { lock, request } = action;\r\n\t\t\tconst { store, path } = request;\r\n\t\t\tconst storePath = [ store, ...path ];\r\n\r\n\t\t\tconst newTree = deepCopyLocksTreePath( state.tree, storePath );\r\n\t\t\tconst node = getNode( newTree, storePath );\r\n\t\t\tnode.locks = [ ...node.locks, lock ];\r\n\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\trequests: state.requests.filter( ( r ) => r !== request ),\r\n\t\t\t\ttree: newTree,\r\n\t\t\t};\r\n\t\t}\r\n\t\tcase 'RELEASE_LOCK': {\r\n\t\t\tconst { lock } = action;\r\n\t\t\tconst storePath = [ lock.store, ...lock.path ];\r\n\r\n\t\t\tconst newTree = deepCopyLocksTreePath( state.tree, storePath );\r\n\t\t\tconst node = getNode( newTree, storePath );\r\n\t\t\tnode.locks = node.locks.filter( ( l ) => l !== lock );\r\n\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\ttree: newTree,\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\r\n\treturn state;\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,OAAO,EAAEC,qBAAqB,QAAQ,SAAS;AAExD,MAAMC,aAAa,GAAG;EACrBC,QAAQ,EAAE,EAAE;EACZC,IAAI,EAAE;IACLC,KAAK,EAAE,EAAE;IACTC,QAAQ,EAAE,CAAC;EACZ;AACD,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAASD,KAAKA,CAAEE,KAAK,GAAGL,aAAa,EAAEM,MAAM,EAAG;EAC9D,QAASA,MAAM,CAACC,IAAI;IACnB,KAAK,sBAAsB;MAAE;QAC5B,MAAM;UAAEC;QAAQ,CAAC,GAAGF,MAAM;QAC1B,OAAO;UACN,GAAGD,KAAK;UACRJ,QAAQ,EAAE,CAAEO,OAAO,EAAE,GAAGH,KAAK,CAACJ,QAAQ;QACvC,CAAC;MACF;IACA,KAAK,oBAAoB;MAAE;QAC1B,MAAM;UAAEQ,IAAI;UAAED;QAAQ,CAAC,GAAGF,MAAM;QAChC,MAAM;UAAEI,KAAK;UAAEC;QAAK,CAAC,GAAGH,OAAO;QAC/B,MAAMI,SAAS,GAAG,CAAEF,KAAK,EAAE,GAAGC,IAAI,CAAE;QAEpC,MAAME,OAAO,GAAGd,qBAAqB,CAAEM,KAAK,CAACH,IAAI,EAAEU,SAAU,CAAC;QAC9D,MAAME,IAAI,GAAGhB,OAAO,CAAEe,OAAO,EAAED,SAAU,CAAC;QAC1CE,IAAI,CAACX,KAAK,GAAG,CAAE,GAAGW,IAAI,CAACX,KAAK,EAAEM,IAAI,CAAE;QAEpC,OAAO;UACN,GAAGJ,KAAK;UACRJ,QAAQ,EAAEI,KAAK,CAACJ,QAAQ,CAACc,MAAM,CAAIC,CAAC,IAAMA,CAAC,KAAKR,OAAQ,CAAC;UACzDN,IAAI,EAAEW;QACP,CAAC;MACF;IACA,KAAK,cAAc;MAAE;QACpB,MAAM;UAAEJ;QAAK,CAAC,GAAGH,MAAM;QACvB,MAAMM,SAAS,GAAG,CAAEH,IAAI,CAACC,KAAK,EAAE,GAAGD,IAAI,CAACE,IAAI,CAAE;QAE9C,MAAME,OAAO,GAAGd,qBAAqB,CAAEM,KAAK,CAACH,IAAI,EAAEU,SAAU,CAAC;QAC9D,MAAME,IAAI,GAAGhB,OAAO,CAAEe,OAAO,EAAED,SAAU,CAAC;QAC1CE,IAAI,CAACX,KAAK,GAAGW,IAAI,CAACX,KAAK,CAACY,MAAM,CAAIE,CAAC,IAAMA,CAAC,KAAKR,IAAK,CAAC;QAErD,OAAO;UACN,GAAGJ,KAAK;UACRH,IAAI,EAAEW;QACP,CAAC;MACF;EACD;EAEA,OAAOR,KAAK;AACb","ignoreList":[]}