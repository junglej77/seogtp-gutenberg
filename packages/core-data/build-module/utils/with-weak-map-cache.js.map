{"version":3,"names":["withWeakMapCache","fn","cache","WeakMap","key","value","has","get","set"],"sources":["@wordpress/core-data/src/utils/with-weak-map-cache.js"],"sourcesContent":["/**\r\n * Given a function, returns an enhanced function which caches the result and\r\n * tracks in WeakMap. The result is only cached if the original function is\r\n * passed a valid object-like argument (requirement for WeakMap key).\r\n *\r\n * @param {Function} fn Original function.\r\n *\r\n * @return {Function} Enhanced caching function.\r\n */\r\nfunction withWeakMapCache( fn ) {\r\n\tconst cache = new WeakMap();\r\n\r\n\treturn ( key ) => {\r\n\t\tlet value;\r\n\t\tif ( cache.has( key ) ) {\r\n\t\t\tvalue = cache.get( key );\r\n\t\t} else {\r\n\t\t\tvalue = fn( key );\r\n\r\n\t\t\t// Can reach here if key is not valid for WeakMap, since `has`\r\n\t\t\t// will return false for invalid key. Since `set` will throw,\r\n\t\t\t// ensure that key is valid before setting into cache.\r\n\t\t\tif ( key !== null && typeof key === 'object' ) {\r\n\t\t\t\tcache.set( key, value );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn value;\r\n\t};\r\n}\r\n\r\nexport default withWeakMapCache;\r\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASA,gBAAgBA,CAAEC,EAAE,EAAG;EAC/B,MAAMC,KAAK,GAAG,IAAIC,OAAO,CAAC,CAAC;EAE3B,OAASC,GAAG,IAAM;IACjB,IAAIC,KAAK;IACT,IAAKH,KAAK,CAACI,GAAG,CAAEF,GAAI,CAAC,EAAG;MACvBC,KAAK,GAAGH,KAAK,CAACK,GAAG,CAAEH,GAAI,CAAC;IACzB,CAAC,MAAM;MACNC,KAAK,GAAGJ,EAAE,CAAEG,GAAI,CAAC;;MAEjB;MACA;MACA;MACA,IAAKA,GAAG,KAAK,IAAI,IAAI,OAAOA,GAAG,KAAK,QAAQ,EAAG;QAC9CF,KAAK,CAACM,GAAG,CAAEJ,GAAG,EAAEC,KAAM,CAAC;MACxB;IACD;IAEA,OAAOA,KAAK;EACb,CAAC;AACF;AAEA,eAAeL,gBAAgB","ignoreList":[]}