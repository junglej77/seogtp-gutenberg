{"version":3,"names":["useRef","useEffect","useDispatch","store","blockEditorStore","getWidgetIdFromBlock","useFocusControl","useBlocksFocusControl","blocks","selectBlock","focusedWidgetIdRef","blocksRef","current","focusedBlock","find","block","clientId","blockNode","document","querySelector","focus"],"sources":["@wordpress/customize-widgets/src/components/focus-control/use-blocks-focus-control.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useRef, useEffect } from '@wordpress/element';\r\nimport { useDispatch } from '@wordpress/data';\r\nimport { store as blockEditorStore } from '@wordpress/block-editor';\r\nimport { getWidgetIdFromBlock } from '@wordpress/widgets';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { useFocusControl } from '.';\r\n\r\nexport default function useBlocksFocusControl( blocks ) {\r\n\tconst { selectBlock } = useDispatch( blockEditorStore );\r\n\tconst [ focusedWidgetIdRef ] = useFocusControl();\r\n\r\n\tconst blocksRef = useRef( blocks );\r\n\r\n\tuseEffect( () => {\r\n\t\tblocksRef.current = blocks;\r\n\t}, [ blocks ] );\r\n\r\n\tuseEffect( () => {\r\n\t\tif ( focusedWidgetIdRef.current ) {\r\n\t\t\tconst focusedBlock = blocksRef.current.find(\r\n\t\t\t\t( block ) =>\r\n\t\t\t\t\tgetWidgetIdFromBlock( block ) === focusedWidgetIdRef.current\r\n\t\t\t);\r\n\r\n\t\t\tif ( focusedBlock ) {\r\n\t\t\t\tselectBlock( focusedBlock.clientId );\r\n\t\t\t\t// If the block is already being selected, the DOM node won't\r\n\t\t\t\t// get focused again automatically.\r\n\t\t\t\t// We select the DOM and focus it manually here.\r\n\t\t\t\tconst blockNode = document.querySelector(\r\n\t\t\t\t\t`[data-block=\"${ focusedBlock.clientId }\"]`\r\n\t\t\t\t);\r\n\t\t\t\tblockNode?.focus();\r\n\t\t\t}\r\n\t\t}\r\n\t}, [ focusedWidgetIdRef, selectBlock ] );\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,MAAM,EAAEC,SAAS,QAAQ,oBAAoB;AACtD,SAASC,WAAW,QAAQ,iBAAiB;AAC7C,SAASC,KAAK,IAAIC,gBAAgB,QAAQ,yBAAyB;AACnE,SAASC,oBAAoB,QAAQ,oBAAoB;;AAEzD;AACA;AACA;AACA,SAASC,eAAe,QAAQ,GAAG;AAEnC,eAAe,SAASC,qBAAqBA,CAAEC,MAAM,EAAG;EACvD,MAAM;IAAEC;EAAY,CAAC,GAAGP,WAAW,CAAEE,gBAAiB,CAAC;EACvD,MAAM,CAAEM,kBAAkB,CAAE,GAAGJ,eAAe,CAAC,CAAC;EAEhD,MAAMK,SAAS,GAAGX,MAAM,CAAEQ,MAAO,CAAC;EAElCP,SAAS,CAAE,MAAM;IAChBU,SAAS,CAACC,OAAO,GAAGJ,MAAM;EAC3B,CAAC,EAAE,CAAEA,MAAM,CAAG,CAAC;EAEfP,SAAS,CAAE,MAAM;IAChB,IAAKS,kBAAkB,CAACE,OAAO,EAAG;MACjC,MAAMC,YAAY,GAAGF,SAAS,CAACC,OAAO,CAACE,IAAI,CACxCC,KAAK,IACNV,oBAAoB,CAAEU,KAAM,CAAC,KAAKL,kBAAkB,CAACE,OACvD,CAAC;MAED,IAAKC,YAAY,EAAG;QACnBJ,WAAW,CAAEI,YAAY,CAACG,QAAS,CAAC;QACpC;QACA;QACA;QACA,MAAMC,SAAS,GAAGC,QAAQ,CAACC,aAAa,CACtC,gBAAgBN,YAAY,CAACG,QAAU,IACzC,CAAC;QACDC,SAAS,EAAEG,KAAK,CAAC,CAAC;MACnB;IACD;EACD,CAAC,EAAE,CAAEV,kBAAkB,EAAED,WAAW,CAAG,CAAC;AACzC","ignoreList":[]}