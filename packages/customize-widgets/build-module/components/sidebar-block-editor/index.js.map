{"version":3,"names":["useViewportMatch","store","coreStore","useSelect","useMemo","createPortal","BlockList","BlockToolbar","BlockInspector","privateApis","blockEditorPrivateApis","__unstableBlockSettingsMenuFirstItem","uploadMedia","preferencesStore","blockLibraryPrivateApis","BlockInspectorButton","Header","useInserter","SidebarEditorProvider","WelcomeGuide","KeyboardShortcuts","BlockAppender","unlock","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ExperimentalBlockCanvas","BlockCanvas","BlockKeyboardShortcuts","SidebarBlockEditor","blockEditorSettings","sidebar","inserter","inspector","isInserterOpened","setIsInserterOpened","isMediumViewport","hasUploadPermissions","isFixedToolbarActive","keepCaretInsideBlock","isWelcomeGuideActive","select","_select$canUser","get","canUser","kind","name","settings","mediaUploadBlockEditor","onError","argumentsObject","wpAllowedMimeTypes","allowedMimeTypes","message","__experimentalSetIsInserterOpened","mediaUpload","hasFixedToolbar","__unstableHasCustomAppender","children","Register","undo","redo","save","hideDragHandle","shouldIframe","styles","defaultEditorStyles","height","renderAppender","onSubmit","event","preventDefault","contentContainer","onClose","closeMenu"],"sources":["@wordpress/customize-widgets/src/components/sidebar-block-editor/index.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useViewportMatch } from '@wordpress/compose';\r\nimport { store as coreStore } from '@wordpress/core-data';\r\nimport { useSelect } from '@wordpress/data';\r\nimport { useMemo, createPortal } from '@wordpress/element';\r\nimport {\r\n\tBlockList,\r\n\tBlockToolbar,\r\n\tBlockInspector,\r\n\tprivateApis as blockEditorPrivateApis,\r\n\t__unstableBlockSettingsMenuFirstItem,\r\n} from '@wordpress/block-editor';\r\nimport { uploadMedia } from '@wordpress/media-utils';\r\nimport { store as preferencesStore } from '@wordpress/preferences';\r\nimport { privateApis as blockLibraryPrivateApis } from '@wordpress/block-library';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport BlockInspectorButton from '../block-inspector-button';\r\nimport Header from '../header';\r\nimport useInserter from '../inserter/use-inserter';\r\nimport SidebarEditorProvider from './sidebar-editor-provider';\r\nimport WelcomeGuide from '../welcome-guide';\r\nimport KeyboardShortcuts from '../keyboard-shortcuts';\r\nimport BlockAppender from '../block-appender';\r\nimport { unlock } from '../../lock-unlock';\r\n\r\nconst { ExperimentalBlockCanvas: BlockCanvas } = unlock(\r\n\tblockEditorPrivateApis\r\n);\r\n\r\nconst { BlockKeyboardShortcuts } = unlock( blockLibraryPrivateApis );\r\n\r\nexport default function SidebarBlockEditor( {\r\n\tblockEditorSettings,\r\n\tsidebar,\r\n\tinserter,\r\n\tinspector,\r\n} ) {\r\n\tconst [ isInserterOpened, setIsInserterOpened ] = useInserter( inserter );\r\n\tconst isMediumViewport = useViewportMatch( 'small' );\r\n\tconst {\r\n\t\thasUploadPermissions,\r\n\t\tisFixedToolbarActive,\r\n\t\tkeepCaretInsideBlock,\r\n\t\tisWelcomeGuideActive,\r\n\t} = useSelect( ( select ) => {\r\n\t\tconst { get } = select( preferencesStore );\r\n\t\treturn {\r\n\t\t\thasUploadPermissions:\r\n\t\t\t\tselect( coreStore ).canUser( 'create', {\r\n\t\t\t\t\tkind: 'root',\r\n\t\t\t\t\tname: 'media',\r\n\t\t\t\t} ) ?? true,\r\n\t\t\tisFixedToolbarActive: !! get(\r\n\t\t\t\t'core/customize-widgets',\r\n\t\t\t\t'fixedToolbar'\r\n\t\t\t),\r\n\t\t\tkeepCaretInsideBlock: !! get(\r\n\t\t\t\t'core/customize-widgets',\r\n\t\t\t\t'keepCaretInsideBlock'\r\n\t\t\t),\r\n\t\t\tisWelcomeGuideActive: !! get(\r\n\t\t\t\t'core/customize-widgets',\r\n\t\t\t\t'welcomeGuide'\r\n\t\t\t),\r\n\t\t};\r\n\t}, [] );\r\n\tconst settings = useMemo( () => {\r\n\t\tlet mediaUploadBlockEditor;\r\n\t\tif ( hasUploadPermissions ) {\r\n\t\t\tmediaUploadBlockEditor = ( { onError, ...argumentsObject } ) => {\r\n\t\t\t\tuploadMedia( {\r\n\t\t\t\t\twpAllowedMimeTypes: blockEditorSettings.allowedMimeTypes,\r\n\t\t\t\t\tonError: ( { message } ) => onError( message ),\r\n\t\t\t\t\t...argumentsObject,\r\n\t\t\t\t} );\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\t...blockEditorSettings,\r\n\t\t\t__experimentalSetIsInserterOpened: setIsInserterOpened,\r\n\t\t\tmediaUpload: mediaUploadBlockEditor,\r\n\t\t\thasFixedToolbar: isFixedToolbarActive || ! isMediumViewport,\r\n\t\t\tkeepCaretInsideBlock,\r\n\t\t\t__unstableHasCustomAppender: true,\r\n\t\t};\r\n\t}, [\r\n\t\thasUploadPermissions,\r\n\t\tblockEditorSettings,\r\n\t\tisFixedToolbarActive,\r\n\t\tisMediumViewport,\r\n\t\tkeepCaretInsideBlock,\r\n\t\tsetIsInserterOpened,\r\n\t] );\r\n\r\n\tif ( isWelcomeGuideActive ) {\r\n\t\treturn <WelcomeGuide sidebar={ sidebar } />;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<KeyboardShortcuts.Register />\r\n\t\t\t<BlockKeyboardShortcuts />\r\n\r\n\t\t\t<SidebarEditorProvider sidebar={ sidebar } settings={ settings }>\r\n\t\t\t\t<KeyboardShortcuts\r\n\t\t\t\t\tundo={ sidebar.undo }\r\n\t\t\t\t\tredo={ sidebar.redo }\r\n\t\t\t\t\tsave={ sidebar.save }\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t<Header\r\n\t\t\t\t\tsidebar={ sidebar }\r\n\t\t\t\t\tinserter={ inserter }\r\n\t\t\t\t\tisInserterOpened={ isInserterOpened }\r\n\t\t\t\t\tsetIsInserterOpened={ setIsInserterOpened }\r\n\t\t\t\t\tisFixedToolbarActive={\r\n\t\t\t\t\t\tisFixedToolbarActive || ! isMediumViewport\r\n\t\t\t\t\t}\r\n\t\t\t\t/>\r\n\t\t\t\t{ ( isFixedToolbarActive || ! isMediumViewport ) && (\r\n\t\t\t\t\t<BlockToolbar hideDragHandle />\r\n\t\t\t\t) }\r\n\t\t\t\t<BlockCanvas\r\n\t\t\t\t\tshouldIframe={ false }\r\n\t\t\t\t\tstyles={ settings.defaultEditorStyles }\r\n\t\t\t\t\theight=\"100%\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<BlockList renderAppender={ BlockAppender } />\r\n\t\t\t\t</BlockCanvas>\r\n\r\n\t\t\t\t{ createPortal(\r\n\t\t\t\t\t// This is a temporary hack to prevent button component inside <BlockInspector>\r\n\t\t\t\t\t// from submitting form when type=\"button\" is not specified.\r\n\t\t\t\t\t<form onSubmit={ ( event ) => event.preventDefault() }>\r\n\t\t\t\t\t\t<BlockInspector />\r\n\t\t\t\t\t</form>,\r\n\t\t\t\t\tinspector.contentContainer[ 0 ]\r\n\t\t\t\t) }\r\n\t\t\t</SidebarEditorProvider>\r\n\r\n\t\t\t<__unstableBlockSettingsMenuFirstItem>\r\n\t\t\t\t{ ( { onClose } ) => (\r\n\t\t\t\t\t<BlockInspectorButton\r\n\t\t\t\t\t\tinspector={ inspector }\r\n\t\t\t\t\t\tcloseMenu={ onClose }\r\n\t\t\t\t\t/>\r\n\t\t\t\t) }\r\n\t\t\t</__unstableBlockSettingsMenuFirstItem>\r\n\t\t</>\r\n\t);\r\n}\r\n"],"mappings":"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","ignoreList":[]}