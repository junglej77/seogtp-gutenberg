{"version":3,"names":["onSubKey","actionProperty","reducer","state","action","key","undefined","nextKeyState","selectorArgsToStateKey","args","len","length","idx","slice"],"sources":["@wordpress/data/src/redux-store/metadata/utils.ts"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport type { AnyAction, Reducer } from 'redux';\r\n\r\n/**\r\n * Higher-order reducer creator which creates a combined reducer object, keyed\r\n * by a property on the action object.\r\n *\r\n * @param actionProperty Action property by which to key object.\r\n * @return Higher-order reducer.\r\n */\r\nexport const onSubKey =\r\n\t< TState extends unknown, TAction extends AnyAction >(\r\n\t\tactionProperty: string\r\n\t) =>\r\n\t(\r\n\t\treducer: Reducer< TState, TAction >\r\n\t): Reducer< Record< string, TState >, TAction > =>\r\n\t( state: Record< string, TState > = {}, action ) => {\r\n\t\t// Retrieve subkey from action. Do not track if undefined; useful for cases\r\n\t\t// where reducer is scoped by action shape.\r\n\t\tconst key = action[ actionProperty ];\r\n\t\tif ( key === undefined ) {\r\n\t\t\treturn state;\r\n\t\t}\r\n\r\n\t\t// Avoid updating state if unchanged. Note that this also accounts for a\r\n\t\t// reducer which returns undefined on a key which is not yet tracked.\r\n\t\tconst nextKeyState = reducer( state[ key ], action );\r\n\t\tif ( nextKeyState === state[ key ] ) {\r\n\t\t\treturn state;\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\t...state,\r\n\t\t\t[ key ]: nextKeyState,\r\n\t\t};\r\n\t};\r\n\r\n/**\r\n * Normalize selector argument array by defaulting `undefined` value to an empty array\r\n * and removing trailing `undefined` values.\r\n *\r\n * @param args Selector argument array\r\n * @return Normalized state key array\r\n */\r\nexport function selectorArgsToStateKey( args: unknown[] | null | undefined ) {\r\n\tif ( args === undefined || args === null ) {\r\n\t\treturn [];\r\n\t}\r\n\r\n\tconst len = args.length;\r\n\tlet idx = len;\r\n\twhile ( idx > 0 && args[ idx - 1 ] === undefined ) {\r\n\t\tidx--;\r\n\t}\r\n\treturn idx === len ? args : args.slice( 0, idx );\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,MAAMA,QAAQ,GAEnBC,cAAsB,IAGtBC,OAAmC,IAEpC,CAAEC,KAA+B,GAAG,CAAC,CAAC,EAAEC,MAAM,KAAM;EACnD;EACA;EACA,MAAMC,GAAG,GAAGD,MAAM,CAAEH,cAAc,CAAE;EACpC,IAAKI,GAAG,KAAKC,SAAS,EAAG;IACxB,OAAOH,KAAK;EACb;;EAEA;EACA;EACA,MAAMI,YAAY,GAAGL,OAAO,CAAEC,KAAK,CAAEE,GAAG,CAAE,EAAED,MAAO,CAAC;EACpD,IAAKG,YAAY,KAAKJ,KAAK,CAAEE,GAAG,CAAE,EAAG;IACpC,OAAOF,KAAK;EACb;EAEA,OAAO;IACN,GAAGA,KAAK;IACR,CAAEE,GAAG,GAAIE;EACV,CAAC;AACF,CAAC;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,sBAAsBA,CAAEC,IAAkC,EAAG;EAC5E,IAAKA,IAAI,KAAKH,SAAS,IAAIG,IAAI,KAAK,IAAI,EAAG;IAC1C,OAAO,EAAE;EACV;EAEA,MAAMC,GAAG,GAAGD,IAAI,CAACE,MAAM;EACvB,IAAIC,GAAG,GAAGF,GAAG;EACb,OAAQE,GAAG,GAAG,CAAC,IAAIH,IAAI,CAAEG,GAAG,GAAG,CAAC,CAAE,KAAKN,SAAS,EAAG;IAClDM,GAAG,EAAE;EACN;EACA,OAAOA,GAAG,KAAKF,GAAG,GAAGD,IAAI,GAAGA,IAAI,CAACI,KAAK,CAAE,CAAC,EAAED,GAAI,CAAC;AACjD","ignoreList":[]}