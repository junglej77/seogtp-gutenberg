{"version":3,"names":["deprecated","createReduxStore","coreDataStore","createEmitter","lock","unlock","getStoreName","storeNameOrDescriptor","name","createRegistry","storeConfigs","parent","stores","emitter","listeningStores","globalListener","emit","subscribe","listener","storeName","store","select","add","getSelectors","__unstableMarkListeningStores","callback","ref","Set","call","current","Array","from","resolveSelect","getResolveSelectors","suspendSelect","getSuspendSelectors","dispatch","getActions","withPlugins","attributes","Object","fromEntries","entries","map","key","attribute","registry","apply","arguments","registerStoreInstance","createStore","console","error","TypeError","currentSubscribe","unsubscribeFromEmitter","unsubscribeFromStore","isPaused","registerPrivateActions","privateActionsOf","registerPrivateSelectors","privateSelectorsOf","e","register","instantiate","registerGenericStore","since","alternative","registerStore","options","reducer","batch","pause","values","forEach","resume","namespaces","use","plugin","config","registryWithPlugins","privateActions","privateSelectors"],"sources":["@wordpress/data/src/registry.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport deprecated from '@wordpress/deprecated';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport createReduxStore from './redux-store';\r\nimport coreDataStore from './store';\r\nimport { createEmitter } from './utils/emitter';\r\nimport { lock, unlock } from './lock-unlock';\r\n\r\n/** @typedef {import('./types').StoreDescriptor} StoreDescriptor */\r\n\r\n/**\r\n * @typedef {Object} WPDataRegistry An isolated orchestrator of store registrations.\r\n *\r\n * @property {Function} registerGenericStore Given a namespace key and settings\r\n *                                           object, registers a new generic\r\n *                                           store.\r\n * @property {Function} registerStore        Given a namespace key and settings\r\n *                                           object, registers a new namespace\r\n *                                           store.\r\n * @property {Function} subscribe            Given a function callback, invokes\r\n *                                           the callback on any change to state\r\n *                                           within any registered store.\r\n * @property {Function} select               Given a namespace key, returns an\r\n *                                           object of the  store's registered\r\n *                                           selectors.\r\n * @property {Function} dispatch             Given a namespace key, returns an\r\n *                                           object of the store's registered\r\n *                                           action dispatchers.\r\n */\r\n\r\n/**\r\n * @typedef {Object} WPDataPlugin An object of registry function overrides.\r\n *\r\n * @property {Function} registerStore registers store.\r\n */\r\n\r\nfunction getStoreName( storeNameOrDescriptor ) {\r\n\treturn typeof storeNameOrDescriptor === 'string'\r\n\t\t? storeNameOrDescriptor\r\n\t\t: storeNameOrDescriptor.name;\r\n}\r\n/**\r\n * Creates a new store registry, given an optional object of initial store\r\n * configurations.\r\n *\r\n * @param {Object}  storeConfigs Initial store configurations.\r\n * @param {Object?} parent       Parent registry.\r\n *\r\n * @return {WPDataRegistry} Data registry.\r\n */\r\nexport function createRegistry( storeConfigs = {}, parent = null ) {\r\n\tconst stores = {};\r\n\tconst emitter = createEmitter();\r\n\tlet listeningStores = null;\r\n\r\n\t/**\r\n\t * Global listener called for each store's update.\r\n\t */\r\n\tfunction globalListener() {\r\n\t\temitter.emit();\r\n\t}\r\n\r\n\t/**\r\n\t * Subscribe to changes to any data, either in all stores in registry, or\r\n\t * in one specific store.\r\n\t *\r\n\t * @param {Function}                listener              Listener function.\r\n\t * @param {string|StoreDescriptor?} storeNameOrDescriptor Optional store name.\r\n\t *\r\n\t * @return {Function} Unsubscribe function.\r\n\t */\r\n\tconst subscribe = ( listener, storeNameOrDescriptor ) => {\r\n\t\t// subscribe to all stores\r\n\t\tif ( ! storeNameOrDescriptor ) {\r\n\t\t\treturn emitter.subscribe( listener );\r\n\t\t}\r\n\r\n\t\t// subscribe to one store\r\n\t\tconst storeName = getStoreName( storeNameOrDescriptor );\r\n\t\tconst store = stores[ storeName ];\r\n\t\tif ( store ) {\r\n\t\t\treturn store.subscribe( listener );\r\n\t\t}\r\n\r\n\t\t// Trying to access a store that hasn't been registered,\r\n\t\t// this is a pattern rarely used but seen in some places.\r\n\t\t// We fallback to global `subscribe` here for backward-compatibility for now.\r\n\t\t// See https://github.com/WordPress/gutenberg/pull/27466 for more info.\r\n\t\tif ( ! parent ) {\r\n\t\t\treturn emitter.subscribe( listener );\r\n\t\t}\r\n\r\n\t\treturn parent.subscribe( listener, storeNameOrDescriptor );\r\n\t};\r\n\r\n\t/**\r\n\t * Calls a selector given the current state and extra arguments.\r\n\t *\r\n\t * @param {string|StoreDescriptor} storeNameOrDescriptor Unique namespace identifier for the store\r\n\t *                                                       or the store descriptor.\r\n\t *\r\n\t * @return {*} The selector's returned value.\r\n\t */\r\n\tfunction select( storeNameOrDescriptor ) {\r\n\t\tconst storeName = getStoreName( storeNameOrDescriptor );\r\n\t\tlisteningStores?.add( storeName );\r\n\t\tconst store = stores[ storeName ];\r\n\t\tif ( store ) {\r\n\t\t\treturn store.getSelectors();\r\n\t\t}\r\n\r\n\t\treturn parent?.select( storeName );\r\n\t}\r\n\r\n\tfunction __unstableMarkListeningStores( callback, ref ) {\r\n\t\tlisteningStores = new Set();\r\n\t\ttry {\r\n\t\t\treturn callback.call( this );\r\n\t\t} finally {\r\n\t\t\tref.current = Array.from( listeningStores );\r\n\t\t\tlisteningStores = null;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Given a store descriptor, returns an object containing the store's selectors pre-bound to\r\n\t * state so that you only need to supply additional arguments, and modified so that they return\r\n\t * promises that resolve to their eventual values, after any resolvers have ran.\r\n\t *\r\n\t * @param {StoreDescriptor|string} storeNameOrDescriptor The store descriptor. The legacy calling\r\n\t *                                                       convention of passing the store name is\r\n\t *                                                       also supported.\r\n\t *\r\n\t * @return {Object} Each key of the object matches the name of a selector.\r\n\t */\r\n\tfunction resolveSelect( storeNameOrDescriptor ) {\r\n\t\tconst storeName = getStoreName( storeNameOrDescriptor );\r\n\t\tlisteningStores?.add( storeName );\r\n\t\tconst store = stores[ storeName ];\r\n\t\tif ( store ) {\r\n\t\t\treturn store.getResolveSelectors();\r\n\t\t}\r\n\r\n\t\treturn parent && parent.resolveSelect( storeName );\r\n\t}\r\n\r\n\t/**\r\n\t * Given a store descriptor, returns an object containing the store's selectors pre-bound to\r\n\t * state so that you only need to supply additional arguments, and modified so that they throw\r\n\t * promises in case the selector is not resolved yet.\r\n\t *\r\n\t * @param {StoreDescriptor|string} storeNameOrDescriptor The store descriptor. The legacy calling\r\n\t *                                                       convention of passing the store name is\r\n\t *                                                       also supported.\r\n\t *\r\n\t * @return {Object} Object containing the store's suspense-wrapped selectors.\r\n\t */\r\n\tfunction suspendSelect( storeNameOrDescriptor ) {\r\n\t\tconst storeName = getStoreName( storeNameOrDescriptor );\r\n\t\tlisteningStores?.add( storeName );\r\n\t\tconst store = stores[ storeName ];\r\n\t\tif ( store ) {\r\n\t\t\treturn store.getSuspendSelectors();\r\n\t\t}\r\n\r\n\t\treturn parent && parent.suspendSelect( storeName );\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the available actions for a part of the state.\r\n\t *\r\n\t * @param {string|StoreDescriptor} storeNameOrDescriptor Unique namespace identifier for the store\r\n\t *                                                       or the store descriptor.\r\n\t *\r\n\t * @return {*} The action's returned value.\r\n\t */\r\n\tfunction dispatch( storeNameOrDescriptor ) {\r\n\t\tconst storeName = getStoreName( storeNameOrDescriptor );\r\n\t\tconst store = stores[ storeName ];\r\n\t\tif ( store ) {\r\n\t\t\treturn store.getActions();\r\n\t\t}\r\n\r\n\t\treturn parent && parent.dispatch( storeName );\r\n\t}\r\n\r\n\t//\r\n\t// Deprecated\r\n\t// TODO: Remove this after `use()` is removed.\r\n\tfunction withPlugins( attributes ) {\r\n\t\treturn Object.fromEntries(\r\n\t\t\tObject.entries( attributes ).map( ( [ key, attribute ] ) => {\r\n\t\t\t\tif ( typeof attribute !== 'function' ) {\r\n\t\t\t\t\treturn [ key, attribute ];\r\n\t\t\t\t}\r\n\t\t\t\treturn [\r\n\t\t\t\t\tkey,\r\n\t\t\t\t\tfunction () {\r\n\t\t\t\t\t\treturn registry[ key ].apply( null, arguments );\r\n\t\t\t\t\t},\r\n\t\t\t\t];\r\n\t\t\t} )\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Registers a store instance.\r\n\t *\r\n\t * @param {string}   name        Store registry name.\r\n\t * @param {Function} createStore Function that creates a store object (getSelectors, getActions, subscribe).\r\n\t */\r\n\tfunction registerStoreInstance( name, createStore ) {\r\n\t\tif ( stores[ name ] ) {\r\n\t\t\t// eslint-disable-next-line no-console\r\n\t\t\tconsole.error( 'Store \"' + name + '\" is already registered.' );\r\n\t\t\treturn stores[ name ];\r\n\t\t}\r\n\r\n\t\tconst store = createStore();\r\n\r\n\t\tif ( typeof store.getSelectors !== 'function' ) {\r\n\t\t\tthrow new TypeError( 'store.getSelectors must be a function' );\r\n\t\t}\r\n\t\tif ( typeof store.getActions !== 'function' ) {\r\n\t\t\tthrow new TypeError( 'store.getActions must be a function' );\r\n\t\t}\r\n\t\tif ( typeof store.subscribe !== 'function' ) {\r\n\t\t\tthrow new TypeError( 'store.subscribe must be a function' );\r\n\t\t}\r\n\t\t// The emitter is used to keep track of active listeners when the registry\r\n\t\t// get paused, that way, when resumed we should be able to call all these\r\n\t\t// pending listeners.\r\n\t\tstore.emitter = createEmitter();\r\n\t\tconst currentSubscribe = store.subscribe;\r\n\t\tstore.subscribe = ( listener ) => {\r\n\t\t\tconst unsubscribeFromEmitter = store.emitter.subscribe( listener );\r\n\t\t\tconst unsubscribeFromStore = currentSubscribe( () => {\r\n\t\t\t\tif ( store.emitter.isPaused ) {\r\n\t\t\t\t\tstore.emitter.emit();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tlistener();\r\n\t\t\t} );\r\n\r\n\t\t\treturn () => {\r\n\t\t\t\tunsubscribeFromStore?.();\r\n\t\t\t\tunsubscribeFromEmitter?.();\r\n\t\t\t};\r\n\t\t};\r\n\t\tstores[ name ] = store;\r\n\t\tstore.subscribe( globalListener );\r\n\r\n\t\t// Copy private actions and selectors from the parent store.\r\n\t\tif ( parent ) {\r\n\t\t\ttry {\r\n\t\t\t\tunlock( store.store ).registerPrivateActions(\r\n\t\t\t\t\tunlock( parent ).privateActionsOf( name )\r\n\t\t\t\t);\r\n\t\t\t\tunlock( store.store ).registerPrivateSelectors(\r\n\t\t\t\t\tunlock( parent ).privateSelectorsOf( name )\r\n\t\t\t\t);\r\n\t\t\t} catch ( e ) {\r\n\t\t\t\t// unlock() throws if store.store was not locked.\r\n\t\t\t\t// The error indicates there's nothing to do here so let's\r\n\t\t\t\t// ignore it.\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn store;\r\n\t}\r\n\r\n\t/**\r\n\t * Registers a new store given a store descriptor.\r\n\t *\r\n\t * @param {StoreDescriptor} store Store descriptor.\r\n\t */\r\n\tfunction register( store ) {\r\n\t\tregisterStoreInstance( store.name, () =>\r\n\t\t\tstore.instantiate( registry )\r\n\t\t);\r\n\t}\r\n\r\n\tfunction registerGenericStore( name, store ) {\r\n\t\tdeprecated( 'wp.data.registerGenericStore', {\r\n\t\t\tsince: '5.9',\r\n\t\t\talternative: 'wp.data.register( storeDescriptor )',\r\n\t\t} );\r\n\t\tregisterStoreInstance( name, () => store );\r\n\t}\r\n\r\n\t/**\r\n\t * Registers a standard `@wordpress/data` store.\r\n\t *\r\n\t * @param {string} storeName Unique namespace identifier.\r\n\t * @param {Object} options   Store description (reducer, actions, selectors, resolvers).\r\n\t *\r\n\t * @return {Object} Registered store object.\r\n\t */\r\n\tfunction registerStore( storeName, options ) {\r\n\t\tif ( ! options.reducer ) {\r\n\t\t\tthrow new TypeError( 'Must specify store reducer' );\r\n\t\t}\r\n\r\n\t\tconst store = registerStoreInstance( storeName, () =>\r\n\t\t\tcreateReduxStore( storeName, options ).instantiate( registry )\r\n\t\t);\r\n\r\n\t\treturn store.store;\r\n\t}\r\n\r\n\tfunction batch( callback ) {\r\n\t\t// If we're already batching, just call the callback.\r\n\t\tif ( emitter.isPaused ) {\r\n\t\t\tcallback();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\temitter.pause();\r\n\t\tObject.values( stores ).forEach( ( store ) => store.emitter.pause() );\r\n\t\ttry {\r\n\t\t\tcallback();\r\n\t\t} finally {\r\n\t\t\temitter.resume();\r\n\t\t\tObject.values( stores ).forEach( ( store ) =>\r\n\t\t\t\tstore.emitter.resume()\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tlet registry = {\r\n\t\tbatch,\r\n\t\tstores,\r\n\t\tnamespaces: stores, // TODO: Deprecate/remove this.\r\n\t\tsubscribe,\r\n\t\tselect,\r\n\t\tresolveSelect,\r\n\t\tsuspendSelect,\r\n\t\tdispatch,\r\n\t\tuse,\r\n\t\tregister,\r\n\t\tregisterGenericStore,\r\n\t\tregisterStore,\r\n\t\t__unstableMarkListeningStores,\r\n\t};\r\n\r\n\t//\r\n\t// TODO:\r\n\t// This function will be deprecated as soon as it is no longer internally referenced.\r\n\tfunction use( plugin, options ) {\r\n\t\tif ( ! plugin ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tregistry = {\r\n\t\t\t...registry,\r\n\t\t\t...plugin( registry, options ),\r\n\t\t};\r\n\r\n\t\treturn registry;\r\n\t}\r\n\r\n\tregistry.register( coreDataStore );\r\n\r\n\tfor ( const [ name, config ] of Object.entries( storeConfigs ) ) {\r\n\t\tregistry.register( createReduxStore( name, config ) );\r\n\t}\r\n\r\n\tif ( parent ) {\r\n\t\tparent.subscribe( globalListener );\r\n\t}\r\n\r\n\tconst registryWithPlugins = withPlugins( registry );\r\n\tlock( registryWithPlugins, {\r\n\t\tprivateActionsOf: ( name ) => {\r\n\t\t\ttry {\r\n\t\t\t\treturn unlock( stores[ name ].store ).privateActions;\r\n\t\t\t} catch ( e ) {\r\n\t\t\t\t// unlock() throws an error the store was not locked â€“ this means\r\n\t\t\t\t// there no private actions are available\r\n\t\t\t\treturn {};\r\n\t\t\t}\r\n\t\t},\r\n\t\tprivateSelectorsOf: ( name ) => {\r\n\t\t\ttry {\r\n\t\t\t\treturn unlock( stores[ name ].store ).privateSelectors;\r\n\t\t\t} catch ( e ) {\r\n\t\t\t\treturn {};\r\n\t\t\t}\r\n\t\t},\r\n\t} );\r\n\treturn registryWithPlugins;\r\n}\r\n"],"mappings":"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","ignoreList":[]}