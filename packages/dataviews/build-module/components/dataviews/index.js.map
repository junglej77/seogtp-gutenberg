{"version":3,"names":["__experimentalHStack","HStack","useMemo","useState","DataViewsContext","default","DataViewsFilters","useFilters","FilterVisibilityToggle","DataViewsLayout","DataViewsFooter","DataViewsSearch","DataViewsViewConfig","normalizeFields","jsx","_jsx","jsxs","_jsxs","defaultGetItemId","item","id","DataViews","view","onChangeView","fields","search","searchLabel","undefined","actions","data","getItemId","isLoading","paginationInfo","defaultLayouts","selection","selectionProperty","onChangeSelection","header","selectionState","setSelectionState","density","setDensity","isUncontrolled","openedFilter","setOpenedFilter","setSelectionWithChange","value","newValue","_fields","_selection","filter","some","filters","isShowingFilter","setIsShowingFilter","isPrimary","Provider","children","className","alignment","justify","spacing","expanded","label","style","flexShrink"],"sources":["@wordpress/dataviews/src/components/dataviews/index.tsx"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport type { ReactNode } from 'react';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { __experimentalHStack as HStack } from '@wordpress/components';\r\nimport { useMemo, useState } from '@wordpress/element';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport DataViewsContext from '../dataviews-context';\r\nimport {\r\n\tdefault as DataViewsFilters,\r\n\tuseFilters,\r\n\tFilterVisibilityToggle,\r\n} from '../dataviews-filters';\r\nimport DataViewsLayout from '../dataviews-layout';\r\nimport DataViewsFooter from '../dataviews-footer';\r\nimport DataViewsSearch from '../dataviews-search';\r\nimport DataViewsViewConfig from '../dataviews-view-config';\r\nimport { normalizeFields } from '../../normalize-fields';\r\nimport type { Action, Field, View, SupportedLayouts } from '../../types';\r\nimport type { SelectionOrUpdater } from '../../private-types';\r\n\r\ntype ItemWithId = { id: string };\r\n\r\ntype DataViewsProps< Item > = {\r\n\tview: View;\r\n\tonChangeView: ( view: View ) => void;\r\n\tfields: Field< Item >[];\r\n\tsearch?: boolean;\r\n\tsearchLabel?: string;\r\n\tactions?: Action< Item >[];\r\n\tdata: Item[];\r\n\tisLoading?: boolean;\r\n\tpaginationInfo: {\r\n\t\ttotalItems: number;\r\n\t\ttotalPages: number;\r\n\t};\r\n\tdefaultLayouts: SupportedLayouts;\r\n\tselection?: string[];\r\n\tonChangeSelection?: ( items: string[] ) => void;\r\n\theader?: ReactNode;\r\n} & ( Item extends ItemWithId\r\n\t? { getItemId?: ( item: Item ) => string }\r\n\t: { getItemId: ( item: Item ) => string } );\r\n\r\nconst defaultGetItemId = ( item: ItemWithId ) => item.id;\r\n\r\nexport default function DataViews< Item >( {\r\n\tview,\r\n\tonChangeView,\r\n\tfields,\r\n\tsearch = true,\r\n\tsearchLabel = undefined,\r\n\tactions = [],\r\n\tdata,\r\n\tgetItemId = defaultGetItemId,\r\n\tisLoading = false,\r\n\tpaginationInfo,\r\n\tdefaultLayouts,\r\n\tselection: selectionProperty,\r\n\tonChangeSelection,\r\n\theader,\r\n}: DataViewsProps< Item > ) {\r\n\tconst [ selectionState, setSelectionState ] = useState< string[] >( [] );\r\n\tconst [ density, setDensity ] = useState< number >( 0 );\r\n\tconst isUncontrolled =\r\n\t\tselectionProperty === undefined || onChangeSelection === undefined;\r\n\tconst selection = isUncontrolled ? selectionState : selectionProperty;\r\n\tconst [ openedFilter, setOpenedFilter ] = useState< string | null >( null );\r\n\tfunction setSelectionWithChange( value: SelectionOrUpdater ) {\r\n\t\tconst newValue =\r\n\t\t\ttypeof value === 'function' ? value( selection ) : value;\r\n\t\tif ( isUncontrolled ) {\r\n\t\t\tsetSelectionState( newValue );\r\n\t\t}\r\n\t\tif ( onChangeSelection ) {\r\n\t\t\tonChangeSelection( newValue );\r\n\t\t}\r\n\t}\r\n\tconst _fields = useMemo( () => normalizeFields( fields ), [ fields ] );\r\n\tconst _selection = useMemo( () => {\r\n\t\treturn selection.filter( ( id ) =>\r\n\t\t\tdata.some( ( item ) => getItemId( item ) === id )\r\n\t\t);\r\n\t}, [ selection, data, getItemId ] );\r\n\r\n\tconst filters = useFilters( _fields, view );\r\n\tconst [ isShowingFilter, setIsShowingFilter ] = useState< boolean >( () =>\r\n\t\t( filters || [] ).some( ( filter ) => filter.isPrimary )\r\n\t);\r\n\r\n\treturn (\r\n\t\t<DataViewsContext.Provider\r\n\t\t\tvalue={ {\r\n\t\t\t\tview,\r\n\t\t\t\tonChangeView,\r\n\t\t\t\tfields: _fields,\r\n\t\t\t\tactions,\r\n\t\t\t\tdata,\r\n\t\t\t\tisLoading,\r\n\t\t\t\tpaginationInfo,\r\n\t\t\t\tselection: _selection,\r\n\t\t\t\tonChangeSelection: setSelectionWithChange,\r\n\t\t\t\topenedFilter,\r\n\t\t\t\tsetOpenedFilter,\r\n\t\t\t\tgetItemId,\r\n\t\t\t\tdensity,\r\n\t\t\t} }\r\n\t\t>\r\n\t\t\t<div className=\"dataviews-wrapper\">\r\n\t\t\t\t<HStack\r\n\t\t\t\t\talignment=\"top\"\r\n\t\t\t\t\tjustify=\"space-between\"\r\n\t\t\t\t\tclassName=\"dataviews__view-actions\"\r\n\t\t\t\t\tspacing={ 1 }\r\n\t\t\t\t>\r\n\t\t\t\t\t<HStack\r\n\t\t\t\t\t\tjustify=\"start\"\r\n\t\t\t\t\t\texpanded={ false }\r\n\t\t\t\t\t\tclassName=\"dataviews__search\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{ search && <DataViewsSearch label={ searchLabel } /> }\r\n\t\t\t\t\t\t<FilterVisibilityToggle\r\n\t\t\t\t\t\t\tfilters={ filters }\r\n\t\t\t\t\t\t\tview={ view }\r\n\t\t\t\t\t\t\tonChangeView={ onChangeView }\r\n\t\t\t\t\t\t\tsetOpenedFilter={ setOpenedFilter }\r\n\t\t\t\t\t\t\tsetIsShowingFilter={ setIsShowingFilter }\r\n\t\t\t\t\t\t\tisShowingFilter={ isShowingFilter }\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</HStack>\r\n\t\t\t\t\t<HStack\r\n\t\t\t\t\t\tspacing={ 1 }\r\n\t\t\t\t\t\texpanded={ false }\r\n\t\t\t\t\t\tstyle={ { flexShrink: 0 } }\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<DataViewsViewConfig\r\n\t\t\t\t\t\t\tdefaultLayouts={ defaultLayouts }\r\n\t\t\t\t\t\t\tdensity={ density }\r\n\t\t\t\t\t\t\tsetDensity={ setDensity }\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{ header }\r\n\t\t\t\t\t</HStack>\r\n\t\t\t\t</HStack>\r\n\t\t\t\t{ isShowingFilter && <DataViewsFilters /> }\r\n\t\t\t\t<DataViewsLayout />\r\n\t\t\t\t<DataViewsFooter />\r\n\t\t\t</div>\r\n\t\t</DataViewsContext.Provider>\r\n\t);\r\n}\r\n"],"mappings":"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","ignoreList":[]}