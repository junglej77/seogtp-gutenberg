{"version":3,"names":["__experimentalVStack","VStack","__experimentalHStack","HStack","__experimentalHeading","Heading","__experimentalSpacer","Spacer","Dropdown","Button","useState","useMemo","sprintf","__","closeSmall","normalizeFields","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","DropdownHeader","title","onClose","className","spacing","children","alignment","level","size","__next40pxDefaultSize","label","icon","onClick","FormField","data","field","onChange","popoverAnchor","setPopoverAnchor","popoverProps","anchor","placement","offset","shift","ref","contentClassName","focusOnMount","toggleProps","variant","tooltipPosition","renderToggle","isOpen","onToggle","render","item","renderContent","Edit","hideLabelFromVision","id","FormPanel","fields","form","visibleFields","_form$fields","map","fieldId","find","filter"],"sources":["@wordpress/dataviews/src/dataforms-layouts/panel/index.tsx"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport {\r\n\t__experimentalVStack as VStack,\r\n\t__experimentalHStack as HStack,\r\n\t__experimentalHeading as Heading,\r\n\t__experimentalSpacer as Spacer,\r\n\tDropdown,\r\n\tButton,\r\n} from '@wordpress/components';\r\nimport { useState, useMemo } from '@wordpress/element';\r\nimport { sprintf, __ } from '@wordpress/i18n';\r\nimport { closeSmall } from '@wordpress/icons';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { normalizeFields } from '../../normalize-fields';\r\nimport type { DataFormProps, NormalizedField, Field } from '../../types';\r\n\r\ninterface FormFieldProps< Item > {\r\n\tdata: Item;\r\n\tfield: NormalizedField< Item >;\r\n\tonChange: ( value: any ) => void;\r\n}\r\n\r\nfunction DropdownHeader( {\r\n\ttitle,\r\n\tonClose,\r\n}: {\r\n\ttitle: string;\r\n\tonClose: () => void;\r\n} ) {\r\n\treturn (\r\n\t\t<VStack\r\n\t\t\tclassName=\"dataforms-layouts-panel__dropdown-header\"\r\n\t\t\tspacing={ 4 }\r\n\t\t>\r\n\t\t\t<HStack alignment=\"center\">\r\n\t\t\t\t<Heading level={ 2 } size={ 13 }>\r\n\t\t\t\t\t{ title }\r\n\t\t\t\t</Heading>\r\n\t\t\t\t<Spacer />\r\n\t\t\t\t{ onClose && (\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\t// TODO: Switch to `true` (40px size) if possible\r\n\t\t\t\t\t\t__next40pxDefaultSize={ false }\r\n\t\t\t\t\t\tclassName=\"dataforms-layouts-panel__dropdown-header-action\"\r\n\t\t\t\t\t\tlabel={ __( 'Close' ) }\r\n\t\t\t\t\t\ticon={ closeSmall }\r\n\t\t\t\t\t\tonClick={ onClose }\r\n\t\t\t\t\t/>\r\n\t\t\t\t) }\r\n\t\t\t</HStack>\r\n\t\t</VStack>\r\n\t);\r\n}\r\n\r\nfunction FormField< Item >( {\r\n\tdata,\r\n\tfield,\r\n\tonChange,\r\n}: FormFieldProps< Item > ) {\r\n\t// Use internal state instead of a ref to make sure that the component\r\n\t// re-renders when the popover's anchor updates.\r\n\tconst [ popoverAnchor, setPopoverAnchor ] = useState< HTMLElement | null >(\r\n\t\tnull\r\n\t);\r\n\t// Memoize popoverProps to avoid returning a new object every time.\r\n\tconst popoverProps = useMemo(\r\n\t\t() => ( {\r\n\t\t\t// Anchor the popover to the middle of the entire row so that it doesn't\r\n\t\t\t// move around when the label changes.\r\n\t\t\tanchor: popoverAnchor,\r\n\t\t\tplacement: 'left-start',\r\n\t\t\toffset: 36,\r\n\t\t\tshift: true,\r\n\t\t} ),\r\n\t\t[ popoverAnchor ]\r\n\t);\r\n\r\n\treturn (\r\n\t\t<HStack\r\n\t\t\tref={ setPopoverAnchor }\r\n\t\t\tclassName=\"dataforms-layouts-panel__field\"\r\n\t\t>\r\n\t\t\t<div className=\"dataforms-layouts-panel__field-label\">\r\n\t\t\t\t{ field.label }\r\n\t\t\t</div>\r\n\t\t\t<div>\r\n\t\t\t\t<Dropdown\r\n\t\t\t\t\tcontentClassName=\"dataforms-layouts-panel__field-dropdown\"\r\n\t\t\t\t\tpopoverProps={ popoverProps }\r\n\t\t\t\t\tfocusOnMount\r\n\t\t\t\t\ttoggleProps={ {\r\n\t\t\t\t\t\tsize: 'compact',\r\n\t\t\t\t\t\tvariant: 'tertiary',\r\n\t\t\t\t\t\ttooltipPosition: 'middle left',\r\n\t\t\t\t\t} }\r\n\t\t\t\t\trenderToggle={ ( { isOpen, onToggle } ) => (\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tclassName=\"dataforms-layouts-panel__field-control\"\r\n\t\t\t\t\t\t\tsize=\"compact\"\r\n\t\t\t\t\t\t\tvariant=\"tertiary\"\r\n\t\t\t\t\t\t\taria-expanded={ isOpen }\r\n\t\t\t\t\t\t\taria-label={ sprintf(\r\n\t\t\t\t\t\t\t\t// translators: %s: Field name.\r\n\t\t\t\t\t\t\t\t__( 'Edit %s' ),\r\n\t\t\t\t\t\t\t\tfield.label\r\n\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\tonClick={ onToggle }\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<field.render item={ data } />\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t) }\r\n\t\t\t\t\trenderContent={ ( { onClose } ) => (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<DropdownHeader\r\n\t\t\t\t\t\t\t\ttitle={ field.label }\r\n\t\t\t\t\t\t\t\tonClose={ onClose }\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<field.Edit\r\n\t\t\t\t\t\t\t\tkey={ field.id }\r\n\t\t\t\t\t\t\t\tdata={ data }\r\n\t\t\t\t\t\t\t\tfield={ field }\r\n\t\t\t\t\t\t\t\tonChange={ onChange }\r\n\t\t\t\t\t\t\t\thideLabelFromVision\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t) }\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t</HStack>\r\n\t);\r\n}\r\n\r\nexport default function FormPanel< Item >( {\r\n\tdata,\r\n\tfields,\r\n\tform,\r\n\tonChange,\r\n}: DataFormProps< Item > ) {\r\n\tconst visibleFields = useMemo(\r\n\t\t() =>\r\n\t\t\tnormalizeFields(\r\n\t\t\t\t( form.fields ?? [] )\r\n\t\t\t\t\t.map( ( fieldId ) =>\r\n\t\t\t\t\t\tfields.find( ( { id } ) => id === fieldId )\r\n\t\t\t\t\t)\r\n\t\t\t\t\t.filter( ( field ): field is Field< Item > => !! field )\r\n\t\t\t),\r\n\t\t[ fields, form.fields ]\r\n\t);\r\n\r\n\treturn (\r\n\t\t<VStack spacing={ 2 }>\r\n\t\t\t{ visibleFields.map( ( field ) => {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<FormField\r\n\t\t\t\t\t\tkey={ field.id }\r\n\t\t\t\t\t\tdata={ data }\r\n\t\t\t\t\t\tfield={ field }\r\n\t\t\t\t\t\tonChange={ onChange }\r\n\t\t\t\t\t/>\r\n\t\t\t\t);\r\n\t\t\t} ) }\r\n\t\t</VStack>\r\n\t);\r\n}\r\n"],"mappings":"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","ignoreList":[]}