{"version":3,"names":["openPublishPanel","publishPost","publishPanelToggle","page","$","isPublishingPost","evaluate","element","textContent","isEntityPublishToggle","classList","contains","click","publishButton","waitForSelector"],"sources":["@wordpress/e2e-test-utils/src/publish-post.js"],"sourcesContent":["/**\r\n * Internal dependencies\r\n */\r\nimport { openPublishPanel } from './open-publish-panel';\r\n\r\n/**\r\n * Publishes the post, resolving once the request is complete (once a notice\r\n * is displayed).\r\n *\r\n * @return {Promise} Promise resolving when publish is complete.\r\n */\r\nexport async function publishPost() {\r\n\tconst publishPanelToggle = await page.$(\r\n\t\t'.editor-post-publish-panel__toggle'\r\n\t);\r\n\tconst isPublishingPost = await publishPanelToggle.evaluate(\r\n\t\t( element ) => element.textContent === 'Publish'\r\n\t);\r\n\tconst isEntityPublishToggle = await publishPanelToggle.evaluate(\r\n\t\t( element ) => element.classList.contains( 'has-changes-dot' )\r\n\t);\r\n\r\n\tawait openPublishPanel();\r\n\r\n\t// Save any entities.\r\n\tif ( isEntityPublishToggle ) {\r\n\t\t// Handle saving entities.\r\n\t\tawait page.click( '.editor-entities-saved-states__save-button' );\r\n\t}\r\n\r\n\t// If this is just an update then the entity save will be all that's needed.\r\n\t// If it's a publish then publish the post in addition to saving the entities.\r\n\tif ( isPublishingPost ) {\r\n\t\t// components-button editor-post-publish-button editor-post-publish-button__button is-primary\r\n\t\t// Handle saving just the post.\r\n\t\tconst publishButton = await page.waitForSelector(\r\n\t\t\t'.editor-post-publish-button:not([aria-disabled=\"true\"])'\r\n\t\t);\r\n\t\tawait publishButton.click();\r\n\r\n\t\t// A success notice should show up.\r\n\t\treturn page.waitForSelector( '.components-snackbar' );\r\n\t}\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,gBAAgB,QAAQ,sBAAsB;;AAEvD;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,eAAeC,WAAWA,CAAA,EAAG;EACnC,MAAMC,kBAAkB,GAAG,MAAMC,IAAI,CAACC,CAAC,CACtC,oCACD,CAAC;EACD,MAAMC,gBAAgB,GAAG,MAAMH,kBAAkB,CAACI,QAAQ,CACvDC,OAAO,IAAMA,OAAO,CAACC,WAAW,KAAK,SACxC,CAAC;EACD,MAAMC,qBAAqB,GAAG,MAAMP,kBAAkB,CAACI,QAAQ,CAC5DC,OAAO,IAAMA,OAAO,CAACG,SAAS,CAACC,QAAQ,CAAE,iBAAkB,CAC9D,CAAC;EAED,MAAMX,gBAAgB,CAAC,CAAC;;EAExB;EACA,IAAKS,qBAAqB,EAAG;IAC5B;IACA,MAAMN,IAAI,CAACS,KAAK,CAAE,4CAA6C,CAAC;EACjE;;EAEA;EACA;EACA,IAAKP,gBAAgB,EAAG;IACvB;IACA;IACA,MAAMQ,aAAa,GAAG,MAAMV,IAAI,CAACW,eAAe,CAC/C,yDACD,CAAC;IACD,MAAMD,aAAa,CAACD,KAAK,CAAC,CAAC;;IAE3B;IACA,OAAOT,IAAI,CAACW,eAAe,CAAE,sBAAuB,CAAC;EACtD;AACD","ignoreList":[]}