{"version":3,"names":["useSelect","useEffect","useRef","store","editorStore","VIEW_AS_LINK_SELECTOR","VIEW_AS_PREVIEW_LINK_SELECTOR","useUpdatePostLinkListener","newPermalink","select","getCurrentPost","link","nodeToUpdateRef","current","document","querySelector","setAttribute"],"sources":["@wordpress/edit-post/src/components/editor-initialization/listener-hooks.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useSelect } from '@wordpress/data';\r\nimport { useEffect, useRef } from '@wordpress/element';\r\nimport { store as editorStore } from '@wordpress/editor';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport {\r\n\tVIEW_AS_LINK_SELECTOR,\r\n\tVIEW_AS_PREVIEW_LINK_SELECTOR,\r\n} from '../../store/constants';\r\n\r\n/**\r\n * This listener hook monitors any change in permalink and updates the view\r\n * post link in the admin bar.\r\n */\r\nexport const useUpdatePostLinkListener = () => {\r\n\tconst { newPermalink } = useSelect(\r\n\t\t( select ) => ( {\r\n\t\t\tnewPermalink: select( editorStore ).getCurrentPost().link,\r\n\t\t} ),\r\n\t\t[]\r\n\t);\r\n\tconst nodeToUpdateRef = useRef();\r\n\r\n\tuseEffect( () => {\r\n\t\tnodeToUpdateRef.current =\r\n\t\t\tdocument.querySelector( VIEW_AS_PREVIEW_LINK_SELECTOR ) ||\r\n\t\t\tdocument.querySelector( VIEW_AS_LINK_SELECTOR );\r\n\t}, [] );\r\n\r\n\tuseEffect( () => {\r\n\t\tif ( ! newPermalink || ! nodeToUpdateRef.current ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tnodeToUpdateRef.current.setAttribute( 'href', newPermalink );\r\n\t}, [ newPermalink ] );\r\n};\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,SAAS,QAAQ,iBAAiB;AAC3C,SAASC,SAAS,EAAEC,MAAM,QAAQ,oBAAoB;AACtD,SAASC,KAAK,IAAIC,WAAW,QAAQ,mBAAmB;;AAExD;AACA;AACA;AACA,SACCC,qBAAqB,EACrBC,6BAA6B,QACvB,uBAAuB;;AAE9B;AACA;AACA;AACA;AACA,OAAO,MAAMC,yBAAyB,GAAGA,CAAA,KAAM;EAC9C,MAAM;IAAEC;EAAa,CAAC,GAAGR,SAAS,CAC/BS,MAAM,KAAQ;IACfD,YAAY,EAAEC,MAAM,CAAEL,WAAY,CAAC,CAACM,cAAc,CAAC,CAAC,CAACC;EACtD,CAAC,CAAE,EACH,EACD,CAAC;EACD,MAAMC,eAAe,GAAGV,MAAM,CAAC,CAAC;EAEhCD,SAAS,CAAE,MAAM;IAChBW,eAAe,CAACC,OAAO,GACtBC,QAAQ,CAACC,aAAa,CAAET,6BAA8B,CAAC,IACvDQ,QAAQ,CAACC,aAAa,CAAEV,qBAAsB,CAAC;EACjD,CAAC,EAAE,EAAG,CAAC;EAEPJ,SAAS,CAAE,MAAM;IAChB,IAAK,CAAEO,YAAY,IAAI,CAAEI,eAAe,CAACC,OAAO,EAAG;MAClD;IACD;IACAD,eAAe,CAACC,OAAO,CAACG,YAAY,CAAE,MAAM,EAAER,YAAa,CAAC;EAC7D,CAAC,EAAE,CAAEA,YAAY,CAAG,CAAC;AACtB,CAAC","ignoreList":[]}