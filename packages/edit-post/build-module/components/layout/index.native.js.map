{"version":3,"names":["Platform","SafeAreaView","View","SafeArea","Component","withSelect","BottomSheetSettings","FloatingToolbar","store","blockEditorStore","compose","withPreferredColorScheme","HTMLTextInput","KeyboardAvoidingView","NoticeList","Tooltip","__unstableAutocompletionItemsSlot","AutocompletionItemsSlot","AutosaveMonitor","OfflineStatus","editorStore","sendNativeEditorDidLayout","styles","headerToolbarStyles","Header","VisualEditor","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Layout","constructor","arguments","onSafeAreaInsetsUpdate","bind","onRootViewLayout","state","rootViewHeight","safeAreaInsets","top","bottom","right","left","getSafeAreaInsetsForRootView","then","componentDidMount","_isMounted","safeAreaSubscription","addEventListener","componentWillUnmount","remove","result","setState","event","setHeightState","height","nativeEvent","layout","renderHTML","globalStyles","props","parentHeight","style","renderVisual","isReady","setTitleRef","render","getStylesFromColorScheme","mode","isHtmlView","marginBottom","OS","containerStyles","container","containerDark","toolbarKeyboardAvoidingViewStyle","toolbarKeyboardAvoidingView","backgroundColor","editorStyles","background","backgroundDark","Slot","children","onLayout","disableIntervalChecks","flex","flexBasis","withAnimatedHeight","select","__unstableIsEditorReady","isEditorReady","getEditorMode","getSettings","__experimentalGlobalStylesBaseStyles","color"],"sources":["@wordpress/edit-post/src/components/layout/index.native.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport { Platform, SafeAreaView, View } from 'react-native';\r\nimport SafeArea from 'react-native-safe-area';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { Component } from '@wordpress/element';\r\nimport { withSelect } from '@wordpress/data';\r\nimport {\r\n\tBottomSheetSettings,\r\n\tFloatingToolbar,\r\n\tstore as blockEditorStore,\r\n} from '@wordpress/block-editor';\r\nimport { compose, withPreferredColorScheme } from '@wordpress/compose';\r\nimport {\r\n\tHTMLTextInput,\r\n\tKeyboardAvoidingView,\r\n\tNoticeList,\r\n\tTooltip,\r\n\t__unstableAutocompletionItemsSlot as AutocompletionItemsSlot,\r\n} from '@wordpress/components';\r\nimport {\r\n\tAutosaveMonitor,\r\n\tOfflineStatus,\r\n\tstore as editorStore,\r\n} from '@wordpress/editor';\r\nimport { sendNativeEditorDidLayout } from '@wordpress/react-native-bridge';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport styles from './style.scss';\r\nimport headerToolbarStyles from '../header/header-toolbar/style.scss';\r\nimport Header from '../header';\r\nimport VisualEditor from '../visual-editor';\r\n\r\nclass Layout extends Component {\r\n\tconstructor() {\r\n\t\tsuper( ...arguments );\r\n\r\n\t\tthis.onSafeAreaInsetsUpdate = this.onSafeAreaInsetsUpdate.bind( this );\r\n\t\tthis.onRootViewLayout = this.onRootViewLayout.bind( this );\r\n\r\n\t\tthis.state = {\r\n\t\t\trootViewHeight: 0,\r\n\t\t\tsafeAreaInsets: { top: 0, bottom: 0, right: 0, left: 0 },\r\n\t\t};\r\n\r\n\t\tSafeArea.getSafeAreaInsetsForRootView().then(\r\n\t\t\tthis.onSafeAreaInsetsUpdate\r\n\t\t);\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis._isMounted = true;\r\n\t\tthis.safeAreaSubscription = SafeArea.addEventListener(\r\n\t\t\t'safeAreaInsetsForRootViewDidChange',\r\n\t\t\tthis.onSafeAreaInsetsUpdate\r\n\t\t);\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tthis.safeAreaSubscription?.remove();\r\n\t\tthis._isMounted = false;\r\n\t}\r\n\r\n\tonSafeAreaInsetsUpdate( result ) {\r\n\t\tconst { safeAreaInsets } = result;\r\n\t\tif ( this._isMounted ) {\r\n\t\t\tthis.setState( { safeAreaInsets } );\r\n\t\t}\r\n\t}\r\n\r\n\tonRootViewLayout( event ) {\r\n\t\tif ( this._isMounted ) {\r\n\t\t\tthis.setHeightState( event );\r\n\t\t}\r\n\t}\r\n\r\n\tsetHeightState( event ) {\r\n\t\tconst { height } = event.nativeEvent.layout;\r\n\t\tif ( height !== this.state.rootViewHeight ) {\r\n\t\t\tthis.setState(\r\n\t\t\t\t{ rootViewHeight: height },\r\n\t\t\t\tsendNativeEditorDidLayout\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\trenderHTML() {\r\n\t\tconst { globalStyles } = this.props;\r\n\t\treturn (\r\n\t\t\t<HTMLTextInput\r\n\t\t\t\tparentHeight={ this.state.rootViewHeight }\r\n\t\t\t\tstyle={ globalStyles }\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n\r\n\trenderVisual() {\r\n\t\tconst { isReady } = this.props;\r\n\r\n\t\tif ( ! isReady ) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn <VisualEditor setTitleRef={ this.props.setTitleRef } />;\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { getStylesFromColorScheme, mode, globalStyles } = this.props;\r\n\r\n\t\tconst isHtmlView = mode === 'text';\r\n\r\n\t\t// Add a margin view at the bottom for the header.\r\n\t\tconst marginBottom =\r\n\t\t\tPlatform.OS === 'android' && ! isHtmlView\r\n\t\t\t\t? headerToolbarStyles[ 'header-toolbar__container' ].height\r\n\t\t\t\t: 0;\r\n\r\n\t\tconst containerStyles = getStylesFromColorScheme(\r\n\t\t\tstyles.container,\r\n\t\t\tstyles.containerDark\r\n\t\t);\r\n\r\n\t\tconst toolbarKeyboardAvoidingViewStyle = {\r\n\t\t\t...styles.toolbarKeyboardAvoidingView,\r\n\t\t\tleft: this.state.safeAreaInsets.left,\r\n\t\t\tright: this.state.safeAreaInsets.right,\r\n\t\t\tbottom: this.state.safeAreaInsets.bottom,\r\n\t\t\tbackgroundColor: containerStyles.backgroundColor,\r\n\t\t};\r\n\r\n\t\tconst editorStyles = [\r\n\t\t\tgetStylesFromColorScheme(\r\n\t\t\t\tstyles.background,\r\n\t\t\t\tstyles.backgroundDark\r\n\t\t\t),\r\n\t\t\tglobalStyles?.background && {\r\n\t\t\t\tbackgroundColor: globalStyles.background,\r\n\t\t\t},\r\n\t\t];\r\n\r\n\t\treturn (\r\n\t\t\t<Tooltip.Slot>\r\n\t\t\t\t<SafeAreaView\r\n\t\t\t\t\tstyle={ containerStyles }\r\n\t\t\t\t\tonLayout={ this.onRootViewLayout }\r\n\t\t\t\t>\r\n\t\t\t\t\t<AutosaveMonitor disableIntervalChecks />\r\n\t\t\t\t\t<OfflineStatus />\r\n\t\t\t\t\t<View style={ editorStyles }>\r\n\t\t\t\t\t\t{ isHtmlView ? this.renderHTML() : this.renderVisual() }\r\n\t\t\t\t\t\t{ ! isHtmlView && Platform.OS === 'android' && (\r\n\t\t\t\t\t\t\t<FloatingToolbar />\r\n\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t<NoticeList />\r\n\t\t\t\t\t</View>\r\n\t\t\t\t\t<View\r\n\t\t\t\t\t\tstyle={ {\r\n\t\t\t\t\t\t\tflex: 0,\r\n\t\t\t\t\t\t\tflexBasis: marginBottom,\r\n\t\t\t\t\t\t\theight: marginBottom,\r\n\t\t\t\t\t\t} }\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t{ ! isHtmlView && (\r\n\t\t\t\t\t\t<KeyboardAvoidingView\r\n\t\t\t\t\t\t\tparentHeight={ this.state.rootViewHeight }\r\n\t\t\t\t\t\t\tstyle={ toolbarKeyboardAvoidingViewStyle }\r\n\t\t\t\t\t\t\twithAnimatedHeight\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{ Platform.OS === 'ios' && (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t<AutocompletionItemsSlot />\r\n\t\t\t\t\t\t\t\t\t<FloatingToolbar />\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\t<Header />\r\n\t\t\t\t\t\t\t<BottomSheetSettings />\r\n\t\t\t\t\t\t</KeyboardAvoidingView>\r\n\t\t\t\t\t) }\r\n\t\t\t\t\t{ Platform.OS === 'android' && <AutocompletionItemsSlot /> }\r\n\t\t\t\t</SafeAreaView>\r\n\t\t\t</Tooltip.Slot>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default compose( [\r\n\twithSelect( ( select ) => {\r\n\t\tconst { __unstableIsEditorReady: isEditorReady, getEditorMode } =\r\n\t\t\tselect( editorStore );\r\n\t\tconst { getSettings } = select( blockEditorStore );\r\n\t\tconst globalStyles =\r\n\t\t\tgetSettings()?.__experimentalGlobalStylesBaseStyles?.color;\r\n\r\n\t\treturn {\r\n\t\t\tisReady: isEditorReady(),\r\n\t\t\tmode: getEditorMode(),\r\n\t\t\tglobalStyles,\r\n\t\t};\r\n\t} ),\r\n\twithPreferredColorScheme,\r\n] )( Layout );\r\n"],"mappings":"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","ignoreList":[]}