{"version":3,"names":["useRegistry","useRefEffect","store","blockEditorStore","isUnmodifiedDefaultBlock","usePaddingAppender","registry","node","onMouseDown","event","target","ownerDocument","defaultView","pseudoHeight","parseInt","getComputedStyle","height","lastChild","lastElementChild","lastChildRect","getBoundingClientRect","clientY","bottom","stopPropagation","blockOrder","select","getBlockOrder","lastBlockClientId","length","lastBlock","getBlock","selectBlock","insertDefaultBlock","dispatch","addEventListener","removeEventListener"],"sources":["@wordpress/edit-post/src/components/layout/use-padding-appender.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useRegistry } from '@wordpress/data';\r\nimport { useRefEffect } from '@wordpress/compose';\r\nimport { store as blockEditorStore } from '@wordpress/block-editor';\r\nimport { isUnmodifiedDefaultBlock } from '@wordpress/blocks';\r\n\r\nexport function usePaddingAppender() {\r\n\tconst registry = useRegistry();\r\n\treturn useRefEffect(\r\n\t\t( node ) => {\r\n\t\t\tfunction onMouseDown( event ) {\r\n\t\t\t\tif ( event.target !== node ) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst { ownerDocument } = node;\r\n\t\t\t\tconst { defaultView } = ownerDocument;\r\n\r\n\t\t\t\tconst pseudoHeight = defaultView.parseInt(\r\n\t\t\t\t\tdefaultView.getComputedStyle( node, ':after' ).height,\r\n\t\t\t\t\t10\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif ( ! pseudoHeight ) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Only handle clicks under the last child.\r\n\t\t\t\tconst lastChild = node.lastElementChild;\r\n\t\t\t\tif ( ! lastChild ) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst lastChildRect = lastChild.getBoundingClientRect();\r\n\t\t\t\tif ( event.clientY < lastChildRect.bottom ) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tevent.stopPropagation();\r\n\r\n\t\t\t\tconst blockOrder = registry\r\n\t\t\t\t\t.select( blockEditorStore )\r\n\t\t\t\t\t.getBlockOrder( '' );\r\n\t\t\t\tconst lastBlockClientId = blockOrder[ blockOrder.length - 1 ];\r\n\r\n\t\t\t\tconst lastBlock = registry\r\n\t\t\t\t\t.select( blockEditorStore )\r\n\t\t\t\t\t.getBlock( lastBlockClientId );\r\n\t\t\t\tconst { selectBlock, insertDefaultBlock } =\r\n\t\t\t\t\tregistry.dispatch( blockEditorStore );\r\n\r\n\t\t\t\tif ( lastBlock && isUnmodifiedDefaultBlock( lastBlock ) ) {\r\n\t\t\t\t\tselectBlock( lastBlockClientId );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tinsertDefaultBlock();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tnode.addEventListener( 'mousedown', onMouseDown );\r\n\t\t\treturn () => {\r\n\t\t\t\tnode.removeEventListener( 'mousedown', onMouseDown );\r\n\t\t\t};\r\n\t\t},\r\n\t\t[ registry ]\r\n\t);\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,WAAW,QAAQ,iBAAiB;AAC7C,SAASC,YAAY,QAAQ,oBAAoB;AACjD,SAASC,KAAK,IAAIC,gBAAgB,QAAQ,yBAAyB;AACnE,SAASC,wBAAwB,QAAQ,mBAAmB;AAE5D,OAAO,SAASC,kBAAkBA,CAAA,EAAG;EACpC,MAAMC,QAAQ,GAAGN,WAAW,CAAC,CAAC;EAC9B,OAAOC,YAAY,CAChBM,IAAI,IAAM;IACX,SAASC,WAAWA,CAAEC,KAAK,EAAG;MAC7B,IAAKA,KAAK,CAACC,MAAM,KAAKH,IAAI,EAAG;QAC5B;MACD;MAEA,MAAM;QAAEI;MAAc,CAAC,GAAGJ,IAAI;MAC9B,MAAM;QAAEK;MAAY,CAAC,GAAGD,aAAa;MAErC,MAAME,YAAY,GAAGD,WAAW,CAACE,QAAQ,CACxCF,WAAW,CAACG,gBAAgB,CAAER,IAAI,EAAE,QAAS,CAAC,CAACS,MAAM,EACrD,EACD,CAAC;MAED,IAAK,CAAEH,YAAY,EAAG;QACrB;MACD;;MAEA;MACA,MAAMI,SAAS,GAAGV,IAAI,CAACW,gBAAgB;MACvC,IAAK,CAAED,SAAS,EAAG;QAClB;MACD;MAEA,MAAME,aAAa,GAAGF,SAAS,CAACG,qBAAqB,CAAC,CAAC;MACvD,IAAKX,KAAK,CAACY,OAAO,GAAGF,aAAa,CAACG,MAAM,EAAG;QAC3C;MACD;MAEAb,KAAK,CAACc,eAAe,CAAC,CAAC;MAEvB,MAAMC,UAAU,GAAGlB,QAAQ,CACzBmB,MAAM,CAAEtB,gBAAiB,CAAC,CAC1BuB,aAAa,CAAE,EAAG,CAAC;MACrB,MAAMC,iBAAiB,GAAGH,UAAU,CAAEA,UAAU,CAACI,MAAM,GAAG,CAAC,CAAE;MAE7D,MAAMC,SAAS,GAAGvB,QAAQ,CACxBmB,MAAM,CAAEtB,gBAAiB,CAAC,CAC1B2B,QAAQ,CAAEH,iBAAkB,CAAC;MAC/B,MAAM;QAAEI,WAAW;QAAEC;MAAmB,CAAC,GACxC1B,QAAQ,CAAC2B,QAAQ,CAAE9B,gBAAiB,CAAC;MAEtC,IAAK0B,SAAS,IAAIzB,wBAAwB,CAAEyB,SAAU,CAAC,EAAG;QACzDE,WAAW,CAAEJ,iBAAkB,CAAC;MACjC,CAAC,MAAM;QACNK,kBAAkB,CAAC,CAAC;MACrB;IACD;IACAzB,IAAI,CAAC2B,gBAAgB,CAAE,WAAW,EAAE1B,WAAY,CAAC;IACjD,OAAO,MAAM;MACZD,IAAI,CAAC4B,mBAAmB,CAAE,WAAW,EAAE3B,WAAY,CAAC;IACrD,CAAC;EACF,CAAC,EACD,CAAEF,QAAQ,CACX,CAAC;AACF","ignoreList":[]}