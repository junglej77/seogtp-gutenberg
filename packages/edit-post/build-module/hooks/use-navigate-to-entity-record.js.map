{"version":3,"names":["useCallback","useReducer","useSelect","useDispatch","store","editorStore","useNavigateToEntityRecord","initialPostId","initialPostType","defaultRenderingMode","postHistory","dispatch","historyState","type","post","previousRenderingMode","length","slice","postId","postType","getRenderingMode","setRenderingMode","onNavigateToEntityRecord","params","onNavigateToPreviousEntityRecord","currentPost","undefined"],"sources":["@wordpress/edit-post/src/hooks/use-navigate-to-entity-record.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useCallback, useReducer } from '@wordpress/element';\r\nimport { useSelect, useDispatch } from '@wordpress/data';\r\nimport { store as editorStore } from '@wordpress/editor';\r\n\r\n/**\r\n * A hook that records the 'entity' history in the post editor as a user\r\n * navigates between editing a post and editing the post template or patterns.\r\n *\r\n * Implemented as a stack, so a little similar to the browser history API.\r\n *\r\n * Used to control displaying UI elements like the back button.\r\n *\r\n * @param {number} initialPostId        The post id of the post when the editor loaded.\r\n * @param {string} initialPostType      The post type of the post when the editor loaded.\r\n * @param {string} defaultRenderingMode The rendering mode to switch to when navigating.\r\n *\r\n * @return {Object} An object containing the `currentPost` variable and\r\n *                 `onNavigateToEntityRecord` and `onNavigateToPreviousEntityRecord` functions.\r\n */\r\nexport default function useNavigateToEntityRecord(\r\n\tinitialPostId,\r\n\tinitialPostType,\r\n\tdefaultRenderingMode\r\n) {\r\n\tconst [ postHistory, dispatch ] = useReducer(\r\n\t\t( historyState, { type, post, previousRenderingMode } ) => {\r\n\t\t\tif ( type === 'push' ) {\r\n\t\t\t\treturn [ ...historyState, { post, previousRenderingMode } ];\r\n\t\t\t}\r\n\t\t\tif ( type === 'pop' ) {\r\n\t\t\t\t// Try to leave one item in the history.\r\n\t\t\t\tif ( historyState.length > 1 ) {\r\n\t\t\t\t\treturn historyState.slice( 0, -1 );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn historyState;\r\n\t\t},\r\n\t\t[\r\n\t\t\t{\r\n\t\t\t\tpost: { postId: initialPostId, postType: initialPostType },\r\n\t\t\t},\r\n\t\t]\r\n\t);\r\n\r\n\tconst { post, previousRenderingMode } =\r\n\t\tpostHistory[ postHistory.length - 1 ];\r\n\r\n\tconst { getRenderingMode } = useSelect( editorStore );\r\n\tconst { setRenderingMode } = useDispatch( editorStore );\r\n\r\n\tconst onNavigateToEntityRecord = useCallback(\r\n\t\t( params ) => {\r\n\t\t\tdispatch( {\r\n\t\t\t\ttype: 'push',\r\n\t\t\t\tpost: { postId: params.postId, postType: params.postType },\r\n\t\t\t\t// Save the current rendering mode so we can restore it when navigating back.\r\n\t\t\t\tpreviousRenderingMode: getRenderingMode(),\r\n\t\t\t} );\r\n\t\t\tsetRenderingMode( defaultRenderingMode );\r\n\t\t},\r\n\t\t[ getRenderingMode, setRenderingMode, defaultRenderingMode ]\r\n\t);\r\n\r\n\tconst onNavigateToPreviousEntityRecord = useCallback( () => {\r\n\t\tdispatch( { type: 'pop' } );\r\n\t\tif ( previousRenderingMode ) {\r\n\t\t\tsetRenderingMode( previousRenderingMode );\r\n\t\t}\r\n\t}, [ setRenderingMode, previousRenderingMode ] );\r\n\r\n\treturn {\r\n\t\tcurrentPost: post,\r\n\t\tonNavigateToEntityRecord,\r\n\t\tonNavigateToPreviousEntityRecord:\r\n\t\t\tpostHistory.length > 1\r\n\t\t\t\t? onNavigateToPreviousEntityRecord\r\n\t\t\t\t: undefined,\r\n\t};\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,WAAW,EAAEC,UAAU,QAAQ,oBAAoB;AAC5D,SAASC,SAAS,EAAEC,WAAW,QAAQ,iBAAiB;AACxD,SAASC,KAAK,IAAIC,WAAW,QAAQ,mBAAmB;;AAExD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAASC,yBAAyBA,CAChDC,aAAa,EACbC,eAAe,EACfC,oBAAoB,EACnB;EACD,MAAM,CAAEC,WAAW,EAAEC,QAAQ,CAAE,GAAGV,UAAU,CAC3C,CAAEW,YAAY,EAAE;IAAEC,IAAI;IAAEC,IAAI;IAAEC;EAAsB,CAAC,KAAM;IAC1D,IAAKF,IAAI,KAAK,MAAM,EAAG;MACtB,OAAO,CAAE,GAAGD,YAAY,EAAE;QAAEE,IAAI;QAAEC;MAAsB,CAAC,CAAE;IAC5D;IACA,IAAKF,IAAI,KAAK,KAAK,EAAG;MACrB;MACA,IAAKD,YAAY,CAACI,MAAM,GAAG,CAAC,EAAG;QAC9B,OAAOJ,YAAY,CAACK,KAAK,CAAE,CAAC,EAAE,CAAC,CAAE,CAAC;MACnC;IACD;IACA,OAAOL,YAAY;EACpB,CAAC,EACD,CACC;IACCE,IAAI,EAAE;MAAEI,MAAM,EAAEX,aAAa;MAAEY,QAAQ,EAAEX;IAAgB;EAC1D,CAAC,CAEH,CAAC;EAED,MAAM;IAAEM,IAAI;IAAEC;EAAsB,CAAC,GACpCL,WAAW,CAAEA,WAAW,CAACM,MAAM,GAAG,CAAC,CAAE;EAEtC,MAAM;IAAEI;EAAiB,CAAC,GAAGlB,SAAS,CAAEG,WAAY,CAAC;EACrD,MAAM;IAAEgB;EAAiB,CAAC,GAAGlB,WAAW,CAAEE,WAAY,CAAC;EAEvD,MAAMiB,wBAAwB,GAAGtB,WAAW,CACzCuB,MAAM,IAAM;IACbZ,QAAQ,CAAE;MACTE,IAAI,EAAE,MAAM;MACZC,IAAI,EAAE;QAAEI,MAAM,EAAEK,MAAM,CAACL,MAAM;QAAEC,QAAQ,EAAEI,MAAM,CAACJ;MAAS,CAAC;MAC1D;MACAJ,qBAAqB,EAAEK,gBAAgB,CAAC;IACzC,CAAE,CAAC;IACHC,gBAAgB,CAAEZ,oBAAqB,CAAC;EACzC,CAAC,EACD,CAAEW,gBAAgB,EAAEC,gBAAgB,EAAEZ,oBAAoB,CAC3D,CAAC;EAED,MAAMe,gCAAgC,GAAGxB,WAAW,CAAE,MAAM;IAC3DW,QAAQ,CAAE;MAAEE,IAAI,EAAE;IAAM,CAAE,CAAC;IAC3B,IAAKE,qBAAqB,EAAG;MAC5BM,gBAAgB,CAAEN,qBAAsB,CAAC;IAC1C;EACD,CAAC,EAAE,CAAEM,gBAAgB,EAAEN,qBAAqB,CAAG,CAAC;EAEhD,OAAO;IACNU,WAAW,EAAEX,IAAI;IACjBQ,wBAAwB;IACxBE,gCAAgC,EAC/Bd,WAAW,CAACM,MAAM,GAAG,CAAC,GACnBQ,gCAAgC,GAChCE;EACL,CAAC;AACF","ignoreList":[]}