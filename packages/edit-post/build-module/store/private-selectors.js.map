{"version":3,"names":["createRegistrySelector","store","coreStore","editorStore","getEditedPostTemplateId","select","id","postId","type","postType","slug","getCurrentPost","getEntityRecord","getEntityRecords","canUser","siteSettings","kind","name","undefined","isPostsPage","page_for_posts","getDefaultTemplateId","currentTemplate","getEditedPostAttribute","templateWithSameSlug","per_page","find","template","slugToCheck"],"sources":["@wordpress/edit-post/src/store/private-selectors.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { createRegistrySelector } from '@wordpress/data';\r\nimport { store as coreStore } from '@wordpress/core-data';\r\nimport { store as editorStore } from '@wordpress/editor';\r\n\r\nexport const getEditedPostTemplateId = createRegistrySelector(\r\n\t( select ) => () => {\r\n\t\tconst {\r\n\t\t\tid: postId,\r\n\t\t\ttype: postType,\r\n\t\t\tslug,\r\n\t\t} = select( editorStore ).getCurrentPost();\r\n\t\tconst { getEntityRecord, getEntityRecords, canUser } =\r\n\t\t\tselect( coreStore );\r\n\t\tconst siteSettings = canUser( 'read', {\r\n\t\t\tkind: 'root',\r\n\t\t\tname: 'site',\r\n\t\t} )\r\n\t\t\t? getEntityRecord( 'root', 'site' )\r\n\t\t\t: undefined;\r\n\t\t// First check if the current page is set as the posts page.\r\n\t\tconst isPostsPage = +postId === siteSettings?.page_for_posts;\r\n\t\tif ( isPostsPage ) {\r\n\t\t\treturn select( coreStore ).getDefaultTemplateId( { slug: 'home' } );\r\n\t\t}\r\n\t\tconst currentTemplate =\r\n\t\t\tselect( editorStore ).getEditedPostAttribute( 'template' );\r\n\t\tif ( currentTemplate ) {\r\n\t\t\tconst templateWithSameSlug = getEntityRecords(\r\n\t\t\t\t'postType',\r\n\t\t\t\t'wp_template',\r\n\t\t\t\t{ per_page: -1 }\r\n\t\t\t)?.find( ( template ) => template.slug === currentTemplate );\r\n\t\t\tif ( ! templateWithSameSlug ) {\r\n\t\t\t\treturn templateWithSameSlug;\r\n\t\t\t}\r\n\t\t\treturn templateWithSameSlug.id;\r\n\t\t}\r\n\t\tlet slugToCheck;\r\n\t\t// In `draft` status we might not have a slug available, so we use the `single`\r\n\t\t// post type templates slug(ex page, single-post, single-product etc..).\r\n\t\t// Pages do not need the `single` prefix in the slug to be prioritized\r\n\t\t// through template hierarchy.\r\n\t\tif ( slug ) {\r\n\t\t\tslugToCheck =\r\n\t\t\t\tpostType === 'page'\r\n\t\t\t\t\t? `${ postType }-${ slug }`\r\n\t\t\t\t\t: `single-${ postType }-${ slug }`;\r\n\t\t} else {\r\n\t\t\tslugToCheck = postType === 'page' ? 'page' : `single-${ postType }`;\r\n\t\t}\r\n\r\n\t\tif ( postType ) {\r\n\t\t\treturn select( coreStore ).getDefaultTemplateId( {\r\n\t\t\t\tslug: slugToCheck,\r\n\t\t\t} );\r\n\t\t}\r\n\t}\r\n);\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,sBAAsB,QAAQ,iBAAiB;AACxD,SAASC,KAAK,IAAIC,SAAS,QAAQ,sBAAsB;AACzD,SAASD,KAAK,IAAIE,WAAW,QAAQ,mBAAmB;AAExD,OAAO,MAAMC,uBAAuB,GAAGJ,sBAAsB,CAC1DK,MAAM,IAAM,MAAM;EACnB,MAAM;IACLC,EAAE,EAAEC,MAAM;IACVC,IAAI,EAAEC,QAAQ;IACdC;EACD,CAAC,GAAGL,MAAM,CAAEF,WAAY,CAAC,CAACQ,cAAc,CAAC,CAAC;EAC1C,MAAM;IAAEC,eAAe;IAAEC,gBAAgB;IAAEC;EAAQ,CAAC,GACnDT,MAAM,CAAEH,SAAU,CAAC;EACpB,MAAMa,YAAY,GAAGD,OAAO,CAAE,MAAM,EAAE;IACrCE,IAAI,EAAE,MAAM;IACZC,IAAI,EAAE;EACP,CAAE,CAAC,GACAL,eAAe,CAAE,MAAM,EAAE,MAAO,CAAC,GACjCM,SAAS;EACZ;EACA,MAAMC,WAAW,GAAG,CAACZ,MAAM,KAAKQ,YAAY,EAAEK,cAAc;EAC5D,IAAKD,WAAW,EAAG;IAClB,OAAOd,MAAM,CAAEH,SAAU,CAAC,CAACmB,oBAAoB,CAAE;MAAEX,IAAI,EAAE;IAAO,CAAE,CAAC;EACpE;EACA,MAAMY,eAAe,GACpBjB,MAAM,CAAEF,WAAY,CAAC,CAACoB,sBAAsB,CAAE,UAAW,CAAC;EAC3D,IAAKD,eAAe,EAAG;IACtB,MAAME,oBAAoB,GAAGX,gBAAgB,CAC5C,UAAU,EACV,aAAa,EACb;MAAEY,QAAQ,EAAE,CAAC;IAAE,CAChB,CAAC,EAAEC,IAAI,CAAIC,QAAQ,IAAMA,QAAQ,CAACjB,IAAI,KAAKY,eAAgB,CAAC;IAC5D,IAAK,CAAEE,oBAAoB,EAAG;MAC7B,OAAOA,oBAAoB;IAC5B;IACA,OAAOA,oBAAoB,CAAClB,EAAE;EAC/B;EACA,IAAIsB,WAAW;EACf;EACA;EACA;EACA;EACA,IAAKlB,IAAI,EAAG;IACXkB,WAAW,GACVnB,QAAQ,KAAK,MAAM,GACf,GAAGA,QAAU,IAAIC,IAAM,EAAC,GACxB,UAAUD,QAAU,IAAIC,IAAM,EAAC;EACrC,CAAC,MAAM;IACNkB,WAAW,GAAGnB,QAAQ,KAAK,MAAM,GAAG,MAAM,GAAI,UAAUA,QAAU,EAAC;EACpE;EAEA,IAAKA,QAAQ,EAAG;IACf,OAAOJ,MAAM,CAAEH,SAAU,CAAC,CAACmB,oBAAoB,CAAE;MAChDX,IAAI,EAAEkB;IACP,CAAE,CAAC;EACJ;AACD,CACD,CAAC","ignoreList":[]}