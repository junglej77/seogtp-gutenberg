{"version":3,"names":["Button","Modal","__experimentalHStack","HStack","__experimentalVStack","VStack","TextControl","__","sprintf","useDispatch","useRegistry","useSelect","useState","store","coreStore","noticesStore","decodeEntities","serialize","synchronizeBlocksWithTemplate","jsx","_jsx","jsxs","_jsxs","AddNewPostModal","postType","onSave","onClose","labels","select","getPostType","isCreatingPost","setIsCreatingPost","title","setTitle","saveEntityRecord","createErrorNotice","createSuccessNotice","resolveSelect","createPost","event","preventDefault","postTypeObject","newPage","status","slug","content","template","length","undefined","throwOnError","rendered","type","error","errorMessage","message","code","singular_name","onRequestClose","focusOnMount","size","children","onSubmit","spacing","__next40pxDefaultSize","__nextHasNoMarginBottom","label","onChange","placeholder","value","justify","variant","onClick","isBusy"],"sources":["@wordpress/edit-site/src/components/add-new-post/index.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport {\r\n\tButton,\r\n\tModal,\r\n\t__experimentalHStack as HStack,\r\n\t__experimentalVStack as VStack,\r\n\tTextControl,\r\n} from '@wordpress/components';\r\nimport { __, sprintf } from '@wordpress/i18n';\r\nimport { useDispatch, useRegistry, useSelect } from '@wordpress/data';\r\nimport { useState } from '@wordpress/element';\r\nimport { store as coreStore } from '@wordpress/core-data';\r\nimport { store as noticesStore } from '@wordpress/notices';\r\nimport { decodeEntities } from '@wordpress/html-entities';\r\nimport { serialize, synchronizeBlocksWithTemplate } from '@wordpress/blocks';\r\n\r\nexport default function AddNewPostModal( { postType, onSave, onClose } ) {\r\n\tconst labels = useSelect(\r\n\t\t( select ) => select( coreStore ).getPostType( postType )?.labels,\r\n\t\t[ postType ]\r\n\t);\r\n\tconst [ isCreatingPost, setIsCreatingPost ] = useState( false );\r\n\tconst [ title, setTitle ] = useState( '' );\r\n\r\n\tconst { saveEntityRecord } = useDispatch( coreStore );\r\n\tconst { createErrorNotice, createSuccessNotice } =\r\n\t\tuseDispatch( noticesStore );\r\n\tconst { resolveSelect } = useRegistry();\r\n\r\n\tasync function createPost( event ) {\r\n\t\tevent.preventDefault();\r\n\r\n\t\tif ( isCreatingPost ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tsetIsCreatingPost( true );\r\n\t\ttry {\r\n\t\t\tconst postTypeObject =\r\n\t\t\t\tawait resolveSelect( coreStore ).getPostType( postType );\r\n\t\t\tconst newPage = await saveEntityRecord(\r\n\t\t\t\t'postType',\r\n\t\t\t\tpostType,\r\n\t\t\t\t{\r\n\t\t\t\t\tstatus: 'draft',\r\n\t\t\t\t\ttitle,\r\n\t\t\t\t\tslug: title || __( 'No title' ),\r\n\t\t\t\t\tcontent:\r\n\t\t\t\t\t\t!! postTypeObject.template &&\r\n\t\t\t\t\t\tpostTypeObject.template.length\r\n\t\t\t\t\t\t\t? serialize(\r\n\t\t\t\t\t\t\t\t\tsynchronizeBlocksWithTemplate(\r\n\t\t\t\t\t\t\t\t\t\t[],\r\n\t\t\t\t\t\t\t\t\t\tpostTypeObject.template\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t  )\r\n\t\t\t\t\t\t\t: undefined,\r\n\t\t\t\t},\r\n\t\t\t\t{ throwOnError: true }\r\n\t\t\t);\r\n\r\n\t\t\tonSave( newPage );\r\n\r\n\t\t\tcreateSuccessNotice(\r\n\t\t\t\tsprintf(\r\n\t\t\t\t\t// translators: %s: Title of the created post e.g: \"Hello world\".\r\n\t\t\t\t\t__( '\"%s\" successfully created.' ),\r\n\t\t\t\t\tdecodeEntities( newPage.title?.rendered || title )\r\n\t\t\t\t),\r\n\t\t\t\t{ type: 'snackbar' }\r\n\t\t\t);\r\n\t\t} catch ( error ) {\r\n\t\t\tconst errorMessage =\r\n\t\t\t\terror.message && error.code !== 'unknown_error'\r\n\t\t\t\t\t? error.message\r\n\t\t\t\t\t: __( 'An error occurred while creating the item.' );\r\n\r\n\t\t\tcreateErrorNotice( errorMessage, {\r\n\t\t\t\ttype: 'snackbar',\r\n\t\t\t} );\r\n\t\t} finally {\r\n\t\t\tsetIsCreatingPost( false );\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Modal\r\n\t\t\ttitle={\r\n\t\t\t\t// translators: %s: post type singular_name label e.g: \"Page\".\r\n\t\t\t\tsprintf( __( 'Draft new: %s' ), labels?.singular_name )\r\n\t\t\t}\r\n\t\t\tonRequestClose={ onClose }\r\n\t\t\tfocusOnMount=\"firstContentElement\"\r\n\t\t\tsize=\"small\"\r\n\t\t>\r\n\t\t\t<form onSubmit={ createPost }>\r\n\t\t\t\t<VStack spacing={ 4 }>\r\n\t\t\t\t\t<TextControl\r\n\t\t\t\t\t\t__next40pxDefaultSize\r\n\t\t\t\t\t\t__nextHasNoMarginBottom\r\n\t\t\t\t\t\tlabel={ __( 'Title' ) }\r\n\t\t\t\t\t\tonChange={ setTitle }\r\n\t\t\t\t\t\tplaceholder={ __( 'No title' ) }\r\n\t\t\t\t\t\tvalue={ title }\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<HStack spacing={ 2 } justify=\"end\">\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t__next40pxDefaultSize\r\n\t\t\t\t\t\t\tvariant=\"tertiary\"\r\n\t\t\t\t\t\t\tonClick={ onClose }\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{ __( 'Cancel' ) }\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t__next40pxDefaultSize\r\n\t\t\t\t\t\t\tvariant=\"primary\"\r\n\t\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\t\tisBusy={ isCreatingPost }\r\n\t\t\t\t\t\t\taria-disabled={ isCreatingPost }\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{ __( 'Create draft' ) }\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</HStack>\r\n\t\t\t\t</VStack>\r\n\t\t\t</form>\r\n\t\t</Modal>\r\n\t);\r\n}\r\n"],"mappings":"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","ignoreList":[]}