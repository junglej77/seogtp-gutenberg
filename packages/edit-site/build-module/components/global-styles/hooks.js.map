{"version":3,"names":["colord","extend","a11yPlugin","store","blocksStore","privateApis","blockEditorPrivateApis","unlock","useSelect","useGlobalSetting","useGlobalStyle","useColorRandomizer","name","themeColors","setThemeColors","randomizeColors","randomRotationValue","Math","floor","random","newColors","map","colorObject","color","newColor","rotate","toHex","window","__experimentalEnableColorRandomizer","useStylesPreviewColors","textColor","backgroundColor","headingColor","linkColor","buttonBackgroundColor","coreColors","customColors","paletteColors","concat","textColorObject","filter","buttonBackgroundColorObject","highlightedColors","slice","useSupportedStyles","element","supportedPanels","select","getSupportedStyles"],"sources":["@wordpress/edit-site/src/components/global-styles/hooks.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport { colord, extend } from 'colord';\r\nimport a11yPlugin from 'colord/plugins/a11y';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { store as blocksStore } from '@wordpress/blocks';\r\nimport { privateApis as blockEditorPrivateApis } from '@wordpress/block-editor';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { unlock } from '../../lock-unlock';\r\nimport { useSelect } from '@wordpress/data';\r\n\r\nconst { useGlobalSetting, useGlobalStyle } = unlock( blockEditorPrivateApis );\r\n\r\n// Enable colord's a11y plugin.\r\nextend( [ a11yPlugin ] );\r\n\r\nexport function useColorRandomizer( name ) {\r\n\tconst [ themeColors, setThemeColors ] = useGlobalSetting(\r\n\t\t'color.palette.theme',\r\n\t\tname\r\n\t);\r\n\r\n\tfunction randomizeColors() {\r\n\t\t/* eslint-disable no-restricted-syntax */\r\n\t\tconst randomRotationValue = Math.floor( Math.random() * 225 );\r\n\t\t/* eslint-enable no-restricted-syntax */\r\n\r\n\t\tconst newColors = themeColors.map( ( colorObject ) => {\r\n\t\t\tconst { color } = colorObject;\r\n\t\t\tconst newColor = colord( color )\r\n\t\t\t\t.rotate( randomRotationValue )\r\n\t\t\t\t.toHex();\r\n\r\n\t\t\treturn {\r\n\t\t\t\t...colorObject,\r\n\t\t\t\tcolor: newColor,\r\n\t\t\t};\r\n\t\t} );\r\n\r\n\t\tsetThemeColors( newColors );\r\n\t}\r\n\r\n\treturn window.__experimentalEnableColorRandomizer\r\n\t\t? [ randomizeColors ]\r\n\t\t: [];\r\n}\r\n\r\nexport function useStylesPreviewColors() {\r\n\tconst [ textColor = 'black' ] = useGlobalStyle( 'color.text' );\r\n\tconst [ backgroundColor = 'white' ] = useGlobalStyle( 'color.background' );\r\n\tconst [ headingColor = textColor ] = useGlobalStyle(\r\n\t\t'elements.h1.color.text'\r\n\t);\r\n\tconst [ linkColor = headingColor ] = useGlobalStyle(\r\n\t\t'elements.link.color.text'\r\n\t);\r\n\r\n\tconst [ buttonBackgroundColor = linkColor ] = useGlobalStyle(\r\n\t\t'elements.button.color.background'\r\n\t);\r\n\tconst [ coreColors ] = useGlobalSetting( 'color.palette.core' );\r\n\tconst [ themeColors ] = useGlobalSetting( 'color.palette.theme' );\r\n\tconst [ customColors ] = useGlobalSetting( 'color.palette.custom' );\r\n\r\n\tconst paletteColors = ( themeColors ?? [] )\r\n\t\t.concat( customColors ?? [] )\r\n\t\t.concat( coreColors ?? [] );\r\n\r\n\tconst textColorObject = paletteColors.filter(\r\n\t\t( { color } ) => color === textColor\r\n\t);\r\n\tconst buttonBackgroundColorObject = paletteColors.filter(\r\n\t\t( { color } ) => color === buttonBackgroundColor\r\n\t);\r\n\r\n\tconst highlightedColors = textColorObject\r\n\t\t.concat( buttonBackgroundColorObject )\r\n\t\t.concat( paletteColors )\r\n\t\t.filter(\r\n\t\t\t// we exclude these background color because it is already visible in the preview.\r\n\t\t\t( { color } ) => color !== backgroundColor\r\n\t\t)\r\n\t\t.slice( 0, 2 );\r\n\r\n\treturn {\r\n\t\tpaletteColors,\r\n\t\thighlightedColors,\r\n\t};\r\n}\r\n\r\nexport function useSupportedStyles( name, element ) {\r\n\tconst { supportedPanels } = useSelect(\r\n\t\t( select ) => {\r\n\t\t\treturn {\r\n\t\t\t\tsupportedPanels: unlock(\r\n\t\t\t\t\tselect( blocksStore )\r\n\t\t\t\t).getSupportedStyles( name, element ),\r\n\t\t\t};\r\n\t\t},\r\n\t\t[ name, element ]\r\n\t);\r\n\r\n\treturn supportedPanels;\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,MAAM,EAAEC,MAAM,QAAQ,QAAQ;AACvC,OAAOC,UAAU,MAAM,qBAAqB;;AAE5C;AACA;AACA;AACA,SAASC,KAAK,IAAIC,WAAW,QAAQ,mBAAmB;AACxD,SAASC,WAAW,IAAIC,sBAAsB,QAAQ,yBAAyB;;AAE/E;AACA;AACA;AACA,SAASC,MAAM,QAAQ,mBAAmB;AAC1C,SAASC,SAAS,QAAQ,iBAAiB;AAE3C,MAAM;EAAEC,gBAAgB;EAAEC;AAAe,CAAC,GAAGH,MAAM,CAAED,sBAAuB,CAAC;;AAE7E;AACAL,MAAM,CAAE,CAAEC,UAAU,CAAG,CAAC;AAExB,OAAO,SAASS,kBAAkBA,CAAEC,IAAI,EAAG;EAC1C,MAAM,CAAEC,WAAW,EAAEC,cAAc,CAAE,GAAGL,gBAAgB,CACvD,qBAAqB,EACrBG,IACD,CAAC;EAED,SAASG,eAAeA,CAAA,EAAG;IAC1B;IACA,MAAMC,mBAAmB,GAAGC,IAAI,CAACC,KAAK,CAAED,IAAI,CAACE,MAAM,CAAC,CAAC,GAAG,GAAI,CAAC;IAC7D;;IAEA,MAAMC,SAAS,GAAGP,WAAW,CAACQ,GAAG,CAAIC,WAAW,IAAM;MACrD,MAAM;QAAEC;MAAM,CAAC,GAAGD,WAAW;MAC7B,MAAME,QAAQ,GAAGxB,MAAM,CAAEuB,KAAM,CAAC,CAC9BE,MAAM,CAAET,mBAAoB,CAAC,CAC7BU,KAAK,CAAC,CAAC;MAET,OAAO;QACN,GAAGJ,WAAW;QACdC,KAAK,EAAEC;MACR,CAAC;IACF,CAAE,CAAC;IAEHV,cAAc,CAAEM,SAAU,CAAC;EAC5B;EAEA,OAAOO,MAAM,CAACC,mCAAmC,GAC9C,CAAEb,eAAe,CAAE,GACnB,EAAE;AACN;AAEA,OAAO,SAASc,sBAAsBA,CAAA,EAAG;EACxC,MAAM,CAAEC,SAAS,GAAG,OAAO,CAAE,GAAGpB,cAAc,CAAE,YAAa,CAAC;EAC9D,MAAM,CAAEqB,eAAe,GAAG,OAAO,CAAE,GAAGrB,cAAc,CAAE,kBAAmB,CAAC;EAC1E,MAAM,CAAEsB,YAAY,GAAGF,SAAS,CAAE,GAAGpB,cAAc,CAClD,wBACD,CAAC;EACD,MAAM,CAAEuB,SAAS,GAAGD,YAAY,CAAE,GAAGtB,cAAc,CAClD,0BACD,CAAC;EAED,MAAM,CAAEwB,qBAAqB,GAAGD,SAAS,CAAE,GAAGvB,cAAc,CAC3D,kCACD,CAAC;EACD,MAAM,CAAEyB,UAAU,CAAE,GAAG1B,gBAAgB,CAAE,oBAAqB,CAAC;EAC/D,MAAM,CAAEI,WAAW,CAAE,GAAGJ,gBAAgB,CAAE,qBAAsB,CAAC;EACjE,MAAM,CAAE2B,YAAY,CAAE,GAAG3B,gBAAgB,CAAE,sBAAuB,CAAC;EAEnE,MAAM4B,aAAa,GAAG,CAAExB,WAAW,aAAXA,WAAW,cAAXA,WAAW,GAAI,EAAE,EACvCyB,MAAM,CAAEF,YAAY,aAAZA,YAAY,cAAZA,YAAY,GAAI,EAAG,CAAC,CAC5BE,MAAM,CAAEH,UAAU,aAAVA,UAAU,cAAVA,UAAU,GAAI,EAAG,CAAC;EAE5B,MAAMI,eAAe,GAAGF,aAAa,CAACG,MAAM,CAC3C,CAAE;IAAEjB;EAAM,CAAC,KAAMA,KAAK,KAAKO,SAC5B,CAAC;EACD,MAAMW,2BAA2B,GAAGJ,aAAa,CAACG,MAAM,CACvD,CAAE;IAAEjB;EAAM,CAAC,KAAMA,KAAK,KAAKW,qBAC5B,CAAC;EAED,MAAMQ,iBAAiB,GAAGH,eAAe,CACvCD,MAAM,CAAEG,2BAA4B,CAAC,CACrCH,MAAM,CAAED,aAAc,CAAC,CACvBG,MAAM;EACN;EACA,CAAE;IAAEjB;EAAM,CAAC,KAAMA,KAAK,KAAKQ,eAC5B,CAAC,CACAY,KAAK,CAAE,CAAC,EAAE,CAAE,CAAC;EAEf,OAAO;IACNN,aAAa;IACbK;EACD,CAAC;AACF;AAEA,OAAO,SAASE,kBAAkBA,CAAEhC,IAAI,EAAEiC,OAAO,EAAG;EACnD,MAAM;IAAEC;EAAgB,CAAC,GAAGtC,SAAS,CAClCuC,MAAM,IAAM;IACb,OAAO;MACND,eAAe,EAAEvC,MAAM,CACtBwC,MAAM,CAAE3C,WAAY,CACrB,CAAC,CAAC4C,kBAAkB,CAAEpC,IAAI,EAAEiC,OAAQ;IACrC,CAAC;EACF,CAAC,EACD,CAAEjC,IAAI,EAAEiC,OAAO,CAChB,CAAC;EAED,OAAOC,eAAe;AACvB","ignoreList":[]}