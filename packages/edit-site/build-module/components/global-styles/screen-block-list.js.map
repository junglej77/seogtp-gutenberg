{"version":3,"names":["store","blocksStore","__","sprintf","_n","FlexItem","SearchControl","__experimentalHStack","HStack","useSelect","useState","useEffect","useRef","useDeferredValue","memo","BlockIcon","privateApis","blockEditorPrivateApis","useDebounce","speak","useBlockVariations","ScreenHeader","NavigationButtonAsItem","unlock","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","useHasDimensionsPanel","useHasTypographyPanel","useHasBorderPanel","useGlobalSetting","useSettingsForBlockElement","useHasColorPanel","useSortedBlockTypes","blockItems","select","getBlockTypes","groupByType","blocks","block","core","noncore","type","name","startsWith","push","coreItems","nonCoreItems","reduce","useBlockHasGlobalStyles","blockName","rawSettings","settings","hasTypographyPanel","hasColorPanel","hasBorderPanel","hasDimensionsPanel","hasLayoutPanel","hasVariationsPanel","length","hasGlobalStyles","BlockMenuItem","hasBlockMenuItem","navigationButtonLabel","title","path","encodeURIComponent","children","justify","icon","BlockList","filterValue","sortedBlockTypes","debouncedSpeak","isMatchingSearchTerm","filteredBlockTypes","filter","blockType","blockTypesListRef","count","current","childElementCount","resultsFoundMessage","ref","className","map","MemoizedBlockList","ScreenBlockList","setFilterValue","deferredFilterValue","description","__nextHasNoMarginBottom","onChange","value","label","placeholder"],"sources":["@wordpress/edit-site/src/components/global-styles/screen-block-list.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { store as blocksStore } from '@wordpress/blocks';\r\nimport { __, sprintf, _n } from '@wordpress/i18n';\r\nimport {\r\n\tFlexItem,\r\n\tSearchControl,\r\n\t__experimentalHStack as HStack,\r\n} from '@wordpress/components';\r\nimport { useSelect } from '@wordpress/data';\r\nimport {\r\n\tuseState,\r\n\tuseEffect,\r\n\tuseRef,\r\n\tuseDeferredValue,\r\n\tmemo,\r\n} from '@wordpress/element';\r\nimport {\r\n\tBlockIcon,\r\n\tprivateApis as blockEditorPrivateApis,\r\n} from '@wordpress/block-editor';\r\nimport { useDebounce } from '@wordpress/compose';\r\nimport { speak } from '@wordpress/a11y';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { useBlockVariations } from './variations/variations-panel';\r\nimport ScreenHeader from './header';\r\nimport { NavigationButtonAsItem } from './navigation-button';\r\nimport { unlock } from '../../lock-unlock';\r\n\r\nconst {\r\n\tuseHasDimensionsPanel,\r\n\tuseHasTypographyPanel,\r\n\tuseHasBorderPanel,\r\n\tuseGlobalSetting,\r\n\tuseSettingsForBlockElement,\r\n\tuseHasColorPanel,\r\n} = unlock( blockEditorPrivateApis );\r\n\r\nfunction useSortedBlockTypes() {\r\n\tconst blockItems = useSelect(\r\n\t\t( select ) => select( blocksStore ).getBlockTypes(),\r\n\t\t[]\r\n\t);\r\n\t// Ensure core blocks are prioritized in the returned results,\r\n\t// because third party blocks can be registered earlier than\r\n\t// the core blocks (usually by using the `init` action),\r\n\t// thus affecting the display order.\r\n\t// We don't sort reusable blocks as they are handled differently.\r\n\tconst groupByType = ( blocks, block ) => {\r\n\t\tconst { core, noncore } = blocks;\r\n\t\tconst type = block.name.startsWith( 'core/' ) ? core : noncore;\r\n\t\ttype.push( block );\r\n\t\treturn blocks;\r\n\t};\r\n\tconst { core: coreItems, noncore: nonCoreItems } = blockItems.reduce(\r\n\t\tgroupByType,\r\n\t\t{ core: [], noncore: [] }\r\n\t);\r\n\treturn [ ...coreItems, ...nonCoreItems ];\r\n}\r\n\r\nexport function useBlockHasGlobalStyles( blockName ) {\r\n\tconst [ rawSettings ] = useGlobalSetting( '', blockName );\r\n\tconst settings = useSettingsForBlockElement( rawSettings, blockName );\r\n\tconst hasTypographyPanel = useHasTypographyPanel( settings );\r\n\tconst hasColorPanel = useHasColorPanel( settings );\r\n\tconst hasBorderPanel = useHasBorderPanel( settings );\r\n\tconst hasDimensionsPanel = useHasDimensionsPanel( settings );\r\n\tconst hasLayoutPanel = hasBorderPanel || hasDimensionsPanel;\r\n\tconst hasVariationsPanel = !! useBlockVariations( blockName )?.length;\r\n\tconst hasGlobalStyles =\r\n\t\thasTypographyPanel ||\r\n\t\thasColorPanel ||\r\n\t\thasLayoutPanel ||\r\n\t\thasVariationsPanel;\r\n\treturn hasGlobalStyles;\r\n}\r\n\r\nfunction BlockMenuItem( { block } ) {\r\n\tconst hasBlockMenuItem = useBlockHasGlobalStyles( block.name );\r\n\tif ( ! hasBlockMenuItem ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconst navigationButtonLabel = sprintf(\r\n\t\t// translators: %s: is the name of a block e.g., 'Image' or 'Table'.\r\n\t\t__( '%s block styles' ),\r\n\t\tblock.title\r\n\t);\r\n\r\n\treturn (\r\n\t\t<NavigationButtonAsItem\r\n\t\t\tpath={ '/blocks/' + encodeURIComponent( block.name ) }\r\n\t\t\taria-label={ navigationButtonLabel }\r\n\t\t>\r\n\t\t\t<HStack justify=\"flex-start\">\r\n\t\t\t\t<BlockIcon icon={ block.icon } />\r\n\t\t\t\t<FlexItem>{ block.title }</FlexItem>\r\n\t\t\t</HStack>\r\n\t\t</NavigationButtonAsItem>\r\n\t);\r\n}\r\n\r\nfunction BlockList( { filterValue } ) {\r\n\tconst sortedBlockTypes = useSortedBlockTypes();\r\n\tconst debouncedSpeak = useDebounce( speak, 500 );\r\n\tconst { isMatchingSearchTerm } = useSelect( blocksStore );\r\n\r\n\tconst filteredBlockTypes = ! filterValue\r\n\t\t? sortedBlockTypes\r\n\t\t: sortedBlockTypes.filter( ( blockType ) =>\r\n\t\t\t\tisMatchingSearchTerm( blockType, filterValue )\r\n\t\t  );\r\n\r\n\tconst blockTypesListRef = useRef();\r\n\r\n\t// Announce search results on change\r\n\tuseEffect( () => {\r\n\t\tif ( ! filterValue ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// We extract the results from the wrapper div's `ref` because\r\n\t\t// filtered items can contain items that will eventually not\r\n\t\t// render and there is no reliable way to detect when a child\r\n\t\t// will return `null`.\r\n\t\t// TODO: We should find a better way of handling this as it's\r\n\t\t// fragile and depends on the number of rendered elements of `BlockMenuItem`,\r\n\t\t// which is now one.\r\n\t\t// @see https://github.com/WordPress/gutenberg/pull/39117#discussion_r816022116\r\n\t\tconst count = blockTypesListRef.current.childElementCount;\r\n\t\tconst resultsFoundMessage = sprintf(\r\n\t\t\t/* translators: %d: number of results. */\r\n\t\t\t_n( '%d result found.', '%d results found.', count ),\r\n\t\t\tcount\r\n\t\t);\r\n\t\tdebouncedSpeak( resultsFoundMessage, count );\r\n\t}, [ filterValue, debouncedSpeak ] );\r\n\r\n\treturn (\r\n\t\t<div\r\n\t\t\tref={ blockTypesListRef }\r\n\t\t\tclassName=\"edit-site-block-types-item-list\"\r\n\t\t>\r\n\t\t\t{ filteredBlockTypes.map( ( block ) => (\r\n\t\t\t\t<BlockMenuItem\r\n\t\t\t\t\tblock={ block }\r\n\t\t\t\t\tkey={ 'menu-itemblock-' + block.name }\r\n\t\t\t\t/>\r\n\t\t\t) ) }\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nconst MemoizedBlockList = memo( BlockList );\r\n\r\nfunction ScreenBlockList() {\r\n\tconst [ filterValue, setFilterValue ] = useState( '' );\r\n\tconst deferredFilterValue = useDeferredValue( filterValue );\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<ScreenHeader\r\n\t\t\t\ttitle={ __( 'Blocks' ) }\r\n\t\t\t\tdescription={ __(\r\n\t\t\t\t\t'Customize the appearance of specific blocks and for the whole site.'\r\n\t\t\t\t) }\r\n\t\t\t/>\r\n\t\t\t<SearchControl\r\n\t\t\t\t__nextHasNoMarginBottom\r\n\t\t\t\tclassName=\"edit-site-block-types-search\"\r\n\t\t\t\tonChange={ setFilterValue }\r\n\t\t\t\tvalue={ filterValue }\r\n\t\t\t\tlabel={ __( 'Search for blocks' ) }\r\n\t\t\t\tplaceholder={ __( 'Search' ) }\r\n\t\t\t/>\r\n\t\t\t<MemoizedBlockList filterValue={ deferredFilterValue } />\r\n\t\t</>\r\n\t);\r\n}\r\n\r\nexport default ScreenBlockList;\r\n"],"mappings":"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","ignoreList":[]}