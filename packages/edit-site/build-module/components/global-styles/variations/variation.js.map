{"version":3,"names":["clsx","Button","Tooltip","apiFetch","store","coreStore","useMemo","useContext","useState","ENTER","__","sprintf","privateApis","blockEditorPrivateApis","editorPrivateApis","dispatch","filterObjectByProperties","unlock","jsx","_jsx","jsxs","_jsxs","mergeBaseAndUserConfigs","GlobalStylesContext","areGlobalStyleConfigsEqual","Variation","currentStyle","variation","children","isPill","properties","showTooltip","isFocused","setIsFocused","base","user","setUserConfig","context","merged","selectVariation","selectOnEnter","event","keyCode","preventDefault","isActive","label","title","description","deleteVariation","console","log","response","path","method","body","JSON","stringify","styleName","headers","success","invalidateResolution","alert","error","content","className","role","onClick","onKeyDown","tabIndex","onFocus","onBlur","isDestructive","isSmall","Provider","value","text"],"sources":["@wordpress/edit-site/src/components/global-styles/variations/variation.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport clsx from 'clsx';\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { Button,Tooltip } from '@wordpress/components'; // seogtp 引入Button,\r\nimport  apiFetch  from '@wordpress/api-fetch'; // seogtp 引入 API 调用\r\nimport { store as coreStore } from '@wordpress/core-data'; // seogtp 引入\r\nimport { useMemo, useContext, useState } from '@wordpress/element';\r\nimport { ENTER } from '@wordpress/keycodes';\r\nimport { __, sprintf } from '@wordpress/i18n';\r\nimport { privateApis as blockEditorPrivateApis } from '@wordpress/block-editor';\r\nimport { privateApis as editorPrivateApis } from '@wordpress/editor';\r\n// 导入数据选择器 seogtp\r\nimport { dispatch } from '@wordpress/data';\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { filterObjectByProperties } from '../../../hooks/use-theme-style-variations/use-theme-style-variations-by-property';\r\nimport { unlock } from '../../../lock-unlock';\r\n\r\nconst { mergeBaseAndUserConfigs } = unlock( editorPrivateApis );\r\nconst { GlobalStylesContext, areGlobalStyleConfigsEqual } = unlock(\r\n\tblockEditorPrivateApis\r\n);\r\nexport default function Variation( {\r\n\tcurrentStyle,\r\n\tvariation,\r\n\tchildren,\r\n\tisPill,\r\n\tproperties,\r\n\tshowTooltip,\r\n} ) {\r\n\tconst [ isFocused, setIsFocused ] = useState( false );\r\n\tconst { base, user, setUserConfig } = useContext( GlobalStylesContext );\r\n\r\n\tconst context = useMemo( () => {\r\n\t\tlet merged = mergeBaseAndUserConfigs( base, variation );\r\n\t\tif ( properties ) {\r\n\t\t\tmerged = filterObjectByProperties( merged, properties );\r\n\t\t}\r\n\t\treturn {\r\n\t\t\tuser: variation,\r\n\t\t\tbase,\r\n\t\t\tmerged,\r\n\t\t\tsetUserConfig: () => {},\r\n\t\t};\r\n\t}, [ variation, base, properties ] );\r\n\r\n\tconst selectVariation = () => setUserConfig( variation )\r\n\r\n\tconst selectOnEnter = ( event ) => {\r\n\t\tif ( event.keyCode === ENTER ) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tselectVariation();\r\n\t\t}\r\n\t};\r\n\tconst isActive = useMemo(\r\n\t\t() => areGlobalStyleConfigsEqual( user, variation ),\r\n\t\t[ user, variation ]\r\n\t);\r\n\r\n\tlet label = variation?.title;\r\n\tif ( variation?.description ) {\r\n\t\tlabel = sprintf(\r\n\t\t\t/* translators: %1$s: variation title. %2$s variation description. */\r\n\t\t\t__( '%1$s (%2$s)' ),\r\n\t\t\tvariation?.title,\r\n\t\t\tvariation?.description\r\n\t\t);\r\n\t}\r\n\t// seogtp删除风格的函数\r\n\r\n\r\n\tconst deleteVariation = async () => {\r\n\t\ttry {\r\n\t\t\tconsole.log(user);\r\n\t\t\tconsole.log(variation);\r\n\t\t\t// 调用 REST API 来删除风格\r\n\t\t\tconst response = await apiFetch({\r\n\t\t\t\tpath: '/seogtp/v1/delete-style',\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\tbody: JSON.stringify({ styleName: variation.title }), // 发送风格名称\r\n\t\t\t\theaders: { 'Content-Type': 'application/json' }, // 设置请求头为 JSON\r\n\t\t\t});\r\n\t\t\tconsole.log('API response:', response); // 确认 response 内容\r\n\r\n\t\t\t// 检查返回结果并提示用户\r\n\t\t\tif (response.success) {\r\n\t\t\t\t// 使缓存失效，确保全局样式的重新获取\r\n\t\t\t\tawait dispatch(coreStore).invalidateResolution('getGlobalStyles');\r\n\t\t\t\tawait dispatch(coreStore).invalidateResolution('__experimentalGetCurrentThemeGlobalStylesVariations');\r\n\t\t\t\talert(__('Style deleted successfully.', 'seogtp'));\r\n\t\t\t} else {\r\n\t\t\t\talert(__('Failed to delete the style.', 'seogtp'));\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\t// 捕捉并处理请求错误\r\n\t\t\tconsole.error('Failed to delete the style: ', error);\r\n\t\t\talert(__('An error occurred while deleting the style.', 'seogtp'));\r\n\t\t}\r\n\t};\r\n\r\n\r\n\r\n\tconst content = (\r\n\t\t<div\r\n\t\t\tclassName={ clsx( 'edit-site-global-styles-variations_item', {\r\n\t\t\t\t'is-active': isActive,\r\n\t\t\t} ) }\r\n\t\t\trole=\"button\"\r\n\t\t\tonClick={ selectVariation }\r\n\t\t\tonKeyDown={ selectOnEnter }\r\n\t\t\ttabIndex=\"0\"\r\n\t\t\taria-label={ label }\r\n\t\t\taria-current={ isActive }\r\n\t\t\tonFocus={ () => setIsFocused( true ) }\r\n\t\t\tonBlur={ () => setIsFocused( false ) }\r\n\t\t>\r\n\t\t\t<div\r\n\t\t\t\tclassName={ clsx(\r\n\t\t\t\t\t'edit-site-global-styles-variations_item-preview',\r\n\t\t\t\t\t{ 'is-pill': isPill }\r\n\t\t\t\t) }\r\n\t\t\t>\r\n\t\t\t\t{ children( isFocused ) }\r\n\t\t\t</div>\r\n\t\t\t{/* 如果风格标题不是 \"default\" 则显示删除按钮 */}\r\n\t\t\t<div    className={`edit-site-global-styles-variations_item_label ${variation.title !== 'default' && currentStyle !== variation.title ? '' : 'olny-center'}`}>\r\n\t\t\t\t<span>{variation.title}</span>\r\n\t\t\t\t{variation.title !== 'default' && currentStyle !== variation.title && (\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tisDestructive\r\n\t\t\t\t\t\tisSmall\r\n\t\t\t\t\t\tonClick={deleteVariation}\r\n\t\t\t\t\t\tclassName=\"delete-style-button\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{__('Delete')}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n\r\n\treturn (\r\n\t\t<GlobalStylesContext.Provider value={ context }>\r\n\t\t\t{ showTooltip ? (\r\n\t\t\t\t<Tooltip text={ variation?.title }>{ content }</Tooltip>\r\n\t\t\t) : (\r\n\t\t\t\tcontent\r\n\t\t\t) }\r\n\t\t</GlobalStylesContext.Provider>\r\n\t);\r\n}\r\n"],"mappings":"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","ignoreList":[]}