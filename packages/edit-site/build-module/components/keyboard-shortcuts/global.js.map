{"version":3,"names":["useShortcut","useDispatch","useSelect","store","coreStore","editorStore","editSiteStore","unlock","KeyboardShortcutsGlobal","__experimentalGetDirtyEntityRecords","isSavingEntityRecord","hasNonPostEntityChanges","getCanvasMode","setIsSaveViewOpened","event","preventDefault","dirtyEntityRecords","hasDirtyEntities","length","isSaving","some","record","kind","name","key","_hasNonPostEntityChanges","isViewMode"],"sources":["@wordpress/edit-site/src/components/keyboard-shortcuts/global.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useShortcut } from '@wordpress/keyboard-shortcuts';\r\nimport { useDispatch, useSelect } from '@wordpress/data';\r\nimport { store as coreStore } from '@wordpress/core-data';\r\nimport { store as editorStore } from '@wordpress/editor';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { store as editSiteStore } from '../../store';\r\nimport { unlock } from '../../lock-unlock';\r\n\r\nfunction KeyboardShortcutsGlobal() {\r\n\tconst { __experimentalGetDirtyEntityRecords, isSavingEntityRecord } =\r\n\t\tuseSelect( coreStore );\r\n\tconst { hasNonPostEntityChanges } = useSelect( editorStore );\r\n\tconst { getCanvasMode } = unlock( useSelect( editSiteStore ) );\r\n\tconst { setIsSaveViewOpened } = useDispatch( editSiteStore );\r\n\r\n\tuseShortcut( 'core/edit-site/save', ( event ) => {\r\n\t\tevent.preventDefault();\r\n\r\n\t\tconst dirtyEntityRecords = __experimentalGetDirtyEntityRecords();\r\n\t\tconst hasDirtyEntities = !! dirtyEntityRecords.length;\r\n\t\tconst isSaving = dirtyEntityRecords.some( ( record ) =>\r\n\t\t\tisSavingEntityRecord( record.kind, record.name, record.key )\r\n\t\t);\r\n\t\tconst _hasNonPostEntityChanges = hasNonPostEntityChanges();\r\n\t\tconst isViewMode = getCanvasMode() === 'view';\r\n\t\tif (\r\n\t\t\t( ! hasDirtyEntities || ! _hasNonPostEntityChanges || isSaving ) &&\r\n\t\t\t! isViewMode\r\n\t\t) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// At this point, we know that there are dirty entities, other than\r\n\t\t// the edited post, and we're not in the process of saving, so open\r\n\t\t// save view.\r\n\t\tsetIsSaveViewOpened( true );\r\n\t} );\r\n\r\n\treturn null;\r\n}\r\n\r\nexport default KeyboardShortcutsGlobal;\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,WAAW,QAAQ,+BAA+B;AAC3D,SAASC,WAAW,EAAEC,SAAS,QAAQ,iBAAiB;AACxD,SAASC,KAAK,IAAIC,SAAS,QAAQ,sBAAsB;AACzD,SAASD,KAAK,IAAIE,WAAW,QAAQ,mBAAmB;;AAExD;AACA;AACA;AACA,SAASF,KAAK,IAAIG,aAAa,QAAQ,aAAa;AACpD,SAASC,MAAM,QAAQ,mBAAmB;AAE1C,SAASC,uBAAuBA,CAAA,EAAG;EAClC,MAAM;IAAEC,mCAAmC;IAAEC;EAAqB,CAAC,GAClER,SAAS,CAAEE,SAAU,CAAC;EACvB,MAAM;IAAEO;EAAwB,CAAC,GAAGT,SAAS,CAAEG,WAAY,CAAC;EAC5D,MAAM;IAAEO;EAAc,CAAC,GAAGL,MAAM,CAAEL,SAAS,CAAEI,aAAc,CAAE,CAAC;EAC9D,MAAM;IAAEO;EAAoB,CAAC,GAAGZ,WAAW,CAAEK,aAAc,CAAC;EAE5DN,WAAW,CAAE,qBAAqB,EAAIc,KAAK,IAAM;IAChDA,KAAK,CAACC,cAAc,CAAC,CAAC;IAEtB,MAAMC,kBAAkB,GAAGP,mCAAmC,CAAC,CAAC;IAChE,MAAMQ,gBAAgB,GAAG,CAAC,CAAED,kBAAkB,CAACE,MAAM;IACrD,MAAMC,QAAQ,GAAGH,kBAAkB,CAACI,IAAI,CAAIC,MAAM,IACjDX,oBAAoB,CAAEW,MAAM,CAACC,IAAI,EAAED,MAAM,CAACE,IAAI,EAAEF,MAAM,CAACG,GAAI,CAC5D,CAAC;IACD,MAAMC,wBAAwB,GAAGd,uBAAuB,CAAC,CAAC;IAC1D,MAAMe,UAAU,GAAGd,aAAa,CAAC,CAAC,KAAK,MAAM;IAC7C,IACC,CAAE,CAAEK,gBAAgB,IAAI,CAAEQ,wBAAwB,IAAIN,QAAQ,KAC9D,CAAEO,UAAU,EACX;MACD;IACD;IACA;IACA;IACA;IACAb,mBAAmB,CAAE,IAAK,CAAC;EAC5B,CAAE,CAAC;EAEH,OAAO,IAAI;AACZ;AAEA,eAAeL,uBAAuB","ignoreList":[]}