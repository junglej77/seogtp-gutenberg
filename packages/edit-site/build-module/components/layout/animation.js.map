{"version":3,"names":["Controller","easings","useLayoutEffect","useMemo","useRef","getAbsolutePosition","element","top","offsetTop","left","offsetLeft","ANIMATION_DURATION","useMovingAnimation","triggerAnimationOnChange","ref","previous","prevRect","current","getBoundingClientRect","disableAnimation","window","matchMedia","matches","controller","x","y","width","height","config","duration","easing","easeInOutQuint","onChange","value","Math","round","finishedMoving","style","transformOrigin","transform","undefined","destination","start","from","stop","set"],"sources":["@wordpress/edit-site/src/components/layout/animation.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport { Controller, easings } from '@react-spring/web';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { useLayoutEffect, useMemo, useRef } from '@wordpress/element';\r\n\r\nfunction getAbsolutePosition( element ) {\r\n\treturn {\r\n\t\ttop: element.offsetTop,\r\n\t\tleft: element.offsetLeft,\r\n\t};\r\n}\r\n\r\nconst ANIMATION_DURATION = 400;\r\n\r\n/**\r\n * Hook used to compute the styles required to move a div into a new position.\r\n *\r\n * The way this animation works is the following:\r\n *  - It first renders the element as if there was no animation.\r\n *  - It takes a snapshot of the position of the block to use it\r\n *    as a destination point for the animation.\r\n *  - It restores the element to the previous position using a CSS transform\r\n *  - It uses the \"resetAnimation\" flag to reset the animation\r\n *    from the beginning in order to animate to the new destination point.\r\n *\r\n * @param {Object} $1                          Options\r\n * @param {*}      $1.triggerAnimationOnChange Variable used to trigger the animation if it changes.\r\n */\r\nfunction useMovingAnimation( { triggerAnimationOnChange } ) {\r\n\tconst ref = useRef();\r\n\r\n\t// Whenever the trigger changes, we need to take a snapshot of the current\r\n\t// position of the block to use it as a destination point for the animation.\r\n\tconst { previous, prevRect } = useMemo(\r\n\t\t() => ( {\r\n\t\t\tprevious: ref.current && getAbsolutePosition( ref.current ),\r\n\t\t\tprevRect: ref.current && ref.current.getBoundingClientRect(),\r\n\t\t} ),\r\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t\t[ triggerAnimationOnChange ]\r\n\t);\r\n\r\n\tuseLayoutEffect( () => {\r\n\t\tif ( ! previous || ! ref.current ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// We disable the animation if the user has a preference for reduced\r\n\t\t// motion.\r\n\t\tconst disableAnimation = window.matchMedia(\r\n\t\t\t'(prefers-reduced-motion: reduce)'\r\n\t\t).matches;\r\n\r\n\t\tif ( disableAnimation ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst controller = new Controller( {\r\n\t\t\tx: 0,\r\n\t\t\ty: 0,\r\n\t\t\twidth: prevRect.width,\r\n\t\t\theight: prevRect.height,\r\n\t\t\tconfig: {\r\n\t\t\t\tduration: ANIMATION_DURATION,\r\n\t\t\t\teasing: easings.easeInOutQuint,\r\n\t\t\t},\r\n\t\t\tonChange( { value } ) {\r\n\t\t\t\tif ( ! ref.current ) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tlet { x, y, width, height } = value;\r\n\t\t\t\tx = Math.round( x );\r\n\t\t\t\ty = Math.round( y );\r\n\t\t\t\twidth = Math.round( width );\r\n\t\t\t\theight = Math.round( height );\r\n\t\t\t\tconst finishedMoving = x === 0 && y === 0;\r\n\t\t\t\tref.current.style.transformOrigin = 'center center';\r\n\t\t\t\tref.current.style.transform = finishedMoving\r\n\t\t\t\t\t? null // Set to `null` to explicitly remove the transform.\r\n\t\t\t\t\t: `translate3d(${ x }px,${ y }px,0)`;\r\n\t\t\t\tref.current.style.width = finishedMoving\r\n\t\t\t\t\t? null\r\n\t\t\t\t\t: `${ width }px`;\r\n\t\t\t\tref.current.style.height = finishedMoving\r\n\t\t\t\t\t? null\r\n\t\t\t\t\t: `${ height }px`;\r\n\t\t\t},\r\n\t\t} );\r\n\r\n\t\tref.current.style.transform = undefined;\r\n\t\tconst destination = ref.current.getBoundingClientRect();\r\n\r\n\t\tconst x = Math.round( prevRect.left - destination.left );\r\n\t\tconst y = Math.round( prevRect.top - destination.top );\r\n\t\tconst width = destination.width;\r\n\t\tconst height = destination.height;\r\n\r\n\t\tcontroller.start( {\r\n\t\t\tx: 0,\r\n\t\t\ty: 0,\r\n\t\t\twidth,\r\n\t\t\theight,\r\n\t\t\tfrom: { x, y, width: prevRect.width, height: prevRect.height },\r\n\t\t} );\r\n\r\n\t\treturn () => {\r\n\t\t\tcontroller.stop();\r\n\t\t\tcontroller.set( {\r\n\t\t\t\tx: 0,\r\n\t\t\t\ty: 0,\r\n\t\t\t\twidth: prevRect.width,\r\n\t\t\t\theight: prevRect.height,\r\n\t\t\t} );\r\n\t\t};\r\n\t}, [ previous, prevRect ] );\r\n\r\n\treturn ref;\r\n}\r\n\r\nexport default useMovingAnimation;\r\n"],"mappings":"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","ignoreList":[]}