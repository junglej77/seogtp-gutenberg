{"version":3,"names":["useEffect","useState","useSelect","store","coreStore","useEditedEntityRecord","MAX_LOADING_TIME","useIsSiteEditorLoading","isLoaded","hasLoadedPost","loaded","setLoaded","inLoadingPause","select","hasResolvingSelectors","timeout","setTimeout","clearTimeout","ARTIFICIAL_DELAY"],"sources":["@wordpress/edit-site/src/components/layout/hooks.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useEffect, useState } from '@wordpress/element';\r\nimport { useSelect } from '@wordpress/data';\r\nimport { store as coreStore } from '@wordpress/core-data';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport useEditedEntityRecord from '../use-edited-entity-record';\r\n\r\nconst MAX_LOADING_TIME = 10000; // 10 seconds\r\n\r\nexport function useIsSiteEditorLoading() {\r\n\tconst { isLoaded: hasLoadedPost } = useEditedEntityRecord();\r\n\tconst [ loaded, setLoaded ] = useState( false );\r\n\tconst inLoadingPause = useSelect(\r\n\t\t( select ) => {\r\n\t\t\tconst hasResolvingSelectors =\r\n\t\t\t\tselect( coreStore ).hasResolvingSelectors();\r\n\t\t\treturn ! loaded && ! hasResolvingSelectors;\r\n\t\t},\r\n\t\t[ loaded ]\r\n\t);\r\n\r\n\t/*\r\n\t * If the maximum expected loading time has passed, we're marking the\r\n\t * editor as loaded, in order to prevent any failed requests from blocking\r\n\t * the editor canvas from appearing.\r\n\t */\r\n\tuseEffect( () => {\r\n\t\tlet timeout;\r\n\r\n\t\tif ( ! loaded ) {\r\n\t\t\ttimeout = setTimeout( () => {\r\n\t\t\t\tsetLoaded( true );\r\n\t\t\t}, MAX_LOADING_TIME );\r\n\t\t}\r\n\r\n\t\treturn () => {\r\n\t\t\tclearTimeout( timeout );\r\n\t\t};\r\n\t}, [ loaded ] );\r\n\r\n\tuseEffect( () => {\r\n\t\tif ( inLoadingPause ) {\r\n\t\t\t/*\r\n\t\t\t * We're using an arbitrary 100ms timeout here to catch brief\r\n\t\t\t * moments without any resolving selectors that would result in\r\n\t\t\t * displaying brief flickers of loading state and loaded state.\r\n\t\t\t *\r\n\t\t\t * It's worth experimenting with different values, since this also\r\n\t\t\t * adds 100ms of artificial delay after loading has finished.\r\n\t\t\t */\r\n\t\t\tconst ARTIFICIAL_DELAY = 100;\r\n\t\t\tconst timeout = setTimeout( () => {\r\n\t\t\t\tsetLoaded( true );\r\n\t\t\t}, ARTIFICIAL_DELAY );\r\n\r\n\t\t\treturn () => {\r\n\t\t\t\tclearTimeout( timeout );\r\n\t\t\t};\r\n\t\t}\r\n\t}, [ inLoadingPause ] );\r\n\r\n\treturn ! loaded || ! hasLoadedPost;\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,SAAS,EAAEC,QAAQ,QAAQ,oBAAoB;AACxD,SAASC,SAAS,QAAQ,iBAAiB;AAC3C,SAASC,KAAK,IAAIC,SAAS,QAAQ,sBAAsB;;AAEzD;AACA;AACA;AACA,OAAOC,qBAAqB,MAAM,6BAA6B;AAE/D,MAAMC,gBAAgB,GAAG,KAAK,CAAC,CAAC;;AAEhC,OAAO,SAASC,sBAAsBA,CAAA,EAAG;EACxC,MAAM;IAAEC,QAAQ,EAAEC;EAAc,CAAC,GAAGJ,qBAAqB,CAAC,CAAC;EAC3D,MAAM,CAAEK,MAAM,EAAEC,SAAS,CAAE,GAAGV,QAAQ,CAAE,KAAM,CAAC;EAC/C,MAAMW,cAAc,GAAGV,SAAS,CAC7BW,MAAM,IAAM;IACb,MAAMC,qBAAqB,GAC1BD,MAAM,CAAET,SAAU,CAAC,CAACU,qBAAqB,CAAC,CAAC;IAC5C,OAAO,CAAEJ,MAAM,IAAI,CAAEI,qBAAqB;EAC3C,CAAC,EACD,CAAEJ,MAAM,CACT,CAAC;;EAED;AACD;AACA;AACA;AACA;EACCV,SAAS,CAAE,MAAM;IAChB,IAAIe,OAAO;IAEX,IAAK,CAAEL,MAAM,EAAG;MACfK,OAAO,GAAGC,UAAU,CAAE,MAAM;QAC3BL,SAAS,CAAE,IAAK,CAAC;MAClB,CAAC,EAAEL,gBAAiB,CAAC;IACtB;IAEA,OAAO,MAAM;MACZW,YAAY,CAAEF,OAAQ,CAAC;IACxB,CAAC;EACF,CAAC,EAAE,CAAEL,MAAM,CAAG,CAAC;EAEfV,SAAS,CAAE,MAAM;IAChB,IAAKY,cAAc,EAAG;MACrB;AACH;AACA;AACA;AACA;AACA;AACA;AACA;MACG,MAAMM,gBAAgB,GAAG,GAAG;MAC5B,MAAMH,OAAO,GAAGC,UAAU,CAAE,MAAM;QACjCL,SAAS,CAAE,IAAK,CAAC;MAClB,CAAC,EAAEO,gBAAiB,CAAC;MAErB,OAAO,MAAM;QACZD,YAAY,CAAEF,OAAQ,CAAC;MACxB,CAAC;IACF;EACD,CAAC,EAAE,CAAEH,cAAc,CAAG,CAAC;EAEvB,OAAO,CAAEF,MAAM,IAAI,CAAED,aAAa;AACnC","ignoreList":[]}