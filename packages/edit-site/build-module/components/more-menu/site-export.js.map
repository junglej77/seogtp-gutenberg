{"version":3,"names":["__","_x","MenuItem","apiFetch","download","useDispatch","downloadBlob","store","noticesStore","jsx","_jsx","SiteExport","createErrorNotice","handleExport","response","path","parse","headers","Accept","blob","contentDisposition","get","contentDispositionMatches","match","fileName","errorResponse","error","json","e","errorMessage","message","code","type","role","icon","onClick","info","children"],"sources":["@wordpress/edit-site/src/components/more-menu/site-export.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { __, _x } from '@wordpress/i18n';\r\nimport { MenuItem } from '@wordpress/components';\r\nimport apiFetch from '@wordpress/api-fetch';\r\nimport { download } from '@wordpress/icons';\r\nimport { useDispatch } from '@wordpress/data';\r\nimport { downloadBlob } from '@wordpress/blob';\r\nimport { store as noticesStore } from '@wordpress/notices';\r\n\r\nexport default function SiteExport() {\r\n\tconst { createErrorNotice } = useDispatch( noticesStore );\r\n\r\n\tasync function handleExport() {\r\n\t\ttry {\r\n\t\t\tconst response = await apiFetch( {\r\n\t\t\t\tpath: '/wp-block-editor/v1/export',\r\n\t\t\t\tparse: false,\r\n\t\t\t\theaders: {\r\n\t\t\t\t\tAccept: 'application/zip',\r\n\t\t\t\t},\r\n\t\t\t} );\r\n\t\t\tconst blob = await response.blob();\r\n\t\t\tconst contentDisposition = response.headers.get(\r\n\t\t\t\t'content-disposition'\r\n\t\t\t);\r\n\t\t\tconst contentDispositionMatches =\r\n\t\t\t\tcontentDisposition.match( /=(.+)\\.zip/ );\r\n\t\t\tconst fileName = contentDispositionMatches[ 1 ]\r\n\t\t\t\t? contentDispositionMatches[ 1 ]\r\n\t\t\t\t: 'edit-site-export';\r\n\r\n\t\t\tdownloadBlob( fileName + '.zip', blob, 'application/zip' );\r\n\t\t} catch ( errorResponse ) {\r\n\t\t\tlet error = {};\r\n\t\t\ttry {\r\n\t\t\t\terror = await errorResponse.json();\r\n\t\t\t} catch ( e ) {}\r\n\t\t\tconst errorMessage =\r\n\t\t\t\terror.message && error.code !== 'unknown_error'\r\n\t\t\t\t\t? error.message\r\n\t\t\t\t\t: __( 'An error occurred while creating the site export.' );\r\n\r\n\t\t\tcreateErrorNotice( errorMessage, { type: 'snackbar' } );\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<MenuItem\r\n\t\t\trole=\"menuitem\"\r\n\t\t\ticon={ download }\r\n\t\t\tonClick={ handleExport }\r\n\t\t\tinfo={ __(\r\n\t\t\t\t'Download your theme with updated templates and styles.'\r\n\t\t\t) }\r\n\t\t>\r\n\t\t\t{ _x( 'Export', 'site exporter menu item' ) }\r\n\t\t</MenuItem>\r\n\t);\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,EAAE,EAAEC,EAAE,QAAQ,iBAAiB;AACxC,SAASC,QAAQ,QAAQ,uBAAuB;AAChD,OAAOC,QAAQ,MAAM,sBAAsB;AAC3C,SAASC,QAAQ,QAAQ,kBAAkB;AAC3C,SAASC,WAAW,QAAQ,iBAAiB;AAC7C,SAASC,YAAY,QAAQ,iBAAiB;AAC9C,SAASC,KAAK,IAAIC,YAAY,QAAQ,oBAAoB;AAAC,SAAAC,GAAA,IAAAC,IAAA;AAE3D,eAAe,SAASC,UAAUA,CAAA,EAAG;EACpC,MAAM;IAAEC;EAAkB,CAAC,GAAGP,WAAW,CAAEG,YAAa,CAAC;EAEzD,eAAeK,YAAYA,CAAA,EAAG;IAC7B,IAAI;MACH,MAAMC,QAAQ,GAAG,MAAMX,QAAQ,CAAE;QAChCY,IAAI,EAAE,4BAA4B;QAClCC,KAAK,EAAE,KAAK;QACZC,OAAO,EAAE;UACRC,MAAM,EAAE;QACT;MACD,CAAE,CAAC;MACH,MAAMC,IAAI,GAAG,MAAML,QAAQ,CAACK,IAAI,CAAC,CAAC;MAClC,MAAMC,kBAAkB,GAAGN,QAAQ,CAACG,OAAO,CAACI,GAAG,CAC9C,qBACD,CAAC;MACD,MAAMC,yBAAyB,GAC9BF,kBAAkB,CAACG,KAAK,CAAE,YAAa,CAAC;MACzC,MAAMC,QAAQ,GAAGF,yBAAyB,CAAE,CAAC,CAAE,GAC5CA,yBAAyB,CAAE,CAAC,CAAE,GAC9B,kBAAkB;MAErBhB,YAAY,CAAEkB,QAAQ,GAAG,MAAM,EAAEL,IAAI,EAAE,iBAAkB,CAAC;IAC3D,CAAC,CAAC,OAAQM,aAAa,EAAG;MACzB,IAAIC,KAAK,GAAG,CAAC,CAAC;MACd,IAAI;QACHA,KAAK,GAAG,MAAMD,aAAa,CAACE,IAAI,CAAC,CAAC;MACnC,CAAC,CAAC,OAAQC,CAAC,EAAG,CAAC;MACf,MAAMC,YAAY,GACjBH,KAAK,CAACI,OAAO,IAAIJ,KAAK,CAACK,IAAI,KAAK,eAAe,GAC5CL,KAAK,CAACI,OAAO,GACb9B,EAAE,CAAE,mDAAoD,CAAC;MAE7DY,iBAAiB,CAAEiB,YAAY,EAAE;QAAEG,IAAI,EAAE;MAAW,CAAE,CAAC;IACxD;EACD;EAEA,oBACCtB,IAAA,CAACR,QAAQ;IACR+B,IAAI,EAAC,UAAU;IACfC,IAAI,EAAG9B,QAAU;IACjB+B,OAAO,EAAGtB,YAAc;IACxBuB,IAAI,EAAGpC,EAAE,CACR,wDACD,CAAG;IAAAqC,QAAA,EAEDpC,EAAE,CAAE,QAAQ,EAAE,yBAA0B;EAAC,CAClC,CAAC;AAEb","ignoreList":[]}