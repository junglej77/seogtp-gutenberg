{"version":3,"names":["clsx","Icon","__experimentalHStack","HStack","__","useState","useMemo","decodeEntities","parse","BlockPreview","privateApis","blockEditorPrivateApis","EditorProvider","Async","default","Link","useLink","useAddedBy","usePatternSettings","unlock","jsx","_jsx","jsxs","_jsxs","useGlobalStyle","PreviewField","item","settings","backgroundColor","blocks","content","raw","onClick","postId","id","postType","type","canvas","isEmpty","length","post","children","className","style","title","rendered","previewField","label","render","enableSorting","TitleField","linkProps","params","titleField","getValue","enableHiding","enableGlobalSearch","descriptionField","description","AuthorField","isImageLoaded","setIsImageLoaded","text","icon","imageUrl","alignment","spacing","onLoad","alt","src","authorField","author_text"],"sources":["@wordpress/edit-site/src/components/page-templates/fields.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport clsx from 'clsx';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { Icon, __experimentalHStack as HStack } from '@wordpress/components';\r\nimport { __ } from '@wordpress/i18n';\r\nimport { useState, useMemo } from '@wordpress/element';\r\nimport { decodeEntities } from '@wordpress/html-entities';\r\nimport { parse } from '@wordpress/blocks';\r\nimport {\r\n\tBlockPreview,\r\n\tprivateApis as blockEditorPrivateApis,\r\n} from '@wordpress/block-editor';\r\nimport { EditorProvider } from '@wordpress/editor';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { Async } from '../async';\r\nimport { default as Link, useLink } from '../routes/link';\r\nimport { useAddedBy } from './hooks';\r\n\r\nimport usePatternSettings from '../page-patterns/use-pattern-settings';\r\nimport { unlock } from '../../lock-unlock';\r\n\r\nconst { useGlobalStyle } = unlock( blockEditorPrivateApis );\r\n\r\nfunction PreviewField( { item } ) {\r\n\tconst settings = usePatternSettings();\r\n\tconst [ backgroundColor = 'white' ] = useGlobalStyle( 'color.background' );\r\n\tconst blocks = useMemo( () => {\r\n\t\treturn parse( item.content.raw );\r\n\t}, [ item.content.raw ] );\r\n\tconst { onClick } = useLink( {\r\n\t\tpostId: item.id,\r\n\t\tpostType: item.type,\r\n\t\tcanvas: 'edit',\r\n\t} );\r\n\r\n\tconst isEmpty = ! blocks?.length;\r\n\t// Wrap everything in a block editor provider to ensure 'styles' that are needed\r\n\t// for the previews are synced between the site editor store and the block editor store.\r\n\t// Additionally we need to have the `__experimentalBlockPatterns` setting in order to\r\n\t// render patterns inside the previews.\r\n\t// TODO: Same approach is used in the patterns list and it becomes obvious that some of\r\n\t// the block editor settings are needed in context where we don't have the block editor.\r\n\t// Explore how we can solve this in a better way.\r\n\treturn (\r\n\t\t<EditorProvider post={ item } settings={ settings }>\r\n\t\t\t<div\r\n\t\t\t\tclassName=\"page-templates-preview-field\"\r\n\t\t\t\tstyle={ { backgroundColor } }\r\n\t\t\t>\r\n\t\t\t\t<button\r\n\t\t\t\t\tclassName=\"page-templates-preview-field__button\"\r\n\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\tonClick={ onClick }\r\n\t\t\t\t\taria-label={ item.title?.rendered || item.title }\r\n\t\t\t\t>\r\n\t\t\t\t\t{ isEmpty && __( 'Empty template' ) }\r\n\t\t\t\t\t{ ! isEmpty && (\r\n\t\t\t\t\t\t<Async>\r\n\t\t\t\t\t\t\t<BlockPreview blocks={ blocks } />\r\n\t\t\t\t\t\t</Async>\r\n\t\t\t\t\t) }\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t</EditorProvider>\r\n\t);\r\n}\r\n\r\nexport const previewField = {\r\n\tlabel: __( 'Preview' ),\r\n\tid: 'preview',\r\n\trender: PreviewField,\r\n\tenableSorting: false,\r\n};\r\n\r\nfunction TitleField( { item } ) {\r\n\tconst linkProps = {\r\n\t\tparams: {\r\n\t\t\tpostId: item.id,\r\n\t\t\tpostType: item.type,\r\n\t\t\tcanvas: 'edit',\r\n\t\t},\r\n\t};\r\n\treturn (\r\n\t\t<Link { ...linkProps }>\r\n\t\t\t{ decodeEntities( item.title?.rendered ) || __( '(no title)' ) }\r\n\t\t</Link>\r\n\t);\r\n}\r\n\r\nexport const titleField = {\r\n\tlabel: __( 'Template' ),\r\n\tid: 'title',\r\n\tgetValue: ( { item } ) => item.title?.rendered,\r\n\trender: TitleField,\r\n\tenableHiding: false,\r\n\tenableGlobalSearch: true,\r\n};\r\n\r\nexport const descriptionField = {\r\n\tlabel: __( 'Description' ),\r\n\tid: 'description',\r\n\trender: ( { item } ) => {\r\n\t\treturn (\r\n\t\t\titem.description && (\r\n\t\t\t\t<span className=\"page-templates-description\">\r\n\t\t\t\t\t{ decodeEntities( item.description ) }\r\n\t\t\t\t</span>\r\n\t\t\t)\r\n\t\t);\r\n\t},\r\n\tenableSorting: false,\r\n\tenableGlobalSearch: true,\r\n};\r\n\r\nfunction AuthorField( { item } ) {\r\n\tconst [ isImageLoaded, setIsImageLoaded ] = useState( false );\r\n\tconst { text, icon, imageUrl } = useAddedBy( item.type, item.id );\r\n\r\n\treturn (\r\n\t\t<HStack alignment=\"left\" spacing={ 0 }>\r\n\t\t\t{ imageUrl && (\r\n\t\t\t\t<div\r\n\t\t\t\t\tclassName={ clsx( 'page-templates-author-field__avatar', {\r\n\t\t\t\t\t\t'is-loaded': isImageLoaded,\r\n\t\t\t\t\t} ) }\r\n\t\t\t\t>\r\n\t\t\t\t\t<img\r\n\t\t\t\t\t\tonLoad={ () => setIsImageLoaded( true ) }\r\n\t\t\t\t\t\talt=\"\"\r\n\t\t\t\t\t\tsrc={ imageUrl }\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t) }\r\n\t\t\t{ ! imageUrl && (\r\n\t\t\t\t<div className=\"page-templates-author-field__icon\">\r\n\t\t\t\t\t<Icon icon={ icon } />\r\n\t\t\t\t</div>\r\n\t\t\t) }\r\n\t\t\t<span className=\"page-templates-author-field__name\">{ text }</span>\r\n\t\t</HStack>\r\n\t);\r\n}\r\n\r\nexport const authorField = {\r\n\tlabel: __( 'Author' ),\r\n\tid: 'author',\r\n\tgetValue: ( { item } ) => item.author_text,\r\n\trender: AuthorField,\r\n};\r\n"],"mappings":"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","ignoreList":[]}