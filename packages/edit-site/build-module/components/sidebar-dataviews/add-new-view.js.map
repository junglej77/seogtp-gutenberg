{"version":3,"names":["Modal","TextControl","__experimentalHStack","HStack","__experimentalVStack","VStack","Button","__","useDispatch","resolveSelect","store","coreStore","useState","plus","privateApis","routerPrivateApis","SidebarNavigationItem","useDefaultViews","unlock","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","useHistory","AddNewItemModalContent","type","setIsAdding","history","saveEntityRecord","title","setTitle","isSaving","setIsSaving","defaultViews","postType","onSubmit","event","preventDefault","getEntityRecords","dataViewTaxonomyId","dataViewTypeRecords","slug","length","id","record","name","savedRecord","status","wp_dataviews_type","content","JSON","stringify","view","params","getLocationWithParams","push","activeView","isCustom","children","spacing","__next40pxDefaultSize","__nextHasNoMarginBottom","label","value","onChange","placeholder","className","justify","variant","onClick","isBusy","AddNewItem","isAdding","icon","onRequestClose"],"sources":["@wordpress/edit-site/src/components/sidebar-dataviews/add-new-view.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport {\r\n\tModal,\r\n\tTextControl,\r\n\t__experimentalHStack as HStack,\r\n\t__experimentalVStack as VStack,\r\n\tButton,\r\n} from '@wordpress/components';\r\nimport { __ } from '@wordpress/i18n';\r\nimport { useDispatch, resolveSelect } from '@wordpress/data';\r\nimport { store as coreStore } from '@wordpress/core-data';\r\nimport { useState } from '@wordpress/element';\r\nimport { plus } from '@wordpress/icons';\r\nimport { privateApis as routerPrivateApis } from '@wordpress/router';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport SidebarNavigationItem from '../sidebar-navigation-item';\r\nimport { useDefaultViews } from './default-views';\r\nimport { unlock } from '../../lock-unlock';\r\n\r\nconst { useHistory } = unlock( routerPrivateApis );\r\n\r\nfunction AddNewItemModalContent( { type, setIsAdding } ) {\r\n\tconst history = useHistory();\r\n\tconst { saveEntityRecord } = useDispatch( coreStore );\r\n\tconst [ title, setTitle ] = useState( '' );\r\n\tconst [ isSaving, setIsSaving ] = useState( false );\r\n\tconst defaultViews = useDefaultViews( { postType: type } );\r\n\treturn (\r\n\t\t<form\r\n\t\t\tonSubmit={ async ( event ) => {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\tsetIsSaving( true );\r\n\t\t\t\tconst { getEntityRecords } = resolveSelect( coreStore );\r\n\t\t\t\tlet dataViewTaxonomyId;\r\n\t\t\t\tconst dataViewTypeRecords = await getEntityRecords(\r\n\t\t\t\t\t'taxonomy',\r\n\t\t\t\t\t'wp_dataviews_type',\r\n\t\t\t\t\t{ slug: type }\r\n\t\t\t\t);\r\n\t\t\t\tif ( dataViewTypeRecords && dataViewTypeRecords.length > 0 ) {\r\n\t\t\t\t\tdataViewTaxonomyId = dataViewTypeRecords[ 0 ].id;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst record = await saveEntityRecord(\r\n\t\t\t\t\t\t'taxonomy',\r\n\t\t\t\t\t\t'wp_dataviews_type',\r\n\t\t\t\t\t\t{ name: type }\r\n\t\t\t\t\t);\r\n\t\t\t\t\tif ( record && record.id ) {\r\n\t\t\t\t\t\tdataViewTaxonomyId = record.id;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tconst savedRecord = await saveEntityRecord(\r\n\t\t\t\t\t'postType',\r\n\t\t\t\t\t'wp_dataviews',\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle,\r\n\t\t\t\t\t\tstatus: 'publish',\r\n\t\t\t\t\t\twp_dataviews_type: dataViewTaxonomyId,\r\n\t\t\t\t\t\tcontent: JSON.stringify( defaultViews[ 0 ].view ),\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t\tconst {\r\n\t\t\t\t\tparams: { postType },\r\n\t\t\t\t} = history.getLocationWithParams();\r\n\t\t\t\thistory.push( {\r\n\t\t\t\t\tpostType,\r\n\t\t\t\t\tactiveView: savedRecord.id,\r\n\t\t\t\t\tisCustom: 'true',\r\n\t\t\t\t} );\r\n\t\t\t\tsetIsSaving( false );\r\n\t\t\t\tsetIsAdding( false );\r\n\t\t\t} }\r\n\t\t>\r\n\t\t\t<VStack spacing=\"5\">\r\n\t\t\t\t<TextControl\r\n\t\t\t\t\t__next40pxDefaultSize\r\n\t\t\t\t\t__nextHasNoMarginBottom\r\n\t\t\t\t\tlabel={ __( 'Name' ) }\r\n\t\t\t\t\tvalue={ title }\r\n\t\t\t\t\tonChange={ setTitle }\r\n\t\t\t\t\tplaceholder={ __( 'My view' ) }\r\n\t\t\t\t\tclassName=\"patterns-create-modal__name-input\"\r\n\t\t\t\t/>\r\n\t\t\t\t<HStack justify=\"right\">\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\t// TODO: Switch to `true` (40px size) if possible\r\n\t\t\t\t\t\t__next40pxDefaultSize={ false }\r\n\t\t\t\t\t\tvariant=\"tertiary\"\r\n\t\t\t\t\t\tonClick={ () => {\r\n\t\t\t\t\t\t\tsetIsAdding( false );\r\n\t\t\t\t\t\t} }\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{ __( 'Cancel' ) }\r\n\t\t\t\t\t</Button>\r\n\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\t// TODO: Switch to `true` (40px size) if possible\r\n\t\t\t\t\t\t__next40pxDefaultSize={ false }\r\n\t\t\t\t\t\tvariant=\"primary\"\r\n\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\taria-disabled={ ! title || isSaving }\r\n\t\t\t\t\t\tisBusy={ isSaving }\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{ __( 'Create' ) }\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</HStack>\r\n\t\t\t</VStack>\r\n\t\t</form>\r\n\t);\r\n}\r\n\r\nexport default function AddNewItem( { type } ) {\r\n\tconst [ isAdding, setIsAdding ] = useState( false );\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<SidebarNavigationItem\r\n\t\t\t\ticon={ plus }\r\n\t\t\t\tonClick={ () => {\r\n\t\t\t\t\tsetIsAdding( true );\r\n\t\t\t\t} }\r\n\t\t\t\tclassName=\"dataviews__siderbar-content-add-new-item\"\r\n\t\t\t>\r\n\t\t\t\t{ __( 'New view' ) }\r\n\t\t\t</SidebarNavigationItem>\r\n\t\t\t{ isAdding && (\r\n\t\t\t\t<Modal\r\n\t\t\t\t\ttitle={ __( 'Add new view' ) }\r\n\t\t\t\t\tonRequestClose={ () => {\r\n\t\t\t\t\t\tsetIsAdding( false );\r\n\t\t\t\t\t} }\r\n\t\t\t\t>\r\n\t\t\t\t\t<AddNewItemModalContent\r\n\t\t\t\t\t\ttype={ type }\r\n\t\t\t\t\t\tsetIsAdding={ setIsAdding }\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Modal>\r\n\t\t\t) }\r\n\t\t</>\r\n\t);\r\n}\r\n"],"mappings":"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","ignoreList":[]}