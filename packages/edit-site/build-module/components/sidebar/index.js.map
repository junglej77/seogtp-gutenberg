{"version":3,"names":["clsx","createContext","useContext","useState","useRef","useLayoutEffect","focus","jsx","_jsx","SidebarNavigationContext","focusSidebarElement","el","direction","focusSelector","elementToFocus","querySelector","firstTabbable","tabbable","find","createNavState","state","get","navigate","SidebarContentWrapper","children","navState","wrapperRef","navAnimation","setNavAnimation","current","wrapperCls","ref","className","SidebarContent","routeKey","Provider","value"],"sources":["@wordpress/edit-site/src/components/sidebar/index.js"],"sourcesContent":["// 外部依赖\r\nimport clsx from 'clsx';\r\n\r\n// WordPress 依赖\r\nimport {\r\n\tcreateContext,\r\n\tuseContext,\r\n\tuseState,\r\n\tuseRef,\r\n\tuseLayoutEffect,\r\n} from '@wordpress/element';\r\nimport { focus } from '@wordpress/dom';\r\n\r\n// 创建一个上下文，用于管理侧边栏导航状态\r\nexport const SidebarNavigationContext = createContext( () => {} );\r\n\r\n// 根据导航方向和选择器聚焦侧边栏元素\r\nfunction focusSidebarElement( el, direction, focusSelector ) {\r\n\tlet elementToFocus;\r\n\tif ( direction === 'back' && focusSelector ) {\r\n\t\telementToFocus = el.querySelector( focusSelector );\r\n\t}\r\n\tif ( direction !== null && ! elementToFocus ) {\r\n\t\tconst [ firstTabbable ] = focus.tabbable.find( el );\r\n\t\telementToFocus = firstTabbable ?? el;\r\n\t}\r\n\telementToFocus?.focus();\r\n}\r\n\r\n// 创建导航状态，用于管理导航方向和聚焦选择器\r\nfunction createNavState() {\r\n\tlet state = {\r\n\t\tdirection: null,\r\n\t\tfocusSelector: null,\r\n\t};\r\n\r\n\treturn {\r\n\t\tget() {\r\n\t\t\treturn state;\r\n\t\t},\r\n\t\tnavigate( direction, focusSelector = null ) {\r\n\t\t\tstate = {\r\n\t\t\t\tdirection,\r\n\t\t\t\tfocusSelector:\r\n\t\t\t\t\tdirection === 'forward' && focusSelector\r\n\t\t\t\t\t\t? focusSelector\r\n\t\t\t\t\t\t: state.focusSelector,\r\n\t\t\t};\r\n\t\t},\r\n\t};\r\n}\r\n\r\n// 侧边栏内容包装组件\r\nfunction SidebarContentWrapper( { children } ) {\r\n\tconst navState = useContext( SidebarNavigationContext );\r\n\tconst wrapperRef = useRef();\r\n\tconst [ navAnimation, setNavAnimation ] = useState( null );\r\n\r\n\tuseLayoutEffect( () => {\r\n\t\tconst { direction, focusSelector } = navState.get();\r\n\t\tfocusSidebarElement( wrapperRef.current, direction, focusSelector );\r\n\t\tsetNavAnimation( direction );\r\n\t}, [ navState ] );\r\n\r\n\tconst wrapperCls = clsx( 'edit-site-sidebar__screen-wrapper', {\r\n\t\t'slide-from-left': navAnimation === 'back',\r\n\t\t'slide-from-right': navAnimation === 'forward',\r\n\t} );\r\n\r\n\treturn (\r\n\t\t<div ref={ wrapperRef } className={ wrapperCls }>\r\n\t\t\t{ children }\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\n// 侧边栏内容主组件\r\nexport default function SidebarContent( { routeKey, children } ) {\r\n\tconst [ navState ] = useState( createNavState );\r\n\r\n\treturn (\r\n\t\t<SidebarNavigationContext.Provider value={ navState }>\r\n\t\t\t<div className=\"edit-site-sidebar__content\">\r\n\t\t\t\t<SidebarContentWrapper key={ routeKey }>\r\n\t\t\t\t\t{ children }\r\n\t\t\t\t</SidebarContentWrapper>\r\n\t\t\t</div>\r\n\t\t</SidebarNavigationContext.Provider>\r\n\t);\r\n}\r\n"],"mappings":"AAAA;AACA,OAAOA,IAAI,MAAM,MAAM;;AAEvB;AACA,SACCC,aAAa,EACbC,UAAU,EACVC,QAAQ,EACRC,MAAM,EACNC,eAAe,QACT,oBAAoB;AAC3B,SAASC,KAAK,QAAQ,gBAAgB;;AAEtC;AAAA,SAAAC,GAAA,IAAAC,IAAA;AACA,OAAO,MAAMC,wBAAwB,GAAGR,aAAa,CAAE,MAAM,CAAC,CAAE,CAAC;;AAEjE;AACA,SAASS,mBAAmBA,CAAEC,EAAE,EAAEC,SAAS,EAAEC,aAAa,EAAG;EAC5D,IAAIC,cAAc;EAClB,IAAKF,SAAS,KAAK,MAAM,IAAIC,aAAa,EAAG;IAC5CC,cAAc,GAAGH,EAAE,CAACI,aAAa,CAAEF,aAAc,CAAC;EACnD;EACA,IAAKD,SAAS,KAAK,IAAI,IAAI,CAAEE,cAAc,EAAG;IAC7C,MAAM,CAAEE,aAAa,CAAE,GAAGV,KAAK,CAACW,QAAQ,CAACC,IAAI,CAAEP,EAAG,CAAC;IACnDG,cAAc,GAAGE,aAAa,aAAbA,aAAa,cAAbA,aAAa,GAAIL,EAAE;EACrC;EACAG,cAAc,EAAER,KAAK,CAAC,CAAC;AACxB;;AAEA;AACA,SAASa,cAAcA,CAAA,EAAG;EACzB,IAAIC,KAAK,GAAG;IACXR,SAAS,EAAE,IAAI;IACfC,aAAa,EAAE;EAChB,CAAC;EAED,OAAO;IACNQ,GAAGA,CAAA,EAAG;MACL,OAAOD,KAAK;IACb,CAAC;IACDE,QAAQA,CAAEV,SAAS,EAAEC,aAAa,GAAG,IAAI,EAAG;MAC3CO,KAAK,GAAG;QACPR,SAAS;QACTC,aAAa,EACZD,SAAS,KAAK,SAAS,IAAIC,aAAa,GACrCA,aAAa,GACbO,KAAK,CAACP;MACX,CAAC;IACF;EACD,CAAC;AACF;;AAEA;AACA,SAASU,qBAAqBA,CAAE;EAAEC;AAAS,CAAC,EAAG;EAC9C,MAAMC,QAAQ,GAAGvB,UAAU,CAAEO,wBAAyB,CAAC;EACvD,MAAMiB,UAAU,GAAGtB,MAAM,CAAC,CAAC;EAC3B,MAAM,CAAEuB,YAAY,EAAEC,eAAe,CAAE,GAAGzB,QAAQ,CAAE,IAAK,CAAC;EAE1DE,eAAe,CAAE,MAAM;IACtB,MAAM;MAAEO,SAAS;MAAEC;IAAc,CAAC,GAAGY,QAAQ,CAACJ,GAAG,CAAC,CAAC;IACnDX,mBAAmB,CAAEgB,UAAU,CAACG,OAAO,EAAEjB,SAAS,EAAEC,aAAc,CAAC;IACnEe,eAAe,CAAEhB,SAAU,CAAC;EAC7B,CAAC,EAAE,CAAEa,QAAQ,CAAG,CAAC;EAEjB,MAAMK,UAAU,GAAG9B,IAAI,CAAE,mCAAmC,EAAE;IAC7D,iBAAiB,EAAE2B,YAAY,KAAK,MAAM;IAC1C,kBAAkB,EAAEA,YAAY,KAAK;EACtC,CAAE,CAAC;EAEH,oBACCnB,IAAA;IAAKuB,GAAG,EAAGL,UAAY;IAACM,SAAS,EAAGF,UAAY;IAAAN,QAAA,EAC7CA;EAAQ,CACN,CAAC;AAER;;AAEA;AACA,eAAe,SAASS,cAAcA,CAAE;EAAEC,QAAQ;EAAEV;AAAS,CAAC,EAAG;EAChE,MAAM,CAAEC,QAAQ,CAAE,GAAGtB,QAAQ,CAAEgB,cAAe,CAAC;EAE/C,oBACCX,IAAA,CAACC,wBAAwB,CAAC0B,QAAQ;IAACC,KAAK,EAAGX,QAAU;IAAAD,QAAA,eACpDhB,IAAA;MAAKwB,SAAS,EAAC,4BAA4B;MAAAR,QAAA,eAC1ChB,IAAA,CAACe,qBAAqB;QAAAC,QAAA,EACnBA;MAAQ,GADkBU,QAEN;IAAC,CACpB;EAAC,CAC4B,CAAC;AAEtC","ignoreList":[]}