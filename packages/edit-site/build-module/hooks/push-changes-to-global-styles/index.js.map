{"version":3,"names":["addFilter","createHigherOrderComponent","InspectorAdvancedControls","store","blockEditorStore","privateApis","blockEditorPrivateApis","useBlockEditingMode","BaseControl","Button","__","sprintf","__EXPERIMENTAL_STYLE_PROPERTY","getBlockType","hasBlockSupport","useContext","useMemo","useCallback","useDispatch","useSelect","noticesStore","coreStore","useSupportedStyles","unlock","setNestedValue","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","cleanEmptyObject","GlobalStylesContext","STYLE_PROPERTY","blockGap","value","STYLE_PATH_TO_CSS_VAR_INFIX","STYLE_PATH_TO_PRESET_BLOCK_ATTRIBUTE","SUPPORTED_STYLES","getValueFromObjectPath","object","path","forEach","fieldName","flatBorderProperties","sides","getBorderStyleChanges","border","presetColor","userStyle","changes","getFallbackBorderStyleChange","color","customColor","style","width","hasColorOrWidth","side","push","globalBorderStyle","useChangesToPush","name","attributes","userConfig","supports","blockUserConfig","styles","blocks","flatMap","key","presetAttributeKey","join","presetAttributeValue","linkChanges","hoverPath","hoverValue","includes","borderChanges","currentPath","splice","borderColor","change","PushChangesToGlobalStylesControl","setAttributes","user","setUserConfig","__unstableMarkNextChangeAsNotPersistent","createSuccessNotice","pushChanges","length","blockStyles","newBlockStyles","structuredClone","newUserConfig","undefined","newBlockAttributes","backgroundColor","textColor","gradient","fontSize","fontFamily","undoIgnore","title","type","actions","label","onClick","__nextHasNoMarginBottom","className","help","children","VisualLabel","__next40pxDefaultSize","variant","accessibleWhenDisabled","disabled","PushChangesToGlobalStyles","props","blockEditingMode","isBlockBasedTheme","select","getCurrentTheme","is_block_theme","supportsStyles","some","feature","isDisplayed","withPushChangesToGlobalStyles","BlockEdit","isSelected"],"sources":["@wordpress/edit-site/src/hooks/push-changes-to-global-styles/index.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { addFilter } from '@wordpress/hooks';\r\nimport { createHigherOrderComponent } from '@wordpress/compose';\r\nimport {\r\n\tInspectorAdvancedControls,\r\n\tstore as blockEditorStore,\r\n\tprivateApis as blockEditorPrivateApis,\r\n\tuseBlockEditingMode,\r\n} from '@wordpress/block-editor';\r\nimport { BaseControl, Button } from '@wordpress/components';\r\nimport { __, sprintf } from '@wordpress/i18n';\r\nimport {\r\n\t__EXPERIMENTAL_STYLE_PROPERTY,\r\n\tgetBlockType,\r\n\thasBlockSupport,\r\n} from '@wordpress/blocks';\r\nimport { useContext, useMemo, useCallback } from '@wordpress/element';\r\nimport { useDispatch, useSelect } from '@wordpress/data';\r\nimport { store as noticesStore } from '@wordpress/notices';\r\nimport { store as coreStore } from '@wordpress/core-data';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { useSupportedStyles } from '../../components/global-styles/hooks';\r\nimport { unlock } from '../../lock-unlock';\r\nimport setNestedValue from '../../utils/set-nested-value';\r\n\r\nconst { cleanEmptyObject, GlobalStylesContext } = unlock(\r\n\tblockEditorPrivateApis\r\n);\r\n\r\n// Block Gap is a special case and isn't defined within the blocks\r\n// style properties config. We'll add it here to allow it to be pushed\r\n// to global styles as well.\r\nconst STYLE_PROPERTY = {\r\n\t...__EXPERIMENTAL_STYLE_PROPERTY,\r\n\tblockGap: { value: [ 'spacing', 'blockGap' ] },\r\n};\r\n\r\n// TODO: Temporary duplication of constant in @wordpress/block-editor. Can be\r\n// removed by moving PushChangesToGlobalStylesControl to\r\n// @wordpress/block-editor.\r\nconst STYLE_PATH_TO_CSS_VAR_INFIX = {\r\n\t'border.color': 'color',\r\n\t'color.background': 'color',\r\n\t'color.text': 'color',\r\n\t'elements.link.color.text': 'color',\r\n\t'elements.link.:hover.color.text': 'color',\r\n\t'elements.link.typography.fontFamily': 'font-family',\r\n\t'elements.link.typography.fontSize': 'font-size',\r\n\t'elements.button.color.text': 'color',\r\n\t'elements.button.color.background': 'color',\r\n\t'elements.button.typography.fontFamily': 'font-family',\r\n\t'elements.button.typography.fontSize': 'font-size',\r\n\t'elements.caption.color.text': 'color',\r\n\t'elements.heading.color': 'color',\r\n\t'elements.heading.color.background': 'color',\r\n\t'elements.heading.typography.fontFamily': 'font-family',\r\n\t'elements.heading.gradient': 'gradient',\r\n\t'elements.heading.color.gradient': 'gradient',\r\n\t'elements.h1.color': 'color',\r\n\t'elements.h1.color.background': 'color',\r\n\t'elements.h1.typography.fontFamily': 'font-family',\r\n\t'elements.h1.color.gradient': 'gradient',\r\n\t'elements.h2.color': 'color',\r\n\t'elements.h2.color.background': 'color',\r\n\t'elements.h2.typography.fontFamily': 'font-family',\r\n\t'elements.h2.color.gradient': 'gradient',\r\n\t'elements.h3.color': 'color',\r\n\t'elements.h3.color.background': 'color',\r\n\t'elements.h3.typography.fontFamily': 'font-family',\r\n\t'elements.h3.color.gradient': 'gradient',\r\n\t'elements.h4.color': 'color',\r\n\t'elements.h4.color.background': 'color',\r\n\t'elements.h4.typography.fontFamily': 'font-family',\r\n\t'elements.h4.color.gradient': 'gradient',\r\n\t'elements.h5.color': 'color',\r\n\t'elements.h5.color.background': 'color',\r\n\t'elements.h5.typography.fontFamily': 'font-family',\r\n\t'elements.h5.color.gradient': 'gradient',\r\n\t'elements.h6.color': 'color',\r\n\t'elements.h6.color.background': 'color',\r\n\t'elements.h6.typography.fontFamily': 'font-family',\r\n\t'elements.h6.color.gradient': 'gradient',\r\n\t'color.gradient': 'gradient',\r\n\tblockGap: 'spacing',\r\n\t'typography.fontSize': 'font-size',\r\n\t'typography.fontFamily': 'font-family',\r\n};\r\n\r\n// TODO: Temporary duplication of constant in @wordpress/block-editor. Can be\r\n// removed by moving PushChangesToGlobalStylesControl to\r\n// @wordpress/block-editor.\r\nconst STYLE_PATH_TO_PRESET_BLOCK_ATTRIBUTE = {\r\n\t'border.color': 'borderColor',\r\n\t'color.background': 'backgroundColor',\r\n\t'color.text': 'textColor',\r\n\t'color.gradient': 'gradient',\r\n\t'typography.fontSize': 'fontSize',\r\n\t'typography.fontFamily': 'fontFamily',\r\n};\r\n\r\nconst SUPPORTED_STYLES = [ 'border', 'color', 'spacing', 'typography' ];\r\n\r\nconst getValueFromObjectPath = ( object, path ) => {\r\n\tlet value = object;\r\n\tpath.forEach( ( fieldName ) => {\r\n\t\tvalue = value?.[ fieldName ];\r\n\t} );\r\n\treturn value;\r\n};\r\n\r\nconst flatBorderProperties = [ 'borderColor', 'borderWidth', 'borderStyle' ];\r\nconst sides = [ 'top', 'right', 'bottom', 'left' ];\r\n\r\nfunction getBorderStyleChanges( border, presetColor, userStyle ) {\r\n\tif ( ! border && ! presetColor ) {\r\n\t\treturn [];\r\n\t}\r\n\r\n\tconst changes = [\r\n\t\t...getFallbackBorderStyleChange( 'top', border, userStyle ),\r\n\t\t...getFallbackBorderStyleChange( 'right', border, userStyle ),\r\n\t\t...getFallbackBorderStyleChange( 'bottom', border, userStyle ),\r\n\t\t...getFallbackBorderStyleChange( 'left', border, userStyle ),\r\n\t];\r\n\r\n\t// Handle a flat border i.e. all sides the same, CSS shorthand.\r\n\tconst { color: customColor, style, width } = border || {};\r\n\tconst hasColorOrWidth = presetColor || customColor || width;\r\n\r\n\tif ( hasColorOrWidth && ! style ) {\r\n\t\t// Global Styles need individual side configurations to overcome\r\n\t\t// theme.json configurations which are per side as well.\r\n\t\tsides.forEach( ( side ) => {\r\n\t\t\t// Only add fallback border-style if global styles don't already\r\n\t\t\t// have something set.\r\n\t\t\tif ( ! userStyle?.[ side ]?.style ) {\r\n\t\t\t\tchanges.push( {\r\n\t\t\t\t\tpath: [ 'border', side, 'style' ],\r\n\t\t\t\t\tvalue: 'solid',\r\n\t\t\t\t} );\r\n\t\t\t}\r\n\t\t} );\r\n\t}\r\n\r\n\treturn changes;\r\n}\r\n\r\nfunction getFallbackBorderStyleChange( side, border, globalBorderStyle ) {\r\n\tif ( ! border?.[ side ] || globalBorderStyle?.[ side ]?.style ) {\r\n\t\treturn [];\r\n\t}\r\n\r\n\tconst { color, style, width } = border[ side ];\r\n\tconst hasColorOrWidth = color || width;\r\n\r\n\tif ( ! hasColorOrWidth || style ) {\r\n\t\treturn [];\r\n\t}\r\n\r\n\treturn [ { path: [ 'border', side, 'style' ], value: 'solid' } ];\r\n}\r\n\r\nfunction useChangesToPush( name, attributes, userConfig ) {\r\n\tconst supports = useSupportedStyles( name );\r\n\tconst blockUserConfig = userConfig?.styles?.blocks?.[ name ];\r\n\r\n\treturn useMemo( () => {\r\n\t\tconst changes = supports.flatMap( ( key ) => {\r\n\t\t\tif ( ! STYLE_PROPERTY[ key ] ) {\r\n\t\t\t\treturn [];\r\n\t\t\t}\r\n\t\t\tconst { value: path } = STYLE_PROPERTY[ key ];\r\n\t\t\tconst presetAttributeKey = path.join( '.' );\r\n\t\t\tconst presetAttributeValue =\r\n\t\t\t\tattributes[\r\n\t\t\t\t\tSTYLE_PATH_TO_PRESET_BLOCK_ATTRIBUTE[ presetAttributeKey ]\r\n\t\t\t\t];\r\n\t\t\tconst value = presetAttributeValue\r\n\t\t\t\t? `var:preset|${ STYLE_PATH_TO_CSS_VAR_INFIX[ presetAttributeKey ] }|${ presetAttributeValue }`\r\n\t\t\t\t: getValueFromObjectPath( attributes.style, path );\r\n\r\n\t\t\t// Links only have a single support entry but have two element\r\n\t\t\t// style properties, color and hover color. The following check\r\n\t\t\t// will add the hover color to the changes if required.\r\n\t\t\tif ( key === 'linkColor' ) {\r\n\t\t\t\tconst linkChanges = value ? [ { path, value } ] : [];\r\n\t\t\t\tconst hoverPath = [\r\n\t\t\t\t\t'elements',\r\n\t\t\t\t\t'link',\r\n\t\t\t\t\t':hover',\r\n\t\t\t\t\t'color',\r\n\t\t\t\t\t'text',\r\n\t\t\t\t];\r\n\t\t\t\tconst hoverValue = getValueFromObjectPath(\r\n\t\t\t\t\tattributes.style,\r\n\t\t\t\t\thoverPath\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif ( hoverValue ) {\r\n\t\t\t\t\tlinkChanges.push( { path: hoverPath, value: hoverValue } );\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn linkChanges;\r\n\t\t\t}\r\n\r\n\t\t\t// The shorthand border styles can't be mapped directly as global\r\n\t\t\t// styles requires longhand config.\r\n\t\t\tif ( flatBorderProperties.includes( key ) && value ) {\r\n\t\t\t\t// The shorthand config path is included to clear the block attribute.\r\n\t\t\t\tconst borderChanges = [ { path, value } ];\r\n\t\t\t\tsides.forEach( ( side ) => {\r\n\t\t\t\t\tconst currentPath = [ ...path ];\r\n\t\t\t\t\tcurrentPath.splice( -1, 0, side );\r\n\t\t\t\t\tborderChanges.push( { path: currentPath, value } );\r\n\t\t\t\t} );\r\n\t\t\t\treturn borderChanges;\r\n\t\t\t}\r\n\r\n\t\t\treturn value ? [ { path, value } ] : [];\r\n\t\t} );\r\n\r\n\t\t// To ensure display of a visible border, global styles require a\r\n\t\t// default border style if a border color or width is present.\r\n\t\tgetBorderStyleChanges(\r\n\t\t\tattributes.style?.border,\r\n\t\t\tattributes.borderColor,\r\n\t\t\tblockUserConfig?.border\r\n\t\t).forEach( ( change ) => changes.push( change ) );\r\n\r\n\t\treturn changes;\r\n\t}, [ supports, attributes, blockUserConfig ] );\r\n}\r\n\r\nfunction PushChangesToGlobalStylesControl( {\r\n\tname,\r\n\tattributes,\r\n\tsetAttributes,\r\n} ) {\r\n\tconst { user: userConfig, setUserConfig } =\r\n\t\tuseContext( GlobalStylesContext );\r\n\r\n\tconst changes = useChangesToPush( name, attributes, userConfig );\r\n\r\n\tconst { __unstableMarkNextChangeAsNotPersistent } =\r\n\t\tuseDispatch( blockEditorStore );\r\n\tconst { createSuccessNotice } = useDispatch( noticesStore );\r\n\r\n\tconst pushChanges = useCallback( () => {\r\n\t\tif ( changes.length === 0 ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif ( changes.length > 0 ) {\r\n\t\t\tconst { style: blockStyles } = attributes;\r\n\r\n\t\t\tconst newBlockStyles = structuredClone( blockStyles );\r\n\t\t\tconst newUserConfig = structuredClone( userConfig );\r\n\r\n\t\t\tfor ( const { path, value } of changes ) {\r\n\t\t\t\tsetNestedValue( newBlockStyles, path, undefined );\r\n\t\t\t\tsetNestedValue(\r\n\t\t\t\t\tnewUserConfig,\r\n\t\t\t\t\t[ 'styles', 'blocks', name, ...path ],\r\n\t\t\t\t\tvalue\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\tconst newBlockAttributes = {\r\n\t\t\t\tborderColor: undefined,\r\n\t\t\t\tbackgroundColor: undefined,\r\n\t\t\t\ttextColor: undefined,\r\n\t\t\t\tgradient: undefined,\r\n\t\t\t\tfontSize: undefined,\r\n\t\t\t\tfontFamily: undefined,\r\n\t\t\t\tstyle: cleanEmptyObject( newBlockStyles ),\r\n\t\t\t};\r\n\r\n\t\t\t// @wordpress/core-data doesn't support editing multiple entity types in\r\n\t\t\t// a single undo level. So for now, we disable @wordpress/core-data undo\r\n\t\t\t// tracking and implement our own Undo button in the snackbar\r\n\t\t\t// notification.\r\n\t\t\t__unstableMarkNextChangeAsNotPersistent();\r\n\t\t\tsetAttributes( newBlockAttributes );\r\n\t\t\tsetUserConfig( newUserConfig, { undoIgnore: true } );\r\n\t\t\tcreateSuccessNotice(\r\n\t\t\t\tsprintf(\r\n\t\t\t\t\t// translators: %s: Title of the block e.g. 'Heading'.\r\n\t\t\t\t\t__( '%s styles applied.' ),\r\n\t\t\t\t\tgetBlockType( name ).title\r\n\t\t\t\t),\r\n\t\t\t\t{\r\n\t\t\t\t\ttype: 'snackbar',\r\n\t\t\t\t\tactions: [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tlabel: __( 'Undo' ),\r\n\t\t\t\t\t\t\tonClick() {\r\n\t\t\t\t\t\t\t\t__unstableMarkNextChangeAsNotPersistent();\r\n\t\t\t\t\t\t\t\tsetAttributes( attributes );\r\n\t\t\t\t\t\t\t\tsetUserConfig( userConfig, {\r\n\t\t\t\t\t\t\t\t\tundoIgnore: true,\r\n\t\t\t\t\t\t\t\t} );\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t],\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t}, [\r\n\t\t__unstableMarkNextChangeAsNotPersistent,\r\n\t\tattributes,\r\n\t\tchanges,\r\n\t\tcreateSuccessNotice,\r\n\t\tname,\r\n\t\tsetAttributes,\r\n\t\tsetUserConfig,\r\n\t\tuserConfig,\r\n\t] );\r\n\r\n\treturn (\r\n\t\t<BaseControl\r\n\t\t\t__nextHasNoMarginBottom\r\n\t\t\tclassName=\"edit-site-push-changes-to-global-styles-control\"\r\n\t\t\thelp={ sprintf(\r\n\t\t\t\t// translators: %s: Title of the block e.g. 'Heading'.\r\n\t\t\t\t__(\r\n\t\t\t\t\t'Apply this blockâ€™s typography, spacing, dimensions, and color styles to all %s blocks.'\r\n\t\t\t\t),\r\n\t\t\t\tgetBlockType( name ).title\r\n\t\t\t) }\r\n\t\t>\r\n\t\t\t<BaseControl.VisualLabel>\r\n\t\t\t\t{ __( 'Styles' ) }\r\n\t\t\t</BaseControl.VisualLabel>\r\n\t\t\t<Button\r\n\t\t\t\t__next40pxDefaultSize\r\n\t\t\t\tvariant=\"secondary\"\r\n\t\t\t\taccessibleWhenDisabled\r\n\t\t\t\tdisabled={ changes.length === 0 }\r\n\t\t\t\tonClick={ pushChanges }\r\n\t\t\t>\r\n\t\t\t\t{ __( 'Apply globally' ) }\r\n\t\t\t</Button>\r\n\t\t</BaseControl>\r\n\t);\r\n}\r\n\r\nfunction PushChangesToGlobalStyles( props ) {\r\n\tconst blockEditingMode = useBlockEditingMode();\r\n\tconst isBlockBasedTheme = useSelect(\r\n\t\t( select ) => select( coreStore ).getCurrentTheme()?.is_block_theme,\r\n\t\t[]\r\n\t);\r\n\tconst supportsStyles = SUPPORTED_STYLES.some( ( feature ) =>\r\n\t\thasBlockSupport( props.name, feature )\r\n\t);\r\n\tconst isDisplayed =\r\n\t\tblockEditingMode === 'default' && supportsStyles && isBlockBasedTheme;\r\n\r\n\tif ( ! isDisplayed ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<InspectorAdvancedControls>\r\n\t\t\t<PushChangesToGlobalStylesControl { ...props } />\r\n\t\t</InspectorAdvancedControls>\r\n\t);\r\n}\r\n\r\nconst withPushChangesToGlobalStyles = createHigherOrderComponent(\r\n\t( BlockEdit ) => ( props ) => (\r\n\t\t<>\r\n\t\t\t<BlockEdit key=\"edit\" { ...props } />\r\n\t\t\t{ props.isSelected && <PushChangesToGlobalStyles { ...props } /> }\r\n\t\t</>\r\n\t)\r\n);\r\n\r\naddFilter(\r\n\t'editor.BlockEdit',\r\n\t'core/edit-site/push-changes-to-global-styles',\r\n\twithPushChangesToGlobalStyles\r\n);\r\n"],"mappings":"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","ignoreList":[]}