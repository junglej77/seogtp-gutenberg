{"version":3,"names":["store","blocksStore","registerCoreBlocks","__experimentalGetCoreBlocks","__experimentalRegisterExperimentalCoreBlocks","dispatch","deprecated","createRoot","StrictMode","editorStore","privateApis","editorPrivateApis","preferencesStore","registerLegacyWidgetBlock","registerWidgetGroupBlock","editSiteStore","unlock","App","jsx","_jsx","registerCoreBlockBindingsSources","bootstrapBlockBindingsSourcesFromServer","initializeEditor","id","settings","target","document","getElementById","root","reapplyBlockTypeFilters","coreBlocks","filter","name","blockBindingsSources","setFreeformFallbackBlockName","inserter","globalThis","IS_GUTENBERG_PLUGIN","enableFSEBlocks","setDefaults","welcomeGuide","welcomeGuideStyles","welcomeGuidePage","welcomeGuideTemplate","allowRightClickOverrides","distractionFree","editorMode","fixedToolbar","focusMode","inactivePanels","keepCaretInsideBlock","openPanels","showBlockBreadcrumbs","showListViewByDefault","enableChoosePatternModal","window","__experimentalMediaProcessing","requireApproval","optimizeOnUpload","updateSettings","updateEditorSettings","defaultTemplateTypes","defaultTemplatePartAreas","addEventListener","e","preventDefault","render","children","reinitializeEditor","since","version","default","PluginTemplateSettingPanel","initializePostsDashboard"],"sources":["@wordpress/edit-site/src/index.js"],"sourcesContent":["/**\r\n * WordPress 依赖项\r\n */\r\nimport { store as blocksStore } from '@wordpress/blocks'; // 导入 WordPress 块存储\r\nimport {\r\n\tregisterCoreBlocks, // 注册核心块\r\n\t__experimentalGetCoreBlocks, // 获取核心块（实验性）\r\n\t__experimentalRegisterExperimentalCoreBlocks, // 注册实验性核心块（实验性）\r\n} from '@wordpress/block-library'; // 从 WordPress 块库导入\r\nimport { dispatch } from '@wordpress/data'; // 导入数据分发函数\r\nimport deprecated from '@wordpress/deprecated'; // 导入弃用警告函数\r\nimport { createRoot, StrictMode } from '@wordpress/element'; // 导入 React 相关函数\r\nimport {\r\n\tstore as editorStore, // 导入编辑器存储\r\n\tprivateApis as editorPrivateApis, // 导入编辑器私有 API\r\n} from '@wordpress/editor'; // 从 WordPress 编辑器导入\r\nimport { store as preferencesStore } from '@wordpress/preferences'; // 导入偏好设置存储\r\nimport {\r\n\tregisterLegacyWidgetBlock, // 注册旧版小工具块\r\n\tregisterWidgetGroupBlock, // 注册小工具组块\r\n} from '@wordpress/widgets'; // 从 WordPress 小工具导入\r\n\r\n/**\r\n * 内部依赖项\r\n */\r\nimport './hooks'; // 导入钩子文件\r\nimport { store as editSiteStore } from './store'; // 导入站点编辑器存储\r\nimport { unlock } from './lock-unlock'; // 导入解锁函数\r\nimport App from './components/app'; // 导入应用组件\r\n\r\n// 解锁编辑器私有 API 中的函数\r\nconst {\r\n\tregisterCoreBlockBindingsSources, // 注册核心块绑定源\r\n\tbootstrapBlockBindingsSourcesFromServer, // 从服务器引导块绑定源\r\n} = unlock( editorPrivateApis );\r\n\r\n/**\r\n * 初始化站点编辑器屏幕。\r\n *\r\n * @param {string} id       根元素的 ID，用于渲染屏幕。\r\n * @param {Object} settings 编辑器设置。\r\n */\r\nexport function initializeEditor( id, settings ) {\r\n\tconst target = document.getElementById( id ); // 获取目标元素\r\n\tconst root = createRoot( target ); // 创建根元素\r\n\r\n\tdispatch( blocksStore ).reapplyBlockTypeFilters(); // 重新应用块类型过滤器\r\n\tconst coreBlocks = __experimentalGetCoreBlocks().filter( // 获取核心块并过滤掉 'core/freeform' 块\r\n\t\t( { name } ) => name !== 'core/freeform'\r\n\t);\r\n\tregisterCoreBlocks( coreBlocks ); // 注册核心块\r\n\tbootstrapBlockBindingsSourcesFromServer( settings?.blockBindingsSources ); // 从服务器引导块绑定源\r\n\tregisterCoreBlockBindingsSources(); // 注册核心块绑定源\r\n\tdispatch( blocksStore ).setFreeformFallbackBlockName( 'core/html' ); // 设置自由形式块的回退块名称\r\n\tregisterLegacyWidgetBlock( { inserter: false } ); // 注册旧版小工具块（不插入）\r\n\tregisterWidgetGroupBlock( { inserter: false } ); // 注册小工具组块（不插入）\r\n\tif ( globalThis.IS_GUTENBERG_PLUGIN ) { // 如果是 Gutenberg 插件\r\n\t\t__experimentalRegisterExperimentalCoreBlocks( { // 注册实验性核心块\r\n\t\t\tenableFSEBlocks: true,\r\n\t\t} );\r\n\t}\r\n\r\n\t// 在渲染之前同步分发操作和更新存储，以避免不必要的 useEffect 重新渲染\r\n\tdispatch( preferencesStore ).setDefaults( 'core/edit-site', {\r\n\t\twelcomeGuide: true, // 欢迎指南\r\n\t\twelcomeGuideStyles: true, // 欢迎指南样式\r\n\t\twelcomeGuidePage: true, // 欢迎指南页面\r\n\t\twelcomeGuideTemplate: true, // 欢迎指南模板\r\n\t} );\r\n\r\n\tdispatch( preferencesStore ).setDefaults( 'core', {\r\n\t\tallowRightClickOverrides: true, // 允许右键覆盖\r\n\t\tdistractionFree: false, // 无干扰模式\r\n\t\teditorMode: 'visual', // 编辑器模式\r\n\t\tfixedToolbar: false, // 固定工具栏\r\n\t\tfocusMode: false, // 焦点模式\r\n\t\tinactivePanels: [], // 非活动面板\r\n\t\tkeepCaretInsideBlock: false, // 保持光标在块内\r\n\t\topenPanels: [ 'post-status' ], // 打开的面板\r\n\t\tshowBlockBreadcrumbs: true, // 显示块面包屑\r\n\t\tshowListViewByDefault: false, // 默认显示列表视图\r\n\t\tenableChoosePatternModal: true, // 启用选择模式模态框\r\n\t} );\r\n\r\n\tif ( window.__experimentalMediaProcessing ) { // 如果启用实验性媒体处理\r\n\t\tdispatch( preferencesStore ).setDefaults( 'core/media', {\r\n\t\t\trequireApproval: true, // 需要批准\r\n\t\t\toptimizeOnUpload: true, // 上传时优化\r\n\t\t} );\r\n\t}\r\n\r\n\tdispatch( editSiteStore ).updateSettings( settings ); // 更新站点编辑器设置\r\n\r\n\t// 将 defaultTemplateTypes 保存在 core/editor 设置中，以便在任何编辑器中使用 core/editor 选择器进行选择\r\n\t// 这是必需的，因为 edit-site 不会使用 EditorProvider 初始化，后者内部也使用 updateEditorSettings\r\n\tdispatch( editorStore ).updateEditorSettings( {\r\n\t\tdefaultTemplateTypes: settings.defaultTemplateTypes, // 默认模板类型\r\n\t\tdefaultTemplatePartAreas: settings.defaultTemplatePartAreas, // 默认模板部分区域\r\n\t} );\r\n\r\n\t// 防止文件拖放到非拖放区域时的默认浏览器行为\r\n\twindow.addEventListener( 'dragover', ( e ) => e.preventDefault(), false );\r\n\twindow.addEventListener( 'drop', ( e ) => e.preventDefault(), false );\r\n\r\n\troot.render( // 渲染应用\r\n\t\t<StrictMode>\r\n\t\t\t<App />\r\n\t\t</StrictMode>\r\n\t);\r\n\r\n\treturn root; // 返回根元素\r\n}\r\n\r\n/**\r\n * 重新初始化编辑器（已弃用）\r\n */\r\nexport function reinitializeEditor() {\r\n\tdeprecated( 'wp.editSite.reinitializeEditor', {\r\n\t\tsince: '6.2', // 自 6.2 版本起\r\n\t\tversion: '6.3', // 在 6.3 版本中弃用\r\n\t} );\r\n}\r\n\r\n// 导出组件和存储\r\nexport { default as PluginTemplateSettingPanel } from './components/plugin-template-setting-panel';\r\nexport { store } from './store';\r\nexport * from './deprecated';\r\n\r\n// 临时：在帖子仪表板迭代期间，它与站点编辑器构建在同一个包中\r\nexport { initializePostsDashboard } from './posts';\r\n"],"mappings":"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","ignoreList":[]}