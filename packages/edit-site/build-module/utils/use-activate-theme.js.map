{"version":3,"names":["store","coreStore","useDispatch","privateApis","routerPrivateApis","unlock","isPreviewingTheme","currentlyPreviewingTheme","useHistory","useActivateTheme","history","startResolution","finishResolution","activationURL","window","WP_BLOCK_THEME_ACTIVATE_NONCE","fetch","params","getLocationWithParams","replace","wp_theme_preview","undefined"],"sources":["@wordpress/edit-site/src/utils/use-activate-theme.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { store as coreStore } from '@wordpress/core-data';\r\nimport { useDispatch } from '@wordpress/data';\r\nimport { privateApis as routerPrivateApis } from '@wordpress/router';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { unlock } from '../lock-unlock';\r\nimport {\r\n\tisPreviewingTheme,\r\n\tcurrentlyPreviewingTheme,\r\n} from './is-previewing-theme';\r\n\r\nconst { useHistory } = unlock( routerPrivateApis );\r\n\r\n/**\r\n * This should be refactored to use the REST API, once the REST API can activate themes.\r\n *\r\n * @return {Function} A function that activates the theme.\r\n */\r\nexport function useActivateTheme() {\r\n\tconst history = useHistory();\r\n\tconst { startResolution, finishResolution } = useDispatch( coreStore );\r\n\r\n\treturn async () => {\r\n\t\tif ( isPreviewingTheme() ) {\r\n\t\t\tconst activationURL =\r\n\t\t\t\t'themes.php?action=activate&stylesheet=' +\r\n\t\t\t\tcurrentlyPreviewingTheme() +\r\n\t\t\t\t'&_wpnonce=' +\r\n\t\t\t\twindow.WP_BLOCK_THEME_ACTIVATE_NONCE;\r\n\t\t\tstartResolution( 'activateTheme' );\r\n\t\t\tawait window.fetch( activationURL );\r\n\t\t\tfinishResolution( 'activateTheme' );\r\n\t\t\t// Remove the wp_theme_preview query param: we've finished activating\r\n\t\t\t// the queue and are switching to normal Site Editor.\r\n\t\t\tconst { params } = history.getLocationWithParams();\r\n\t\t\thistory.replace( { ...params, wp_theme_preview: undefined } );\r\n\t\t}\r\n\t};\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,KAAK,IAAIC,SAAS,QAAQ,sBAAsB;AACzD,SAASC,WAAW,QAAQ,iBAAiB;AAC7C,SAASC,WAAW,IAAIC,iBAAiB,QAAQ,mBAAmB;;AAEpE;AACA;AACA;AACA,SAASC,MAAM,QAAQ,gBAAgB;AACvC,SACCC,iBAAiB,EACjBC,wBAAwB,QAClB,uBAAuB;AAE9B,MAAM;EAAEC;AAAW,CAAC,GAAGH,MAAM,CAAED,iBAAkB,CAAC;;AAElD;AACA;AACA;AACA;AACA;AACA,OAAO,SAASK,gBAAgBA,CAAA,EAAG;EAClC,MAAMC,OAAO,GAAGF,UAAU,CAAC,CAAC;EAC5B,MAAM;IAAEG,eAAe;IAAEC;EAAiB,CAAC,GAAGV,WAAW,CAAED,SAAU,CAAC;EAEtE,OAAO,YAAY;IAClB,IAAKK,iBAAiB,CAAC,CAAC,EAAG;MAC1B,MAAMO,aAAa,GAClB,wCAAwC,GACxCN,wBAAwB,CAAC,CAAC,GAC1B,YAAY,GACZO,MAAM,CAACC,6BAA6B;MACrCJ,eAAe,CAAE,eAAgB,CAAC;MAClC,MAAMG,MAAM,CAACE,KAAK,CAAEH,aAAc,CAAC;MACnCD,gBAAgB,CAAE,eAAgB,CAAC;MACnC;MACA;MACA,MAAM;QAAEK;MAAO,CAAC,GAAGP,OAAO,CAACQ,qBAAqB,CAAC,CAAC;MAClDR,OAAO,CAACS,OAAO,CAAE;QAAE,GAAGF,MAAM;QAAEG,gBAAgB,EAAEC;MAAU,CAAE,CAAC;IAC9D;EACD,CAAC;AACF","ignoreList":[]}