{"version":3,"names":["store","blocksStore","withSelect","withDispatch","SearchControl","Button","__","_n","sprintf","useEffect","useState","useDebounce","compose","speak","preferencesStore","unlock","editorStore","BlockManagerCategory","jsx","_jsx","jsxs","_jsxs","BlockManager","blockTypes","categories","hasBlockSupport","isMatchingSearchTerm","numberOfHiddenBlocks","enableAllBlockTypes","debouncedSpeak","search","setSearch","filter","blockType","parent","includes","count","length","resultsFoundMessage","className","children","__next40pxDefaultSize","variant","onClick","__nextHasNoMarginBottom","label","placeholder","value","onChange","nextSearch","tabIndex","role","map","category","title","slug","select","_get","getBlockTypes","getCategories","get","hiddenBlockTypes","hiddenBlock","some","registeredBlock","name","Array","isArray","dispatch","showBlockTypes","blockNames"],"sources":["@wordpress/editor/src/components/block-manager/index.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { store as blocksStore } from '@wordpress/blocks';\r\nimport { withSelect, withDispatch } from '@wordpress/data';\r\nimport { SearchControl, Button } from '@wordpress/components';\r\nimport { __, _n, sprintf } from '@wordpress/i18n';\r\nimport { useEffect, useState } from '@wordpress/element';\r\nimport { useDebounce, compose } from '@wordpress/compose';\r\nimport { speak } from '@wordpress/a11y';\r\nimport { store as preferencesStore } from '@wordpress/preferences';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { unlock } from '../../lock-unlock';\r\nimport { store as editorStore } from '../../store';\r\nimport BlockManagerCategory from './category';\r\n\r\nfunction BlockManager( {\r\n\tblockTypes,\r\n\tcategories,\r\n\thasBlockSupport,\r\n\tisMatchingSearchTerm,\r\n\tnumberOfHiddenBlocks,\r\n\tenableAllBlockTypes,\r\n} ) {\r\n\tconst debouncedSpeak = useDebounce( speak, 500 );\r\n\tconst [ search, setSearch ] = useState( '' );\r\n\r\n\t// Filtering occurs here (as opposed to `withSelect`) to avoid\r\n\t// wasted renders by consequence of `Array#filter` producing\r\n\t// a new value reference on each call.\r\n\tblockTypes = blockTypes.filter(\r\n\t\t( blockType ) =>\r\n\t\t\thasBlockSupport( blockType, 'inserter', true ) &&\r\n\t\t\t( ! search || isMatchingSearchTerm( blockType, search ) ) &&\r\n\t\t\t( ! blockType.parent ||\r\n\t\t\t\tblockType.parent.includes( 'core/post-content' ) )\r\n\t);\r\n\r\n\t// Announce search results on change\r\n\tuseEffect( () => {\r\n\t\tif ( ! search ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst count = blockTypes.length;\r\n\t\tconst resultsFoundMessage = sprintf(\r\n\t\t\t/* translators: %d: number of results. */\r\n\t\t\t_n( '%d result found.', '%d results found.', count ),\r\n\t\t\tcount\r\n\t\t);\r\n\t\tdebouncedSpeak( resultsFoundMessage );\r\n\t}, [ blockTypes.length, search, debouncedSpeak ] );\r\n\r\n\treturn (\r\n\t\t<div className=\"editor-block-manager__content\">\r\n\t\t\t{ !! numberOfHiddenBlocks && (\r\n\t\t\t\t<div className=\"editor-block-manager__disabled-blocks-count\">\r\n\t\t\t\t\t{ sprintf(\r\n\t\t\t\t\t\t/* translators: %d: number of blocks. */\r\n\t\t\t\t\t\t_n(\r\n\t\t\t\t\t\t\t'%d block is hidden.',\r\n\t\t\t\t\t\t\t'%d blocks are hidden.',\r\n\t\t\t\t\t\t\tnumberOfHiddenBlocks\r\n\t\t\t\t\t\t),\r\n\t\t\t\t\t\tnumberOfHiddenBlocks\r\n\t\t\t\t\t) }\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\t// TODO: Switch to `true` (40px size) if possible\r\n\t\t\t\t\t\t__next40pxDefaultSize={ false }\r\n\t\t\t\t\t\tvariant=\"link\"\r\n\t\t\t\t\t\tonClick={ () => enableAllBlockTypes( blockTypes ) }\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{ __( 'Reset' ) }\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</div>\r\n\t\t\t) }\r\n\t\t\t<SearchControl\r\n\t\t\t\t__nextHasNoMarginBottom\r\n\t\t\t\tlabel={ __( 'Search for a block' ) }\r\n\t\t\t\tplaceholder={ __( 'Search for a block' ) }\r\n\t\t\t\tvalue={ search }\r\n\t\t\t\tonChange={ ( nextSearch ) => setSearch( nextSearch ) }\r\n\t\t\t\tclassName=\"editor-block-manager__search\"\r\n\t\t\t/>\r\n\t\t\t<div\r\n\t\t\t\ttabIndex=\"0\"\r\n\t\t\t\trole=\"region\"\r\n\t\t\t\taria-label={ __( 'Available block types' ) }\r\n\t\t\t\tclassName=\"editor-block-manager__results\"\r\n\t\t\t>\r\n\t\t\t\t{ blockTypes.length === 0 && (\r\n\t\t\t\t\t<p className=\"editor-block-manager__no-results\">\r\n\t\t\t\t\t\t{ __( 'No blocks found.' ) }\r\n\t\t\t\t\t</p>\r\n\t\t\t\t) }\r\n\t\t\t\t{ categories.map( ( category ) => (\r\n\t\t\t\t\t<BlockManagerCategory\r\n\t\t\t\t\t\tkey={ category.slug }\r\n\t\t\t\t\t\ttitle={ category.title }\r\n\t\t\t\t\t\tblockTypes={ blockTypes.filter(\r\n\t\t\t\t\t\t\t( blockType ) =>\r\n\t\t\t\t\t\t\t\tblockType.category === category.slug\r\n\t\t\t\t\t\t) }\r\n\t\t\t\t\t/>\r\n\t\t\t\t) ) }\r\n\t\t\t\t<BlockManagerCategory\r\n\t\t\t\t\ttitle={ __( 'Uncategorized' ) }\r\n\t\t\t\t\tblockTypes={ blockTypes.filter(\r\n\t\t\t\t\t\t( { category } ) => ! category\r\n\t\t\t\t\t) }\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport default compose( [\r\n\twithSelect( ( select ) => {\r\n\t\tconst {\r\n\t\t\tgetBlockTypes,\r\n\t\t\tgetCategories,\r\n\t\t\thasBlockSupport,\r\n\t\t\tisMatchingSearchTerm,\r\n\t\t} = select( blocksStore );\r\n\t\tconst { get } = select( preferencesStore );\r\n\r\n\t\t// Some hidden blocks become unregistered\r\n\t\t// by removing for instance the plugin that registered them, yet\r\n\t\t// they're still remain as hidden by the user's action.\r\n\t\t// We consider \"hidden\", blocks which were hidden and\r\n\t\t// are still registered.\r\n\t\tconst blockTypes = getBlockTypes();\r\n\t\tconst hiddenBlockTypes = (\r\n\t\t\tget( 'core', 'hiddenBlockTypes' ) ?? []\r\n\t\t).filter( ( hiddenBlock ) => {\r\n\t\t\treturn blockTypes.some(\r\n\t\t\t\t( registeredBlock ) => registeredBlock.name === hiddenBlock\r\n\t\t\t);\r\n\t\t} );\r\n\t\tconst numberOfHiddenBlocks =\r\n\t\t\tArray.isArray( hiddenBlockTypes ) && hiddenBlockTypes.length;\r\n\r\n\t\treturn {\r\n\t\t\tblockTypes,\r\n\t\t\tcategories: getCategories(),\r\n\t\t\thasBlockSupport,\r\n\t\t\tisMatchingSearchTerm,\r\n\t\t\tnumberOfHiddenBlocks,\r\n\t\t};\r\n\t} ),\r\n\twithDispatch( ( dispatch ) => {\r\n\t\tconst { showBlockTypes } = unlock( dispatch( editorStore ) );\r\n\t\treturn {\r\n\t\t\tenableAllBlockTypes: ( blockTypes ) => {\r\n\t\t\t\tconst blockNames = blockTypes.map( ( { name } ) => name );\r\n\t\t\t\tshowBlockTypes( blockNames );\r\n\t\t\t},\r\n\t\t};\r\n\t} ),\r\n] )( BlockManager );\r\n"],"mappings":"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","ignoreList":[]}