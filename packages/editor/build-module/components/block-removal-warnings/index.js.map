{"version":3,"names":["_n","privateApis","blockEditorPrivateApis","useSelect","useMemo","unlock","store","editorStore","jsx","_jsx","BlockRemovalWarningModal","TEMPLATE_BLOCKS","BLOCK_REMOVAL_RULES","postTypes","callback","removedBlocks","removedTemplateBlocks","filter","name","includes","length","removedBlocksWithOverrides","attributes","metadata","bindings","Object","values","some","binding","source","BlockRemovalWarnings","currentPostType","select","getCurrentPostType","removalRulesForPostType","rule","rules"],"sources":["@wordpress/editor/src/components/block-removal-warnings/index.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\n\r\nimport { _n } from '@wordpress/i18n';\r\nimport { privateApis as blockEditorPrivateApis } from '@wordpress/block-editor';\r\nimport { useSelect } from '@wordpress/data';\r\nimport { useMemo } from '@wordpress/element';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { unlock } from '../../lock-unlock';\r\nimport { store as editorStore } from '../../store';\r\n\r\nconst { BlockRemovalWarningModal } = unlock( blockEditorPrivateApis );\r\n\r\n// Prevent accidental removal of certain blocks, asking the user for confirmation first.\r\nconst TEMPLATE_BLOCKS = [\r\n\t'core/post-content',\r\n\t'core/post-template',\r\n\t'core/query',\r\n];\r\nconst BLOCK_REMOVAL_RULES = [\r\n\t{\r\n\t\t// Template blocks.\r\n\t\t// The warning is only shown when a user manipulates templates or template parts.\r\n\t\tpostTypes: [ 'wp_template', 'wp_template_part' ],\r\n\t\tcallback( removedBlocks ) {\r\n\t\t\tconst removedTemplateBlocks = removedBlocks.filter( ( { name } ) =>\r\n\t\t\t\tTEMPLATE_BLOCKS.includes( name )\r\n\t\t\t);\r\n\t\t\tif ( removedTemplateBlocks.length ) {\r\n\t\t\t\treturn _n(\r\n\t\t\t\t\t'Deleting this block will stop your post or page content from displaying on this template. It is not recommended.',\r\n\t\t\t\t\t'Some of the deleted blocks will stop your post or page content from displaying on this template. It is not recommended.',\r\n\t\t\t\t\tremovedBlocks.length\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t},\r\n\t},\r\n\t{\r\n\t\t// Pattern overrides.\r\n\t\t// The warning is only shown when the user edits a pattern.\r\n\t\tpostTypes: [ 'wp_block' ],\r\n\t\tcallback( removedBlocks ) {\r\n\t\t\tconst removedBlocksWithOverrides = removedBlocks.filter(\r\n\t\t\t\t( { attributes } ) =>\r\n\t\t\t\t\tattributes?.metadata?.bindings &&\r\n\t\t\t\t\tObject.values( attributes.metadata.bindings ).some(\r\n\t\t\t\t\t\t( binding ) =>\r\n\t\t\t\t\t\t\tbinding.source === 'core/pattern-overrides'\r\n\t\t\t\t\t)\r\n\t\t\t);\r\n\t\t\tif ( removedBlocksWithOverrides.length ) {\r\n\t\t\t\treturn _n(\r\n\t\t\t\t\t'The deleted block allows instance overrides. Removing it may result in content not displaying where this pattern is used. Are you sure you want to proceed?',\r\n\t\t\t\t\t'Some of the deleted blocks allow instance overrides. Removing them may result in content not displaying where this pattern is used. Are you sure you want to proceed?',\r\n\t\t\t\t\tremovedBlocks.length\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t},\r\n\t},\r\n];\r\n\r\nexport default function BlockRemovalWarnings() {\r\n\tconst currentPostType = useSelect(\r\n\t\t( select ) => select( editorStore ).getCurrentPostType(),\r\n\t\t[]\r\n\t);\r\n\r\n\tconst removalRulesForPostType = useMemo(\r\n\t\t() =>\r\n\t\t\tBLOCK_REMOVAL_RULES.filter( ( rule ) =>\r\n\t\t\t\trule.postTypes.includes( currentPostType )\r\n\t\t\t),\r\n\t\t[ currentPostType ]\r\n\t);\r\n\r\n\t// `BlockRemovalWarnings` is rendered in the editor provider, a shared component\r\n\t// across react native and web. However, `BlockRemovalWarningModal` is web only.\r\n\t// Check it exists before trying to render it.\r\n\tif ( ! BlockRemovalWarningModal ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tif ( ! removalRulesForPostType ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\treturn <BlockRemovalWarningModal rules={ removalRulesForPostType } />;\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;;AAEA,SAASA,EAAE,QAAQ,iBAAiB;AACpC,SAASC,WAAW,IAAIC,sBAAsB,QAAQ,yBAAyB;AAC/E,SAASC,SAAS,QAAQ,iBAAiB;AAC3C,SAASC,OAAO,QAAQ,oBAAoB;;AAE5C;AACA;AACA;AACA,SAASC,MAAM,QAAQ,mBAAmB;AAC1C,SAASC,KAAK,IAAIC,WAAW,QAAQ,aAAa;AAAC,SAAAC,GAAA,IAAAC,IAAA;AAEnD,MAAM;EAAEC;AAAyB,CAAC,GAAGL,MAAM,CAAEH,sBAAuB,CAAC;;AAErE;AACA,MAAMS,eAAe,GAAG,CACvB,mBAAmB,EACnB,oBAAoB,EACpB,YAAY,CACZ;AACD,MAAMC,mBAAmB,GAAG,CAC3B;EACC;EACA;EACAC,SAAS,EAAE,CAAE,aAAa,EAAE,kBAAkB,CAAE;EAChDC,QAAQA,CAAEC,aAAa,EAAG;IACzB,MAAMC,qBAAqB,GAAGD,aAAa,CAACE,MAAM,CAAE,CAAE;MAAEC;IAAK,CAAC,KAC7DP,eAAe,CAACQ,QAAQ,CAAED,IAAK,CAChC,CAAC;IACD,IAAKF,qBAAqB,CAACI,MAAM,EAAG;MACnC,OAAOpB,EAAE,CACR,kHAAkH,EAClH,yHAAyH,EACzHe,aAAa,CAACK,MACf,CAAC;IACF;EACD;AACD,CAAC,EACD;EACC;EACA;EACAP,SAAS,EAAE,CAAE,UAAU,CAAE;EACzBC,QAAQA,CAAEC,aAAa,EAAG;IACzB,MAAMM,0BAA0B,GAAGN,aAAa,CAACE,MAAM,CACtD,CAAE;MAAEK;IAAW,CAAC,KACfA,UAAU,EAAEC,QAAQ,EAAEC,QAAQ,IAC9BC,MAAM,CAACC,MAAM,CAAEJ,UAAU,CAACC,QAAQ,CAACC,QAAS,CAAC,CAACG,IAAI,CAC/CC,OAAO,IACRA,OAAO,CAACC,MAAM,KAAK,wBACrB,CACF,CAAC;IACD,IAAKR,0BAA0B,CAACD,MAAM,EAAG;MACxC,OAAOpB,EAAE,CACR,6JAA6J,EAC7J,uKAAuK,EACvKe,aAAa,CAACK,MACf,CAAC;IACF;EACD;AACD,CAAC,CACD;AAED,eAAe,SAASU,oBAAoBA,CAAA,EAAG;EAC9C,MAAMC,eAAe,GAAG5B,SAAS,CAC9B6B,MAAM,IAAMA,MAAM,CAAEzB,WAAY,CAAC,CAAC0B,kBAAkB,CAAC,CAAC,EACxD,EACD,CAAC;EAED,MAAMC,uBAAuB,GAAG9B,OAAO,CACtC,MACCQ,mBAAmB,CAACK,MAAM,CAAIkB,IAAI,IACjCA,IAAI,CAACtB,SAAS,CAACM,QAAQ,CAAEY,eAAgB,CAC1C,CAAC,EACF,CAAEA,eAAe,CAClB,CAAC;;EAED;EACA;EACA;EACA,IAAK,CAAErB,wBAAwB,EAAG;IACjC,OAAO,IAAI;EACZ;EAEA,IAAK,CAAEwB,uBAAuB,EAAG;IAChC,OAAO,IAAI;EACZ;EAEA,oBAAOzB,IAAA,CAACC,wBAAwB;IAAC0B,KAAK,EAAGF;EAAyB,CAAE,CAAC;AACtE","ignoreList":[]}