{"version":3,"names":["BlockSettingsMenuControls","__unstableBlockSettingsMenuFirstItem","BlockSettingsMenuFirstItem","store","blockEditorStore","useBlockDisplayInformation","coreStore","__experimentalText","Text","MenuItem","useSelect","useDispatch","__","_x","editorStore","unlock","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","ContentOnlySettingsMenuItems","clientId","onClose","entity","onNavigateToEntityRecord","canEditTemplates","select","getBlockEditingMode","getBlockParentsByBlockName","getSettings","getBlockAttributes","contentOnly","patternParent","record","getEntityRecord","ref","getCurrentTemplateId","templateId","getContentLockingParent","_canEditTemplates","canUser","kind","name","TemplateLockContentOnlyMenuItems","isPattern","type","helpText","children","onClick","postId","id","postType","disabled","variant","as","className","contentLockingParent","blockDisplayInformation","blockEditorActions","title","modifyContentLockBlock","ContentOnlySettingsMenu","selectedClientIds","length"],"sources":["@wordpress/editor/src/components/block-settings-menu/content-only-settings-menu.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport {\r\n\tBlockSettingsMenuControls,\r\n\t__unstableBlockSettingsMenuFirstItem as BlockSettingsMenuFirstItem,\r\n\tstore as blockEditorStore,\r\n\tuseBlockDisplayInformation,\r\n} from '@wordpress/block-editor';\r\nimport { store as coreStore } from '@wordpress/core-data';\r\nimport { __experimentalText as Text, MenuItem } from '@wordpress/components';\r\nimport { useSelect, useDispatch } from '@wordpress/data';\r\nimport { __, _x } from '@wordpress/i18n';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { store as editorStore } from '../../store';\r\nimport { unlock } from '../../lock-unlock';\r\n\r\nfunction ContentOnlySettingsMenuItems( { clientId, onClose } ) {\r\n\tconst { entity, onNavigateToEntityRecord, canEditTemplates } = useSelect(\r\n\t\t( select ) => {\r\n\t\t\tconst {\r\n\t\t\t\tgetBlockEditingMode,\r\n\t\t\t\tgetBlockParentsByBlockName,\r\n\t\t\t\tgetSettings,\r\n\t\t\t\tgetBlockAttributes,\r\n\t\t\t} = select( blockEditorStore );\r\n\t\t\tconst contentOnly =\r\n\t\t\t\tgetBlockEditingMode( clientId ) === 'contentOnly';\r\n\t\t\tif ( ! contentOnly ) {\r\n\t\t\t\treturn {};\r\n\t\t\t}\r\n\t\t\tconst patternParent = getBlockParentsByBlockName(\r\n\t\t\t\tclientId,\r\n\t\t\t\t'core/block',\r\n\t\t\t\ttrue\r\n\t\t\t)[ 0 ];\r\n\r\n\t\t\tlet record;\r\n\t\t\tif ( patternParent ) {\r\n\t\t\t\trecord = select( coreStore ).getEntityRecord(\r\n\t\t\t\t\t'postType',\r\n\t\t\t\t\t'wp_block',\r\n\t\t\t\t\tgetBlockAttributes( patternParent ).ref\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tconst { getCurrentTemplateId } = select( editorStore );\r\n\t\t\t\tconst templateId = getCurrentTemplateId();\r\n\t\t\t\tconst { getContentLockingParent } = unlock(\r\n\t\t\t\t\tselect( blockEditorStore )\r\n\t\t\t\t);\r\n\t\t\t\tif ( ! getContentLockingParent( clientId ) && templateId ) {\r\n\t\t\t\t\trecord = select( coreStore ).getEntityRecord(\r\n\t\t\t\t\t\t'postType',\r\n\t\t\t\t\t\t'wp_template',\r\n\t\t\t\t\t\ttemplateId\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst _canEditTemplates = select( coreStore ).canUser( 'create', {\r\n\t\t\t\tkind: 'postType',\r\n\t\t\t\tname: 'wp_template',\r\n\t\t\t} );\r\n\t\t\treturn {\r\n\t\t\t\tcanEditTemplates: _canEditTemplates,\r\n\t\t\t\tentity: record,\r\n\t\t\t\tonNavigateToEntityRecord:\r\n\t\t\t\t\tgetSettings().onNavigateToEntityRecord,\r\n\t\t\t};\r\n\t\t},\r\n\t\t[ clientId ]\r\n\t);\r\n\r\n\tif ( ! entity ) {\r\n\t\treturn (\r\n\t\t\t<TemplateLockContentOnlyMenuItems\r\n\t\t\t\tclientId={ clientId }\r\n\t\t\t\tonClose={ onClose }\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n\r\n\tconst isPattern = entity.type === 'wp_block';\r\n\tlet helpText = isPattern\r\n\t\t? __(\r\n\t\t\t\t'Edit the pattern to move, delete, or make further changes to this block.'\r\n\t\t  )\r\n\t\t: __(\r\n\t\t\t\t'Edit the template to move, delete, or make further changes to this block.'\r\n\t\t  );\r\n\r\n\tif ( ! canEditTemplates ) {\r\n\t\thelpText = __(\r\n\t\t\t'Only users with permissions to edit the template can move or delete this block'\r\n\t\t);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<BlockSettingsMenuFirstItem>\r\n\t\t\t\t<MenuItem\r\n\t\t\t\t\tonClick={ () => {\r\n\t\t\t\t\t\tonNavigateToEntityRecord( {\r\n\t\t\t\t\t\t\tpostId: entity.id,\r\n\t\t\t\t\t\t\tpostType: entity.type,\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t} }\r\n\t\t\t\t\tdisabled={ ! canEditTemplates }\r\n\t\t\t\t>\r\n\t\t\t\t\t{ isPattern ? __( 'Edit pattern' ) : __( 'Edit template' ) }\r\n\t\t\t\t</MenuItem>\r\n\t\t\t</BlockSettingsMenuFirstItem>\r\n\t\t\t<Text\r\n\t\t\t\tvariant=\"muted\"\r\n\t\t\t\tas=\"p\"\r\n\t\t\t\tclassName=\"editor-content-only-settings-menu__description\"\r\n\t\t\t>\r\n\t\t\t\t{ helpText }\r\n\t\t\t</Text>\r\n\t\t</>\r\n\t);\r\n}\r\n\r\nfunction TemplateLockContentOnlyMenuItems( { clientId, onClose } ) {\r\n\tconst { contentLockingParent } = useSelect(\r\n\t\t( select ) => {\r\n\t\t\tconst { getContentLockingParent } = unlock(\r\n\t\t\t\tselect( blockEditorStore )\r\n\t\t\t);\r\n\t\t\treturn {\r\n\t\t\t\tcontentLockingParent: getContentLockingParent( clientId ),\r\n\t\t\t};\r\n\t\t},\r\n\t\t[ clientId ]\r\n\t);\r\n\tconst blockDisplayInformation =\r\n\t\tuseBlockDisplayInformation( contentLockingParent );\r\n\tconst blockEditorActions = useDispatch( blockEditorStore );\r\n\tif ( ! blockDisplayInformation?.title ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconst { modifyContentLockBlock } = unlock( blockEditorActions );\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<BlockSettingsMenuFirstItem>\r\n\t\t\t\t<MenuItem\r\n\t\t\t\t\tonClick={ () => {\r\n\t\t\t\t\t\tmodifyContentLockBlock( contentLockingParent );\r\n\t\t\t\t\t\tonClose();\r\n\t\t\t\t\t} }\r\n\t\t\t\t>\r\n\t\t\t\t\t{ _x( 'Unlock', 'Unlock content locked blocks' ) }\r\n\t\t\t\t</MenuItem>\r\n\t\t\t</BlockSettingsMenuFirstItem>\r\n\t\t\t<Text\r\n\t\t\t\tvariant=\"muted\"\r\n\t\t\t\tas=\"p\"\r\n\t\t\t\tclassName=\"editor-content-only-settings-menu__description\"\r\n\t\t\t>\r\n\t\t\t\t{ __(\r\n\t\t\t\t\t'Temporarily unlock the parent block to edit, delete or make further changes to this block.'\r\n\t\t\t\t) }\r\n\t\t\t</Text>\r\n\t\t</>\r\n\t);\r\n}\r\n\r\nexport default function ContentOnlySettingsMenu() {\r\n\treturn (\r\n\t\t<BlockSettingsMenuControls>\r\n\t\t\t{ ( { selectedClientIds, onClose } ) =>\r\n\t\t\t\tselectedClientIds.length === 1 && (\r\n\t\t\t\t\t<ContentOnlySettingsMenuItems\r\n\t\t\t\t\t\tclientId={ selectedClientIds[ 0 ] }\r\n\t\t\t\t\t\tonClose={ onClose }\r\n\t\t\t\t\t/>\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t</BlockSettingsMenuControls>\r\n\t);\r\n}\r\n"],"mappings":"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","ignoreList":[]}