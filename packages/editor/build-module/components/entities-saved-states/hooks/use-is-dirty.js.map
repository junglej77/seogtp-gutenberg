{"version":3,"names":["useSelect","store","coreStore","useMemo","useState","useIsDirty","editedEntities","siteEdits","siteEntityConfig","select","__experimentalGetDirtyEntityRecords","getEntityRecordEdits","getEntityConfig","dirtyEntityRecords","_siteEntityConfig$met","editedEntitiesWithoutSite","filter","record","kind","name","siteEntityLabels","meta","labels","editedSiteEntities","property","push","title","unselectedEntities","_setUnselectedEntities","setUnselectedEntities","key","checked","elt","isDirty","length"],"sources":["@wordpress/editor/src/components/entities-saved-states/hooks/use-is-dirty.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useSelect } from '@wordpress/data';\r\nimport { store as coreStore } from '@wordpress/core-data';\r\nimport { useMemo, useState } from '@wordpress/element';\r\n\r\n/**\r\n * Custom hook that determines if any entities are dirty (edited) and provides a way to manage selected/unselected entities.\r\n *\r\n * @return {Object} An object containing the following properties:\r\n *   - dirtyEntityRecords: An array of dirty entity records.\r\n *   - isDirty: A boolean indicating if there are any dirty entity records.\r\n *   - setUnselectedEntities: A function to set the unselected entities.\r\n *   - unselectedEntities: An array of unselected entities.\r\n */\r\nexport const useIsDirty = () => {\r\n\tconst { editedEntities, siteEdits, siteEntityConfig } = useSelect(\r\n\t\t( select ) => {\r\n\t\t\tconst {\r\n\t\t\t\t__experimentalGetDirtyEntityRecords,\r\n\t\t\t\tgetEntityRecordEdits,\r\n\t\t\t\tgetEntityConfig,\r\n\t\t\t} = select( coreStore );\r\n\r\n\t\t\treturn {\r\n\t\t\t\teditedEntities: __experimentalGetDirtyEntityRecords(),\r\n\t\t\t\tsiteEdits: getEntityRecordEdits( 'root', 'site' ),\r\n\t\t\t\tsiteEntityConfig: getEntityConfig( 'root', 'site' ),\r\n\t\t\t};\r\n\t\t},\r\n\t\t[]\r\n\t);\r\n\r\n\tconst dirtyEntityRecords = useMemo( () => {\r\n\t\t// Remove site object and decouple into its edited pieces.\r\n\t\tconst editedEntitiesWithoutSite = editedEntities.filter(\r\n\t\t\t( record ) => ! ( record.kind === 'root' && record.name === 'site' )\r\n\t\t);\r\n\r\n\t\tconst siteEntityLabels = siteEntityConfig?.meta?.labels ?? {};\r\n\t\tconst editedSiteEntities = [];\r\n\t\tfor ( const property in siteEdits ) {\r\n\t\t\teditedSiteEntities.push( {\r\n\t\t\t\tkind: 'root',\r\n\t\t\t\tname: 'site',\r\n\t\t\t\ttitle: siteEntityLabels[ property ] || property,\r\n\t\t\t\tproperty,\r\n\t\t\t} );\r\n\t\t}\r\n\t\treturn [ ...editedEntitiesWithoutSite, ...editedSiteEntities ];\r\n\t}, [ editedEntities, siteEdits, siteEntityConfig ] );\r\n\r\n\t// Unchecked entities to be ignored by save function.\r\n\tconst [ unselectedEntities, _setUnselectedEntities ] = useState( [] );\r\n\r\n\tconst setUnselectedEntities = (\r\n\t\t{ kind, name, key, property },\r\n\t\tchecked\r\n\t) => {\r\n\t\tif ( checked ) {\r\n\t\t\t_setUnselectedEntities(\r\n\t\t\t\tunselectedEntities.filter(\r\n\t\t\t\t\t( elt ) =>\r\n\t\t\t\t\t\telt.kind !== kind ||\r\n\t\t\t\t\t\telt.name !== name ||\r\n\t\t\t\t\t\telt.key !== key ||\r\n\t\t\t\t\t\telt.property !== property\r\n\t\t\t\t)\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\t_setUnselectedEntities( [\r\n\t\t\t\t...unselectedEntities,\r\n\t\t\t\t{ kind, name, key, property },\r\n\t\t\t] );\r\n\t\t}\r\n\t};\r\n\r\n\tconst isDirty = dirtyEntityRecords.length - unselectedEntities.length > 0;\r\n\r\n\treturn {\r\n\t\tdirtyEntityRecords,\r\n\t\tisDirty,\r\n\t\tsetUnselectedEntities,\r\n\t\tunselectedEntities,\r\n\t};\r\n};\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,SAAS,QAAQ,iBAAiB;AAC3C,SAASC,KAAK,IAAIC,SAAS,QAAQ,sBAAsB;AACzD,SAASC,OAAO,EAAEC,QAAQ,QAAQ,oBAAoB;;AAEtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,MAAMC,UAAU,GAAGA,CAAA,KAAM;EAC/B,MAAM;IAAEC,cAAc;IAAEC,SAAS;IAAEC;EAAiB,CAAC,GAAGR,SAAS,CAC9DS,MAAM,IAAM;IACb,MAAM;MACLC,mCAAmC;MACnCC,oBAAoB;MACpBC;IACD,CAAC,GAAGH,MAAM,CAAEP,SAAU,CAAC;IAEvB,OAAO;MACNI,cAAc,EAAEI,mCAAmC,CAAC,CAAC;MACrDH,SAAS,EAAEI,oBAAoB,CAAE,MAAM,EAAE,MAAO,CAAC;MACjDH,gBAAgB,EAAEI,eAAe,CAAE,MAAM,EAAE,MAAO;IACnD,CAAC;EACF,CAAC,EACD,EACD,CAAC;EAED,MAAMC,kBAAkB,GAAGV,OAAO,CAAE,MAAM;IAAA,IAAAW,qBAAA;IACzC;IACA,MAAMC,yBAAyB,GAAGT,cAAc,CAACU,MAAM,CACpDC,MAAM,IAAM,EAAIA,MAAM,CAACC,IAAI,KAAK,MAAM,IAAID,MAAM,CAACE,IAAI,KAAK,MAAM,CACnE,CAAC;IAED,MAAMC,gBAAgB,IAAAN,qBAAA,GAAGN,gBAAgB,EAAEa,IAAI,EAAEC,MAAM,cAAAR,qBAAA,cAAAA,qBAAA,GAAI,CAAC,CAAC;IAC7D,MAAMS,kBAAkB,GAAG,EAAE;IAC7B,KAAM,MAAMC,QAAQ,IAAIjB,SAAS,EAAG;MACnCgB,kBAAkB,CAACE,IAAI,CAAE;QACxBP,IAAI,EAAE,MAAM;QACZC,IAAI,EAAE,MAAM;QACZO,KAAK,EAAEN,gBAAgB,CAAEI,QAAQ,CAAE,IAAIA,QAAQ;QAC/CA;MACD,CAAE,CAAC;IACJ;IACA,OAAO,CAAE,GAAGT,yBAAyB,EAAE,GAAGQ,kBAAkB,CAAE;EAC/D,CAAC,EAAE,CAAEjB,cAAc,EAAEC,SAAS,EAAEC,gBAAgB,CAAG,CAAC;;EAEpD;EACA,MAAM,CAAEmB,kBAAkB,EAAEC,sBAAsB,CAAE,GAAGxB,QAAQ,CAAE,EAAG,CAAC;EAErE,MAAMyB,qBAAqB,GAAGA,CAC7B;IAAEX,IAAI;IAAEC,IAAI;IAAEW,GAAG;IAAEN;EAAS,CAAC,EAC7BO,OAAO,KACH;IACJ,IAAKA,OAAO,EAAG;MACdH,sBAAsB,CACrBD,kBAAkB,CAACX,MAAM,CACtBgB,GAAG,IACJA,GAAG,CAACd,IAAI,KAAKA,IAAI,IACjBc,GAAG,CAACb,IAAI,KAAKA,IAAI,IACjBa,GAAG,CAACF,GAAG,KAAKA,GAAG,IACfE,GAAG,CAACR,QAAQ,KAAKA,QACnB,CACD,CAAC;IACF,CAAC,MAAM;MACNI,sBAAsB,CAAE,CACvB,GAAGD,kBAAkB,EACrB;QAAET,IAAI;QAAEC,IAAI;QAAEW,GAAG;QAAEN;MAAS,CAAC,CAC5B,CAAC;IACJ;EACD,CAAC;EAED,MAAMS,OAAO,GAAGpB,kBAAkB,CAACqB,MAAM,GAAGP,kBAAkB,CAACO,MAAM,GAAG,CAAC;EAEzE,OAAO;IACNrB,kBAAkB;IAClBoB,OAAO;IACPJ,qBAAqB;IACrBF;EACD,CAAC;AACF,CAAC","ignoreList":[]}