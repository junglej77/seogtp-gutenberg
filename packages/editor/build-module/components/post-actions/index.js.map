{"version":3,"names":["useSelect","useState","useMemo","__","privateApis","componentsPrivateApis","Button","Modal","moreVertical","store","coreStore","unlock","usePostActions","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","DropdownMenuV2","kebabCase","PostActions","postType","postId","onActionPerformed","isActionsMenuOpen","setIsActionsMenuOpen","item","permissions","select","getEditedEntityRecord","getEntityRecordPermissions","itemWithPermissions","allActions","actions","filter","action","isEligible","open","trigger","size","icon","label","disabled","length","accessibleWhenDisabled","className","onClick","onOpenChange","placement","children","ActionsDropdownMenuGroup","onClose","DropdownMenuItemTrigger","items","Item","hideOnClick","RenderModal","ItemLabel","ActionWithModal","ActionTrigger","isModalOpen","setIsModalOpen","actionTriggerProps","hideModalHeader","title","modalHeader","__experimentalHideHeader","onRequestClose","overlayClassName","id","focusOnMount","closeModal","Group","map","callback"],"sources":["@wordpress/editor/src/components/post-actions/index.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useSelect } from '@wordpress/data';\r\nimport { useState, useMemo } from '@wordpress/element';\r\nimport { __ } from '@wordpress/i18n';\r\nimport {\r\n\tprivateApis as componentsPrivateApis,\r\n\tButton,\r\n\tModal,\r\n} from '@wordpress/components';\r\nimport { moreVertical } from '@wordpress/icons';\r\nimport { store as coreStore } from '@wordpress/core-data';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { unlock } from '../../lock-unlock';\r\nimport { usePostActions } from './actions';\r\n\r\nconst { DropdownMenuV2, kebabCase } = unlock( componentsPrivateApis );\r\n\r\nexport default function PostActions( { postType, postId, onActionPerformed } ) {\r\n\tconst [ isActionsMenuOpen, setIsActionsMenuOpen ] = useState( false );\r\n\tconst { item, permissions } = useSelect(\r\n\t\t( select ) => {\r\n\t\t\tconst { getEditedEntityRecord, getEntityRecordPermissions } =\r\n\t\t\t\tunlock( select( coreStore ) );\r\n\t\t\treturn {\r\n\t\t\t\titem: getEditedEntityRecord( 'postType', postType, postId ),\r\n\t\t\t\tpermissions: getEntityRecordPermissions(\r\n\t\t\t\t\t'postType',\r\n\t\t\t\t\tpostType,\r\n\t\t\t\t\tpostId\r\n\t\t\t\t),\r\n\t\t\t};\r\n\t\t},\r\n\t\t[ postId, postType ]\r\n\t);\r\n\tconst itemWithPermissions = useMemo( () => {\r\n\t\treturn {\r\n\t\t\t...item,\r\n\t\t\tpermissions,\r\n\t\t};\r\n\t}, [ item, permissions ] );\r\n\tconst allActions = usePostActions( { postType, onActionPerformed } );\r\n\r\n\tconst actions = useMemo( () => {\r\n\t\treturn allActions.filter( ( action ) => {\r\n\t\t\treturn (\r\n\t\t\t\t! action.isEligible || action.isEligible( itemWithPermissions )\r\n\t\t\t);\r\n\t\t} );\r\n\t}, [ allActions, itemWithPermissions ] );\r\n\r\n\treturn (\r\n\t\t<DropdownMenuV2\r\n\t\t\topen={ isActionsMenuOpen }\r\n\t\t\ttrigger={\r\n\t\t\t\t<Button\r\n\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\ticon={ moreVertical }\r\n\t\t\t\t\tlabel={ __( 'Actions' ) }\r\n\t\t\t\t\tdisabled={ ! actions.length }\r\n\t\t\t\t\taccessibleWhenDisabled\r\n\t\t\t\t\tclassName=\"editor-all-actions-button\"\r\n\t\t\t\t\tonClick={ () =>\r\n\t\t\t\t\t\tsetIsActionsMenuOpen( ! isActionsMenuOpen )\r\n\t\t\t\t\t}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t\tonOpenChange={ setIsActionsMenuOpen }\r\n\t\t\tplacement=\"bottom-end\"\r\n\t\t>\r\n\t\t\t<ActionsDropdownMenuGroup\r\n\t\t\t\tactions={ actions }\r\n\t\t\t\titem={ itemWithPermissions }\r\n\t\t\t\tonClose={ () => {\r\n\t\t\t\t\tsetIsActionsMenuOpen( false );\r\n\t\t\t\t} }\r\n\t\t\t/>\r\n\t\t</DropdownMenuV2>\r\n\t);\r\n}\r\n\r\n// From now on all the functions on this file are copied as from the dataviews packages,\r\n// The editor packages should not be using the dataviews packages directly,\r\n// and the dataviews package should not be using the editor packages directly,\r\n// so duplicating the code here seems like the least bad option.\r\n\r\n// Copied as is from packages/dataviews/src/item-actions.js\r\nfunction DropdownMenuItemTrigger( { action, onClick, items } ) {\r\n\tconst label =\r\n\t\ttypeof action.label === 'string' ? action.label : action.label( items );\r\n\treturn (\r\n\t\t<DropdownMenuV2.Item\r\n\t\t\tonClick={ onClick }\r\n\t\t\thideOnClick={ ! action.RenderModal }\r\n\t\t>\r\n\t\t\t<DropdownMenuV2.ItemLabel>{ label }</DropdownMenuV2.ItemLabel>\r\n\t\t</DropdownMenuV2.Item>\r\n\t);\r\n}\r\n\r\n// Copied as is from packages/dataviews/src/item-actions.js\r\n// With an added onClose prop.\r\nfunction ActionWithModal( { action, item, ActionTrigger, onClose } ) {\r\n\tconst [ isModalOpen, setIsModalOpen ] = useState( false );\r\n\tconst actionTriggerProps = {\r\n\t\taction,\r\n\t\tonClick: () => setIsModalOpen( true ),\r\n\t\titems: [ item ],\r\n\t};\r\n\tconst { RenderModal, hideModalHeader } = action;\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<ActionTrigger { ...actionTriggerProps } />\r\n\t\t\t{ isModalOpen && (\r\n\t\t\t\t<Modal\r\n\t\t\t\t\ttitle={ action.modalHeader || action.label }\r\n\t\t\t\t\t__experimentalHideHeader={ !! hideModalHeader }\r\n\t\t\t\t\tonRequestClose={ () => {\r\n\t\t\t\t\t\tsetIsModalOpen( false );\r\n\t\t\t\t\t} }\r\n\t\t\t\t\toverlayClassName={ `editor-action-modal editor-action-modal__${ kebabCase(\r\n\t\t\t\t\t\taction.id\r\n\t\t\t\t\t) }` }\r\n\t\t\t\t\tfocusOnMount=\"firstContentElement\"\r\n\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<RenderModal\r\n\t\t\t\t\t\titems={ [ item ] }\r\n\t\t\t\t\t\tcloseModal={ () => {\r\n\t\t\t\t\t\t\tsetIsModalOpen( false );\r\n\t\t\t\t\t\t\tonClose();\r\n\t\t\t\t\t\t} }\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Modal>\r\n\t\t\t) }\r\n\t\t</>\r\n\t);\r\n}\r\n\r\n// Copied as is from packages/dataviews/src/item-actions.js\r\n// With an added onClose prop.\r\nfunction ActionsDropdownMenuGroup( { actions, item, onClose } ) {\r\n\treturn (\r\n\t\t<DropdownMenuV2.Group>\r\n\t\t\t{ actions.map( ( action ) => {\r\n\t\t\t\tif ( action.RenderModal ) {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<ActionWithModal\r\n\t\t\t\t\t\t\tkey={ action.id }\r\n\t\t\t\t\t\t\taction={ action }\r\n\t\t\t\t\t\t\titem={ item }\r\n\t\t\t\t\t\t\tActionTrigger={ DropdownMenuItemTrigger }\r\n\t\t\t\t\t\t\tonClose={ onClose }\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<DropdownMenuItemTrigger\r\n\t\t\t\t\t\tkey={ action.id }\r\n\t\t\t\t\t\taction={ action }\r\n\t\t\t\t\t\tonClick={ () => action.callback( [ item ] ) }\r\n\t\t\t\t\t\titems={ [ item ] }\r\n\t\t\t\t\t/>\r\n\t\t\t\t);\r\n\t\t\t} ) }\r\n\t\t</DropdownMenuV2.Group>\r\n\t);\r\n}\r\n"],"mappings":"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","ignoreList":[]}