{"version":3,"names":["__","_x","Dropdown","Button","__experimentalVStack","VStack","useSelect","useState","useMemo","__experimentalInspectorPopoverHeader","InspectorPopoverHeader","store","coreStore","editorStore","PostTypeSupportCheck","PostComments","PostPingbacks","PostPanelRow","jsx","_jsx","jsxs","_jsxs","PANEL_NAME","ModalContents","onClose","className","children","title","spacing","supportKeys","PostDiscussionToggle","isOpen","onClick","commentStatus","pingStatus","commentsSupported","trackbacksSupported","select","_getEditedPostAttribu","_getEditedPostAttribu2","getEditedPostAttribute","getPostType","postType","supports","comments","trackbacks","label","size","variant","PostDiscussionPanel","isEnabled","isEditorPanelEnabled","popoverAnchor","setPopoverAnchor","popoverProps","anchor","placement","offset","shift","ref","contentClassName","focusOnMount","renderToggle","onToggle","renderContent"],"sources":["@wordpress/editor/src/components/post-discussion/panel.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { __, _x } from '@wordpress/i18n';\r\nimport {\r\n\tDropdown,\r\n\tButton,\r\n\t__experimentalVStack as VStack,\r\n} from '@wordpress/components';\r\nimport { useSelect } from '@wordpress/data';\r\nimport { useState, useMemo } from '@wordpress/element';\r\nimport { __experimentalInspectorPopoverHeader as InspectorPopoverHeader } from '@wordpress/block-editor';\r\nimport { store as coreStore } from '@wordpress/core-data';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { store as editorStore } from '../../store';\r\nimport PostTypeSupportCheck from '../post-type-support-check';\r\nimport PostComments from '../post-comments';\r\nimport PostPingbacks from '../post-pingbacks';\r\nimport PostPanelRow from '../post-panel-row';\r\n\r\nconst PANEL_NAME = 'discussion-panel';\r\n\r\nfunction ModalContents( { onClose } ) {\r\n\treturn (\r\n\t\t<div className=\"editor-post-discussion\">\r\n\t\t\t<InspectorPopoverHeader\r\n\t\t\t\ttitle={ __( 'Discussion' ) }\r\n\t\t\t\tonClose={ onClose }\r\n\t\t\t/>\r\n\t\t\t<VStack spacing={ 4 }>\r\n\t\t\t\t<PostTypeSupportCheck supportKeys=\"comments\">\r\n\t\t\t\t\t<PostComments />\r\n\t\t\t\t</PostTypeSupportCheck>\r\n\t\t\t\t<PostTypeSupportCheck supportKeys=\"trackbacks\">\r\n\t\t\t\t\t<PostPingbacks />\r\n\t\t\t\t</PostTypeSupportCheck>\r\n\t\t\t</VStack>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nfunction PostDiscussionToggle( { isOpen, onClick } ) {\r\n\tconst {\r\n\t\tcommentStatus,\r\n\t\tpingStatus,\r\n\t\tcommentsSupported,\r\n\t\ttrackbacksSupported,\r\n\t} = useSelect( ( select ) => {\r\n\t\tconst { getEditedPostAttribute } = select( editorStore );\r\n\t\tconst { getPostType } = select( coreStore );\r\n\t\tconst postType = getPostType( getEditedPostAttribute( 'type' ) );\r\n\t\treturn {\r\n\t\t\tcommentStatus: getEditedPostAttribute( 'comment_status' ) ?? 'open',\r\n\t\t\tpingStatus: getEditedPostAttribute( 'ping_status' ) ?? 'open',\r\n\t\t\tcommentsSupported: !! postType.supports.comments,\r\n\t\t\ttrackbacksSupported: !! postType.supports.trackbacks,\r\n\t\t};\r\n\t}, [] );\r\n\tlet label;\r\n\tif ( commentStatus === 'open' ) {\r\n\t\tif ( pingStatus === 'open' ) {\r\n\t\t\tlabel = _x( 'Open', 'Adjective: e.g. \"Comments are open\"' );\r\n\t\t} else {\r\n\t\t\tlabel = trackbacksSupported\r\n\t\t\t\t? __( 'Comments only' )\r\n\t\t\t\t: _x( 'Open', 'Adjective: e.g. \"Comments are open\"' );\r\n\t\t}\r\n\t} else if ( pingStatus === 'open' ) {\r\n\t\tlabel = commentsSupported ? __( 'Pings only' ) : __( 'Pings enabled' );\r\n\t} else {\r\n\t\tlabel = __( 'Closed' );\r\n\t}\r\n\treturn (\r\n\t\t<Button\r\n\t\t\tsize=\"compact\"\r\n\t\t\tclassName=\"editor-post-discussion__panel-toggle\"\r\n\t\t\tvariant=\"tertiary\"\r\n\t\t\taria-label={ __( 'Change discussion options' ) }\r\n\t\t\taria-expanded={ isOpen }\r\n\t\t\tonClick={ onClick }\r\n\t\t>\r\n\t\t\t{ label }\r\n\t\t</Button>\r\n\t);\r\n}\r\n\r\n/**\r\n * This component allows to update comment and pingback\r\n * settings for the current post. Internally there are\r\n * checks whether the current post has support for the\r\n * above and if the `discussion-panel` panel is enabled.\r\n *\r\n * @return {JSX.Element|null} The rendered PostDiscussionPanel component.\r\n */\r\nexport default function PostDiscussionPanel() {\r\n\tconst { isEnabled } = useSelect( ( select ) => {\r\n\t\tconst { isEditorPanelEnabled } = select( editorStore );\r\n\t\treturn {\r\n\t\t\tisEnabled: isEditorPanelEnabled( PANEL_NAME ),\r\n\t\t};\r\n\t}, [] );\r\n\r\n\t// Use internal state instead of a ref to make sure that the component\r\n\t// re-renders when the popover's anchor updates.\r\n\tconst [ popoverAnchor, setPopoverAnchor ] = useState( null );\r\n\t// Memoize popoverProps to avoid returning a new object every time.\r\n\tconst popoverProps = useMemo(\r\n\t\t() => ( {\r\n\t\t\t// Anchor the popover to the middle of the entire row so that it doesn't\r\n\t\t\t// move around when the label changes.\r\n\t\t\tanchor: popoverAnchor,\r\n\t\t\tplacement: 'left-start',\r\n\t\t\toffset: 36,\r\n\t\t\tshift: true,\r\n\t\t} ),\r\n\t\t[ popoverAnchor ]\r\n\t);\r\n\r\n\tif ( ! isEnabled ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<PostTypeSupportCheck supportKeys={ [ 'comments', 'trackbacks' ] }>\r\n\t\t\t<PostPanelRow label={ __( 'Discussion' ) } ref={ setPopoverAnchor }>\r\n\t\t\t\t<Dropdown\r\n\t\t\t\t\tpopoverProps={ popoverProps }\r\n\t\t\t\t\tclassName=\"editor-post-discussion__panel-dropdown\"\r\n\t\t\t\t\tcontentClassName=\"editor-post-discussion__panel-dialog\"\r\n\t\t\t\t\tfocusOnMount\r\n\t\t\t\t\trenderToggle={ ( { isOpen, onToggle } ) => (\r\n\t\t\t\t\t\t<PostDiscussionToggle\r\n\t\t\t\t\t\t\tisOpen={ isOpen }\r\n\t\t\t\t\t\t\tonClick={ onToggle }\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t) }\r\n\t\t\t\t\trenderContent={ ( { onClose } ) => (\r\n\t\t\t\t\t\t<ModalContents onClose={ onClose } />\r\n\t\t\t\t\t) }\r\n\t\t\t\t/>\r\n\t\t\t</PostPanelRow>\r\n\t\t</PostTypeSupportCheck>\r\n\t);\r\n}\r\n"],"mappings":"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","ignoreList":[]}