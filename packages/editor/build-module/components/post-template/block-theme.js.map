{"version":3,"names":["useSelect","useDispatch","decodeEntities","DropdownMenu","MenuGroup","MenuItem","__","useEntityRecord","store","coreStore","check","noticesStore","preferencesStore","editorStore","SwapTemplateButton","ResetDefaultTemplate","unlock","CreateNewTemplate","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","POPOVER_PROPS","className","placement","BlockThemeControl","id","isTemplateHidden","onNavigateToEntityRecord","getEditorSettings","hasGoBack","select","getRenderingMode","_getEditorSettings","editorSettings","hasOwnProperty","get","getPreference","editedRecord","template","hasResolved","createSuccessNotice","setRenderingMode","canCreateTemplate","canUser","kind","name","notificationAction","label","onClick","onNavigateToPreviousEntityRecord","undefined","mayShowTemplateEditNotice","type","actions","popoverProps","focusOnMount","toggleProps","size","variant","tooltipPosition","text","title","icon","children","onClose","postId","postType","isSelected","role"],"sources":["@wordpress/editor/src/components/post-template/block-theme.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useSelect, useDispatch } from '@wordpress/data';\r\nimport { decodeEntities } from '@wordpress/html-entities';\r\nimport { DropdownMenu, MenuGroup, MenuItem } from '@wordpress/components';\r\nimport { __ } from '@wordpress/i18n';\r\nimport { useEntityRecord, store as coreStore } from '@wordpress/core-data';\r\nimport { check } from '@wordpress/icons';\r\nimport { store as noticesStore } from '@wordpress/notices';\r\nimport { store as preferencesStore } from '@wordpress/preferences';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { store as editorStore } from '../../store';\r\nimport SwapTemplateButton from './swap-template-button';\r\nimport ResetDefaultTemplate from './reset-default-template';\r\nimport { unlock } from '../../lock-unlock';\r\nimport CreateNewTemplate from './create-new-template';\r\n\r\nconst POPOVER_PROPS = {\r\n\tclassName: 'editor-post-template__dropdown',\r\n\tplacement: 'bottom-start',\r\n};\r\n\r\nexport default function BlockThemeControl( { id } ) {\r\n\tconst {\r\n\t\tisTemplateHidden,\r\n\t\tonNavigateToEntityRecord,\r\n\t\tgetEditorSettings,\r\n\t\thasGoBack,\r\n\t} = useSelect( ( select ) => {\r\n\t\tconst { getRenderingMode, getEditorSettings: _getEditorSettings } =\r\n\t\t\tunlock( select( editorStore ) );\r\n\t\tconst editorSettings = _getEditorSettings();\r\n\t\treturn {\r\n\t\t\tisTemplateHidden: getRenderingMode() === 'post-only',\r\n\t\t\tonNavigateToEntityRecord: editorSettings.onNavigateToEntityRecord,\r\n\t\t\tgetEditorSettings: _getEditorSettings,\r\n\t\t\thasGoBack: editorSettings.hasOwnProperty(\r\n\t\t\t\t'onNavigateToPreviousEntityRecord'\r\n\t\t\t),\r\n\t\t};\r\n\t}, [] );\r\n\r\n\tconst { get: getPreference } = useSelect( preferencesStore );\r\n\r\n\tconst { editedRecord: template, hasResolved } = useEntityRecord(\r\n\t\t'postType',\r\n\t\t'wp_template',\r\n\t\tid\r\n\t);\r\n\tconst { createSuccessNotice } = useDispatch( noticesStore );\r\n\tconst { setRenderingMode } = useDispatch( editorStore );\r\n\r\n\tconst canCreateTemplate = useSelect(\r\n\t\t( select ) =>\r\n\t\t\t!! select( coreStore ).canUser( 'create', {\r\n\t\t\t\tkind: 'postType',\r\n\t\t\t\tname: 'wp_template',\r\n\t\t\t} ),\r\n\t\t[]\r\n\t);\r\n\r\n\tif ( ! hasResolved ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\t// The site editor does not have a `onNavigateToPreviousEntityRecord` setting as it uses its own routing\r\n\t// and assigns its own backlink to focusMode pages.\r\n\tconst notificationAction = hasGoBack\r\n\t\t? [\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: __( 'Go back' ),\r\n\t\t\t\t\tonClick: () =>\r\n\t\t\t\t\t\tgetEditorSettings().onNavigateToPreviousEntityRecord(),\r\n\t\t\t\t},\r\n\t\t  ]\r\n\t\t: undefined;\r\n\r\n\tconst mayShowTemplateEditNotice = () => {\r\n\t\tif ( ! getPreference( 'core/edit-site', 'welcomeGuideTemplate' ) ) {\r\n\t\t\tcreateSuccessNotice(\r\n\t\t\t\t__(\r\n\t\t\t\t\t'Editing template. Changes made here affect all posts and pages that use the template.'\r\n\t\t\t\t),\r\n\t\t\t\t{ type: 'snackbar', actions: notificationAction }\r\n\t\t\t);\r\n\t\t}\r\n\t};\r\n\treturn (\r\n\t\t<DropdownMenu\r\n\t\t\tpopoverProps={ POPOVER_PROPS }\r\n\t\t\tfocusOnMount\r\n\t\t\ttoggleProps={ {\r\n\t\t\t\tsize: 'compact',\r\n\t\t\t\tvariant: 'tertiary',\r\n\t\t\t\ttooltipPosition: 'middle left',\r\n\t\t\t} }\r\n\t\t\tlabel={ __( 'Template options' ) }\r\n\t\t\ttext={ decodeEntities( template.title ) }\r\n\t\t\ticon={ null }\r\n\t\t>\r\n\t\t\t{ ( { onClose } ) => (\r\n\t\t\t\t<>\r\n\t\t\t\t\t<MenuGroup>\r\n\t\t\t\t\t\t{ canCreateTemplate && (\r\n\t\t\t\t\t\t\t<MenuItem\r\n\t\t\t\t\t\t\t\tonClick={ () => {\r\n\t\t\t\t\t\t\t\t\tonNavigateToEntityRecord( {\r\n\t\t\t\t\t\t\t\t\t\tpostId: template.id,\r\n\t\t\t\t\t\t\t\t\t\tpostType: 'wp_template',\r\n\t\t\t\t\t\t\t\t\t} );\r\n\t\t\t\t\t\t\t\t\tonClose();\r\n\t\t\t\t\t\t\t\t\tmayShowTemplateEditNotice();\r\n\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{ __( 'Edit template' ) }\r\n\t\t\t\t\t\t\t</MenuItem>\r\n\t\t\t\t\t\t) }\r\n\r\n\t\t\t\t\t\t<SwapTemplateButton onClick={ onClose } />\r\n\t\t\t\t\t\t<ResetDefaultTemplate onClick={ onClose } />\r\n\t\t\t\t\t\t{ canCreateTemplate && (\r\n\t\t\t\t\t\t\t<CreateNewTemplate onClick={ onClose } />\r\n\t\t\t\t\t\t) }\r\n\t\t\t\t\t</MenuGroup>\r\n\t\t\t\t\t<MenuGroup>\r\n\t\t\t\t\t\t<MenuItem\r\n\t\t\t\t\t\t\ticon={ ! isTemplateHidden ? check : undefined }\r\n\t\t\t\t\t\t\tisSelected={ ! isTemplateHidden }\r\n\t\t\t\t\t\t\trole=\"menuitemcheckbox\"\r\n\t\t\t\t\t\t\tonClick={ () => {\r\n\t\t\t\t\t\t\t\tsetRenderingMode(\r\n\t\t\t\t\t\t\t\t\tisTemplateHidden\r\n\t\t\t\t\t\t\t\t\t\t? 'template-locked'\r\n\t\t\t\t\t\t\t\t\t\t: 'post-only'\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{ __( 'Show template' ) }\r\n\t\t\t\t\t\t</MenuItem>\r\n\t\t\t\t\t</MenuGroup>\r\n\t\t\t\t</>\r\n\t\t\t) }\r\n\t\t</DropdownMenu>\r\n\t);\r\n}\r\n"],"mappings":"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","ignoreList":[]}