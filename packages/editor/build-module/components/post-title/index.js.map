{"version":3,"names":["clsx","__","forwardRef","useState","decodeEntities","useSelect","useDispatch","store","blockEditorStore","ENTER","pasteHandler","__unstableUseRichText","useRichText","create","insert","useMergeRefs","__unstableStripHTML","stripHTML","DEFAULT_CLASSNAMES","REGEXP_NEWLINES","usePostTitleFocus","usePostTitle","PostTypeSupportCheck","jsx","_jsx","PostTitle","_","forwardedRef","placeholder","select","getSettings","titlePlaceholder","isSelected","setIsSelected","ref","focusRef","title","setTitle","onUpdate","selection","setSelection","clearSelectedBlock","insertBlocks","insertDefaultBlock","decodedPlaceholder","value","onChange","richTextRef","newValue","replace","selectionStart","start","selectionEnd","end","onSelectionChange","newStart","newEnd","sel","__unstableDisableFormats","onInsertBlockAfter","blocks","onSelect","onUnselect","onEnterPress","undefined","onKeyDown","event","keyCode","preventDefault","onPaste","clipboardData","plainText","html","getData","error","window","console","log","content","HTML","length","firstBlock","name","contentNoHTML","attributes","slice","className","supportKeys","children","contentEditable","role","onFocus","onBlur"],"sources":["@wordpress/editor/src/components/post-title/index.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport clsx from 'clsx';\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { __ } from '@wordpress/i18n';\r\nimport { forwardRef, useState } from '@wordpress/element';\r\nimport { decodeEntities } from '@wordpress/html-entities';\r\nimport { useSelect, useDispatch } from '@wordpress/data';\r\nimport { store as blockEditorStore } from '@wordpress/block-editor';\r\nimport { ENTER } from '@wordpress/keycodes';\r\nimport { pasteHandler } from '@wordpress/blocks';\r\nimport {\r\n\t__unstableUseRichText as useRichText,\r\n\tcreate,\r\n\tinsert,\r\n} from '@wordpress/rich-text';\r\nimport { useMergeRefs } from '@wordpress/compose';\r\nimport { __unstableStripHTML as stripHTML } from '@wordpress/dom';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { DEFAULT_CLASSNAMES, REGEXP_NEWLINES } from './constants';\r\nimport usePostTitleFocus from './use-post-title-focus';\r\nimport usePostTitle from './use-post-title';\r\nimport PostTypeSupportCheck from '../post-type-support-check';\r\n\r\nfunction PostTitle( _, forwardedRef ) {\r\n\tconst { placeholder } = useSelect( ( select ) => {\r\n\t\tconst { getSettings } = select( blockEditorStore );\r\n\t\tconst { titlePlaceholder } = getSettings();\r\n\r\n\t\treturn {\r\n\t\t\tplaceholder: titlePlaceholder,\r\n\t\t};\r\n\t}, [] );\r\n\r\n\tconst [ isSelected, setIsSelected ] = useState( false );\r\n\r\n\tconst { ref: focusRef } = usePostTitleFocus( forwardedRef );\r\n\r\n\tconst { title, setTitle: onUpdate } = usePostTitle();\r\n\r\n\tconst [ selection, setSelection ] = useState( {} );\r\n\r\n\tconst { clearSelectedBlock, insertBlocks, insertDefaultBlock } =\r\n\t\tuseDispatch( blockEditorStore );\r\n\r\n\tconst decodedPlaceholder =\r\n\t\tdecodeEntities( placeholder ) || __( 'Add title' );\r\n\r\n\tconst {\r\n\t\tvalue,\r\n\t\tonChange,\r\n\t\tref: richTextRef,\r\n\t} = useRichText( {\r\n\t\tvalue: title,\r\n\t\tonChange( newValue ) {\r\n\t\t\tonUpdate( newValue.replace( REGEXP_NEWLINES, ' ' ) );\r\n\t\t},\r\n\t\tplaceholder: decodedPlaceholder,\r\n\t\tselectionStart: selection.start,\r\n\t\tselectionEnd: selection.end,\r\n\t\tonSelectionChange( newStart, newEnd ) {\r\n\t\t\tsetSelection( ( sel ) => {\r\n\t\t\t\tconst { start, end } = sel;\r\n\t\t\t\tif ( start === newStart && end === newEnd ) {\r\n\t\t\t\t\treturn sel;\r\n\t\t\t\t}\r\n\t\t\t\treturn {\r\n\t\t\t\t\tstart: newStart,\r\n\t\t\t\t\tend: newEnd,\r\n\t\t\t\t};\r\n\t\t\t} );\r\n\t\t},\r\n\t\t__unstableDisableFormats: false,\r\n\t} );\r\n\r\n\tfunction onInsertBlockAfter( blocks ) {\r\n\t\tinsertBlocks( blocks, 0 );\r\n\t}\r\n\r\n\tfunction onSelect() {\r\n\t\tsetIsSelected( true );\r\n\t\tclearSelectedBlock();\r\n\t}\r\n\r\n\tfunction onUnselect() {\r\n\t\tsetIsSelected( false );\r\n\t\tsetSelection( {} );\r\n\t}\r\n\r\n\tfunction onEnterPress() {\r\n\t\tinsertDefaultBlock( undefined, undefined, 0 );\r\n\t}\r\n\r\n\tfunction onKeyDown( event ) {\r\n\t\tif ( event.keyCode === ENTER ) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tonEnterPress();\r\n\t\t}\r\n\t}\r\n\r\n\tfunction onPaste( event ) {\r\n\t\tconst clipboardData = event.clipboardData;\r\n\r\n\t\tlet plainText = '';\r\n\t\tlet html = '';\r\n\r\n\t\ttry {\r\n\t\t\tplainText = clipboardData.getData( 'text/plain' );\r\n\t\t\thtml = clipboardData.getData( 'text/html' );\r\n\t\t} catch ( error ) {\r\n\t\t\t// Some browsers like UC Browser paste plain text by default and\r\n\t\t\t// don't support clipboardData at all, so allow default\r\n\t\t\t// behaviour.\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Allows us to ask for this information when we get a report.\r\n\t\twindow.console.log( 'Received HTML:\\n\\n', html );\r\n\t\twindow.console.log( 'Received plain text:\\n\\n', plainText );\r\n\r\n\t\tconst content = pasteHandler( {\r\n\t\t\tHTML: html,\r\n\t\t\tplainText,\r\n\t\t} );\r\n\r\n\t\tevent.preventDefault();\r\n\r\n\t\tif ( ! content.length ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif ( typeof content !== 'string' ) {\r\n\t\t\tconst [ firstBlock ] = content;\r\n\r\n\t\t\tif (\r\n\t\t\t\t! title &&\r\n\t\t\t\t( firstBlock.name === 'core/heading' ||\r\n\t\t\t\t\tfirstBlock.name === 'core/paragraph' )\r\n\t\t\t) {\r\n\t\t\t\t// Strip HTML to avoid unwanted HTML being added to the title.\r\n\t\t\t\t// In the majority of cases it is assumed that HTML in the title\r\n\t\t\t\t// is undesirable.\r\n\t\t\t\tconst contentNoHTML = stripHTML(\r\n\t\t\t\t\tfirstBlock.attributes.content\r\n\t\t\t\t);\r\n\t\t\t\tonUpdate( contentNoHTML );\r\n\t\t\t\tonInsertBlockAfter( content.slice( 1 ) );\r\n\t\t\t} else {\r\n\t\t\t\tonInsertBlockAfter( content );\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// Strip HTML to avoid unwanted HTML being added to the title.\r\n\t\t\t// In the majority of cases it is assumed that HTML in the title\r\n\t\t\t// is undesirable.\r\n\t\t\tconst contentNoHTML = stripHTML( content );\r\n\t\t\tonChange( insert( value, create( { html: contentNoHTML } ) ) );\r\n\t\t}\r\n\t}\r\n\r\n\t// The wp-block className is important for editor styles.\r\n\t// This same block is used in both the visual and the code editor.\r\n\tconst className = clsx( DEFAULT_CLASSNAMES, {\r\n\t\t'is-selected': isSelected,\r\n\t} );\r\n\r\n\treturn (\r\n\t\t/* eslint-disable jsx-a11y/heading-has-content, jsx-a11y/no-noninteractive-element-to-interactive-role */\r\n\t\t<PostTypeSupportCheck supportKeys=\"title\">\r\n\t\t\t<h1\r\n\t\t\t\tref={ useMergeRefs( [ richTextRef, focusRef ] ) }\r\n\t\t\t\tcontentEditable\r\n\t\t\t\tclassName={ className }\r\n\t\t\t\taria-label={ decodedPlaceholder }\r\n\t\t\t\trole=\"textbox\"\r\n\t\t\t\taria-multiline=\"true\"\r\n\t\t\t\tonFocus={ onSelect }\r\n\t\t\t\tonBlur={ onUnselect }\r\n\t\t\t\tonKeyDown={ onKeyDown }\r\n\t\t\t\tonPaste={ onPaste }\r\n\t\t\t/>\r\n\t\t</PostTypeSupportCheck>\r\n\t\t/* eslint-enable jsx-a11y/heading-has-content, jsx-a11y/no-noninteractive-element-to-interactive-role */\r\n\t);\r\n}\r\n\r\n/**\r\n * Renders the `PostTitle` component.\r\n *\r\n * @param {Object}  _            Unused parameter.\r\n * @param {Element} forwardedRef Forwarded ref for the component.\r\n *\r\n * @return {Component} The rendered PostTitle component.\r\n */\r\nexport default forwardRef( PostTitle );\r\n"],"mappings":"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","ignoreList":[]}