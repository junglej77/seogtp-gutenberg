{"version":3,"names":["clsx","useViewportMatch","DropdownMenu","MenuGroup","MenuItem","MenuItemsChoice","VisuallyHidden","Icon","__","desktop","mobile","tablet","external","useSelect","useDispatch","store","coreStore","useEffect","useRef","preferencesStore","blockEditorStore","ActionItem","editorStore","PostPreviewButton","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","PreviewDropdown","forceIsAutosaveable","disabled","deviceType","editorMode","homeUrl","isTemplate","isViewable","showIconLabels","select","_getPostType$viewable","getDeviceType","getCurrentPostType","getEntityRecord","getPostType","get","__unstableGetEditorMode","_currentPostType","home","viewable","setDeviceType","__unstableSetEditorMode","originalEditingModeRef","current","isMobile","popoverProps","placement","toggleProps","className","iconPosition","size","showTooltip","accessibleWhenDisabled","menuProps","deviceIcons","choices","value","label","icon","window","__experimentalEnableZoomOutExperiment","push","previewValue","onSelect","newEditorMode","toLowerCase","text","undefined","disableOpenOnArrowDown","children","onClose","href","target","onClick","as","role","textContent","onPreview","Slot","name","fillProps"],"sources":["@wordpress/editor/src/components/preview-dropdown/index.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport clsx from 'clsx';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { useViewportMatch } from '@wordpress/compose';\r\nimport {\r\n\tDropdownMenu,\r\n\tMenuGroup,\r\n\tMenuItem,\r\n\tMenuItemsChoice,\r\n\tVisuallyHidden,\r\n\tIcon,\r\n} from '@wordpress/components';\r\nimport { __ } from '@wordpress/i18n';\r\nimport { desktop, mobile, tablet, external } from '@wordpress/icons';\r\nimport { useSelect, useDispatch } from '@wordpress/data';\r\nimport { store as coreStore } from '@wordpress/core-data';\r\nimport { useEffect, useRef } from '@wordpress/element';\r\nimport { store as preferencesStore } from '@wordpress/preferences';\r\nimport { store as blockEditorStore } from '@wordpress/block-editor';\r\nimport { ActionItem } from '@wordpress/interface';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { store as editorStore } from '../../store';\r\nimport PostPreviewButton from '../post-preview-button';\r\n\r\nexport default function PreviewDropdown( { forceIsAutosaveable, disabled } ) {\r\n\tconst {\r\n\t\tdeviceType,\r\n\t\teditorMode,\r\n\t\thomeUrl,\r\n\t\tisTemplate,\r\n\t\tisViewable,\r\n\t\tshowIconLabels,\r\n\t} = useSelect( ( select ) => {\r\n\t\tconst { getDeviceType, getCurrentPostType } = select( editorStore );\r\n\t\tconst { getEntityRecord, getPostType } = select( coreStore );\r\n\t\tconst { get } = select( preferencesStore );\r\n\t\tconst { __unstableGetEditorMode } = select( blockEditorStore );\r\n\t\tconst _currentPostType = getCurrentPostType();\r\n\t\treturn {\r\n\t\t\tdeviceType: getDeviceType(),\r\n\t\t\teditorMode: __unstableGetEditorMode(),\r\n\t\t\thomeUrl: getEntityRecord( 'root', '__unstableBase' )?.home,\r\n\t\t\tisTemplate: _currentPostType === 'wp_template',\r\n\t\t\tisViewable: getPostType( _currentPostType )?.viewable ?? false,\r\n\t\t\tshowIconLabels: get( 'core', 'showIconLabels' ),\r\n\t\t};\r\n\t}, [] );\r\n\tconst { setDeviceType } = useDispatch( editorStore );\r\n\tconst { __unstableSetEditorMode } = useDispatch( blockEditorStore );\r\n\r\n\t/**\r\n\t * Save the original editing mode in a ref to restore it when we exit zoom out.\r\n\t */\r\n\tconst originalEditingModeRef = useRef( editorMode );\r\n\tuseEffect( () => {\r\n\t\tif ( editorMode !== 'zoom-out' ) {\r\n\t\t\toriginalEditingModeRef.current = editorMode;\r\n\t\t}\r\n\r\n\t\treturn () => {\r\n\t\t\tif (\r\n\t\t\t\teditorMode === 'zoom-out' &&\r\n\t\t\t\teditorMode !== originalEditingModeRef.current\r\n\t\t\t) {\r\n\t\t\t\t__unstableSetEditorMode( originalEditingModeRef.current );\r\n\t\t\t}\r\n\t\t};\r\n\t}, [ editorMode, __unstableSetEditorMode ] );\r\n\r\n\tconst isMobile = useViewportMatch( 'medium', '<' );\r\n\tif ( isMobile ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconst popoverProps = {\r\n\t\tplacement: 'bottom-end',\r\n\t};\r\n\tconst toggleProps = {\r\n\t\tclassName: 'editor-preview-dropdown__toggle',\r\n\t\ticonPosition: 'right',\r\n\t\tsize: 'compact',\r\n\t\tshowTooltip: ! showIconLabels,\r\n\t\tdisabled,\r\n\t\taccessibleWhenDisabled: disabled,\r\n\t};\r\n\tconst menuProps = {\r\n\t\t'aria-label': __( 'View options' ),\r\n\t};\r\n\r\n\tconst deviceIcons = {\r\n\t\tdesktop,\r\n\t\tmobile,\r\n\t\ttablet,\r\n\t};\r\n\r\n\t/**\r\n\t * The choices for the device type.\r\n\t *\r\n\t * @type {Array}\r\n\t */\r\n\tconst choices = [\r\n\t\t{\r\n\t\t\tvalue: 'Desktop',\r\n\t\t\tlabel: __( 'Desktop' ),\r\n\t\t\ticon: desktop,\r\n\t\t},\r\n\t];\r\n\tif ( window.__experimentalEnableZoomOutExperiment ) {\r\n\t\tchoices.push( {\r\n\t\t\tvalue: 'ZoomOut',\r\n\t\t\tlabel: __( 'Desktop (50%)' ),\r\n\t\t\ticon: desktop,\r\n\t\t} );\r\n\t}\r\n\tchoices.push( {\r\n\t\tvalue: 'Tablet',\r\n\t\tlabel: __( 'Tablet' ),\r\n\t\ticon: tablet,\r\n\t} );\r\n\tchoices.push( {\r\n\t\tvalue: 'Mobile',\r\n\t\tlabel: __( 'Mobile' ),\r\n\t\ticon: mobile,\r\n\t} );\r\n\r\n\tconst previewValue = editorMode === 'zoom-out' ? 'ZoomOut' : deviceType;\r\n\r\n\t/**\r\n\t * Handles the selection of a device type.\r\n\t *\r\n\t * @param {string} value The device type.\r\n\t */\r\n\tconst onSelect = ( value ) => {\r\n\t\tlet newEditorMode = originalEditingModeRef.current;\r\n\r\n\t\tif ( value === 'ZoomOut' ) {\r\n\t\t\tnewEditorMode = 'zoom-out';\r\n\t\t\tsetDeviceType( 'Desktop' );\r\n\t\t} else {\r\n\t\t\tsetDeviceType( value );\r\n\t\t}\r\n\r\n\t\t__unstableSetEditorMode( newEditorMode );\r\n\t};\r\n\r\n\treturn (\r\n\t\t<DropdownMenu\r\n\t\t\tclassName={ clsx(\r\n\t\t\t\t'editor-preview-dropdown',\r\n\t\t\t\t`editor-preview-dropdown--${ deviceType.toLowerCase() }`\r\n\t\t\t) }\r\n\t\t\tpopoverProps={ popoverProps }\r\n\t\t\ttoggleProps={ toggleProps }\r\n\t\t\tmenuProps={ menuProps }\r\n\t\t\ticon={ deviceIcons[ deviceType.toLowerCase() ] }\r\n\t\t\ttext={ editorMode === 'zoom-out' ? __( '50%' ) : undefined }\r\n\t\t\tlabel={ __( 'View' ) }\r\n\t\t\tdisableOpenOnArrowDown={ disabled }\r\n\t\t>\r\n\t\t\t{ ( { onClose } ) => (\r\n\t\t\t\t<>\r\n\t\t\t\t\t<MenuGroup>\r\n\t\t\t\t\t\t<MenuItemsChoice\r\n\t\t\t\t\t\t\tchoices={ choices }\r\n\t\t\t\t\t\t\tvalue={ previewValue }\r\n\t\t\t\t\t\t\tonSelect={ onSelect }\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</MenuGroup>\r\n\t\t\t\t\t{ isTemplate && (\r\n\t\t\t\t\t\t<MenuGroup>\r\n\t\t\t\t\t\t\t<MenuItem\r\n\t\t\t\t\t\t\t\thref={ homeUrl }\r\n\t\t\t\t\t\t\t\ttarget=\"_blank\"\r\n\t\t\t\t\t\t\t\ticon={ external }\r\n\t\t\t\t\t\t\t\tonClick={ onClose }\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{ __( 'View site' ) }\r\n\t\t\t\t\t\t\t\t<VisuallyHidden as=\"span\">\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t/* translators: accessibility text */\r\n\t\t\t\t\t\t\t\t\t\t__( '(opens in a new tab)' )\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t</VisuallyHidden>\r\n\t\t\t\t\t\t\t</MenuItem>\r\n\t\t\t\t\t\t</MenuGroup>\r\n\t\t\t\t\t) }\r\n\t\t\t\t\t{ isViewable && (\r\n\t\t\t\t\t\t<MenuGroup>\r\n\t\t\t\t\t\t\t<PostPreviewButton\r\n\t\t\t\t\t\t\t\tclassName=\"editor-preview-dropdown__button-external\"\r\n\t\t\t\t\t\t\t\trole=\"menuitem\"\r\n\t\t\t\t\t\t\t\tforceIsAutosaveable={ forceIsAutosaveable }\r\n\t\t\t\t\t\t\t\taria-label={ __( 'Preview in new tab' ) }\r\n\t\t\t\t\t\t\t\ttextContent={\r\n\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t{ __( 'Preview in new tab' ) }\r\n\t\t\t\t\t\t\t\t\t\t<Icon icon={ external } />\r\n\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tonPreview={ onClose }\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</MenuGroup>\r\n\t\t\t\t\t) }\r\n\t\t\t\t\t<ActionItem.Slot\r\n\t\t\t\t\t\tname=\"core/plugin-preview-menu\"\r\n\t\t\t\t\t\tas={ MenuGroup }\r\n\t\t\t\t\t\tfillProps={ { onClick: onClose } }\r\n\t\t\t\t\t/>\r\n\t\t\t\t</>\r\n\t\t\t) }\r\n\t\t</DropdownMenu>\r\n\t);\r\n}\r\n"],"mappings":"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","ignoreList":[]}