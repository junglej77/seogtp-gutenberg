{"version":3,"names":["useEffect","addFilter","removeFilter","POST_TYPES_ALLOWING_POST_CONTENT_TEMPLATE_PART","useHideBlocksFromInserter","postType","mode","canInsert","blockType","includes","name","rootClientId","getBlockParentsByBlockName","length"],"sources":["@wordpress/editor/src/components/provider/use-hide-blocks-from-inserter.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useEffect } from '@wordpress/element';\r\nimport { addFilter, removeFilter } from '@wordpress/hooks';\r\n\r\n// These post types are \"structural\" block lists.\r\n// We should be allowed to use\r\n// the post content and template parts blocks within them.\r\nconst POST_TYPES_ALLOWING_POST_CONTENT_TEMPLATE_PART = [\r\n\t'wp_block',\r\n\t'wp_template',\r\n\t'wp_template_part',\r\n];\r\n\r\n/**\r\n * In some specific contexts,\r\n * the template part and post content blocks need to be hidden.\r\n *\r\n * @param {string} postType Post Type\r\n * @param {string} mode     Rendering mode\r\n */\r\nexport function useHideBlocksFromInserter( postType, mode ) {\r\n\tuseEffect( () => {\r\n\t\t/*\r\n\t\t * Prevent adding template part in the editor.\r\n\t\t */\r\n\t\taddFilter(\r\n\t\t\t'blockEditor.__unstableCanInsertBlockType',\r\n\t\t\t'removeTemplatePartsFromInserter',\r\n\t\t\t( canInsert, blockType ) => {\r\n\t\t\t\tif (\r\n\t\t\t\t\t! POST_TYPES_ALLOWING_POST_CONTENT_TEMPLATE_PART.includes(\r\n\t\t\t\t\t\tpostType\r\n\t\t\t\t\t) &&\r\n\t\t\t\t\tblockType.name === 'core/template-part' &&\r\n\t\t\t\t\tmode === 'post-only'\r\n\t\t\t\t) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\treturn canInsert;\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\t/*\r\n\t\t * Prevent adding post content block (except in query block) in the editor.\r\n\t\t */\r\n\t\taddFilter(\r\n\t\t\t'blockEditor.__unstableCanInsertBlockType',\r\n\t\t\t'removePostContentFromInserter',\r\n\t\t\t(\r\n\t\t\t\tcanInsert,\r\n\t\t\t\tblockType,\r\n\t\t\t\trootClientId,\r\n\t\t\t\t{ getBlockParentsByBlockName }\r\n\t\t\t) => {\r\n\t\t\t\tif (\r\n\t\t\t\t\t! POST_TYPES_ALLOWING_POST_CONTENT_TEMPLATE_PART.includes(\r\n\t\t\t\t\t\tpostType\r\n\t\t\t\t\t) &&\r\n\t\t\t\t\tblockType.name === 'core/post-content'\r\n\t\t\t\t) {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\tgetBlockParentsByBlockName( rootClientId, 'core/query' )\r\n\t\t\t\t\t\t\t.length > 0\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\treturn canInsert;\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\treturn () => {\r\n\t\t\tremoveFilter(\r\n\t\t\t\t'blockEditor.__unstableCanInsertBlockType',\r\n\t\t\t\t'removeTemplatePartsFromInserter'\r\n\t\t\t);\r\n\t\t\tremoveFilter(\r\n\t\t\t\t'blockEditor.__unstableCanInsertBlockType',\r\n\t\t\t\t'removePostContentFromInserter'\r\n\t\t\t);\r\n\t\t};\r\n\t}, [ postType, mode ] );\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,SAAS,QAAQ,oBAAoB;AAC9C,SAASC,SAAS,EAAEC,YAAY,QAAQ,kBAAkB;;AAE1D;AACA;AACA;AACA,MAAMC,8CAA8C,GAAG,CACtD,UAAU,EACV,aAAa,EACb,kBAAkB,CAClB;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,yBAAyBA,CAAEC,QAAQ,EAAEC,IAAI,EAAG;EAC3DN,SAAS,CAAE,MAAM;IAChB;AACF;AACA;IACEC,SAAS,CACR,0CAA0C,EAC1C,iCAAiC,EACjC,CAAEM,SAAS,EAAEC,SAAS,KAAM;MAC3B,IACC,CAAEL,8CAA8C,CAACM,QAAQ,CACxDJ,QACD,CAAC,IACDG,SAAS,CAACE,IAAI,KAAK,oBAAoB,IACvCJ,IAAI,KAAK,WAAW,EACnB;QACD,OAAO,KAAK;MACb;MACA,OAAOC,SAAS;IACjB,CACD,CAAC;;IAED;AACF;AACA;IACEN,SAAS,CACR,0CAA0C,EAC1C,+BAA+B,EAC/B,CACCM,SAAS,EACTC,SAAS,EACTG,YAAY,EACZ;MAAEC;IAA2B,CAAC,KAC1B;MACJ,IACC,CAAET,8CAA8C,CAACM,QAAQ,CACxDJ,QACD,CAAC,IACDG,SAAS,CAACE,IAAI,KAAK,mBAAmB,EACrC;QACD,OACCE,0BAA0B,CAAED,YAAY,EAAE,YAAa,CAAC,CACtDE,MAAM,GAAG,CAAC;MAEd;MACA,OAAON,SAAS;IACjB,CACD,CAAC;IAED,OAAO,MAAM;MACZL,YAAY,CACX,0CAA0C,EAC1C,iCACD,CAAC;MACDA,YAAY,CACX,0CAA0C,EAC1C,+BACD,CAAC;IACF,CAAC;EACF,CAAC,EAAE,CAAEG,QAAQ,EAAEC,IAAI,CAAG,CAAC;AACxB","ignoreList":[]}