{"version":3,"names":["useState","useRegistry","createRegistry","RegistryProvider","createHigherOrderComponent","storeConfig","blockEditorStoreConfig","jsx","_jsx","getSubRegistry","subRegistries","registry","useSubRegistry","subRegistry","get","registerStore","set","withRegistryProvider","WrappedComponent","props","WeakMap","value","children"],"sources":["@wordpress/editor/src/components/provider/with-registry-provider.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useState } from '@wordpress/element';\r\nimport { useRegistry, createRegistry, RegistryProvider } from '@wordpress/data';\r\nimport { createHigherOrderComponent } from '@wordpress/compose';\r\nimport { storeConfig as blockEditorStoreConfig } from '@wordpress/block-editor';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { storeConfig } from '../../store';\r\n\r\nfunction getSubRegistry( subRegistries, registry, useSubRegistry ) {\r\n\tif ( ! useSubRegistry ) {\r\n\t\treturn registry;\r\n\t}\r\n\tlet subRegistry = subRegistries.get( registry );\r\n\tif ( ! subRegistry ) {\r\n\t\tsubRegistry = createRegistry(\r\n\t\t\t{\r\n\t\t\t\t'core/block-editor': blockEditorStoreConfig,\r\n\t\t\t},\r\n\t\t\tregistry\r\n\t\t);\r\n\t\t// Todo: The interface store should also be created per instance.\r\n\t\tsubRegistry.registerStore( 'core/editor', storeConfig );\r\n\t\tsubRegistries.set( registry, subRegistry );\r\n\t}\r\n\treturn subRegistry;\r\n}\r\n\r\nconst withRegistryProvider = createHigherOrderComponent(\r\n\t( WrappedComponent ) =>\r\n\t\t( { useSubRegistry = true, ...props } ) => {\r\n\t\t\tconst registry = useRegistry();\r\n\t\t\tconst [ subRegistries ] = useState( () => new WeakMap() );\r\n\t\t\tconst subRegistry = getSubRegistry(\r\n\t\t\t\tsubRegistries,\r\n\t\t\t\tregistry,\r\n\t\t\t\tuseSubRegistry\r\n\t\t\t);\r\n\r\n\t\t\tif ( subRegistry === registry ) {\r\n\t\t\t\treturn <WrappedComponent registry={ registry } { ...props } />;\r\n\t\t\t}\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<RegistryProvider value={ subRegistry }>\r\n\t\t\t\t\t<WrappedComponent registry={ subRegistry } { ...props } />\r\n\t\t\t\t</RegistryProvider>\r\n\t\t\t);\r\n\t\t},\r\n\t'withRegistryProvider'\r\n);\r\n\r\nexport default withRegistryProvider;\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,QAAQ,QAAQ,oBAAoB;AAC7C,SAASC,WAAW,EAAEC,cAAc,EAAEC,gBAAgB,QAAQ,iBAAiB;AAC/E,SAASC,0BAA0B,QAAQ,oBAAoB;AAC/D,SAASC,WAAW,IAAIC,sBAAsB,QAAQ,yBAAyB;;AAE/E;AACA;AACA;AACA,SAASD,WAAW,QAAQ,aAAa;AAAC,SAAAE,GAAA,IAAAC,IAAA;AAE1C,SAASC,cAAcA,CAAEC,aAAa,EAAEC,QAAQ,EAAEC,cAAc,EAAG;EAClE,IAAK,CAAEA,cAAc,EAAG;IACvB,OAAOD,QAAQ;EAChB;EACA,IAAIE,WAAW,GAAGH,aAAa,CAACI,GAAG,CAAEH,QAAS,CAAC;EAC/C,IAAK,CAAEE,WAAW,EAAG;IACpBA,WAAW,GAAGX,cAAc,CAC3B;MACC,mBAAmB,EAAEI;IACtB,CAAC,EACDK,QACD,CAAC;IACD;IACAE,WAAW,CAACE,aAAa,CAAE,aAAa,EAAEV,WAAY,CAAC;IACvDK,aAAa,CAACM,GAAG,CAAEL,QAAQ,EAAEE,WAAY,CAAC;EAC3C;EACA,OAAOA,WAAW;AACnB;AAEA,MAAMI,oBAAoB,GAAGb,0BAA0B,CACpDc,gBAAgB,IACjB,CAAE;EAAEN,cAAc,GAAG,IAAI;EAAE,GAAGO;AAAM,CAAC,KAAM;EAC1C,MAAMR,QAAQ,GAAGV,WAAW,CAAC,CAAC;EAC9B,MAAM,CAAES,aAAa,CAAE,GAAGV,QAAQ,CAAE,MAAM,IAAIoB,OAAO,CAAC,CAAE,CAAC;EACzD,MAAMP,WAAW,GAAGJ,cAAc,CACjCC,aAAa,EACbC,QAAQ,EACRC,cACD,CAAC;EAED,IAAKC,WAAW,KAAKF,QAAQ,EAAG;IAC/B,oBAAOH,IAAA,CAACU,gBAAgB;MAACP,QAAQ,EAAGA,QAAU;MAAA,GAAMQ;IAAK,CAAI,CAAC;EAC/D;EAEA,oBACCX,IAAA,CAACL,gBAAgB;IAACkB,KAAK,EAAGR,WAAa;IAAAS,QAAA,eACtCd,IAAA,CAACU,gBAAgB;MAACP,QAAQ,EAAGE,WAAa;MAAA,GAAMM;IAAK,CAAI;EAAC,CACzC,CAAC;AAErB,CAAC,EACF,sBACD,CAAC;AAED,eAAeF,oBAAoB","ignoreList":[]}