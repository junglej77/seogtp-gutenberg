{"version":3,"names":["useSelect","store","coreStore","useEffect","useState","__","__experimentalConfirmDialog","ConfirmDialog","editorStore","jsx","_jsx","EditTemplateBlocksNotification","contentRef","onNavigateToEntityRecord","templateId","select","getEditorSettings","getCurrentTemplateId","canEditTemplate","canUser","kind","name","isDialogOpen","setIsDialogOpen","handleDblClick","event","target","classList","contains","dataset","type","canvas","current","addEventListener","removeEventListener","isOpen","confirmButtonText","onConfirm","postId","postType","onCancel","size","children"],"sources":["@wordpress/editor/src/components/visual-editor/edit-template-blocks-notification.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useSelect } from '@wordpress/data';\r\nimport { store as coreStore } from '@wordpress/core-data';\r\nimport { useEffect, useState } from '@wordpress/element';\r\nimport { __ } from '@wordpress/i18n';\r\nimport { __experimentalConfirmDialog as ConfirmDialog } from '@wordpress/components';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { store as editorStore } from '../../store';\r\n\r\n/**\r\n * Component that:\r\n *\r\n * - Displays a 'Edit your template to edit this block' notification when the\r\n *   user is focusing on editing page content and clicks on a disabled template\r\n *   block.\r\n * - Displays a 'Edit your template to edit this block' dialog when the user\r\n *   is focusing on editing page conetnt and double clicks on a disabled\r\n *   template block.\r\n *\r\n * @param {Object}                                 props\r\n * @param {import('react').RefObject<HTMLElement>} props.contentRef Ref to the block\r\n *                                                                  editor iframe canvas.\r\n */\r\nexport default function EditTemplateBlocksNotification( { contentRef } ) {\r\n\tconst { onNavigateToEntityRecord, templateId } = useSelect( ( select ) => {\r\n\t\tconst { getEditorSettings, getCurrentTemplateId } =\r\n\t\t\tselect( editorStore );\r\n\r\n\t\treturn {\r\n\t\t\tonNavigateToEntityRecord:\r\n\t\t\t\tgetEditorSettings().onNavigateToEntityRecord,\r\n\t\t\ttemplateId: getCurrentTemplateId(),\r\n\t\t};\r\n\t}, [] );\r\n\r\n\tconst canEditTemplate = useSelect(\r\n\t\t( select ) =>\r\n\t\t\t!! select( coreStore ).canUser( 'create', {\r\n\t\t\t\tkind: 'postType',\r\n\t\t\t\tname: 'wp_template',\r\n\t\t\t} ),\r\n\t\t[]\r\n\t);\r\n\r\n\tconst [ isDialogOpen, setIsDialogOpen ] = useState( false );\r\n\r\n\tuseEffect( () => {\r\n\t\tconst handleDblClick = ( event ) => {\r\n\t\t\tif ( ! canEditTemplate ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\t! event.target.classList.contains( 'is-root-container' ) ||\r\n\t\t\t\tevent.target.dataset?.type === 'core/template-part'\r\n\t\t\t) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tsetIsDialogOpen( true );\r\n\t\t};\r\n\r\n\t\tconst canvas = contentRef.current;\r\n\t\tcanvas?.addEventListener( 'dblclick', handleDblClick );\r\n\t\treturn () => {\r\n\t\t\tcanvas?.removeEventListener( 'dblclick', handleDblClick );\r\n\t\t};\r\n\t}, [ contentRef, canEditTemplate ] );\r\n\r\n\tif ( ! canEditTemplate ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<ConfirmDialog\r\n\t\t\tisOpen={ isDialogOpen }\r\n\t\t\tconfirmButtonText={ __( 'Edit template' ) }\r\n\t\t\tonConfirm={ () => {\r\n\t\t\t\tsetIsDialogOpen( false );\r\n\t\t\t\tonNavigateToEntityRecord( {\r\n\t\t\t\t\tpostId: templateId,\r\n\t\t\t\t\tpostType: 'wp_template',\r\n\t\t\t\t} );\r\n\t\t\t} }\r\n\t\t\tonCancel={ () => setIsDialogOpen( false ) }\r\n\t\t\tsize=\"medium\"\r\n\t\t>\r\n\t\t\t{ __(\r\n\t\t\t\t'Youâ€™ve tried to select a block that is part of a template, which may be used on other posts and pages. Would you like to edit the template?'\r\n\t\t\t) }\r\n\t\t</ConfirmDialog>\r\n\t);\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,SAAS,QAAQ,iBAAiB;AAC3C,SAASC,KAAK,IAAIC,SAAS,QAAQ,sBAAsB;AACzD,SAASC,SAAS,EAAEC,QAAQ,QAAQ,oBAAoB;AACxD,SAASC,EAAE,QAAQ,iBAAiB;AACpC,SAASC,2BAA2B,IAAIC,aAAa,QAAQ,uBAAuB;;AAEpF;AACA;AACA;AACA,SAASN,KAAK,IAAIO,WAAW,QAAQ,aAAa;;AAElD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAbA,SAAAC,GAAA,IAAAC,IAAA;AAcA,eAAe,SAASC,8BAA8BA,CAAE;EAAEC;AAAW,CAAC,EAAG;EACxE,MAAM;IAAEC,wBAAwB;IAAEC;EAAW,CAAC,GAAGd,SAAS,CAAIe,MAAM,IAAM;IACzE,MAAM;MAAEC,iBAAiB;MAAEC;IAAqB,CAAC,GAChDF,MAAM,CAAEP,WAAY,CAAC;IAEtB,OAAO;MACNK,wBAAwB,EACvBG,iBAAiB,CAAC,CAAC,CAACH,wBAAwB;MAC7CC,UAAU,EAAEG,oBAAoB,CAAC;IAClC,CAAC;EACF,CAAC,EAAE,EAAG,CAAC;EAEP,MAAMC,eAAe,GAAGlB,SAAS,CAC9Be,MAAM,IACP,CAAC,CAAEA,MAAM,CAAEb,SAAU,CAAC,CAACiB,OAAO,CAAE,QAAQ,EAAE;IACzCC,IAAI,EAAE,UAAU;IAChBC,IAAI,EAAE;EACP,CAAE,CAAC,EACJ,EACD,CAAC;EAED,MAAM,CAAEC,YAAY,EAAEC,eAAe,CAAE,GAAGnB,QAAQ,CAAE,KAAM,CAAC;EAE3DD,SAAS,CAAE,MAAM;IAChB,MAAMqB,cAAc,GAAKC,KAAK,IAAM;MACnC,IAAK,CAAEP,eAAe,EAAG;QACxB;MACD;MAEA,IACC,CAAEO,KAAK,CAACC,MAAM,CAACC,SAAS,CAACC,QAAQ,CAAE,mBAAoB,CAAC,IACxDH,KAAK,CAACC,MAAM,CAACG,OAAO,EAAEC,IAAI,KAAK,oBAAoB,EAClD;QACD;MACD;MACAP,eAAe,CAAE,IAAK,CAAC;IACxB,CAAC;IAED,MAAMQ,MAAM,GAAGnB,UAAU,CAACoB,OAAO;IACjCD,MAAM,EAAEE,gBAAgB,CAAE,UAAU,EAAET,cAAe,CAAC;IACtD,OAAO,MAAM;MACZO,MAAM,EAAEG,mBAAmB,CAAE,UAAU,EAAEV,cAAe,CAAC;IAC1D,CAAC;EACF,CAAC,EAAE,CAAEZ,UAAU,EAAEM,eAAe,CAAG,CAAC;EAEpC,IAAK,CAAEA,eAAe,EAAG;IACxB,OAAO,IAAI;EACZ;EAEA,oBACCR,IAAA,CAACH,aAAa;IACb4B,MAAM,EAAGb,YAAc;IACvBc,iBAAiB,EAAG/B,EAAE,CAAE,eAAgB,CAAG;IAC3CgC,SAAS,EAAGA,CAAA,KAAM;MACjBd,eAAe,CAAE,KAAM,CAAC;MACxBV,wBAAwB,CAAE;QACzByB,MAAM,EAAExB,UAAU;QAClByB,QAAQ,EAAE;MACX,CAAE,CAAC;IACJ,CAAG;IACHC,QAAQ,EAAGA,CAAA,KAAMjB,eAAe,CAAE,KAAM,CAAG;IAC3CkB,IAAI,EAAC,QAAQ;IAAAC,QAAA,EAEXrC,EAAE,CACH,6IACD;EAAC,CACa,CAAC;AAElB","ignoreList":[]}