{"version":3,"names":["useDispatch","store","coreStore","__","noticesStore","useState","DataForm","isItemValid","Button","__experimentalHStack","HStack","__experimentalVStack","VStack","orderField","jsx","_jsx","jsxs","_jsxs","fields","formOrderAction","ReorderModal","items","closeModal","onActionPerformed","item","setItem","orderInput","menu_order","editEntityRecord","saveEditedEntityRecord","createSuccessNotice","createErrorNotice","onOrder","event","preventDefault","type","id","throwOnError","error","typedError","errorMessage","message","code","isSaveDisabled","onSubmit","children","spacing","data","form","onChange","changes","justify","__next40pxDefaultSize","variant","onClick","accessibleWhenDisabled","disabled","reorderPage","label","isEligible","status","RenderModal"],"sources":["@wordpress/editor/src/dataviews/actions/reorder-page.tsx"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useDispatch } from '@wordpress/data';\r\nimport { store as coreStore } from '@wordpress/core-data';\r\nimport { __ } from '@wordpress/i18n';\r\nimport { store as noticesStore } from '@wordpress/notices';\r\nimport { useState } from '@wordpress/element';\r\nimport { DataForm, isItemValid } from '@wordpress/dataviews';\r\nimport {\r\n\tButton,\r\n\t__experimentalHStack as HStack,\r\n\t__experimentalVStack as VStack,\r\n} from '@wordpress/components';\r\nimport type { Action, RenderModalProps } from '@wordpress/dataviews';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport type { CoreDataError, BasePost } from '../types';\r\nimport { orderField } from '../fields';\r\n\r\nconst fields = [ orderField ];\r\nconst formOrderAction = {\r\n\tfields: [ 'menu_order' ],\r\n};\r\n\r\nfunction ReorderModal( {\r\n\titems,\r\n\tcloseModal,\r\n\tonActionPerformed,\r\n}: RenderModalProps< BasePost > ) {\r\n\tconst [ item, setItem ] = useState( items[ 0 ] );\r\n\tconst orderInput = item.menu_order;\r\n\tconst { editEntityRecord, saveEditedEntityRecord } =\r\n\t\tuseDispatch( coreStore );\r\n\tconst { createSuccessNotice, createErrorNotice } =\r\n\t\tuseDispatch( noticesStore );\r\n\r\n\tasync function onOrder( event: React.FormEvent ) {\r\n\t\tevent.preventDefault();\r\n\r\n\t\tif ( ! isItemValid( item, fields, formOrderAction ) ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tawait editEntityRecord( 'postType', item.type, item.id, {\r\n\t\t\t\tmenu_order: orderInput,\r\n\t\t\t} );\r\n\t\t\tcloseModal?.();\r\n\t\t\t// Persist edited entity.\r\n\t\t\tawait saveEditedEntityRecord( 'postType', item.type, item.id, {\r\n\t\t\t\tthrowOnError: true,\r\n\t\t\t} );\r\n\t\t\tcreateSuccessNotice( __( 'Order updated.' ), {\r\n\t\t\t\ttype: 'snackbar',\r\n\t\t\t} );\r\n\t\t\tonActionPerformed?.( items );\r\n\t\t} catch ( error ) {\r\n\t\t\tconst typedError = error as CoreDataError;\r\n\t\t\tconst errorMessage =\r\n\t\t\t\ttypedError.message && typedError.code !== 'unknown_error'\r\n\t\t\t\t\t? typedError.message\r\n\t\t\t\t\t: __( 'An error occurred while updating the order' );\r\n\t\t\tcreateErrorNotice( errorMessage, {\r\n\t\t\t\ttype: 'snackbar',\r\n\t\t\t} );\r\n\t\t}\r\n\t}\r\n\tconst isSaveDisabled = ! isItemValid( item, fields, formOrderAction );\r\n\treturn (\r\n\t\t<form onSubmit={ onOrder }>\r\n\t\t\t<VStack spacing=\"5\">\r\n\t\t\t\t<div>\r\n\t\t\t\t\t{ __(\r\n\t\t\t\t\t\t'Determines the order of pages. Pages with the same order value are sorted alphabetically. Negative order values are supported.'\r\n\t\t\t\t\t) }\r\n\t\t\t\t</div>\r\n\t\t\t\t<DataForm\r\n\t\t\t\t\tdata={ item }\r\n\t\t\t\t\tfields={ fields }\r\n\t\t\t\t\tform={ formOrderAction }\r\n\t\t\t\t\tonChange={ ( changes ) =>\r\n\t\t\t\t\t\tsetItem( {\r\n\t\t\t\t\t\t\t...item,\r\n\t\t\t\t\t\t\t...changes,\r\n\t\t\t\t\t\t} )\r\n\t\t\t\t\t}\r\n\t\t\t\t/>\r\n\t\t\t\t<HStack justify=\"right\">\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\t__next40pxDefaultSize\r\n\t\t\t\t\t\tvariant=\"tertiary\"\r\n\t\t\t\t\t\tonClick={ () => {\r\n\t\t\t\t\t\t\tcloseModal?.();\r\n\t\t\t\t\t\t} }\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{ __( 'Cancel' ) }\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\t__next40pxDefaultSize\r\n\t\t\t\t\t\tvariant=\"primary\"\r\n\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\taccessibleWhenDisabled\r\n\t\t\t\t\t\tdisabled={ isSaveDisabled }\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{ __( 'Save' ) }\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</HStack>\r\n\t\t\t</VStack>\r\n\t\t</form>\r\n\t);\r\n}\r\n\r\nconst reorderPage: Action< BasePost > = {\r\n\tid: 'order-pages',\r\n\tlabel: __( 'Order' ),\r\n\tisEligible( { status } ) {\r\n\t\treturn status !== 'trash';\r\n\t},\r\n\tRenderModal: ReorderModal,\r\n};\r\n\r\nexport default reorderPage;\r\n"],"mappings":"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","ignoreList":[]}