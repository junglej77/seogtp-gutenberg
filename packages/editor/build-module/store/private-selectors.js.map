{"version":3,"names":["fastDeepEqual","store","blockEditorStore","createSelector","createRegistrySelector","layout","symbol","navigation","page","pageIcon","verse","coreStore","getRenderingMode","getCurrentPost","__experimentalGetDefaultTemplatePartAreas","getEntityActions","_getEntityActions","isEntityReady","_isEntityReady","EMPTY_INSERTION_POINT","rootClientId","undefined","insertionIndex","filterValue","getInsertionPoint","select","state","blockInserterPanel","postContentClientId","getBlocksByName","getListViewToggleRef","listViewToggleRef","getInserterSidebarToggleRef","inserterSidebarToggleRef","CARD_ICONS","wp_block","wp_navigation","post","getPostIcon","postType","options","find","item","area","icon","postTypeEntity","getPostType","startsWith","slice","hasPostMetaChanges","postId","type","currentPostType","id","currentPostId","edits","getEntityRecordNonTransientEdits","meta","originalPostMeta","getEntityRecord","footnotes","args","dataviews","getPostBlocksByName","blockNames","Array","isArray","getBlockParents","getBlockName","filter","clientId","every","parentClientId","parentBlockName","includes","getBlocks"],"sources":["@wordpress/editor/src/store/private-selectors.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport fastDeepEqual from 'fast-deep-equal';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { store as blockEditorStore } from '@wordpress/block-editor';\r\nimport { createSelector, createRegistrySelector } from '@wordpress/data';\r\nimport {\r\n\tlayout,\r\n\tsymbol,\r\n\tnavigation,\r\n\tpage as pageIcon,\r\n\tverse,\r\n} from '@wordpress/icons';\r\nimport { store as coreStore } from '@wordpress/core-data';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport {\r\n\tgetRenderingMode,\r\n\tgetCurrentPost,\r\n\t__experimentalGetDefaultTemplatePartAreas,\r\n} from './selectors';\r\nimport {\r\n\tgetEntityActions as _getEntityActions,\r\n\tisEntityReady as _isEntityReady,\r\n} from '../dataviews/store/private-selectors';\r\n\r\nconst EMPTY_INSERTION_POINT = {\r\n\trootClientId: undefined,\r\n\tinsertionIndex: undefined,\r\n\tfilterValue: undefined,\r\n};\r\n\r\n/**\r\n * Get the insertion point for the inserter.\r\n *\r\n * @param {Object} state Global application state.\r\n *\r\n * @return {Object} The root client ID, index to insert at and starting filter value.\r\n */\r\nexport const getInsertionPoint = createRegistrySelector( ( select ) =>\r\n\tcreateSelector(\r\n\t\t( state ) => {\r\n\t\t\tif ( typeof state.blockInserterPanel === 'object' ) {\r\n\t\t\t\treturn state.blockInserterPanel;\r\n\t\t\t}\r\n\r\n\t\t\tif ( getRenderingMode( state ) === 'template-locked' ) {\r\n\t\t\t\tconst [ postContentClientId ] =\r\n\t\t\t\t\tselect( blockEditorStore ).getBlocksByName(\r\n\t\t\t\t\t\t'core/post-content'\r\n\t\t\t\t\t);\r\n\t\t\t\tif ( postContentClientId ) {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\trootClientId: postContentClientId,\r\n\t\t\t\t\t\tinsertionIndex: undefined,\r\n\t\t\t\t\t\tfilterValue: undefined,\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn EMPTY_INSERTION_POINT;\r\n\t\t},\r\n\t\t( state ) => {\r\n\t\t\tconst [ postContentClientId ] =\r\n\t\t\t\tselect( blockEditorStore ).getBlocksByName(\r\n\t\t\t\t\t'core/post-content'\r\n\t\t\t\t);\r\n\t\t\treturn [\r\n\t\t\t\tstate.blockInserterPanel,\r\n\t\t\t\tgetRenderingMode( state ),\r\n\t\t\t\tpostContentClientId,\r\n\t\t\t];\r\n\t\t}\r\n\t)\r\n);\r\n\r\nexport function getListViewToggleRef( state ) {\r\n\treturn state.listViewToggleRef;\r\n}\r\nexport function getInserterSidebarToggleRef( state ) {\r\n\treturn state.inserterSidebarToggleRef;\r\n}\r\nconst CARD_ICONS = {\r\n\twp_block: symbol,\r\n\twp_navigation: navigation,\r\n\tpage: pageIcon,\r\n\tpost: verse,\r\n};\r\n\r\nexport const getPostIcon = createRegistrySelector(\r\n\t( select ) => ( state, postType, options ) => {\r\n\t\t{\r\n\t\t\tif (\r\n\t\t\t\tpostType === 'wp_template_part' ||\r\n\t\t\t\tpostType === 'wp_template'\r\n\t\t\t) {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t__experimentalGetDefaultTemplatePartAreas( state ).find(\r\n\t\t\t\t\t\t( item ) => options.area === item.area\r\n\t\t\t\t\t)?.icon || layout\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tif ( CARD_ICONS[ postType ] ) {\r\n\t\t\t\treturn CARD_ICONS[ postType ];\r\n\t\t\t}\r\n\t\t\tconst postTypeEntity = select( coreStore ).getPostType( postType );\r\n\t\t\t// `icon` is the `menu_icon` property of a post type. We\r\n\t\t\t// only handle `dashicons` for now, even if the `menu_icon`\r\n\t\t\t// also supports urls and svg as values.\r\n\t\t\tif (\r\n\t\t\t\ttypeof postTypeEntity?.icon === 'string' &&\r\n\t\t\t\tpostTypeEntity.icon.startsWith( 'dashicons-' )\r\n\t\t\t) {\r\n\t\t\t\treturn postTypeEntity.icon.slice( 10 );\r\n\t\t\t}\r\n\t\t\treturn pageIcon;\r\n\t\t}\r\n\t}\r\n);\r\n\r\n/**\r\n * Returns true if there are unsaved changes to the\r\n * post's meta fields, and false otherwise.\r\n *\r\n * @param {Object} state    Global application state.\r\n * @param {string} postType The post type of the post.\r\n * @param {number} postId   The ID of the post.\r\n *\r\n * @return {boolean} Whether there are edits or not in the meta fields of the relevant post.\r\n */\r\nexport const hasPostMetaChanges = createRegistrySelector(\r\n\t( select ) => ( state, postType, postId ) => {\r\n\t\tconst { type: currentPostType, id: currentPostId } =\r\n\t\t\tgetCurrentPost( state );\r\n\t\t// If no postType or postId is passed, use the current post.\r\n\t\tconst edits = select( coreStore ).getEntityRecordNonTransientEdits(\r\n\t\t\t'postType',\r\n\t\t\tpostType || currentPostType,\r\n\t\t\tpostId || currentPostId\r\n\t\t);\r\n\r\n\t\tif ( ! edits?.meta ) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// Compare if anything apart from `footnotes` has changed.\r\n\t\tconst originalPostMeta = select( coreStore ).getEntityRecord(\r\n\t\t\t'postType',\r\n\t\t\tpostType || currentPostType,\r\n\t\t\tpostId || currentPostId\r\n\t\t)?.meta;\r\n\r\n\t\treturn ! fastDeepEqual(\r\n\t\t\t{ ...originalPostMeta, footnotes: undefined },\r\n\t\t\t{ ...edits.meta, footnotes: undefined }\r\n\t\t);\r\n\t}\r\n);\r\n\r\nexport function getEntityActions( state, ...args ) {\r\n\treturn _getEntityActions( state.dataviews, ...args );\r\n}\r\n\r\nexport function isEntityReady( state, ...args ) {\r\n\treturn _isEntityReady( state.dataviews, ...args );\r\n}\r\n\r\n/**\r\n * Similar to getBlocksByName in @wordpress/block-editor, but only returns the top-most\r\n * blocks that aren't descendants of the query block.\r\n *\r\n * @param {Object}       state      Global application state.\r\n * @param {Array|string} blockNames Block names of the blocks to retrieve.\r\n *\r\n * @return {Array} Block client IDs.\r\n */\r\nexport const getPostBlocksByName = createRegistrySelector( ( select ) =>\r\n\tcreateSelector(\r\n\t\t( state, blockNames ) => {\r\n\t\t\tblockNames = Array.isArray( blockNames )\r\n\t\t\t\t? blockNames\r\n\t\t\t\t: [ blockNames ];\r\n\t\t\tconst { getBlocksByName, getBlockParents, getBlockName } =\r\n\t\t\t\tselect( blockEditorStore );\r\n\t\t\treturn getBlocksByName( blockNames ).filter( ( clientId ) =>\r\n\t\t\t\tgetBlockParents( clientId ).every( ( parentClientId ) => {\r\n\t\t\t\t\tconst parentBlockName = getBlockName( parentClientId );\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t// Ignore descendents of the query block.\r\n\t\t\t\t\t\tparentBlockName !== 'core/query' &&\r\n\t\t\t\t\t\t// Enable only the top-most block.\r\n\t\t\t\t\t\t! blockNames.includes( parentBlockName )\r\n\t\t\t\t\t);\r\n\t\t\t\t} )\r\n\t\t\t);\r\n\t\t},\r\n\t\t() => [ select( blockEditorStore ).getBlocks() ]\r\n\t)\r\n);\r\n"],"mappings":"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","ignoreList":[]}