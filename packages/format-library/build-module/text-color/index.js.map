{"version":3,"names":["__","useMemo","useState","RichTextToolbarButton","useSettings","Icon","color","colorIcon","textColor","textColorIcon","removeFormat","default","InlineColorUI","getActiveColors","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","transparentValue","name","title","EMPTY_ARRAY","getComputedStyleProperty","element","property","ownerDocument","defaultView","style","getComputedStyle","value","getPropertyValue","parentElement","fillComputedColors","backgroundColor","TextColorEdit","onChange","isActive","activeAttributes","contentRef","allowCustomControl","colors","isAddingColor","setIsAddingColor","colorIndicatorStyle","current","hasColorsToChoose","length","children","className","icon","Object","keys","onClick","role","onClose","tagName","attributes","class","edit"],"sources":["@wordpress/format-library/src/text-color/index.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { __ } from '@wordpress/i18n';\r\nimport { useMemo, useState } from '@wordpress/element';\r\nimport { RichTextToolbarButton, useSettings } from '@wordpress/block-editor';\r\nimport {\r\n\tIcon,\r\n\tcolor as colorIcon,\r\n\ttextColor as textColorIcon,\r\n} from '@wordpress/icons';\r\nimport { removeFormat } from '@wordpress/rich-text';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { default as InlineColorUI, getActiveColors } from './inline';\r\n\r\nexport const transparentValue = 'rgba(0, 0, 0, 0)';\r\n\r\nconst name = 'core/text-color';\r\nconst title = __( 'Highlight' );\r\n\r\nconst EMPTY_ARRAY = [];\r\n\r\nfunction getComputedStyleProperty( element, property ) {\r\n\tconst { ownerDocument } = element;\r\n\tconst { defaultView } = ownerDocument;\r\n\tconst style = defaultView.getComputedStyle( element );\r\n\tconst value = style.getPropertyValue( property );\r\n\r\n\tif (\r\n\t\tproperty === 'background-color' &&\r\n\t\tvalue === transparentValue &&\r\n\t\telement.parentElement\r\n\t) {\r\n\t\treturn getComputedStyleProperty( element.parentElement, property );\r\n\t}\r\n\r\n\treturn value;\r\n}\r\n\r\nfunction fillComputedColors( element, { color, backgroundColor } ) {\r\n\tif ( ! color && ! backgroundColor ) {\r\n\t\treturn;\r\n\t}\r\n\r\n\treturn {\r\n\t\tcolor: color || getComputedStyleProperty( element, 'color' ),\r\n\t\tbackgroundColor:\r\n\t\t\tbackgroundColor === transparentValue\r\n\t\t\t\t? getComputedStyleProperty( element, 'background-color' )\r\n\t\t\t\t: backgroundColor,\r\n\t};\r\n}\r\n\r\nfunction TextColorEdit( {\r\n\tvalue,\r\n\tonChange,\r\n\tisActive,\r\n\tactiveAttributes,\r\n\tcontentRef,\r\n} ) {\r\n\tconst [ allowCustomControl, colors = EMPTY_ARRAY ] = useSettings(\r\n\t\t'color.custom',\r\n\t\t'color.palette'\r\n\t);\r\n\tconst [ isAddingColor, setIsAddingColor ] = useState( false );\r\n\tconst colorIndicatorStyle = useMemo(\r\n\t\t() =>\r\n\t\t\tfillComputedColors(\r\n\t\t\t\tcontentRef.current,\r\n\t\t\t\tgetActiveColors( value, name, colors )\r\n\t\t\t),\r\n\t\t[ contentRef, value, colors ]\r\n\t);\r\n\r\n\tconst hasColorsToChoose = colors.length || ! allowCustomControl;\r\n\tif ( ! hasColorsToChoose && ! isActive ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<RichTextToolbarButton\r\n\t\t\t\tclassName=\"format-library-text-color-button\"\r\n\t\t\t\tisActive={ isActive }\r\n\t\t\t\ticon={\r\n\t\t\t\t\t<Icon\r\n\t\t\t\t\t\ticon={\r\n\t\t\t\t\t\t\tObject.keys( activeAttributes ).length\r\n\t\t\t\t\t\t\t\t? textColorIcon\r\n\t\t\t\t\t\t\t\t: colorIcon\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tstyle={ colorIndicatorStyle }\r\n\t\t\t\t\t/>\r\n\t\t\t\t}\r\n\t\t\t\ttitle={ title }\r\n\t\t\t\t// If has no colors to choose but a color is active remove the color onClick.\r\n\t\t\t\tonClick={\r\n\t\t\t\t\thasColorsToChoose\r\n\t\t\t\t\t\t? () => setIsAddingColor( true )\r\n\t\t\t\t\t\t: () => onChange( removeFormat( value, name ) )\r\n\t\t\t\t}\r\n\t\t\t\trole=\"menuitemcheckbox\"\r\n\t\t\t/>\r\n\t\t\t{ isAddingColor && (\r\n\t\t\t\t<InlineColorUI\r\n\t\t\t\t\tname={ name }\r\n\t\t\t\t\tonClose={ () => setIsAddingColor( false ) }\r\n\t\t\t\t\tactiveAttributes={ activeAttributes }\r\n\t\t\t\t\tvalue={ value }\r\n\t\t\t\t\tonChange={ onChange }\r\n\t\t\t\t\tcontentRef={ contentRef }\r\n\t\t\t\t\tisActive={ isActive }\r\n\t\t\t\t/>\r\n\t\t\t) }\r\n\t\t</>\r\n\t);\r\n}\r\n\r\nexport const textColor = {\r\n\tname,\r\n\ttitle,\r\n\ttagName: 'mark',\r\n\tclassName: 'has-inline-color',\r\n\tattributes: {\r\n\t\tstyle: 'style',\r\n\t\tclass: 'class',\r\n\t},\r\n\tedit: TextColorEdit,\r\n};\r\n"],"mappings":"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","ignoreList":[]}