{"version":3,"names":["useMemo","useSelect","applyFormat","removeFormat","getActiveFormat","useAnchor","ColorPalette","getColorClassName","getColorObjectByColorValue","getColorObjectByAttributeValues","store","blockEditorStore","Popover","privateApis","componentsPrivateApis","__","textColor","settings","transparentValue","unlock","jsx","_jsx","jsxs","_jsxs","Tabs","TABS","name","title","parseCSS","css","split","reduce","accumulator","rule","property","value","color","backgroundColor","parseClassName","className","colorSettings","startsWith","endsWith","colorSlug","replace","colorObject","getActiveColors","activeColorFormat","attributes","style","class","setColors","colors","styles","classNames","push","join","slug","length","type","ColorPicker","onChange","select","_getSettings$colors","getSettings","activeColors","InlineColorUI","onClose","contentRef","isActive","popoverAnchor","editableContentElement","current","anchor","children","TabList","map","tab","Tab","tabId","TabPanel","focusable"],"sources":["@wordpress/format-library/src/text-color/inline.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useMemo } from '@wordpress/element';\r\nimport { useSelect } from '@wordpress/data';\r\nimport {\r\n\tapplyFormat,\r\n\tremoveFormat,\r\n\tgetActiveFormat,\r\n\tuseAnchor,\r\n} from '@wordpress/rich-text';\r\nimport {\r\n\tColorPalette,\r\n\tgetColorClassName,\r\n\tgetColorObjectByColorValue,\r\n\tgetColorObjectByAttributeValues,\r\n\tstore as blockEditorStore,\r\n} from '@wordpress/block-editor';\r\nimport {\r\n\tPopover,\r\n\tprivateApis as componentsPrivateApis,\r\n} from '@wordpress/components';\r\nimport { __ } from '@wordpress/i18n';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { textColor as settings, transparentValue } from './index';\r\nimport { unlock } from '../lock-unlock';\r\n\r\nconst { Tabs } = unlock( componentsPrivateApis );\r\n\r\nconst TABS = [\r\n\t{ name: 'color', title: __( 'Text' ) },\r\n\t{ name: 'backgroundColor', title: __( 'Background' ) },\r\n];\r\n\r\nfunction parseCSS( css = '' ) {\r\n\treturn css.split( ';' ).reduce( ( accumulator, rule ) => {\r\n\t\tif ( rule ) {\r\n\t\t\tconst [ property, value ] = rule.split( ':' );\r\n\t\t\tif ( property === 'color' ) {\r\n\t\t\t\taccumulator.color = value;\r\n\t\t\t}\r\n\t\t\tif (\r\n\t\t\t\tproperty === 'background-color' &&\r\n\t\t\t\tvalue !== transparentValue\r\n\t\t\t) {\r\n\t\t\t\taccumulator.backgroundColor = value;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn accumulator;\r\n\t}, {} );\r\n}\r\n\r\nexport function parseClassName( className = '', colorSettings ) {\r\n\treturn className.split( ' ' ).reduce( ( accumulator, name ) => {\r\n\t\t// `colorSlug` could contain dashes, so simply match the start and end.\r\n\t\tif ( name.startsWith( 'has-' ) && name.endsWith( '-color' ) ) {\r\n\t\t\tconst colorSlug = name\r\n\t\t\t\t.replace( /^has-/, '' )\r\n\t\t\t\t.replace( /-color$/, '' );\r\n\t\t\tconst colorObject = getColorObjectByAttributeValues(\r\n\t\t\t\tcolorSettings,\r\n\t\t\t\tcolorSlug\r\n\t\t\t);\r\n\t\t\taccumulator.color = colorObject.color;\r\n\t\t}\r\n\t\treturn accumulator;\r\n\t}, {} );\r\n}\r\n\r\nexport function getActiveColors( value, name, colorSettings ) {\r\n\tconst activeColorFormat = getActiveFormat( value, name );\r\n\r\n\tif ( ! activeColorFormat ) {\r\n\t\treturn {};\r\n\t}\r\n\r\n\treturn {\r\n\t\t...parseCSS( activeColorFormat.attributes.style ),\r\n\t\t...parseClassName( activeColorFormat.attributes.class, colorSettings ),\r\n\t};\r\n}\r\n\r\nfunction setColors( value, name, colorSettings, colors ) {\r\n\tconst { color, backgroundColor } = {\r\n\t\t...getActiveColors( value, name, colorSettings ),\r\n\t\t...colors,\r\n\t};\r\n\r\n\tif ( ! color && ! backgroundColor ) {\r\n\t\treturn removeFormat( value, name );\r\n\t}\r\n\r\n\tconst styles = [];\r\n\tconst classNames = [];\r\n\tconst attributes = {};\r\n\r\n\tif ( backgroundColor ) {\r\n\t\tstyles.push( [ 'background-color', backgroundColor ].join( ':' ) );\r\n\t} else {\r\n\t\t// Override default browser color for mark element.\r\n\t\tstyles.push( [ 'background-color', transparentValue ].join( ':' ) );\r\n\t}\r\n\r\n\tif ( color ) {\r\n\t\tconst colorObject = getColorObjectByColorValue( colorSettings, color );\r\n\r\n\t\tif ( colorObject ) {\r\n\t\t\tclassNames.push( getColorClassName( 'color', colorObject.slug ) );\r\n\t\t} else {\r\n\t\t\tstyles.push( [ 'color', color ].join( ':' ) );\r\n\t\t}\r\n\t}\r\n\r\n\tif ( styles.length ) {\r\n\t\tattributes.style = styles.join( ';' );\r\n\t}\r\n\tif ( classNames.length ) {\r\n\t\tattributes.class = classNames.join( ' ' );\r\n\t}\r\n\r\n\treturn applyFormat( value, { type: name, attributes } );\r\n}\r\n\r\nfunction ColorPicker( { name, property, value, onChange } ) {\r\n\tconst colors = useSelect( ( select ) => {\r\n\t\tconst { getSettings } = select( blockEditorStore );\r\n\t\treturn getSettings().colors ?? [];\r\n\t}, [] );\r\n\tconst activeColors = useMemo(\r\n\t\t() => getActiveColors( value, name, colors ),\r\n\t\t[ name, value, colors ]\r\n\t);\r\n\r\n\treturn (\r\n\t\t<ColorPalette\r\n\t\t\tvalue={ activeColors[ property ] }\r\n\t\t\tonChange={ ( color ) => {\r\n\t\t\t\tonChange(\r\n\t\t\t\t\tsetColors( value, name, colors, { [ property ]: color } )\r\n\t\t\t\t);\r\n\t\t\t} }\r\n\t\t/>\r\n\t);\r\n}\r\n\r\nexport default function InlineColorUI( {\r\n\tname,\r\n\tvalue,\r\n\tonChange,\r\n\tonClose,\r\n\tcontentRef,\r\n\tisActive,\r\n} ) {\r\n\tconst popoverAnchor = useAnchor( {\r\n\t\teditableContentElement: contentRef.current,\r\n\t\tsettings: { ...settings, isActive },\r\n\t} );\r\n\r\n\treturn (\r\n\t\t<Popover\r\n\t\t\tonClose={ onClose }\r\n\t\t\tclassName=\"format-library__inline-color-popover\"\r\n\t\t\tanchor={ popoverAnchor }\r\n\t\t>\r\n\t\t\t<Tabs>\r\n\t\t\t\t<Tabs.TabList>\r\n\t\t\t\t\t{ TABS.map( ( tab ) => (\r\n\t\t\t\t\t\t<Tabs.Tab tabId={ tab.name } key={ tab.name }>\r\n\t\t\t\t\t\t\t{ tab.title }\r\n\t\t\t\t\t\t</Tabs.Tab>\r\n\t\t\t\t\t) ) }\r\n\t\t\t\t</Tabs.TabList>\r\n\t\t\t\t{ TABS.map( ( tab ) => (\r\n\t\t\t\t\t<Tabs.TabPanel\r\n\t\t\t\t\t\ttabId={ tab.name }\r\n\t\t\t\t\t\tfocusable={ false }\r\n\t\t\t\t\t\tkey={ tab.name }\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\t\tname={ name }\r\n\t\t\t\t\t\t\tproperty={ tab.name }\r\n\t\t\t\t\t\t\tvalue={ value }\r\n\t\t\t\t\t\t\tonChange={ onChange }\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Tabs.TabPanel>\r\n\t\t\t\t) ) }\r\n\t\t\t</Tabs>\r\n\t\t</Popover>\r\n\t);\r\n}\r\n"],"mappings":"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","ignoreList":[]}