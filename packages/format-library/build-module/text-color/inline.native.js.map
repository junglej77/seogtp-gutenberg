{"version":3,"names":["useCallback","useMemo","applyFormat","removeFormat","getActiveFormat","getColorClassName","getColorObjectByColorValue","useMultipleOriginColorsAndGradients","useMobileGlobalStylesColors","BottomSheet","ColorSettings","transparentValue","parseClassName","jsx","_jsx","parseCSS","css","split","reduce","accumulator","rule","property","value","replace","color","backgroundColor","getActiveColors","name","colorSettings","activeColorFormat","attributes","style","class","setColors","colors","contentRef","onRemoveMarkFormatting","styles","classNames","push","join","colorObject","slug","length","format","type","hasNoSelection","start","end","onMarkFormatting","ColorPicker","onChange","allAvailableColors","onColorChange","activeColors","colorValue","onColorCleared","defaultSettings","hideNavigation","InlineColorUI","onClose","isVisible","hideHeader","contentStyle","paddingLeft","paddingRight","hasNavigation","leftButton","testID","children","NavigationContainer","animate","main","NavigationScreen"],"sources":["@wordpress/format-library/src/text-color/inline.native.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useCallback, useMemo } from '@wordpress/element';\r\nimport {\r\n\tapplyFormat,\r\n\tremoveFormat,\r\n\tgetActiveFormat,\r\n} from '@wordpress/rich-text';\r\nimport {\r\n\tgetColorClassName,\r\n\tgetColorObjectByColorValue,\r\n\tuseMultipleOriginColorsAndGradients,\r\n\tuseMobileGlobalStylesColors,\r\n} from '@wordpress/block-editor';\r\nimport { BottomSheet, ColorSettings } from '@wordpress/components';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { transparentValue } from './index.js';\r\nimport { parseClassName } from './inline.js';\r\n\r\nfunction parseCSS( css = '' ) {\r\n\treturn css.split( ';' ).reduce( ( accumulator, rule ) => {\r\n\t\tif ( rule ) {\r\n\t\t\tconst [ property, value ] = rule.replace( / /g, '' ).split( ':' );\r\n\t\t\tif ( property === 'color' ) {\r\n\t\t\t\taccumulator.color = value;\r\n\t\t\t}\r\n\t\t\tif (\r\n\t\t\t\tproperty === 'background-color' &&\r\n\t\t\t\tvalue !== transparentValue\r\n\t\t\t) {\r\n\t\t\t\taccumulator.backgroundColor = value;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn accumulator;\r\n\t}, {} );\r\n}\r\n\r\nexport function getActiveColors( value, name, colorSettings ) {\r\n\tconst activeColorFormat = getActiveFormat( value, name );\r\n\r\n\tif ( ! activeColorFormat ) {\r\n\t\treturn {};\r\n\t}\r\n\r\n\treturn {\r\n\t\t...parseCSS( activeColorFormat.attributes.style ),\r\n\t\t...parseClassName( activeColorFormat.attributes.class, colorSettings ),\r\n\t};\r\n}\r\n\r\nfunction setColors( value, name, colorSettings, colors, contentRef ) {\r\n\tconst { color, backgroundColor } = {\r\n\t\t...getActiveColors( value, name, colorSettings ),\r\n\t\t...colors,\r\n\t};\r\n\r\n\tif ( ! color ) {\r\n\t\tcontentRef?.onRemoveMarkFormatting();\r\n\t\treturn removeFormat( value, name );\r\n\t}\r\n\r\n\tconst styles = [];\r\n\tconst classNames = [];\r\n\tconst attributes = {};\r\n\r\n\tif ( backgroundColor ) {\r\n\t\tstyles.push( [ 'background-color', backgroundColor ].join( ':' ) );\r\n\t} else {\r\n\t\t// Override default browser color for mark element.\r\n\t\tstyles.push( [ 'background-color', transparentValue ].join( ':' ) );\r\n\t}\r\n\r\n\tif ( color ) {\r\n\t\tconst colorObject = getColorObjectByColorValue( colorSettings, color );\r\n\r\n\t\tif ( colorObject ) {\r\n\t\t\tclassNames.push( getColorClassName( 'color', colorObject.slug ) );\r\n\t\t\tstyles.push( [ 'color', colorObject.color ].join( ':' ) );\r\n\t\t} else {\r\n\t\t\tstyles.push( [ 'color', color ].join( ':' ) );\r\n\t\t}\r\n\t}\r\n\r\n\tif ( styles.length ) {\r\n\t\tattributes.style = styles.join( ';' );\r\n\t}\r\n\tif ( classNames.length ) {\r\n\t\tattributes.class = classNames.join( ' ' );\r\n\t}\r\n\r\n\tconst format = { type: name, attributes };\r\n\tconst hasNoSelection = value.start === value.end;\r\n\r\n\tif ( hasNoSelection ) {\r\n\t\tcontentRef?.onMarkFormatting( color );\r\n\t}\r\n\treturn applyFormat( value, format );\r\n}\r\n\r\nfunction ColorPicker( { name, value, onChange, contentRef } ) {\r\n\tconst property = 'color';\r\n\tconst colors = useMobileGlobalStylesColors();\r\n\tconst colorSettings = useMultipleOriginColorsAndGradients();\r\n\tcolorSettings.allAvailableColors = colors;\r\n\r\n\tconst onColorChange = useCallback(\r\n\t\t( color ) => {\r\n\t\t\tonChange(\r\n\t\t\t\tsetColors(\r\n\t\t\t\t\tvalue,\r\n\t\t\t\t\tname,\r\n\t\t\t\t\tcolors,\r\n\t\t\t\t\t{ [ property ]: color },\r\n\t\t\t\t\tcontentRef\r\n\t\t\t\t)\r\n\t\t\t);\r\n\t\t},\r\n\t\t[ colors, contentRef, name, onChange, value ]\r\n\t);\r\n\tconst activeColors = useMemo(\r\n\t\t() => getActiveColors( value, name, colors ),\r\n\t\t[ name, value, colors ]\r\n\t);\r\n\r\n\treturn (\r\n\t\t<ColorSettings\r\n\t\t\tcolorValue={ activeColors[ property ] }\r\n\t\t\tonColorChange={ onColorChange }\r\n\t\t\tonColorCleared={ onColorChange }\r\n\t\t\tdefaultSettings={ colorSettings }\r\n\t\t\thideNavigation\r\n\t\t/>\r\n\t);\r\n}\r\n\r\nexport default function InlineColorUI( {\r\n\tname,\r\n\tvalue,\r\n\tonChange,\r\n\tonClose,\r\n\tcontentRef,\r\n} ) {\r\n\treturn (\r\n\t\t<BottomSheet\r\n\t\t\tisVisible\r\n\t\t\tonClose={ onClose }\r\n\t\t\thideHeader\r\n\t\t\tcontentStyle={ { paddingLeft: 0, paddingRight: 0 } }\r\n\t\t\thasNavigation\r\n\t\t\tleftButton={ null }\r\n\t\t\ttestID=\"inline-text-color-modal\"\r\n\t\t>\r\n\t\t\t<BottomSheet.NavigationContainer animate main>\r\n\t\t\t\t<BottomSheet.NavigationScreen name=\"text-color\">\r\n\t\t\t\t\t<ColorPicker\r\n\t\t\t\t\t\tname={ name }\r\n\t\t\t\t\t\tvalue={ value }\r\n\t\t\t\t\t\tonChange={ onChange }\r\n\t\t\t\t\t\tcontentRef={ contentRef }\r\n\t\t\t\t\t/>\r\n\t\t\t\t</BottomSheet.NavigationScreen>\r\n\t\t\t</BottomSheet.NavigationContainer>\r\n\t\t</BottomSheet>\r\n\t);\r\n}\r\n"],"mappings":"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","ignoreList":[]}