{"version":3,"names":["validateNamespace","validateHookName","createRemoveHook","hooks","storeKey","removeAll","removeHook","hookName","namespace","hooksStore","handlersRemoved","handlers","length","runs","i","splice","__current","forEach","hookInfo","name","currentIndex","doAction"],"sources":["@wordpress/hooks/src/createRemoveHook.js"],"sourcesContent":["/**\r\n * Internal dependencies\r\n */\r\nimport validateNamespace from './validateNamespace.js';\r\nimport validateHookName from './validateHookName.js';\r\n\r\n/**\r\n * @callback RemoveHook\r\n * Removes the specified callback (or all callbacks) from the hook with a given hookName\r\n * and namespace.\r\n *\r\n * @param {string} hookName  The name of the hook to modify.\r\n * @param {string} namespace The unique namespace identifying the callback in the\r\n *                           form `vendor/plugin/function`.\r\n *\r\n * @return {number | undefined} The number of callbacks removed.\r\n */\r\n\r\n/**\r\n * Returns a function which, when invoked, will remove a specified hook or all\r\n * hooks by the given name.\r\n *\r\n * @param {import('.').Hooks}    hooks             Hooks instance.\r\n * @param {import('.').StoreKey} storeKey\r\n * @param {boolean}              [removeAll=false] Whether to remove all callbacks for a hookName,\r\n *                                                 without regard to namespace. Used to create\r\n *                                                 `removeAll*` functions.\r\n *\r\n * @return {RemoveHook} Function that removes hooks.\r\n */\r\nfunction createRemoveHook( hooks, storeKey, removeAll = false ) {\r\n\treturn function removeHook( hookName, namespace ) {\r\n\t\tconst hooksStore = hooks[ storeKey ];\r\n\r\n\t\tif ( ! validateHookName( hookName ) ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif ( ! removeAll && ! validateNamespace( namespace ) ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Bail if no hooks exist by this name.\r\n\t\tif ( ! hooksStore[ hookName ] ) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\tlet handlersRemoved = 0;\r\n\r\n\t\tif ( removeAll ) {\r\n\t\t\thandlersRemoved = hooksStore[ hookName ].handlers.length;\r\n\t\t\thooksStore[ hookName ] = {\r\n\t\t\t\truns: hooksStore[ hookName ].runs,\r\n\t\t\t\thandlers: [],\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\t// Try to find the specified callback to remove.\r\n\t\t\tconst handlers = hooksStore[ hookName ].handlers;\r\n\t\t\tfor ( let i = handlers.length - 1; i >= 0; i-- ) {\r\n\t\t\t\tif ( handlers[ i ].namespace === namespace ) {\r\n\t\t\t\t\thandlers.splice( i, 1 );\r\n\t\t\t\t\thandlersRemoved++;\r\n\t\t\t\t\t// This callback may also be part of a hook that is\r\n\t\t\t\t\t// currently executing.  If the callback we're removing\r\n\t\t\t\t\t// comes after the current callback, there's no problem;\r\n\t\t\t\t\t// otherwise we need to decrease the execution index of any\r\n\t\t\t\t\t// other runs by 1 to account for the removed element.\r\n\t\t\t\t\thooksStore.__current.forEach( ( hookInfo ) => {\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\thookInfo.name === hookName &&\r\n\t\t\t\t\t\t\thookInfo.currentIndex >= i\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\thookInfo.currentIndex--;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif ( hookName !== 'hookRemoved' ) {\r\n\t\t\thooks.doAction( 'hookRemoved', hookName, namespace );\r\n\t\t}\r\n\r\n\t\treturn handlersRemoved;\r\n\t};\r\n}\r\n\r\nexport default createRemoveHook;\r\n"],"mappings":"AAAA;AACA;AACA;AACA,OAAOA,iBAAiB,MAAM,wBAAwB;AACtD,OAAOC,gBAAgB,MAAM,uBAAuB;;AAEpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASC,gBAAgBA,CAAEC,KAAK,EAAEC,QAAQ,EAAEC,SAAS,GAAG,KAAK,EAAG;EAC/D,OAAO,SAASC,UAAUA,CAAEC,QAAQ,EAAEC,SAAS,EAAG;IACjD,MAAMC,UAAU,GAAGN,KAAK,CAAEC,QAAQ,CAAE;IAEpC,IAAK,CAAEH,gBAAgB,CAAEM,QAAS,CAAC,EAAG;MACrC;IACD;IAEA,IAAK,CAAEF,SAAS,IAAI,CAAEL,iBAAiB,CAAEQ,SAAU,CAAC,EAAG;MACtD;IACD;;IAEA;IACA,IAAK,CAAEC,UAAU,CAAEF,QAAQ,CAAE,EAAG;MAC/B,OAAO,CAAC;IACT;IAEA,IAAIG,eAAe,GAAG,CAAC;IAEvB,IAAKL,SAAS,EAAG;MAChBK,eAAe,GAAGD,UAAU,CAAEF,QAAQ,CAAE,CAACI,QAAQ,CAACC,MAAM;MACxDH,UAAU,CAAEF,QAAQ,CAAE,GAAG;QACxBM,IAAI,EAAEJ,UAAU,CAAEF,QAAQ,CAAE,CAACM,IAAI;QACjCF,QAAQ,EAAE;MACX,CAAC;IACF,CAAC,MAAM;MACN;MACA,MAAMA,QAAQ,GAAGF,UAAU,CAAEF,QAAQ,CAAE,CAACI,QAAQ;MAChD,KAAM,IAAIG,CAAC,GAAGH,QAAQ,CAACC,MAAM,GAAG,CAAC,EAAEE,CAAC,IAAI,CAAC,EAAEA,CAAC,EAAE,EAAG;QAChD,IAAKH,QAAQ,CAAEG,CAAC,CAAE,CAACN,SAAS,KAAKA,SAAS,EAAG;UAC5CG,QAAQ,CAACI,MAAM,CAAED,CAAC,EAAE,CAAE,CAAC;UACvBJ,eAAe,EAAE;UACjB;UACA;UACA;UACA;UACA;UACAD,UAAU,CAACO,SAAS,CAACC,OAAO,CAAIC,QAAQ,IAAM;YAC7C,IACCA,QAAQ,CAACC,IAAI,KAAKZ,QAAQ,IAC1BW,QAAQ,CAACE,YAAY,IAAIN,CAAC,EACzB;cACDI,QAAQ,CAACE,YAAY,EAAE;YACxB;UACD,CAAE,CAAC;QACJ;MACD;IACD;IAEA,IAAKb,QAAQ,KAAK,aAAa,EAAG;MACjCJ,KAAK,CAACkB,QAAQ,CAAE,aAAa,EAAEd,QAAQ,EAAEC,SAAU,CAAC;IACrD;IAEA,OAAOE,eAAe;EACvB,CAAC;AACF;AAEA,eAAeR,gBAAgB","ignoreList":[]}