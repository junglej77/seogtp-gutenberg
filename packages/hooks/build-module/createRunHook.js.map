{"version":3,"names":["createRunHook","hooks","storeKey","returnFirstArg","runHooks","hookName","args","hooksStore","handlers","runs","process","env","NODE_ENV","all","push","length","undefined","hookInfo","name","currentIndex","__current","handler","result","callback","apply","pop"],"sources":["@wordpress/hooks/src/createRunHook.js"],"sourcesContent":["/**\r\n * Returns a function which, when invoked, will execute all callbacks\r\n * registered to a hook of the specified type, optionally returning the final\r\n * value of the call chain.\r\n *\r\n * @param {import('.').Hooks}    hooks                  Hooks instance.\r\n * @param {import('.').StoreKey} storeKey\r\n * @param {boolean}              [returnFirstArg=false] Whether each hook callback is expected to\r\n *                                                      return its first argument.\r\n *\r\n * @return {(hookName:string, ...args: unknown[]) => undefined|unknown} Function that runs hook callbacks.\r\n */\r\nfunction createRunHook( hooks, storeKey, returnFirstArg = false ) {\r\n\treturn function runHooks( hookName, ...args ) {\r\n\t\tconst hooksStore = hooks[ storeKey ];\r\n\r\n\t\tif ( ! hooksStore[ hookName ] ) {\r\n\t\t\thooksStore[ hookName ] = {\r\n\t\t\t\thandlers: [],\r\n\t\t\t\truns: 0,\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\thooksStore[ hookName ].runs++;\r\n\r\n\t\tconst handlers = hooksStore[ hookName ].handlers;\r\n\r\n\t\t// The following code is stripped from production builds.\r\n\t\tif ( 'production' !== process.env.NODE_ENV ) {\r\n\t\t\t// Handle any 'all' hooks registered.\r\n\t\t\tif ( 'hookAdded' !== hookName && hooksStore.all ) {\r\n\t\t\t\thandlers.push( ...hooksStore.all.handlers );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif ( ! handlers || ! handlers.length ) {\r\n\t\t\treturn returnFirstArg ? args[ 0 ] : undefined;\r\n\t\t}\r\n\r\n\t\tconst hookInfo = {\r\n\t\t\tname: hookName,\r\n\t\t\tcurrentIndex: 0,\r\n\t\t};\r\n\r\n\t\thooksStore.__current.push( hookInfo );\r\n\r\n\t\twhile ( hookInfo.currentIndex < handlers.length ) {\r\n\t\t\tconst handler = handlers[ hookInfo.currentIndex ];\r\n\r\n\t\t\tconst result = handler.callback.apply( null, args );\r\n\t\t\tif ( returnFirstArg ) {\r\n\t\t\t\targs[ 0 ] = result;\r\n\t\t\t}\r\n\r\n\t\t\thookInfo.currentIndex++;\r\n\t\t}\r\n\r\n\t\thooksStore.__current.pop();\r\n\r\n\t\tif ( returnFirstArg ) {\r\n\t\t\treturn args[ 0 ];\r\n\t\t}\r\n\r\n\t\treturn undefined;\r\n\t};\r\n}\r\n\r\nexport default createRunHook;\r\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASA,aAAaA,CAAEC,KAAK,EAAEC,QAAQ,EAAEC,cAAc,GAAG,KAAK,EAAG;EACjE,OAAO,SAASC,QAAQA,CAAEC,QAAQ,EAAE,GAAGC,IAAI,EAAG;IAC7C,MAAMC,UAAU,GAAGN,KAAK,CAAEC,QAAQ,CAAE;IAEpC,IAAK,CAAEK,UAAU,CAAEF,QAAQ,CAAE,EAAG;MAC/BE,UAAU,CAAEF,QAAQ,CAAE,GAAG;QACxBG,QAAQ,EAAE,EAAE;QACZC,IAAI,EAAE;MACP,CAAC;IACF;IAEAF,UAAU,CAAEF,QAAQ,CAAE,CAACI,IAAI,EAAE;IAE7B,MAAMD,QAAQ,GAAGD,UAAU,CAAEF,QAAQ,CAAE,CAACG,QAAQ;;IAEhD;IACA,IAAK,YAAY,KAAKE,OAAO,CAACC,GAAG,CAACC,QAAQ,EAAG;MAC5C;MACA,IAAK,WAAW,KAAKP,QAAQ,IAAIE,UAAU,CAACM,GAAG,EAAG;QACjDL,QAAQ,CAACM,IAAI,CAAE,GAAGP,UAAU,CAACM,GAAG,CAACL,QAAS,CAAC;MAC5C;IACD;IAEA,IAAK,CAAEA,QAAQ,IAAI,CAAEA,QAAQ,CAACO,MAAM,EAAG;MACtC,OAAOZ,cAAc,GAAGG,IAAI,CAAE,CAAC,CAAE,GAAGU,SAAS;IAC9C;IAEA,MAAMC,QAAQ,GAAG;MAChBC,IAAI,EAAEb,QAAQ;MACdc,YAAY,EAAE;IACf,CAAC;IAEDZ,UAAU,CAACa,SAAS,CAACN,IAAI,CAAEG,QAAS,CAAC;IAErC,OAAQA,QAAQ,CAACE,YAAY,GAAGX,QAAQ,CAACO,MAAM,EAAG;MACjD,MAAMM,OAAO,GAAGb,QAAQ,CAAES,QAAQ,CAACE,YAAY,CAAE;MAEjD,MAAMG,MAAM,GAAGD,OAAO,CAACE,QAAQ,CAACC,KAAK,CAAE,IAAI,EAAElB,IAAK,CAAC;MACnD,IAAKH,cAAc,EAAG;QACrBG,IAAI,CAAE,CAAC,CAAE,GAAGgB,MAAM;MACnB;MAEAL,QAAQ,CAACE,YAAY,EAAE;IACxB;IAEAZ,UAAU,CAACa,SAAS,CAACK,GAAG,CAAC,CAAC;IAE1B,IAAKtB,cAAc,EAAG;MACrB,OAAOG,IAAI,CAAE,CAAC,CAAE;IACjB;IAEA,OAAOU,SAAS;EACjB,CAAC;AACF;AAEA,eAAehB,aAAa","ignoreList":[]}