{"version":3,"names":["objToProxy","WeakMap","proxyToObj","proxyToNs","supported","Set","Object","Array","createProxy","namespace","obj","handlers","shouldProxy","Error","has","proxy","Proxy","set","get","getProxyFromObject","getNamespaceFromProxy","candidate","constructor","getObjectFromProxy"],"sources":["@wordpress/interactivity/src/proxies/registry.ts"],"sourcesContent":["/**\r\n * Proxies for each object.\r\n */\r\nconst objToProxy = new WeakMap< object, object >();\r\nconst proxyToObj = new WeakMap< object, object >();\r\n\r\n/**\r\n * Namespaces for each created proxy.\r\n */\r\nconst proxyToNs = new WeakMap< object, string >();\r\n\r\n/**\r\n * Object types that can be proxied.\r\n */\r\nconst supported = new Set( [ Object, Array ] );\r\n\r\n/**\r\n * Returns a proxy to the passed object with the given handlers, assigning the\r\n * specified namespace to it. If a proxy for the passed object was created\r\n * before, that proxy is returned.\r\n *\r\n * @param namespace The namespace that will be associated to this proxy.\r\n * @param obj       The object to proxify.\r\n * @param handlers  Handlers that the proxy will use.\r\n *\r\n * @throws Error if the object cannot be proxified. Use {@link shouldProxy} to\r\n *         check if a proxy can be created for a specific object.\r\n *\r\n * @return The created proxy.\r\n */\r\nexport const createProxy = < T extends object >(\r\n\tnamespace: string,\r\n\tobj: T,\r\n\thandlers: ProxyHandler< T >\r\n): T => {\r\n\tif ( ! shouldProxy( obj ) ) {\r\n\t\tthrow Error( 'This object cannot be proxified.' );\r\n\t}\r\n\tif ( ! objToProxy.has( obj ) ) {\r\n\t\tconst proxy = new Proxy( obj, handlers );\r\n\t\tobjToProxy.set( obj, proxy );\r\n\t\tproxyToObj.set( proxy, obj );\r\n\t\tproxyToNs.set( proxy, namespace );\r\n\t}\r\n\treturn objToProxy.get( obj ) as T;\r\n};\r\n\r\n/**\r\n * Returns the proxy for the given object. If there is no associated proxy, the\r\n * function returns `undefined`.\r\n *\r\n * @param obj Object from which to know the proxy.\r\n * @return Associated proxy or `undefined`.\r\n */\r\nexport const getProxyFromObject = < T extends object >(\r\n\tobj: T\r\n): T | undefined => objToProxy.get( obj ) as T;\r\n\r\n/**\r\n * Gets the namespace associated with the given proxy.\r\n *\r\n * Proxies have a namespace assigned upon creation. See {@link createProxy}.\r\n *\r\n * @param proxy Proxy.\r\n * @return Namespace.\r\n */\r\nexport const getNamespaceFromProxy = ( proxy: object ): string =>\r\n\tproxyToNs.get( proxy )!;\r\n\r\n/**\r\n * Checks if a given object can be proxied.\r\n *\r\n * @param candidate Object to know whether it can be proxied.\r\n * @return True if the passed instance can be proxied.\r\n */\r\nexport const shouldProxy = (\r\n\tcandidate: any\r\n): candidate is Object | Array< unknown > => {\r\n\tif ( typeof candidate !== 'object' || candidate === null ) {\r\n\t\treturn false;\r\n\t}\r\n\treturn (\r\n\t\t! proxyToNs.has( candidate ) && supported.has( candidate.constructor )\r\n\t);\r\n};\r\n\r\n/**\r\n * Returns the target object for the passed proxy. If the passed object is not a registered proxy, the\r\n * function returns `undefined`.\r\n *\r\n * @param proxy Proxy from which to know the target.\r\n * @return The target object or `undefined`.\r\n */\r\nexport const getObjectFromProxy = < T extends object >(\r\n\tproxy: T\r\n): T | undefined => proxyToObj.get( proxy ) as T;\r\n"],"mappings":"AAAA;AACA;AACA;AACA,MAAMA,UAAU,GAAG,IAAIC,OAAO,CAAmB,CAAC;AAClD,MAAMC,UAAU,GAAG,IAAID,OAAO,CAAmB,CAAC;;AAElD;AACA;AACA;AACA,MAAME,SAAS,GAAG,IAAIF,OAAO,CAAmB,CAAC;;AAEjD;AACA;AACA;AACA,MAAMG,SAAS,GAAG,IAAIC,GAAG,CAAE,CAAEC,MAAM,EAAEC,KAAK,CAAG,CAAC;;AAE9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,MAAMC,WAAW,GAAGA,CAC1BC,SAAiB,EACjBC,GAAM,EACNC,QAA2B,KACpB;EACP,IAAK,CAAEC,WAAW,CAAEF,GAAI,CAAC,EAAG;IAC3B,MAAMG,KAAK,CAAE,kCAAmC,CAAC;EAClD;EACA,IAAK,CAAEb,UAAU,CAACc,GAAG,CAAEJ,GAAI,CAAC,EAAG;IAC9B,MAAMK,KAAK,GAAG,IAAIC,KAAK,CAAEN,GAAG,EAAEC,QAAS,CAAC;IACxCX,UAAU,CAACiB,GAAG,CAAEP,GAAG,EAAEK,KAAM,CAAC;IAC5Bb,UAAU,CAACe,GAAG,CAAEF,KAAK,EAAEL,GAAI,CAAC;IAC5BP,SAAS,CAACc,GAAG,CAAEF,KAAK,EAAEN,SAAU,CAAC;EAClC;EACA,OAAOT,UAAU,CAACkB,GAAG,CAAER,GAAI,CAAC;AAC7B,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,MAAMS,kBAAkB,GAC9BT,GAAM,IACaV,UAAU,CAACkB,GAAG,CAAER,GAAI,CAAM;;AAE9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,MAAMU,qBAAqB,GAAKL,KAAa,IACnDZ,SAAS,CAACe,GAAG,CAAEH,KAAM,CAAE;;AAExB;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,MAAMH,WAAW,GACvBS,SAAc,IAC8B;EAC5C,IAAK,OAAOA,SAAS,KAAK,QAAQ,IAAIA,SAAS,KAAK,IAAI,EAAG;IAC1D,OAAO,KAAK;EACb;EACA,OACC,CAAElB,SAAS,CAACW,GAAG,CAAEO,SAAU,CAAC,IAAIjB,SAAS,CAACU,GAAG,CAAEO,SAAS,CAACC,WAAY,CAAC;AAExE,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,MAAMC,kBAAkB,GAC9BR,KAAQ,IACWb,UAAU,CAACgB,GAAG,CAAEH,KAAM,CAAM","ignoreList":[]}