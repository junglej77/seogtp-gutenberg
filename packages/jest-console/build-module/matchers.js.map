{"version":3,"names":["matcherHint","printExpected","printReceived","supportedMatchers","createErrorMessage","spyInfo","spy","pass","calls","matcherName","methodName","expected","hint","message","map","getMockName","createSpyInfo","mock","JSON","stringify","includes","length","createToHaveBeenCalledMatcher","received","assertionsNumber","createToHaveBeenCalledWith","expect","extend","Object","entries","reduce","result","matcherNameWith"],"sources":["@wordpress/jest-console/src/matchers.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport { matcherHint, printExpected, printReceived } from 'jest-matcher-utils';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport supportedMatchers from './supported-matchers';\r\n\r\nconst createErrorMessage = ( spyInfo ) => {\r\n\tconst { spy, pass, calls, matcherName, methodName, expected } = spyInfo;\r\n\tconst hint = pass ? `.not${ matcherName }` : matcherName;\r\n\tconst message = pass\r\n\t\t? `Expected mock function not to be called but it was called with:\\n${ calls.map(\r\n\t\t\t\tprintReceived\r\n\t\t  ) }`\r\n\t\t: `Expected mock function to be called${\r\n\t\t\t\texpected ? ` with:\\n${ printExpected( expected ) }\\n` : '.'\r\n\t\t  }\\nbut it was called with:\\n${ calls.map( printReceived ) }`;\r\n\r\n\treturn () =>\r\n\t\t`${ matcherHint( hint, spy.getMockName() ) }` +\r\n\t\t'\\n\\n' +\r\n\t\tmessage +\r\n\t\t'\\n\\n' +\r\n\t\t`console.${ methodName }() should not be used unless explicitly expected\\n` +\r\n\t\t'See https://www.npmjs.com/package/@wordpress/jest-console for details.';\r\n};\r\n\r\nconst createSpyInfo = ( spy, matcherName, methodName, expected ) => {\r\n\tconst calls = spy.mock.calls;\r\n\r\n\tconst pass = expected\r\n\t\t? JSON.stringify( calls ).includes( JSON.stringify( expected ) )\r\n\t\t: calls.length > 0;\r\n\r\n\tconst message = createErrorMessage( {\r\n\t\tspy,\r\n\t\tpass,\r\n\t\tcalls,\r\n\t\tmatcherName,\r\n\t\tmethodName,\r\n\t\texpected,\r\n\t} );\r\n\r\n\treturn {\r\n\t\tpass,\r\n\t\tmessage,\r\n\t};\r\n};\r\n\r\nconst createToHaveBeenCalledMatcher =\r\n\t( matcherName, methodName ) => ( received ) => {\r\n\t\tconst spy = received[ methodName ];\r\n\t\tconst spyInfo = createSpyInfo( spy, matcherName, methodName );\r\n\r\n\t\tspy.assertionsNumber += 1;\r\n\r\n\t\treturn spyInfo;\r\n\t};\r\n\r\nconst createToHaveBeenCalledWith = ( matcherName, methodName ) =>\r\n\tfunction ( received, ...expected ) {\r\n\t\tconst spy = received[ methodName ];\r\n\t\tconst spyInfo = createSpyInfo( spy, matcherName, methodName, expected );\r\n\r\n\t\tspy.assertionsNumber += 1;\r\n\r\n\t\treturn spyInfo;\r\n\t};\r\n\r\nexpect.extend(\r\n\tObject.entries( supportedMatchers ).reduce(\r\n\t\t( result, [ methodName, matcherName ] ) => {\r\n\t\t\tconst matcherNameWith = `${ matcherName }With`;\r\n\r\n\t\t\treturn {\r\n\t\t\t\t...result,\r\n\t\t\t\t[ matcherName ]: createToHaveBeenCalledMatcher(\r\n\t\t\t\t\t`.${ matcherName }`,\r\n\t\t\t\t\tmethodName\r\n\t\t\t\t),\r\n\t\t\t\t[ matcherNameWith ]: createToHaveBeenCalledWith(\r\n\t\t\t\t\t`.${ matcherNameWith }`,\r\n\t\t\t\t\tmethodName\r\n\t\t\t\t),\r\n\t\t\t};\r\n\t\t},\r\n\t\t{}\r\n\t)\r\n);\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,WAAW,EAAEC,aAAa,EAAEC,aAAa,QAAQ,oBAAoB;;AAE9E;AACA;AACA;AACA,OAAOC,iBAAiB,MAAM,sBAAsB;AAEpD,MAAMC,kBAAkB,GAAKC,OAAO,IAAM;EACzC,MAAM;IAAEC,GAAG;IAAEC,IAAI;IAAEC,KAAK;IAAEC,WAAW;IAAEC,UAAU;IAAEC;EAAS,CAAC,GAAGN,OAAO;EACvE,MAAMO,IAAI,GAAGL,IAAI,GAAI,OAAOE,WAAa,EAAC,GAAGA,WAAW;EACxD,MAAMI,OAAO,GAAGN,IAAI,GAChB,oEAAoEC,KAAK,CAACM,GAAG,CAC9EZ,aACA,CAAG,EAAC,GACH,sCACDS,QAAQ,GAAI,WAAWV,aAAa,CAAEU,QAAS,CAAG,IAAG,GAAG,GACvD,8BAA8BH,KAAK,CAACM,GAAG,CAAEZ,aAAc,CAAG,EAAC;EAE/D,OAAO,MACL,GAAGF,WAAW,CAAEY,IAAI,EAAEN,GAAG,CAACS,WAAW,CAAC,CAAE,CAAG,EAAC,GAC7C,MAAM,GACNF,OAAO,GACP,MAAM,GACL,WAAWH,UAAY,oDAAmD,GAC3E,wEAAwE;AAC1E,CAAC;AAED,MAAMM,aAAa,GAAGA,CAAEV,GAAG,EAAEG,WAAW,EAAEC,UAAU,EAAEC,QAAQ,KAAM;EACnE,MAAMH,KAAK,GAAGF,GAAG,CAACW,IAAI,CAACT,KAAK;EAE5B,MAAMD,IAAI,GAAGI,QAAQ,GAClBO,IAAI,CAACC,SAAS,CAAEX,KAAM,CAAC,CAACY,QAAQ,CAAEF,IAAI,CAACC,SAAS,CAAER,QAAS,CAAE,CAAC,GAC9DH,KAAK,CAACa,MAAM,GAAG,CAAC;EAEnB,MAAMR,OAAO,GAAGT,kBAAkB,CAAE;IACnCE,GAAG;IACHC,IAAI;IACJC,KAAK;IACLC,WAAW;IACXC,UAAU;IACVC;EACD,CAAE,CAAC;EAEH,OAAO;IACNJ,IAAI;IACJM;EACD,CAAC;AACF,CAAC;AAED,MAAMS,6BAA6B,GAClCA,CAAEb,WAAW,EAAEC,UAAU,KAAQa,QAAQ,IAAM;EAC9C,MAAMjB,GAAG,GAAGiB,QAAQ,CAAEb,UAAU,CAAE;EAClC,MAAML,OAAO,GAAGW,aAAa,CAAEV,GAAG,EAAEG,WAAW,EAAEC,UAAW,CAAC;EAE7DJ,GAAG,CAACkB,gBAAgB,IAAI,CAAC;EAEzB,OAAOnB,OAAO;AACf,CAAC;AAEF,MAAMoB,0BAA0B,GAAGA,CAAEhB,WAAW,EAAEC,UAAU,KAC3D,UAAWa,QAAQ,EAAE,GAAGZ,QAAQ,EAAG;EAClC,MAAML,GAAG,GAAGiB,QAAQ,CAAEb,UAAU,CAAE;EAClC,MAAML,OAAO,GAAGW,aAAa,CAAEV,GAAG,EAAEG,WAAW,EAAEC,UAAU,EAAEC,QAAS,CAAC;EAEvEL,GAAG,CAACkB,gBAAgB,IAAI,CAAC;EAEzB,OAAOnB,OAAO;AACf,CAAC;AAEFqB,MAAM,CAACC,MAAM,CACZC,MAAM,CAACC,OAAO,CAAE1B,iBAAkB,CAAC,CAAC2B,MAAM,CACzC,CAAEC,MAAM,EAAE,CAAErB,UAAU,EAAED,WAAW,CAAE,KAAM;EAC1C,MAAMuB,eAAe,GAAI,GAAGvB,WAAa,MAAK;EAE9C,OAAO;IACN,GAAGsB,MAAM;IACT,CAAEtB,WAAW,GAAIa,6BAA6B,CAC5C,IAAIb,WAAa,EAAC,EACnBC,UACD,CAAC;IACD,CAAEsB,eAAe,GAAIP,0BAA0B,CAC7C,IAAIO,eAAiB,EAAC,EACvBtB,UACD;EACD,CAAC;AACF,CAAC,EACD,CAAC,CACF,CACD,CAAC","ignoreList":[]}