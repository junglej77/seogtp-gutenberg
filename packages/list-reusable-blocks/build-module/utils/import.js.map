{"version":3,"names":["apiFetch","readTextFile","importReusableBlock","file","fileContent","parsedContent","JSON","parse","e","Error","__file","title","content","syncStatus","postType","path","reusableBlock","rest_base","data","status","meta","wp_pattern_sync_status","undefined","method"],"sources":["@wordpress/list-reusable-blocks/src/utils/import.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport apiFetch from '@wordpress/api-fetch';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { readTextFile } from './file';\r\n\r\n/**\r\n * Import a reusable block from a JSON file.\r\n *\r\n * @param {File} file File.\r\n * @return {Promise} Promise returning the imported reusable block.\r\n */\r\nasync function importReusableBlock( file ) {\r\n\tconst fileContent = await readTextFile( file );\r\n\tlet parsedContent;\r\n\ttry {\r\n\t\tparsedContent = JSON.parse( fileContent );\r\n\t} catch ( e ) {\r\n\t\tthrow new Error( 'Invalid JSON file' );\r\n\t}\r\n\tif (\r\n\t\tparsedContent.__file !== 'wp_block' ||\r\n\t\t! parsedContent.title ||\r\n\t\t! parsedContent.content ||\r\n\t\ttypeof parsedContent.title !== 'string' ||\r\n\t\ttypeof parsedContent.content !== 'string' ||\r\n\t\t( parsedContent.syncStatus &&\r\n\t\t\ttypeof parsedContent.syncStatus !== 'string' )\r\n\t) {\r\n\t\tthrow new Error( 'Invalid pattern JSON file' );\r\n\t}\r\n\tconst postType = await apiFetch( { path: `/wp/v2/types/wp_block` } );\r\n\tconst reusableBlock = await apiFetch( {\r\n\t\tpath: `/wp/v2/${ postType.rest_base }`,\r\n\t\tdata: {\r\n\t\t\ttitle: parsedContent.title,\r\n\t\t\tcontent: parsedContent.content,\r\n\t\t\tstatus: 'publish',\r\n\t\t\tmeta:\r\n\t\t\t\tparsedContent.syncStatus === 'unsynced'\r\n\t\t\t\t\t? { wp_pattern_sync_status: parsedContent.syncStatus }\r\n\t\t\t\t\t: undefined,\r\n\t\t},\r\n\t\tmethod: 'POST',\r\n\t} );\r\n\r\n\treturn reusableBlock;\r\n}\r\n\r\nexport default importReusableBlock;\r\n"],"mappings":"AAAA;AACA;AACA;AACA,OAAOA,QAAQ,MAAM,sBAAsB;;AAE3C;AACA;AACA;AACA,SAASC,YAAY,QAAQ,QAAQ;;AAErC;AACA;AACA;AACA;AACA;AACA;AACA,eAAeC,mBAAmBA,CAAEC,IAAI,EAAG;EAC1C,MAAMC,WAAW,GAAG,MAAMH,YAAY,CAAEE,IAAK,CAAC;EAC9C,IAAIE,aAAa;EACjB,IAAI;IACHA,aAAa,GAAGC,IAAI,CAACC,KAAK,CAAEH,WAAY,CAAC;EAC1C,CAAC,CAAC,OAAQI,CAAC,EAAG;IACb,MAAM,IAAIC,KAAK,CAAE,mBAAoB,CAAC;EACvC;EACA,IACCJ,aAAa,CAACK,MAAM,KAAK,UAAU,IACnC,CAAEL,aAAa,CAACM,KAAK,IACrB,CAAEN,aAAa,CAACO,OAAO,IACvB,OAAOP,aAAa,CAACM,KAAK,KAAK,QAAQ,IACvC,OAAON,aAAa,CAACO,OAAO,KAAK,QAAQ,IACvCP,aAAa,CAACQ,UAAU,IACzB,OAAOR,aAAa,CAACQ,UAAU,KAAK,QAAU,EAC9C;IACD,MAAM,IAAIJ,KAAK,CAAE,2BAA4B,CAAC;EAC/C;EACA,MAAMK,QAAQ,GAAG,MAAMd,QAAQ,CAAE;IAAEe,IAAI,EAAG;EAAuB,CAAE,CAAC;EACpE,MAAMC,aAAa,GAAG,MAAMhB,QAAQ,CAAE;IACrCe,IAAI,EAAG,UAAUD,QAAQ,CAACG,SAAW,EAAC;IACtCC,IAAI,EAAE;MACLP,KAAK,EAAEN,aAAa,CAACM,KAAK;MAC1BC,OAAO,EAAEP,aAAa,CAACO,OAAO;MAC9BO,MAAM,EAAE,SAAS;MACjBC,IAAI,EACHf,aAAa,CAACQ,UAAU,KAAK,UAAU,GACpC;QAAEQ,sBAAsB,EAAEhB,aAAa,CAACQ;MAAW,CAAC,GACpDS;IACL,CAAC;IACDC,MAAM,EAAE;EACT,CAAE,CAAC;EAEH,OAAOP,aAAa;AACrB;AAEA,eAAed,mBAAmB","ignoreList":[]}