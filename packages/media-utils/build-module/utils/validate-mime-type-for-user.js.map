{"version":3,"names":["__","sprintf","UploadError","getMimeTypesArray","validateMimeTypeForUser","file","wpAllowedMimeTypes","allowedMimeTypesForUser","isAllowedMimeTypeForUser","includes","type","code","message","name"],"sources":["@wordpress/media-utils/src/utils/validate-mime-type-for-user.ts"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { __, sprintf } from '@wordpress/i18n';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { UploadError } from './upload-error';\r\nimport { getMimeTypesArray } from './get-mime-types-array';\r\n\r\n/**\r\n * Verifies if the user is allowed to upload this mime type.\r\n *\r\n * @param file               File object.\r\n * @param wpAllowedMimeTypes List of allowed mime types and file extensions.\r\n */\r\nexport function validateMimeTypeForUser(\r\n\tfile: File,\r\n\twpAllowedMimeTypes?: Record< string, string > | null\r\n) {\r\n\t// Allowed types for the current WP_User.\r\n\tconst allowedMimeTypesForUser = getMimeTypesArray( wpAllowedMimeTypes );\r\n\r\n\tif ( ! allowedMimeTypesForUser ) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tconst isAllowedMimeTypeForUser = allowedMimeTypesForUser.includes(\r\n\t\tfile.type\r\n\t);\r\n\r\n\tif ( file.type && ! isAllowedMimeTypeForUser ) {\r\n\t\tthrow new UploadError( {\r\n\t\t\tcode: 'MIME_TYPE_NOT_ALLOWED_FOR_USER',\r\n\t\t\tmessage: sprintf(\r\n\t\t\t\t// translators: %s: file name.\r\n\t\t\t\t__(\r\n\t\t\t\t\t'%s: Sorry, you are not allowed to upload this file type.'\r\n\t\t\t\t),\r\n\t\t\t\tfile.name\r\n\t\t\t),\r\n\t\t\tfile,\r\n\t\t} );\r\n\t}\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,EAAE,EAAEC,OAAO,QAAQ,iBAAiB;;AAE7C;AACA;AACA;AACA,SAASC,WAAW,QAAQ,gBAAgB;AAC5C,SAASC,iBAAiB,QAAQ,wBAAwB;;AAE1D;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,uBAAuBA,CACtCC,IAAU,EACVC,kBAAoD,EACnD;EACD;EACA,MAAMC,uBAAuB,GAAGJ,iBAAiB,CAAEG,kBAAmB,CAAC;EAEvE,IAAK,CAAEC,uBAAuB,EAAG;IAChC;EACD;EAEA,MAAMC,wBAAwB,GAAGD,uBAAuB,CAACE,QAAQ,CAChEJ,IAAI,CAACK,IACN,CAAC;EAED,IAAKL,IAAI,CAACK,IAAI,IAAI,CAAEF,wBAAwB,EAAG;IAC9C,MAAM,IAAIN,WAAW,CAAE;MACtBS,IAAI,EAAE,gCAAgC;MACtCC,OAAO,EAAEX,OAAO;MACf;MACAD,EAAE,CACD,0DACD,CAAC,EACDK,IAAI,CAACQ,IACN,CAAC;MACDR;IACD,CAAE,CAAC;EACJ;AACD","ignoreList":[]}