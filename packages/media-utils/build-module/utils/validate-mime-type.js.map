{"version":3,"names":["__","sprintf","UploadError","validateMimeType","file","allowedTypes","isAllowedType","some","allowedType","includes","type","startsWith","code","message","name"],"sources":["@wordpress/media-utils/src/utils/validate-mime-type.ts"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { __, sprintf } from '@wordpress/i18n';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { UploadError } from './upload-error';\r\n\r\n/**\r\n * Verifies if the caller (e.g. a block) supports this mime type.\r\n *\r\n * @param file         File object.\r\n * @param allowedTypes List of allowed mime types.\r\n */\r\nexport function validateMimeType( file: File, allowedTypes?: string[] ) {\r\n\tif ( ! allowedTypes ) {\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Allowed type specified by consumer.\r\n\tconst isAllowedType = allowedTypes.some( ( allowedType ) => {\r\n\t\t// If a complete mimetype is specified verify if it matches exactly the mime type of the file.\r\n\t\tif ( allowedType.includes( '/' ) ) {\r\n\t\t\treturn allowedType === file.type;\r\n\t\t}\r\n\t\t// Otherwise a general mime type is used, and we should verify if the file mimetype starts with it.\r\n\t\treturn file.type.startsWith( `${ allowedType }/` );\r\n\t} );\r\n\r\n\tif ( file.type && ! isAllowedType ) {\r\n\t\tthrow new UploadError( {\r\n\t\t\tcode: 'MIME_TYPE_NOT_SUPPORTED',\r\n\t\t\tmessage: sprintf(\r\n\t\t\t\t// translators: %s: file name.\r\n\t\t\t\t__( '%s: Sorry, this file type is not supported here.' ),\r\n\t\t\t\tfile.name\r\n\t\t\t),\r\n\t\t\tfile,\r\n\t\t} );\r\n\t}\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,EAAE,EAAEC,OAAO,QAAQ,iBAAiB;;AAE7C;AACA;AACA;AACA,SAASC,WAAW,QAAQ,gBAAgB;;AAE5C;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,gBAAgBA,CAAEC,IAAU,EAAEC,YAAuB,EAAG;EACvE,IAAK,CAAEA,YAAY,EAAG;IACrB;EACD;;EAEA;EACA,MAAMC,aAAa,GAAGD,YAAY,CAACE,IAAI,CAAIC,WAAW,IAAM;IAC3D;IACA,IAAKA,WAAW,CAACC,QAAQ,CAAE,GAAI,CAAC,EAAG;MAClC,OAAOD,WAAW,KAAKJ,IAAI,CAACM,IAAI;IACjC;IACA;IACA,OAAON,IAAI,CAACM,IAAI,CAACC,UAAU,CAAG,GAAGH,WAAa,GAAG,CAAC;EACnD,CAAE,CAAC;EAEH,IAAKJ,IAAI,CAACM,IAAI,IAAI,CAAEJ,aAAa,EAAG;IACnC,MAAM,IAAIJ,WAAW,CAAE;MACtBU,IAAI,EAAE,yBAAyB;MAC/BC,OAAO,EAAEZ,OAAO;MACf;MACAD,EAAE,CAAE,kDAAmD,CAAC,EACxDI,IAAI,CAACU,IACN,CAAC;MACDV;IACD,CAAE,CAAC;EACJ;AACD","ignoreList":[]}