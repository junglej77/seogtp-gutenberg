{"version":3,"names":["Modal","Button","TextControl","__experimentalHStack","HStack","__experimentalVStack","VStack","ToggleControl","__","_x","useState","useDispatch","useSelect","store","noticesStore","coreStore","PATTERN_DEFAULT_CATEGORY","PATTERN_SYNC_TYPES","PATTERN_TYPES","patternsStore","CategorySelector","useAddPatternCategory","unlock","jsx","_jsx","jsxs","_jsxs","CreatePatternModal","className","modalTitle","restProps","defaultModalTitle","select","getPostType","user","labels","add_new_item","title","onRequestClose","onClose","overlayClassName","focusOnMount","size","children","CreatePatternModalContents","confirmLabel","defaultCategories","content","onError","onSuccess","defaultSyncType","full","defaultTitle","syncType","setSyncType","categoryTerms","setCategoryTerms","setTitle","isSaving","setIsSaving","createPattern","createErrorNotice","categoryMap","findOrCreateTerm","onCreate","patternTitle","sync","categories","Promise","all","map","termName","newPattern","pattern","categoryId","error","message","type","id","onSubmit","event","preventDefault","spacing","label","value","onChange","placeholder","__nextHasNoMarginBottom","__next40pxDefaultSize","help","checked","unsynced","justify","variant","onClick","isBusy"],"sources":["@wordpress/patterns/src/components/create-pattern-modal.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport {\r\n\tModal,\r\n\tButton,\r\n\tTextControl,\r\n\t__experimentalHStack as HStack,\r\n\t__experimentalVStack as VStack,\r\n\tToggleControl,\r\n} from '@wordpress/components';\r\nimport { __, _x } from '@wordpress/i18n';\r\nimport { useState } from '@wordpress/element';\r\nimport { useDispatch, useSelect } from '@wordpress/data';\r\nimport { store as noticesStore } from '@wordpress/notices';\r\nimport { store as coreStore } from '@wordpress/core-data';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport {\r\n\tPATTERN_DEFAULT_CATEGORY,\r\n\tPATTERN_SYNC_TYPES,\r\n\tPATTERN_TYPES,\r\n} from '../constants';\r\nimport { store as patternsStore } from '../store';\r\nimport CategorySelector from './category-selector';\r\nimport { useAddPatternCategory } from '../private-hooks';\r\nimport { unlock } from '../lock-unlock';\r\n\r\nexport default function CreatePatternModal( {\r\n\tclassName = 'patterns-menu-items__convert-modal',\r\n\tmodalTitle,\r\n\t...restProps\r\n} ) {\r\n\tconst defaultModalTitle = useSelect(\r\n\t\t( select ) =>\r\n\t\t\tselect( coreStore ).getPostType( PATTERN_TYPES.user )?.labels\r\n\t\t\t\t?.add_new_item,\r\n\t\t[]\r\n\t);\r\n\treturn (\r\n\t\t<Modal\r\n\t\t\ttitle={ modalTitle || defaultModalTitle }\r\n\t\t\tonRequestClose={ restProps.onClose }\r\n\t\t\toverlayClassName={ className }\r\n\t\t\tfocusOnMount=\"firstContentElement\"\r\n\t\t\tsize=\"small\"\r\n\t\t>\r\n\t\t\t<CreatePatternModalContents { ...restProps } />\r\n\t\t</Modal>\r\n\t);\r\n}\r\n\r\nexport function CreatePatternModalContents( {\r\n\tconfirmLabel = __( 'Add' ),\r\n\tdefaultCategories = [],\r\n\tcontent,\r\n\tonClose,\r\n\tonError,\r\n\tonSuccess,\r\n\tdefaultSyncType = PATTERN_SYNC_TYPES.full,\r\n\tdefaultTitle = '',\r\n} ) {\r\n\tconst [ syncType, setSyncType ] = useState( defaultSyncType );\r\n\tconst [ categoryTerms, setCategoryTerms ] = useState( defaultCategories );\r\n\tconst [ title, setTitle ] = useState( defaultTitle );\r\n\r\n\tconst [ isSaving, setIsSaving ] = useState( false );\r\n\tconst { createPattern } = unlock( useDispatch( patternsStore ) );\r\n\tconst { createErrorNotice } = useDispatch( noticesStore );\r\n\r\n\tconst { categoryMap, findOrCreateTerm } = useAddPatternCategory();\r\n\r\n\tasync function onCreate( patternTitle, sync ) {\r\n\t\tif ( ! title || isSaving ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tsetIsSaving( true );\r\n\t\t\tconst categories = await Promise.all(\r\n\t\t\t\tcategoryTerms.map( ( termName ) =>\r\n\t\t\t\t\tfindOrCreateTerm( termName )\r\n\t\t\t\t)\r\n\t\t\t);\r\n\r\n\t\t\tconst newPattern = await createPattern(\r\n\t\t\t\tpatternTitle,\r\n\t\t\t\tsync,\r\n\t\t\t\ttypeof content === 'function' ? content() : content,\r\n\t\t\t\tcategories\r\n\t\t\t);\r\n\t\t\tonSuccess( {\r\n\t\t\t\tpattern: newPattern,\r\n\t\t\t\tcategoryId: PATTERN_DEFAULT_CATEGORY,\r\n\t\t\t} );\r\n\t\t} catch ( error ) {\r\n\t\t\tcreateErrorNotice( error.message, {\r\n\t\t\t\ttype: 'snackbar',\r\n\t\t\t\tid: 'pattern-create',\r\n\t\t\t} );\r\n\t\t\tonError?.();\r\n\t\t} finally {\r\n\t\t\tsetIsSaving( false );\r\n\t\t\tsetCategoryTerms( [] );\r\n\t\t\tsetTitle( '' );\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<form\r\n\t\t\tonSubmit={ ( event ) => {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\tonCreate( title, syncType );\r\n\t\t\t} }\r\n\t\t>\r\n\t\t\t<VStack spacing=\"5\">\r\n\t\t\t\t<TextControl\r\n\t\t\t\t\tlabel={ __( 'Name' ) }\r\n\t\t\t\t\tvalue={ title }\r\n\t\t\t\t\tonChange={ setTitle }\r\n\t\t\t\t\tplaceholder={ __( 'My pattern' ) }\r\n\t\t\t\t\tclassName=\"patterns-create-modal__name-input\"\r\n\t\t\t\t\t__nextHasNoMarginBottom\r\n\t\t\t\t\t__next40pxDefaultSize\r\n\t\t\t\t/>\r\n\t\t\t\t<CategorySelector\r\n\t\t\t\t\tcategoryTerms={ categoryTerms }\r\n\t\t\t\t\tonChange={ setCategoryTerms }\r\n\t\t\t\t\tcategoryMap={ categoryMap }\r\n\t\t\t\t/>\r\n\t\t\t\t<ToggleControl\r\n\t\t\t\t\t__nextHasNoMarginBottom\r\n\t\t\t\t\tlabel={ _x( 'Synced', 'pattern (singular)' ) }\r\n\t\t\t\t\thelp={ __(\r\n\t\t\t\t\t\t'Sync this pattern across multiple locations.'\r\n\t\t\t\t\t) }\r\n\t\t\t\t\tchecked={ syncType === PATTERN_SYNC_TYPES.full }\r\n\t\t\t\t\tonChange={ () => {\r\n\t\t\t\t\t\tsetSyncType(\r\n\t\t\t\t\t\t\tsyncType === PATTERN_SYNC_TYPES.full\r\n\t\t\t\t\t\t\t\t? PATTERN_SYNC_TYPES.unsynced\r\n\t\t\t\t\t\t\t\t: PATTERN_SYNC_TYPES.full\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t} }\r\n\t\t\t\t/>\r\n\t\t\t\t<HStack justify=\"right\">\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\t__next40pxDefaultSize\r\n\t\t\t\t\t\tvariant=\"tertiary\"\r\n\t\t\t\t\t\tonClick={ () => {\r\n\t\t\t\t\t\t\tonClose();\r\n\t\t\t\t\t\t\tsetTitle( '' );\r\n\t\t\t\t\t\t} }\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{ __( 'Cancel' ) }\r\n\t\t\t\t\t</Button>\r\n\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\t__next40pxDefaultSize\r\n\t\t\t\t\t\tvariant=\"primary\"\r\n\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\taria-disabled={ ! title || isSaving }\r\n\t\t\t\t\t\tisBusy={ isSaving }\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{ confirmLabel }\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</HStack>\r\n\t\t\t</VStack>\r\n\t\t</form>\r\n\t);\r\n}\r\n"],"mappings":"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","ignoreList":[]}