{"version":3,"names":["Modal","Button","TextControl","__experimentalHStack","HStack","__experimentalVStack","VStack","store","coreStore","useDispatch","useId","useRef","useState","decodeEntities","__","noticesStore","speak","CATEGORY_SLUG","jsx","_jsx","jsxs","_jsxs","RenamePatternCategoryModal","category","existingCategories","onClose","onError","onSuccess","props","id","textControlRef","name","setName","isSaving","setIsSaving","validationMessage","setValidationMessage","validationMessageId","undefined","saveEntityRecord","invalidateResolution","createErrorNotice","createSuccessNotice","onChange","newName","onSave","event","preventDefault","message","current","focus","patternCategories","find","existingCategory","label","toLowerCase","savedRecord","slug","type","error","onRequestClose","title","children","onSubmit","spacing","ref","__nextHasNoMarginBottom","__next40pxDefaultSize","value","required","className","justify","variant","onClick","isBusy"],"sources":["@wordpress/patterns/src/components/rename-pattern-category-modal.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport {\r\n\tModal,\r\n\tButton,\r\n\tTextControl,\r\n\t__experimentalHStack as HStack,\r\n\t__experimentalVStack as VStack,\r\n} from '@wordpress/components';\r\nimport { store as coreStore } from '@wordpress/core-data';\r\nimport { useDispatch } from '@wordpress/data';\r\nimport { useId, useRef, useState } from '@wordpress/element';\r\nimport { decodeEntities } from '@wordpress/html-entities';\r\nimport { __ } from '@wordpress/i18n';\r\nimport { store as noticesStore } from '@wordpress/notices';\r\nimport { speak } from '@wordpress/a11y';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { CATEGORY_SLUG } from './category-selector';\r\n\r\nexport default function RenamePatternCategoryModal( {\r\n\tcategory,\r\n\texistingCategories,\r\n\tonClose,\r\n\tonError,\r\n\tonSuccess,\r\n\t...props\r\n} ) {\r\n\tconst id = useId();\r\n\tconst textControlRef = useRef();\r\n\tconst [ name, setName ] = useState( decodeEntities( category.name ) );\r\n\tconst [ isSaving, setIsSaving ] = useState( false );\r\n\tconst [ validationMessage, setValidationMessage ] = useState( false );\r\n\tconst validationMessageId = validationMessage\r\n\t\t? `patterns-rename-pattern-category-modal__validation-message-${ id }`\r\n\t\t: undefined;\r\n\r\n\tconst { saveEntityRecord, invalidateResolution } = useDispatch( coreStore );\r\n\tconst { createErrorNotice, createSuccessNotice } =\r\n\t\tuseDispatch( noticesStore );\r\n\r\n\tconst onChange = ( newName ) => {\r\n\t\tif ( validationMessage ) {\r\n\t\t\tsetValidationMessage( undefined );\r\n\t\t}\r\n\t\tsetName( newName );\r\n\t};\r\n\r\n\tconst onSave = async ( event ) => {\r\n\t\tevent.preventDefault();\r\n\r\n\t\tif ( isSaving ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif ( ! name || name === category.name ) {\r\n\t\t\tconst message = __( 'Please enter a new name for this category.' );\r\n\t\t\tspeak( message, 'assertive' );\r\n\t\t\tsetValidationMessage( message );\r\n\t\t\ttextControlRef.current?.focus();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Check existing categories to avoid creating duplicates.\r\n\t\tif (\r\n\t\t\texistingCategories.patternCategories.find( ( existingCategory ) => {\r\n\t\t\t\t// Compare the id so that the we don't disallow the user changing the case of their current category\r\n\t\t\t\t// (i.e. renaming 'test' to 'Test').\r\n\t\t\t\treturn (\r\n\t\t\t\t\texistingCategory.id !== category.id &&\r\n\t\t\t\t\texistingCategory.label.toLowerCase() === name.toLowerCase()\r\n\t\t\t\t);\r\n\t\t\t} )\r\n\t\t) {\r\n\t\t\tconst message = __(\r\n\t\t\t\t'This category already exists. Please use a different name.'\r\n\t\t\t);\r\n\t\t\tspeak( message, 'assertive' );\r\n\t\t\tsetValidationMessage( message );\r\n\t\t\ttextControlRef.current?.focus();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tsetIsSaving( true );\r\n\r\n\t\t\t// User pattern category properties may differ as they can be\r\n\t\t\t// normalized for use alongside template part areas, core pattern\r\n\t\t\t// categories etc. As a result we won't just destructure the passed\r\n\t\t\t// category object.\r\n\t\t\tconst savedRecord = await saveEntityRecord(\r\n\t\t\t\t'taxonomy',\r\n\t\t\t\tCATEGORY_SLUG,\r\n\t\t\t\t{\r\n\t\t\t\t\tid: category.id,\r\n\t\t\t\t\tslug: category.slug,\r\n\t\t\t\t\tname,\r\n\t\t\t\t}\r\n\t\t\t);\r\n\r\n\t\t\tinvalidateResolution( 'getUserPatternCategories' );\r\n\t\t\tonSuccess?.( savedRecord );\r\n\t\t\tonClose();\r\n\r\n\t\t\tcreateSuccessNotice( __( 'Pattern category renamed.' ), {\r\n\t\t\t\ttype: 'snackbar',\r\n\t\t\t\tid: 'pattern-category-update',\r\n\t\t\t} );\r\n\t\t} catch ( error ) {\r\n\t\t\tonError?.();\r\n\t\t\tcreateErrorNotice( error.message, {\r\n\t\t\t\ttype: 'snackbar',\r\n\t\t\t\tid: 'pattern-category-update',\r\n\t\t\t} );\r\n\t\t} finally {\r\n\t\t\tsetIsSaving( false );\r\n\t\t\tsetName( '' );\r\n\t\t}\r\n\t};\r\n\r\n\tconst onRequestClose = () => {\r\n\t\tonClose();\r\n\t\tsetName( '' );\r\n\t};\r\n\r\n\treturn (\r\n\t\t<Modal\r\n\t\t\ttitle={ __( 'Rename' ) }\r\n\t\t\tonRequestClose={ onRequestClose }\r\n\t\t\t{ ...props }\r\n\t\t>\r\n\t\t\t<form onSubmit={ onSave }>\r\n\t\t\t\t<VStack spacing=\"5\">\r\n\t\t\t\t\t<VStack spacing=\"2\">\r\n\t\t\t\t\t\t<TextControl\r\n\t\t\t\t\t\t\tref={ textControlRef }\r\n\t\t\t\t\t\t\t__nextHasNoMarginBottom\r\n\t\t\t\t\t\t\t__next40pxDefaultSize\r\n\t\t\t\t\t\t\tlabel={ __( 'Name' ) }\r\n\t\t\t\t\t\t\tvalue={ name }\r\n\t\t\t\t\t\t\tonChange={ onChange }\r\n\t\t\t\t\t\t\taria-describedby={ validationMessageId }\r\n\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{ validationMessage && (\r\n\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\tclassName=\"patterns-rename-pattern-category-modal__validation-message\"\r\n\t\t\t\t\t\t\t\tid={ validationMessageId }\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{ validationMessage }\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t) }\r\n\t\t\t\t\t</VStack>\r\n\t\t\t\t\t<HStack justify=\"right\">\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t__next40pxDefaultSize\r\n\t\t\t\t\t\t\tvariant=\"tertiary\"\r\n\t\t\t\t\t\t\tonClick={ onRequestClose }\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{ __( 'Cancel' ) }\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t__next40pxDefaultSize\r\n\t\t\t\t\t\t\tvariant=\"primary\"\r\n\t\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\t\taria-disabled={\r\n\t\t\t\t\t\t\t\t! name || name === category.name || isSaving\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tisBusy={ isSaving }\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{ __( 'Save' ) }\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</HStack>\r\n\t\t\t\t</VStack>\r\n\t\t\t</form>\r\n\t\t</Modal>\r\n\t);\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SACCA,KAAK,EACLC,MAAM,EACNC,WAAW,EACXC,oBAAoB,IAAIC,MAAM,EAC9BC,oBAAoB,IAAIC,MAAM,QACxB,uBAAuB;AAC9B,SAASC,KAAK,IAAIC,SAAS,QAAQ,sBAAsB;AACzD,SAASC,WAAW,QAAQ,iBAAiB;AAC7C,SAASC,KAAK,EAAEC,MAAM,EAAEC,QAAQ,QAAQ,oBAAoB;AAC5D,SAASC,cAAc,QAAQ,0BAA0B;AACzD,SAASC,EAAE,QAAQ,iBAAiB;AACpC,SAASP,KAAK,IAAIQ,YAAY,QAAQ,oBAAoB;AAC1D,SAASC,KAAK,QAAQ,iBAAiB;;AAEvC;AACA;AACA;AACA,SAASC,aAAa,QAAQ,qBAAqB;AAAC,SAAAC,GAAA,IAAAC,IAAA;AAAA,SAAAC,IAAA,IAAAC,KAAA;AAEpD,eAAe,SAASC,0BAA0BA,CAAE;EACnDC,QAAQ;EACRC,kBAAkB;EAClBC,OAAO;EACPC,OAAO;EACPC,SAAS;EACT,GAAGC;AACJ,CAAC,EAAG;EACH,MAAMC,EAAE,GAAGnB,KAAK,CAAC,CAAC;EAClB,MAAMoB,cAAc,GAAGnB,MAAM,CAAC,CAAC;EAC/B,MAAM,CAAEoB,IAAI,EAAEC,OAAO,CAAE,GAAGpB,QAAQ,CAAEC,cAAc,CAAEU,QAAQ,CAACQ,IAAK,CAAE,CAAC;EACrE,MAAM,CAAEE,QAAQ,EAAEC,WAAW,CAAE,GAAGtB,QAAQ,CAAE,KAAM,CAAC;EACnD,MAAM,CAAEuB,iBAAiB,EAAEC,oBAAoB,CAAE,GAAGxB,QAAQ,CAAE,KAAM,CAAC;EACrE,MAAMyB,mBAAmB,GAAGF,iBAAiB,GACzC,8DAA8DN,EAAI,EAAC,GACpES,SAAS;EAEZ,MAAM;IAAEC,gBAAgB;IAAEC;EAAqB,CAAC,GAAG/B,WAAW,CAAED,SAAU,CAAC;EAC3E,MAAM;IAAEiC,iBAAiB;IAAEC;EAAoB,CAAC,GAC/CjC,WAAW,CAAEM,YAAa,CAAC;EAE5B,MAAM4B,QAAQ,GAAKC,OAAO,IAAM;IAC/B,IAAKT,iBAAiB,EAAG;MACxBC,oBAAoB,CAAEE,SAAU,CAAC;IAClC;IACAN,OAAO,CAAEY,OAAQ,CAAC;EACnB,CAAC;EAED,MAAMC,MAAM,GAAG,MAAQC,KAAK,IAAM;IACjCA,KAAK,CAACC,cAAc,CAAC,CAAC;IAEtB,IAAKd,QAAQ,EAAG;MACf;IACD;IAEA,IAAK,CAAEF,IAAI,IAAIA,IAAI,KAAKR,QAAQ,CAACQ,IAAI,EAAG;MACvC,MAAMiB,OAAO,GAAGlC,EAAE,CAAE,4CAA6C,CAAC;MAClEE,KAAK,CAAEgC,OAAO,EAAE,WAAY,CAAC;MAC7BZ,oBAAoB,CAAEY,OAAQ,CAAC;MAC/BlB,cAAc,CAACmB,OAAO,EAAEC,KAAK,CAAC,CAAC;MAC/B;IACD;;IAEA;IACA,IACC1B,kBAAkB,CAAC2B,iBAAiB,CAACC,IAAI,CAAIC,gBAAgB,IAAM;MAClE;MACA;MACA,OACCA,gBAAgB,CAACxB,EAAE,KAAKN,QAAQ,CAACM,EAAE,IACnCwB,gBAAgB,CAACC,KAAK,CAACC,WAAW,CAAC,CAAC,KAAKxB,IAAI,CAACwB,WAAW,CAAC,CAAC;IAE7D,CAAE,CAAC,EACF;MACD,MAAMP,OAAO,GAAGlC,EAAE,CACjB,4DACD,CAAC;MACDE,KAAK,CAAEgC,OAAO,EAAE,WAAY,CAAC;MAC7BZ,oBAAoB,CAAEY,OAAQ,CAAC;MAC/BlB,cAAc,CAACmB,OAAO,EAAEC,KAAK,CAAC,CAAC;MAC/B;IACD;IAEA,IAAI;MACHhB,WAAW,CAAE,IAAK,CAAC;;MAEnB;MACA;MACA;MACA;MACA,MAAMsB,WAAW,GAAG,MAAMjB,gBAAgB,CACzC,UAAU,EACVtB,aAAa,EACb;QACCY,EAAE,EAAEN,QAAQ,CAACM,EAAE;QACf4B,IAAI,EAAElC,QAAQ,CAACkC,IAAI;QACnB1B;MACD,CACD,CAAC;MAEDS,oBAAoB,CAAE,0BAA2B,CAAC;MAClDb,SAAS,GAAI6B,WAAY,CAAC;MAC1B/B,OAAO,CAAC,CAAC;MAETiB,mBAAmB,CAAE5B,EAAE,CAAE,2BAA4B,CAAC,EAAE;QACvD4C,IAAI,EAAE,UAAU;QAChB7B,EAAE,EAAE;MACL,CAAE,CAAC;IACJ,CAAC,CAAC,OAAQ8B,KAAK,EAAG;MACjBjC,OAAO,GAAG,CAAC;MACXe,iBAAiB,CAAEkB,KAAK,CAACX,OAAO,EAAE;QACjCU,IAAI,EAAE,UAAU;QAChB7B,EAAE,EAAE;MACL,CAAE,CAAC;IACJ,CAAC,SAAS;MACTK,WAAW,CAAE,KAAM,CAAC;MACpBF,OAAO,CAAE,EAAG,CAAC;IACd;EACD,CAAC;EAED,MAAM4B,cAAc,GAAGA,CAAA,KAAM;IAC5BnC,OAAO,CAAC,CAAC;IACTO,OAAO,CAAE,EAAG,CAAC;EACd,CAAC;EAED,oBACCb,IAAA,CAACnB,KAAK;IACL6D,KAAK,EAAG/C,EAAE,CAAE,QAAS,CAAG;IACxB8C,cAAc,EAAGA,cAAgB;IAAA,GAC5BhC,KAAK;IAAAkC,QAAA,eAEV3C,IAAA;MAAM4C,QAAQ,EAAGlB,MAAQ;MAAAiB,QAAA,eACxBzC,KAAA,CAACf,MAAM;QAAC0D,OAAO,EAAC,GAAG;QAAAF,QAAA,gBAClBzC,KAAA,CAACf,MAAM;UAAC0D,OAAO,EAAC,GAAG;UAAAF,QAAA,gBAClB3C,IAAA,CAACjB,WAAW;YACX+D,GAAG,EAAGnC,cAAgB;YACtBoC,uBAAuB;YACvBC,qBAAqB;YACrBb,KAAK,EAAGxC,EAAE,CAAE,MAAO,CAAG;YACtBsD,KAAK,EAAGrC,IAAM;YACdY,QAAQ,EAAGA,QAAU;YACrB,oBAAmBN,mBAAqB;YACxCgC,QAAQ;UAAA,CACR,CAAC,EACAlC,iBAAiB,iBAClBhB,IAAA;YACCmD,SAAS,EAAC,4DAA4D;YACtEzC,EAAE,EAAGQ,mBAAqB;YAAAyB,QAAA,EAExB3B;UAAiB,CACd,CACN;QAAA,CACM,CAAC,eACTd,KAAA,CAACjB,MAAM;UAACmE,OAAO,EAAC,OAAO;UAAAT,QAAA,gBACtB3C,IAAA,CAAClB,MAAM;YACNkE,qBAAqB;YACrBK,OAAO,EAAC,UAAU;YAClBC,OAAO,EAAGb,cAAgB;YAAAE,QAAA,EAExBhD,EAAE,CAAE,QAAS;UAAC,CACT,CAAC,eACTK,IAAA,CAAClB,MAAM;YACNkE,qBAAqB;YACrBK,OAAO,EAAC,SAAS;YACjBd,IAAI,EAAC,QAAQ;YACb,iBACC,CAAE3B,IAAI,IAAIA,IAAI,KAAKR,QAAQ,CAACQ,IAAI,IAAIE,QACpC;YACDyC,MAAM,EAAGzC,QAAU;YAAA6B,QAAA,EAEjBhD,EAAE,CAAE,MAAO;UAAC,CACP,CAAC;QAAA,CACF,CAAC;MAAA,CACF;IAAC,CACJ;EAAC,CACD,CAAC;AAEV","ignoreList":[]}