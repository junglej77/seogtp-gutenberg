{"version":3,"names":["createContext","useContext","useEffect","useMemo","useReducer","defaultI18n","jsx","_jsx","makeContextValue","i18n","__","bind","_x","_n","_nx","isRTL","hasTranslation","I18nContext","I18nProvider","props","children","update","forceUpdate","subscribe","value","Provider","useI18n","withI18n","InnerComponent","EnhancedComponent","i18nProps","innerComponentName","displayName","name"],"sources":["@wordpress/react-i18n/src/index.tsx"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport type {\r\n\tComponentType,\r\n\tFunctionComponent,\r\n\tPropsWithChildren,\r\n} from 'react';\r\nimport type { Subtract } from 'utility-types';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport {\r\n\tcreateContext,\r\n\tuseContext,\r\n\tuseEffect,\r\n\tuseMemo,\r\n\tuseReducer,\r\n} from '@wordpress/element';\r\nimport { defaultI18n } from '@wordpress/i18n';\r\nimport type { I18n } from '@wordpress/i18n';\r\ninterface I18nContextProps {\r\n\t__: I18n[ '__' ];\r\n\t_x: I18n[ '_x' ];\r\n\t_n: I18n[ '_n' ];\r\n\t_nx: I18n[ '_nx' ];\r\n\tisRTL: I18n[ 'isRTL' ];\r\n\thasTranslation: I18n[ 'hasTranslation' ];\r\n}\r\n\r\n/**\r\n * Utility to make a new context value\r\n *\r\n * @param i18n\r\n */\r\nfunction makeContextValue( i18n: I18n ): I18nContextProps {\r\n\treturn {\r\n\t\t__: i18n.__.bind( i18n ),\r\n\t\t_x: i18n._x.bind( i18n ),\r\n\t\t_n: i18n._n.bind( i18n ),\r\n\t\t_nx: i18n._nx.bind( i18n ),\r\n\t\tisRTL: i18n.isRTL.bind( i18n ),\r\n\t\thasTranslation: i18n.hasTranslation.bind( i18n ),\r\n\t};\r\n}\r\n\r\nconst I18nContext = createContext( makeContextValue( defaultI18n ) );\r\n\r\ntype I18nProviderProps = PropsWithChildren< { i18n: I18n } >;\r\n\r\n/**\r\n * The `I18nProvider` should be mounted above any localized components:\r\n *\r\n * @example\r\n * ```js\r\n * import { createI18n } from '@wordpress/i18n';\r\n * import { I18nProvider } from '@wordpress/react-i18n';\r\n * const i18n = createI18n();\r\n *\r\n * ReactDom.render(\r\n * \t<I18nProvider i18n={ i18n }>\r\n * \t\t<App />\r\n * \t</I18nProvider>,\r\n * \tel\r\n * );\r\n * ```\r\n *\r\n * You can also instantiate the provider without the `i18n` prop. In that case it will use the\r\n * default `I18n` instance exported from `@wordpress/i18n`.\r\n *\r\n * @param props i18n provider props.\r\n * @return Children wrapped in the I18nProvider.\r\n */\r\nexport function I18nProvider( props: I18nProviderProps ): JSX.Element {\r\n\tconst { children, i18n = defaultI18n } = props;\r\n\tconst [ update, forceUpdate ] = useReducer( () => [], [] );\r\n\r\n\t// Rerender translations whenever the i18n instance fires a change event.\r\n\tuseEffect( () => i18n.subscribe( forceUpdate ), [ i18n ] );\r\n\r\n\tconst value = useMemo( () => makeContextValue( i18n ), [ i18n, update ] );\r\n\r\n\treturn (\r\n\t\t<I18nContext.Provider value={ value }>\r\n\t\t\t{ children }\r\n\t\t</I18nContext.Provider>\r\n\t);\r\n}\r\n\r\n/**\r\n * React hook providing access to i18n functions. It exposes the `__`, `_x`, `_n`, `_nx`,\r\n * `isRTL` and `hasTranslation` functions from [`@wordpress/i18n`](../i18n).\r\n * Refer to their documentation there.\r\n *\r\n * @example\r\n * ```js\r\n * import { useI18n } from '@wordpress/react-i18n';\r\n *\r\n * function MyComponent() {\r\n * \tconst { __ } = useI18n();\r\n * \treturn __( 'Hello, world!' );\r\n * }\r\n * ```\r\n */\r\nexport const useI18n = () => useContext( I18nContext );\r\n\r\ntype PropsAndI18n< P > = Pick<\r\n\tP,\r\n\tExclude< keyof P, '__' | '_x' | '_n' | '_nx' | 'isRTL' | 'hasTranslation' >\r\n>;\r\n\r\n/**\r\n * React higher-order component that passes the i18n translate functions (the same set\r\n * as exposed by the `useI18n` hook) to the wrapped component as props.\r\n *\r\n * @example\r\n * ```js\r\n * import { withI18n } from '@wordpress/react-i18n';\r\n *\r\n * function MyComponent( { __ } ) {\r\n * \treturn __( 'Hello, world!' );\r\n * }\r\n *\r\n * export default withI18n( MyComponent );\r\n * ```\r\n *\r\n * @param InnerComponent React component to be wrapped and receive the i18n functions like `__`\r\n * @return The wrapped component\r\n */\r\nexport function withI18n< P extends I18nContextProps >(\r\n\tInnerComponent: ComponentType< P >\r\n): FunctionComponent< PropsAndI18n< P > > {\r\n\tconst EnhancedComponent: ComponentType<\r\n\t\tSubtract< P, I18nContextProps >\r\n\t> = ( props ) => {\r\n\t\tconst i18nProps = useI18n();\r\n\t\treturn <InnerComponent { ...( props as P ) } { ...i18nProps } />;\r\n\t};\r\n\tconst innerComponentName =\r\n\t\tInnerComponent.displayName || InnerComponent.name || 'Component';\r\n\tEnhancedComponent.displayName = `WithI18n(${ innerComponentName })`;\r\n\treturn EnhancedComponent;\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;;AAQA;AACA;AACA;AACA,SACCA,aAAa,EACbC,UAAU,EACVC,SAAS,EACTC,OAAO,EACPC,UAAU,QACJ,oBAAoB;AAC3B,SAASC,WAAW,QAAQ,iBAAiB;AAAC,SAAAC,GAAA,IAAAC,IAAA;AAW9C;AACA;AACA;AACA;AACA;AACA,SAASC,gBAAgBA,CAAEC,IAAU,EAAqB;EACzD,OAAO;IACNC,EAAE,EAAED,IAAI,CAACC,EAAE,CAACC,IAAI,CAAEF,IAAK,CAAC;IACxBG,EAAE,EAAEH,IAAI,CAACG,EAAE,CAACD,IAAI,CAAEF,IAAK,CAAC;IACxBI,EAAE,EAAEJ,IAAI,CAACI,EAAE,CAACF,IAAI,CAAEF,IAAK,CAAC;IACxBK,GAAG,EAAEL,IAAI,CAACK,GAAG,CAACH,IAAI,CAAEF,IAAK,CAAC;IAC1BM,KAAK,EAAEN,IAAI,CAACM,KAAK,CAACJ,IAAI,CAAEF,IAAK,CAAC;IAC9BO,cAAc,EAAEP,IAAI,CAACO,cAAc,CAACL,IAAI,CAAEF,IAAK;EAChD,CAAC;AACF;AAEA,MAAMQ,WAAW,GAAGjB,aAAa,CAAEQ,gBAAgB,CAAEH,WAAY,CAAE,CAAC;AAIpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASa,YAAYA,CAAEC,KAAwB,EAAgB;EACrE,MAAM;IAAEC,QAAQ;IAAEX,IAAI,GAAGJ;EAAY,CAAC,GAAGc,KAAK;EAC9C,MAAM,CAAEE,MAAM,EAAEC,WAAW,CAAE,GAAGlB,UAAU,CAAE,MAAM,EAAE,EAAE,EAAG,CAAC;;EAE1D;EACAF,SAAS,CAAE,MAAMO,IAAI,CAACc,SAAS,CAAED,WAAY,CAAC,EAAE,CAAEb,IAAI,CAAG,CAAC;EAE1D,MAAMe,KAAK,GAAGrB,OAAO,CAAE,MAAMK,gBAAgB,CAAEC,IAAK,CAAC,EAAE,CAAEA,IAAI,EAAEY,MAAM,CAAG,CAAC;EAEzE,oBACCd,IAAA,CAACU,WAAW,CAACQ,QAAQ;IAACD,KAAK,EAAGA,KAAO;IAAAJ,QAAA,EAClCA;EAAQ,CACW,CAAC;AAEzB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,MAAMM,OAAO,GAAGA,CAAA,KAAMzB,UAAU,CAAEgB,WAAY,CAAC;AAOtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASU,QAAQA,CACvBC,cAAkC,EACO;EACzC,MAAMC,iBAEL,GAAKV,KAAK,IAAM;IAChB,MAAMW,SAAS,GAAGJ,OAAO,CAAC,CAAC;IAC3B,oBAAOnB,IAAA,CAACqB,cAAc;MAAA,GAAQT,KAAK;MAAA,GAAeW;IAAS,CAAI,CAAC;EACjE,CAAC;EACD,MAAMC,kBAAkB,GACvBH,cAAc,CAACI,WAAW,IAAIJ,cAAc,CAACK,IAAI,IAAI,WAAW;EACjEJ,iBAAiB,CAACG,WAAW,GAAI,YAAYD,kBAAoB,GAAE;EACnE,OAAOF,iBAAiB;AACzB","ignoreList":[]}