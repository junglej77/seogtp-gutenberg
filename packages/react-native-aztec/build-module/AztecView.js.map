{"version":3,"names":["findNodeHandle","requireNativeComponent","UIManager","Pressable","Platform","TouchableWithoutFeedback","Component","createRef","BACKSPACE","DELETE","DOWN","ENTER","ESCAPE","LEFT","RIGHT","SPACE","UP","AztecInputState","jsx","_jsx","AztecManager","getViewManagerConfig","KEYCODES","AztecView","constructor","arguments","aztecViewRef","_onContentSizeChange","bind","_onEnter","_onBackspace","_onKeyDown","_onChange","_onHTMLContentWithCursor","_onFocus","_onBlur","_onSelectionChange","_onPress","_onAztecFocus","blur","focus","componentWillUnmount","blurOnUnmount","current","dispatch","command","params","dispatchViewManagerCommand","requestHTMLWithCursor","Commands","returnHTMLWithCursor","event","updateCaretData","props","onContentSizeChange","size","nativeEvent","contentSize","isFocused","onKeyDown","newEvent","keyCode","code","preventDefault","onHTMLContentWithCursor","text","selectionStart","selectionEnd","onFocus","selectionEndCaretY","onBlur","OS","triggersIncludeEventKeyCode","triggerKeyCodes","map","char","charCodeAt","includes","onChange","onSelectionChange","caretY","setCurrentCaretData","caretHeight","selectionEndCaretHeight","focusedElement","getCurrentFocusedElement","onRemoveMarkFormatting","onMarkFormatting","color","focusInput","render","onActiveFormatsChange","otherProps","style","hasOwnProperty","lineHeight","tag","fontSize","TouchableComponent","accessible","onPress","children","RCTAztecView","onEnter","onBackspace","deleteEnter","ref","InputState","KeyCodes"],"sources":["@wordpress/react-native-aztec/src/AztecView.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport {\r\n\tfindNodeHandle,\r\n\trequireNativeComponent,\r\n\tUIManager,\r\n\tPressable,\r\n\tPlatform,\r\n\tTouchableWithoutFeedback,\r\n} from 'react-native';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { Component, createRef } from '@wordpress/element';\r\nimport {\r\n\tBACKSPACE,\r\n\tDELETE,\r\n\tDOWN,\r\n\tENTER,\r\n\tESCAPE,\r\n\tLEFT,\r\n\tRIGHT,\r\n\tSPACE,\r\n\tUP,\r\n} from '@wordpress/keycodes';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport * as AztecInputState from './AztecInputState';\r\n\r\nconst AztecManager = UIManager.getViewManagerConfig( 'RCTAztecView' );\r\n\r\n// Used to match KeyboardEvent.code values (from the Web API) with native keycodes.\r\nconst KEYCODES = {\r\n\t[ BACKSPACE ]: 'Backspace',\r\n\t[ DELETE ]: 'Delete',\r\n\t[ DOWN ]: 'ArrowDown',\r\n\t[ ENTER ]: 'Enter',\r\n\t[ ESCAPE ]: 'Escape',\r\n\t[ LEFT ]: 'ArrowLeft',\r\n\t[ RIGHT ]: 'ArrowRight',\r\n\t[ SPACE ]: 'Space',\r\n\t[ UP ]: 'ArrowUp',\r\n};\r\n\r\nclass AztecView extends Component {\r\n\tconstructor() {\r\n\t\tsuper( ...arguments );\r\n\t\tthis.aztecViewRef = createRef();\r\n\r\n\t\tthis._onContentSizeChange = this._onContentSizeChange.bind( this );\r\n\t\tthis._onEnter = this._onEnter.bind( this );\r\n\t\tthis._onBackspace = this._onBackspace.bind( this );\r\n\t\tthis._onKeyDown = this._onKeyDown.bind( this );\r\n\t\tthis._onChange = this._onChange.bind( this );\r\n\t\tthis._onHTMLContentWithCursor =\r\n\t\t\tthis._onHTMLContentWithCursor.bind( this );\r\n\t\tthis._onFocus = this._onFocus.bind( this );\r\n\t\tthis._onBlur = this._onBlur.bind( this );\r\n\t\tthis._onSelectionChange = this._onSelectionChange.bind( this );\r\n\t\tthis._onPress = this._onPress.bind( this );\r\n\t\tthis._onAztecFocus = this._onAztecFocus.bind( this );\r\n\t\tthis.blur = this.blur.bind( this );\r\n\t\tthis.focus = this.focus.bind( this );\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tAztecInputState.blurOnUnmount( this.aztecViewRef.current );\r\n\t}\r\n\r\n\tdispatch( command, params ) {\r\n\t\tparams = params || [];\r\n\t\tUIManager.dispatchViewManagerCommand(\r\n\t\t\tthis.aztecViewRef.current,\r\n\t\t\tcommand,\r\n\t\t\tparams\r\n\t\t);\r\n\t}\r\n\r\n\trequestHTMLWithCursor() {\r\n\t\tthis.dispatch( AztecManager.Commands.returnHTMLWithCursor );\r\n\t}\r\n\r\n\t_onContentSizeChange( event ) {\r\n\t\tthis.updateCaretData( event );\r\n\r\n\t\tif ( ! this.props.onContentSizeChange ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst size = event.nativeEvent.contentSize;\r\n\t\tconst { onContentSizeChange } = this.props;\r\n\t\tonContentSizeChange( size );\r\n\t}\r\n\r\n\t_onEnter( event ) {\r\n\t\tif ( ! this.isFocused() ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif ( ! this.props.onKeyDown ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst { onKeyDown } = this.props;\r\n\r\n\t\tconst newEvent = { ...event, keyCode: ENTER, code: KEYCODES[ ENTER ] };\r\n\t\tonKeyDown( newEvent );\r\n\t}\r\n\r\n\t_onBackspace( event ) {\r\n\t\tif ( ! this.props.onKeyDown ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst { onKeyDown } = this.props;\r\n\r\n\t\tconst newEvent = {\r\n\t\t\t...event,\r\n\t\t\tkeyCode: BACKSPACE,\r\n\t\t\tcode: KEYCODES[ BACKSPACE ],\r\n\t\t\tpreventDefault: () => {},\r\n\t\t};\r\n\t\tonKeyDown( newEvent );\r\n\t}\r\n\r\n\t_onKeyDown( event ) {\r\n\t\tif ( ! this.props.onKeyDown ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst { onKeyDown } = this.props;\r\n\t\tconst { keyCode } = event.nativeEvent;\r\n\t\tconst newEvent = {\r\n\t\t\t...event,\r\n\t\t\tkeyCode,\r\n\t\t\t...( KEYCODES[ keyCode ] && {\r\n\t\t\t\tcode: KEYCODES[ keyCode ],\r\n\t\t\t} ),\r\n\t\t\tpreventDefault: () => {},\r\n\t\t};\r\n\t\tonKeyDown( newEvent );\r\n\t}\r\n\r\n\t_onHTMLContentWithCursor( event ) {\r\n\t\tif ( ! this.props.onHTMLContentWithCursor ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst text = event.nativeEvent.text;\r\n\t\tconst selectionStart = event.nativeEvent.selectionStart;\r\n\t\tconst selectionEnd = event.nativeEvent.selectionEnd;\r\n\t\tconst { onHTMLContentWithCursor } = this.props;\r\n\t\tonHTMLContentWithCursor( text, selectionStart, selectionEnd );\r\n\t}\r\n\r\n\t_onFocus( event ) {\r\n\t\tif ( ! this.props.onFocus ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst { onFocus } = this.props;\r\n\t\tonFocus( event );\r\n\t}\r\n\r\n\t_onBlur( event ) {\r\n\t\tthis.selectionEndCaretY = null;\r\n\r\n\t\tAztecInputState.blur( this.aztecViewRef.current );\r\n\r\n\t\tif ( ! this.props.onBlur ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst { onBlur } = this.props;\r\n\t\tonBlur( event );\r\n\t}\r\n\r\n\t_onChange( event ) {\r\n\t\t// iOS uses the onKeyDown prop directly from native only when one of the triggerKeyCodes is entered, but\r\n\t\t// Android includes the information needed for onKeyDown in the event passed to onChange.\r\n\t\tif ( Platform.OS === 'android' ) {\r\n\t\t\tconst triggersIncludeEventKeyCode =\r\n\t\t\t\tthis.props.triggerKeyCodes &&\r\n\t\t\t\tthis.props.triggerKeyCodes\r\n\t\t\t\t\t.map( ( char ) => char.charCodeAt( 0 ) )\r\n\t\t\t\t\t.includes( event.nativeEvent.keyCode );\r\n\t\t\tif ( triggersIncludeEventKeyCode ) {\r\n\t\t\t\tthis._onKeyDown( event );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst { onChange } = this.props;\r\n\t\tif ( onChange ) {\r\n\t\t\tonChange( event );\r\n\t\t}\r\n\t}\r\n\r\n\t_onSelectionChange( event ) {\r\n\t\tif ( this.props.onSelectionChange ) {\r\n\t\t\tconst { selectionStart, selectionEnd, text } = event.nativeEvent;\r\n\t\t\tconst { onSelectionChange } = this.props;\r\n\t\t\tonSelectionChange( selectionStart, selectionEnd, text, event );\r\n\t\t}\r\n\r\n\t\tthis.updateCaretData( event );\r\n\t}\r\n\r\n\tupdateCaretData( event ) {\r\n\t\tif (\r\n\t\t\tthis.isFocused() &&\r\n\t\t\tthis.selectionEndCaretY !== event?.nativeEvent?.selectionEndCaretY\r\n\t\t) {\r\n\t\t\tconst caretY = event.nativeEvent.selectionEndCaretY;\r\n\t\t\tAztecInputState.setCurrentCaretData( {\r\n\t\t\t\tcaretY,\r\n\t\t\t\tcaretHeight: event.nativeEvent?.selectionEndCaretHeight,\r\n\t\t\t} );\r\n\t\t\tthis.selectionEndCaretY = caretY;\r\n\t\t}\r\n\t}\r\n\r\n\tblur() {\r\n\t\tAztecInputState.blur( this.aztecViewRef.current );\r\n\t}\r\n\r\n\tfocus() {\r\n\t\tAztecInputState.focus( this.aztecViewRef.current );\r\n\t}\r\n\r\n\tisFocused() {\r\n\t\tconst focusedElement = AztecInputState.getCurrentFocusedElement();\r\n\t\treturn focusedElement && focusedElement === this.aztecViewRef.current;\r\n\t}\r\n\r\n\tonRemoveMarkFormatting() {\r\n\t\tUIManager.dispatchViewManagerCommand(\r\n\t\t\tfindNodeHandle( this.aztecViewRef.current ),\r\n\t\t\t'onRemoveMarkFormatting',\r\n\t\t\t[]\r\n\t\t);\r\n\t}\r\n\r\n\tonMarkFormatting( color ) {\r\n\t\tUIManager.dispatchViewManagerCommand(\r\n\t\t\tfindNodeHandle( this.aztecViewRef.current ),\r\n\t\t\t'onMarkFormatting',\r\n\t\t\t[ color ]\r\n\t\t);\r\n\t}\r\n\r\n\t_onPress( event ) {\r\n\t\tif ( ! this.isFocused() ) {\r\n\t\t\tthis.focus(); // Call to move the focus in RN way (TextInputState)\r\n\t\t\tthis._onFocus( event ); // Check if there are listeners set on the focus event.\r\n\t\t}\r\n\t}\r\n\r\n\t_onAztecFocus( event ) {\r\n\t\t// IMPORTANT: This function serves two purposes:\r\n\t\t//\r\n\t\t// Android: This intentional no-op function prevents focus loops originating\r\n\t\t// when the native Aztec module programmatically focuses the instance. The\r\n\t\t// no-op is explicitly passed as an `onFocus` prop to avoid future prop\r\n\t\t// spreading from inadvertently introducing focus loops. The user-facing\r\n\t\t// focus of the element is handled by `onPress` instead.\r\n\t\t//\r\n\t\t// See: https://github.com/wordpress-mobile/gutenberg-mobile/issues/302\r\n\t\t//\r\n\t\t// iOS: Programmatic focus from the native Aztec module is required to\r\n\t\t// ensure the React-based `TextStateInput` ref is properly set when focus\r\n\t\t// is *returned* to an instance, e.g. dismissing a bottom sheet. If the ref\r\n\t\t// is not updated, attempts to dismiss the keyboard via the `ToolbarButton`\r\n\t\t// will fail.\r\n\t\t//\r\n\t\t// See: https://github.com/wordpress-mobile/gutenberg-mobile/issues/702\r\n\t\tif (\r\n\t\t\t// The Android keyboard is, likely erroneously, already dismissed in the\r\n\t\t\t// contexts where programmatic focus may be required on iOS.\r\n\t\t\t//\r\n\t\t\t// - https://github.com/WordPress/gutenberg/issues/28748\r\n\t\t\t// - https://github.com/WordPress/gutenberg/issues/29048\r\n\t\t\t// - https://github.com/wordpress-mobile/WordPress-Android/issues/16167\r\n\t\t\tPlatform.OS === 'ios'\r\n\t\t) {\r\n\t\t\tthis.updateCaretData( event );\r\n\r\n\t\t\tif ( ! this.isFocused() ) {\r\n\t\t\t\t// Programmatically swapping input focus creates an infinite loop if the\r\n\t\t\t\t// user taps a different input in between the programmatic focus and\r\n\t\t\t\t// the resulting update to the React Native TextInputState focused element\r\n\t\t\t\t// ref. To mitigate this, the below updates the focused element ref, but\r\n\t\t\t\t// does not call the native focus methods.\r\n\t\t\t\t//\r\n\t\t\t\t// See: https://github.com/wordpress-mobile/WordPress-iOS/issues/18783\r\n\t\t\t\tAztecInputState.focusInput( this.aztecViewRef.current );\r\n\r\n\t\t\t\t// Calling _onFocus is needed to trigger provided onFocus callbacks\r\n\t\t\t\t// which are needed to prevent undesired results like having a focused\r\n\t\t\t\t// TextInput when another element has the focus.\r\n\t\t\t\tthis._onFocus( event );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { onActiveFormatsChange, ...otherProps } = this.props;\r\n\t\t// `style` has to be destructured separately, without `otherProps`, because of:\r\n\t\t// https://github.com/WordPress/gutenberg/issues/23611\r\n\t\tconst { style } = this.props;\r\n\r\n\t\tif ( style.hasOwnProperty( 'lineHeight' ) ) {\r\n\t\t\tdelete style.lineHeight;\r\n\t\t\t// Prevents passing line-height within styles to avoid a crash due to values without units\r\n\t\t\t// We now support this but passing line-height as a prop instead.\r\n\t\t}\r\n\r\n\t\t// Remove Font size rendering for pre elements until we fix an issue with AztecAndroid.\r\n\t\tif (\r\n\t\t\tPlatform.OS === 'android' &&\r\n\t\t\tthis.props.text?.tag === 'pre' &&\r\n\t\t\tstyle.hasOwnProperty( 'fontSize' )\r\n\t\t) {\r\n\t\t\tdelete style.fontSize;\r\n\t\t}\r\n\r\n\t\t// We need to use `Pressable` on iOS to avoid issues with VoiceOver and assistive\r\n\t\t// input like the Braille Screen Input.\r\n\t\t// More information about this can be found in https://github.com/WordPress/gutenberg/pull/53895.\r\n\t\tconst TouchableComponent =\r\n\t\t\tPlatform.OS === 'ios' ? Pressable : TouchableWithoutFeedback;\r\n\r\n\t\treturn (\r\n\t\t\t<TouchableComponent\r\n\t\t\t\taccessible={ Platform.OS !== 'ios' }\r\n\t\t\t\tonPress={ this._onPress }\r\n\t\t\t>\r\n\t\t\t\t<RCTAztecView\r\n\t\t\t\t\t{ ...otherProps }\r\n\t\t\t\t\tstyle={ style }\r\n\t\t\t\t\tonContentSizeChange={ this._onContentSizeChange }\r\n\t\t\t\t\tonHTMLContentWithCursor={ this._onHTMLContentWithCursor }\r\n\t\t\t\t\tonChange={ this._onChange }\r\n\t\t\t\t\tonSelectionChange={ this._onSelectionChange }\r\n\t\t\t\t\tonEnter={ this.props.onKeyDown && this._onEnter }\r\n\t\t\t\t\tonBackspace={ this.props.onKeyDown && this._onBackspace }\r\n\t\t\t\t\tonKeyDown={ this.props.onKeyDown && this._onKeyDown }\r\n\t\t\t\t\tdeleteEnter={ this.props.deleteEnter }\r\n\t\t\t\t\t// IMPORTANT: Do not remove the `onFocus` prop, see `_onAztecFocus`\r\n\t\t\t\t\tonFocus={ this._onAztecFocus }\r\n\t\t\t\t\tonBlur={ this._onBlur }\r\n\t\t\t\t\tref={ this.aztecViewRef }\r\n\t\t\t\t/>\r\n\t\t\t</TouchableComponent>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nconst RCTAztecView = requireNativeComponent( 'RCTAztecView', AztecView );\r\n\r\nAztecView.InputState = AztecInputState;\r\nAztecView.KeyCodes = KEYCODES;\r\n\r\nexport default AztecView;\r\n"],"mappings":"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","ignoreList":[]}