{"version":3,"names":["I18nManager","LogBox","unregisterBlockType","getBlockType","addAction","addFilter","doAction","wpData","registerCoreBlocks","initializeEditor","initialHtml","setupApiFetch","reactNativeSetup","ignoreLogs","forceRTL","gutenbergSetup","userId","storageKey","use","plugins","persistence","setupInitHooks","props","_props$capabilities","capabilities","registerBlocks","undefined","reusableBlock","initialData","initialTitle","postType","hostAppNamespace","featuredImageId","rawStyles","rawFeatures","locale","__DEV__","initialHtmlModeEnabled","blocksRegistered","editorComponent"],"sources":["@wordpress/react-native-editor/src/setup.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\nimport { I18nManager, LogBox } from 'react-native';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { unregisterBlockType, getBlockType } from '@wordpress/blocks';\r\nimport { addAction, addFilter, doAction } from '@wordpress/hooks';\r\nimport * as wpData from '@wordpress/data';\r\nimport { registerCoreBlocks } from '@wordpress/block-library';\r\n// eslint-disable-next-line no-restricted-imports\r\nimport { initializeEditor } from '@wordpress/edit-post';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport initialHtml from './initial-html';\r\nimport setupApiFetch from './api-fetch-setup';\r\n\r\nconst reactNativeSetup = () => {\r\n\tLogBox.ignoreLogs( [\r\n\t\t'Require cycle:', // TODO: Refactor to remove require cycles\r\n\t] );\r\n\r\n\tI18nManager.forceRTL( false ); // Change to `true` to debug RTL layout easily.\r\n};\r\n\r\nconst gutenbergSetup = () => {\r\n\t// wp-data\r\n\tconst userId = 1;\r\n\tconst storageKey = 'WP_DATA_USER_' + userId;\r\n\twpData.use( wpData.plugins.persistence, { storageKey } );\r\n\r\n\tsetupApiFetch();\r\n\r\n\tsetupInitHooks();\r\n};\r\n\r\nconst setupInitHooks = () => {\r\n\taddAction( 'native.pre-render', 'core/react-native-editor', ( props ) => {\r\n\t\tconst capabilities = props.capabilities ?? {};\r\n\r\n\t\tregisterBlocks();\r\n\r\n\t\t// Unregister non-supported blocks by capabilities\r\n\t\tif (\r\n\t\t\tgetBlockType( 'core/block' ) !== undefined &&\r\n\t\t\tcapabilities.reusableBlock !== true\r\n\t\t) {\r\n\t\t\tunregisterBlockType( 'core/block' );\r\n\t\t}\r\n\r\n\t\tdoAction( 'native.post-register-core-blocks', props );\r\n\t} );\r\n\r\n\t// Map native props to Editor props\r\n\t// TODO: normalize props in the bridge (So we don't have to map initialData to initialHtml)\r\n\taddFilter(\r\n\t\t'native.block_editor_props',\r\n\t\t'core/react-native-editor',\r\n\t\t( props ) => {\r\n\t\t\tconst { capabilities = {} } = props;\r\n\t\t\tlet {\r\n\t\t\t\tinitialData,\r\n\t\t\t\tinitialTitle,\r\n\t\t\t\tpostType,\r\n\t\t\t\thostAppNamespace,\r\n\t\t\t\tfeaturedImageId,\r\n\t\t\t\trawStyles,\r\n\t\t\t\trawFeatures,\r\n\t\t\t\tlocale,\r\n\t\t\t} = props;\r\n\r\n\t\t\tif ( initialData === undefined && __DEV__ ) {\r\n\t\t\t\tinitialData = initialHtml;\r\n\t\t\t}\r\n\t\t\tif ( initialTitle === undefined ) {\r\n\t\t\t\tinitialTitle = 'Welcome to Gutenberg!';\r\n\t\t\t}\r\n\t\t\tif ( postType === undefined ) {\r\n\t\t\t\tpostType = 'post';\r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\t\t\t\tinitialHtml: initialData,\r\n\t\t\t\tinitialHtmlModeEnabled: props.initialHtmlModeEnabled,\r\n\t\t\t\tinitialTitle,\r\n\t\t\t\tpostType,\r\n\t\t\t\thostAppNamespace,\r\n\t\t\t\tfeaturedImageId,\r\n\t\t\t\tcapabilities,\r\n\t\t\t\trawStyles,\r\n\t\t\t\trawFeatures,\r\n\t\t\t\tlocale,\r\n\t\t\t};\r\n\t\t}\r\n\t);\r\n};\r\n\r\nlet blocksRegistered = false;\r\nconst registerBlocks = () => {\r\n\tif ( blocksRegistered ) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tregisterCoreBlocks();\r\n\r\n\tblocksRegistered = true;\r\n};\r\n\r\nlet editorComponent;\r\nexport default () => {\r\n\tif ( editorComponent ) {\r\n\t\treturn editorComponent;\r\n\t}\r\n\r\n\treactNativeSetup();\r\n\tgutenbergSetup();\r\n\teditorComponent = initializeEditor( 'gutenberg', 'post', 1 );\r\n\r\n\treturn editorComponent;\r\n};\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,WAAW,EAAEC,MAAM,QAAQ,cAAc;;AAElD;AACA;AACA;AACA,SAASC,mBAAmB,EAAEC,YAAY,QAAQ,mBAAmB;AACrE,SAASC,SAAS,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,kBAAkB;AACjE,OAAO,KAAKC,MAAM,MAAM,iBAAiB;AACzC,SAASC,kBAAkB,QAAQ,0BAA0B;AAC7D;AACA,SAASC,gBAAgB,QAAQ,sBAAsB;;AAEvD;AACA;AACA;AACA,OAAOC,WAAW,MAAM,gBAAgB;AACxC,OAAOC,aAAa,MAAM,mBAAmB;AAE7C,MAAMC,gBAAgB,GAAGA,CAAA,KAAM;EAC9BX,MAAM,CAACY,UAAU,CAAE,CAClB,gBAAgB,CAAE;EAAA,CACjB,CAAC;EAEHb,WAAW,CAACc,QAAQ,CAAE,KAAM,CAAC,CAAC,CAAC;AAChC,CAAC;AAED,MAAMC,cAAc,GAAGA,CAAA,KAAM;EAC5B;EACA,MAAMC,MAAM,GAAG,CAAC;EAChB,MAAMC,UAAU,GAAG,eAAe,GAAGD,MAAM;EAC3CT,MAAM,CAACW,GAAG,CAAEX,MAAM,CAACY,OAAO,CAACC,WAAW,EAAE;IAAEH;EAAW,CAAE,CAAC;EAExDN,aAAa,CAAC,CAAC;EAEfU,cAAc,CAAC,CAAC;AACjB,CAAC;AAED,MAAMA,cAAc,GAAGA,CAAA,KAAM;EAC5BjB,SAAS,CAAE,mBAAmB,EAAE,0BAA0B,EAAIkB,KAAK,IAAM;IAAA,IAAAC,mBAAA;IACxE,MAAMC,YAAY,IAAAD,mBAAA,GAAGD,KAAK,CAACE,YAAY,cAAAD,mBAAA,cAAAA,mBAAA,GAAI,CAAC,CAAC;IAE7CE,cAAc,CAAC,CAAC;;IAEhB;IACA,IACCtB,YAAY,CAAE,YAAa,CAAC,KAAKuB,SAAS,IAC1CF,YAAY,CAACG,aAAa,KAAK,IAAI,EAClC;MACDzB,mBAAmB,CAAE,YAAa,CAAC;IACpC;IAEAI,QAAQ,CAAE,kCAAkC,EAAEgB,KAAM,CAAC;EACtD,CAAE,CAAC;;EAEH;EACA;EACAjB,SAAS,CACR,2BAA2B,EAC3B,0BAA0B,EACxBiB,KAAK,IAAM;IACZ,MAAM;MAAEE,YAAY,GAAG,CAAC;IAAE,CAAC,GAAGF,KAAK;IACnC,IAAI;MACHM,WAAW;MACXC,YAAY;MACZC,QAAQ;MACRC,gBAAgB;MAChBC,eAAe;MACfC,SAAS;MACTC,WAAW;MACXC;IACD,CAAC,GAAGb,KAAK;IAET,IAAKM,WAAW,KAAKF,SAAS,IAAIU,OAAO,EAAG;MAC3CR,WAAW,GAAGlB,WAAW;IAC1B;IACA,IAAKmB,YAAY,KAAKH,SAAS,EAAG;MACjCG,YAAY,GAAG,uBAAuB;IACvC;IACA,IAAKC,QAAQ,KAAKJ,SAAS,EAAG;MAC7BI,QAAQ,GAAG,MAAM;IAClB;IAEA,OAAO;MACNpB,WAAW,EAAEkB,WAAW;MACxBS,sBAAsB,EAAEf,KAAK,CAACe,sBAAsB;MACpDR,YAAY;MACZC,QAAQ;MACRC,gBAAgB;MAChBC,eAAe;MACfR,YAAY;MACZS,SAAS;MACTC,WAAW;MACXC;IACD,CAAC;EACF,CACD,CAAC;AACF,CAAC;AAED,IAAIG,gBAAgB,GAAG,KAAK;AAC5B,MAAMb,cAAc,GAAGA,CAAA,KAAM;EAC5B,IAAKa,gBAAgB,EAAG;IACvB;EACD;EAEA9B,kBAAkB,CAAC,CAAC;EAEpB8B,gBAAgB,GAAG,IAAI;AACxB,CAAC;AAED,IAAIC,eAAe;AACnB,gBAAe,MAAM;EACpB,IAAKA,eAAe,EAAG;IACtB,OAAOA,eAAe;EACvB;EAEA3B,gBAAgB,CAAC,CAAC;EAClBG,cAAc,CAAC,CAAC;EAChBwB,eAAe,GAAG9B,gBAAgB,CAAE,WAAW,EAAE,MAAM,EAAE,CAAE,CAAC;EAE5D,OAAO8B,eAAe;AACvB,CAAC","ignoreList":[]}