{"version":3,"names":["toHTMLString","slice","remove","getTextContent","props","element","onCopy","event","record","createRecord","handleChange","current","ownerDocument","defaultView","anchorNode","focusNode","isCollapsed","getSelection","containsSelection","contains","selectedRecord","plainText","html","value","clipboardData","setData","preventDefault","type","addEventListener","removeEventListener"],"sources":["@wordpress/rich-text/src/component/event-listeners/copy-handler.js"],"sourcesContent":["/**\r\n * Internal dependencies\r\n */\r\nimport { toHTMLString } from '../../to-html-string';\r\nimport { slice } from '../../slice';\r\nimport { remove } from '../../remove';\r\nimport { getTextContent } from '../../get-text-content';\r\n\r\nexport default ( props ) => ( element ) => {\r\n\tfunction onCopy( event ) {\r\n\t\tconst { record, createRecord, handleChange } = props.current;\r\n\t\tconst { ownerDocument } = element;\r\n\t\tconst { defaultView } = ownerDocument;\r\n\t\tconst { anchorNode, focusNode, isCollapsed } =\r\n\t\t\tdefaultView.getSelection();\r\n\t\tconst containsSelection =\r\n\t\t\telement.contains( anchorNode ) && element.contains( focusNode );\r\n\r\n\t\tif ( isCollapsed || ! containsSelection ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst selectedRecord = slice( record.current );\r\n\t\tconst plainText = getTextContent( selectedRecord );\r\n\t\tconst html = toHTMLString( { value: selectedRecord } );\r\n\t\tevent.clipboardData.setData( 'text/plain', plainText );\r\n\t\tevent.clipboardData.setData( 'text/html', html );\r\n\t\tevent.clipboardData.setData( 'rich-text', 'true' );\r\n\t\tevent.preventDefault();\r\n\r\n\t\tif ( event.type === 'cut' ) {\r\n\t\t\thandleChange( remove( createRecord() ) );\r\n\t\t}\r\n\t}\r\n\r\n\tconst { defaultView } = element.ownerDocument;\r\n\r\n\tdefaultView.addEventListener( 'copy', onCopy );\r\n\tdefaultView.addEventListener( 'cut', onCopy );\r\n\treturn () => {\r\n\t\tdefaultView.removeEventListener( 'copy', onCopy );\r\n\t\tdefaultView.removeEventListener( 'cut', onCopy );\r\n\t};\r\n};\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,YAAY,QAAQ,sBAAsB;AACnD,SAASC,KAAK,QAAQ,aAAa;AACnC,SAASC,MAAM,QAAQ,cAAc;AACrC,SAASC,cAAc,QAAQ,wBAAwB;AAEvD,gBAAiBC,KAAK,IAAQC,OAAO,IAAM;EAC1C,SAASC,MAAMA,CAAEC,KAAK,EAAG;IACxB,MAAM;MAAEC,MAAM;MAAEC,YAAY;MAAEC;IAAa,CAAC,GAAGN,KAAK,CAACO,OAAO;IAC5D,MAAM;MAAEC;IAAc,CAAC,GAAGP,OAAO;IACjC,MAAM;MAAEQ;IAAY,CAAC,GAAGD,aAAa;IACrC,MAAM;MAAEE,UAAU;MAAEC,SAAS;MAAEC;IAAY,CAAC,GAC3CH,WAAW,CAACI,YAAY,CAAC,CAAC;IAC3B,MAAMC,iBAAiB,GACtBb,OAAO,CAACc,QAAQ,CAAEL,UAAW,CAAC,IAAIT,OAAO,CAACc,QAAQ,CAAEJ,SAAU,CAAC;IAEhE,IAAKC,WAAW,IAAI,CAAEE,iBAAiB,EAAG;MACzC;IACD;IAEA,MAAME,cAAc,GAAGnB,KAAK,CAAEO,MAAM,CAACG,OAAQ,CAAC;IAC9C,MAAMU,SAAS,GAAGlB,cAAc,CAAEiB,cAAe,CAAC;IAClD,MAAME,IAAI,GAAGtB,YAAY,CAAE;MAAEuB,KAAK,EAAEH;IAAe,CAAE,CAAC;IACtDb,KAAK,CAACiB,aAAa,CAACC,OAAO,CAAE,YAAY,EAAEJ,SAAU,CAAC;IACtDd,KAAK,CAACiB,aAAa,CAACC,OAAO,CAAE,WAAW,EAAEH,IAAK,CAAC;IAChDf,KAAK,CAACiB,aAAa,CAACC,OAAO,CAAE,WAAW,EAAE,MAAO,CAAC;IAClDlB,KAAK,CAACmB,cAAc,CAAC,CAAC;IAEtB,IAAKnB,KAAK,CAACoB,IAAI,KAAK,KAAK,EAAG;MAC3BjB,YAAY,CAAER,MAAM,CAAEO,YAAY,CAAC,CAAE,CAAE,CAAC;IACzC;EACD;EAEA,MAAM;IAAEI;EAAY,CAAC,GAAGR,OAAO,CAACO,aAAa;EAE7CC,WAAW,CAACe,gBAAgB,CAAE,MAAM,EAAEtB,MAAO,CAAC;EAC9CO,WAAW,CAACe,gBAAgB,CAAE,KAAK,EAAEtB,MAAO,CAAC;EAC7C,OAAO,MAAM;IACZO,WAAW,CAACgB,mBAAmB,CAAE,MAAM,EAAEvB,MAAO,CAAC;IACjDO,WAAW,CAACgB,mBAAmB,CAAE,KAAK,EAAEvB,MAAO,CAAC;EACjD,CAAC;AACF,CAAC","ignoreList":[]}