{"version":3,"names":["useEffect","useRef","useBoundaryStyle","record","ref","activeFormats","replacements","start","current","activeReplacement","length","boundarySelector","element","querySelector","ownerDocument","defaultView","computedStyle","getComputedStyle","newColor","color","replace","selector","rule","style","globalStyleId","globalStyle","getElementById","createElement","id","head","appendChild","innerHTML"],"sources":["@wordpress/rich-text/src/component/use-boundary-style.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useEffect, useRef } from '@wordpress/element';\r\n\r\n/*\r\n * Calculates and renders the format boundary style when the active formats\r\n * change.\r\n */\r\nexport function useBoundaryStyle( { record } ) {\r\n\tconst ref = useRef();\r\n\tconst { activeFormats = [], replacements, start } = record.current;\r\n\tconst activeReplacement = replacements[ start ];\r\n\tuseEffect( () => {\r\n\t\t// There's no need to recalculate the boundary styles if no formats are\r\n\t\t// active, because no boundary styles will be visible.\r\n\t\tif (\r\n\t\t\t( ! activeFormats || ! activeFormats.length ) &&\r\n\t\t\t! activeReplacement\r\n\t\t) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst boundarySelector = '*[data-rich-text-format-boundary]';\r\n\t\tconst element = ref.current.querySelector( boundarySelector );\r\n\r\n\t\tif ( ! element ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst { ownerDocument } = element;\r\n\t\tconst { defaultView } = ownerDocument;\r\n\t\tconst computedStyle = defaultView.getComputedStyle( element );\r\n\t\tconst newColor = computedStyle.color\r\n\t\t\t.replace( ')', ', 0.2)' )\r\n\t\t\t.replace( 'rgb', 'rgba' );\r\n\t\tconst selector = `.rich-text:focus ${ boundarySelector }`;\r\n\t\tconst rule = `background-color: ${ newColor }`;\r\n\t\tconst style = `${ selector } {${ rule }}`;\r\n\t\tconst globalStyleId = 'rich-text-boundary-style';\r\n\r\n\t\tlet globalStyle = ownerDocument.getElementById( globalStyleId );\r\n\r\n\t\tif ( ! globalStyle ) {\r\n\t\t\tglobalStyle = ownerDocument.createElement( 'style' );\r\n\t\t\tglobalStyle.id = globalStyleId;\r\n\t\t\townerDocument.head.appendChild( globalStyle );\r\n\t\t}\r\n\r\n\t\tif ( globalStyle.innerHTML !== style ) {\r\n\t\t\tglobalStyle.innerHTML = style;\r\n\t\t}\r\n\t}, [ activeFormats, activeReplacement ] );\r\n\treturn ref;\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,SAAS,EAAEC,MAAM,QAAQ,oBAAoB;;AAEtD;AACA;AACA;AACA;AACA,OAAO,SAASC,gBAAgBA,CAAE;EAAEC;AAAO,CAAC,EAAG;EAC9C,MAAMC,GAAG,GAAGH,MAAM,CAAC,CAAC;EACpB,MAAM;IAAEI,aAAa,GAAG,EAAE;IAAEC,YAAY;IAAEC;EAAM,CAAC,GAAGJ,MAAM,CAACK,OAAO;EAClE,MAAMC,iBAAiB,GAAGH,YAAY,CAAEC,KAAK,CAAE;EAC/CP,SAAS,CAAE,MAAM;IAChB;IACA;IACA,IACC,CAAE,CAAEK,aAAa,IAAI,CAAEA,aAAa,CAACK,MAAM,KAC3C,CAAED,iBAAiB,EAClB;MACD;IACD;IAEA,MAAME,gBAAgB,GAAG,mCAAmC;IAC5D,MAAMC,OAAO,GAAGR,GAAG,CAACI,OAAO,CAACK,aAAa,CAAEF,gBAAiB,CAAC;IAE7D,IAAK,CAAEC,OAAO,EAAG;MAChB;IACD;IAEA,MAAM;MAAEE;IAAc,CAAC,GAAGF,OAAO;IACjC,MAAM;MAAEG;IAAY,CAAC,GAAGD,aAAa;IACrC,MAAME,aAAa,GAAGD,WAAW,CAACE,gBAAgB,CAAEL,OAAQ,CAAC;IAC7D,MAAMM,QAAQ,GAAGF,aAAa,CAACG,KAAK,CAClCC,OAAO,CAAE,GAAG,EAAE,QAAS,CAAC,CACxBA,OAAO,CAAE,KAAK,EAAE,MAAO,CAAC;IAC1B,MAAMC,QAAQ,GAAI,oBAAoBV,gBAAkB,EAAC;IACzD,MAAMW,IAAI,GAAI,qBAAqBJ,QAAU,EAAC;IAC9C,MAAMK,KAAK,GAAI,GAAGF,QAAU,KAAKC,IAAM,GAAE;IACzC,MAAME,aAAa,GAAG,0BAA0B;IAEhD,IAAIC,WAAW,GAAGX,aAAa,CAACY,cAAc,CAAEF,aAAc,CAAC;IAE/D,IAAK,CAAEC,WAAW,EAAG;MACpBA,WAAW,GAAGX,aAAa,CAACa,aAAa,CAAE,OAAQ,CAAC;MACpDF,WAAW,CAACG,EAAE,GAAGJ,aAAa;MAC9BV,aAAa,CAACe,IAAI,CAACC,WAAW,CAAEL,WAAY,CAAC;IAC9C;IAEA,IAAKA,WAAW,CAACM,SAAS,KAAKR,KAAK,EAAG;MACtCE,WAAW,CAACM,SAAS,GAAGR,KAAK;IAC9B;EACD,CAAC,EAAE,CAAElB,aAAa,EAAEI,iBAAiB,CAAG,CAAC;EACzC,OAAOL,GAAG;AACX","ignoreList":[]}