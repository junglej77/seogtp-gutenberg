{"version":3,"names":["select","dispatch","store","richTextStore","registerFormatType","name","settings","window","console","error","test","getFormatType","tagName","className","formatTypeForBareElement","getFormatTypeForBareElement","formatTypeForClassName","getFormatTypeForClassName","title","keywords","length","addFormatTypes"],"sources":["@wordpress/rich-text/src/register-format-type.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { select, dispatch } from '@wordpress/data';\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { store as richTextStore } from './store';\r\n/**\r\n * @typedef {Object} WPFormat\r\n *\r\n * @property {string}        name        A string identifying the format. Must be\r\n *                                       unique across all registered formats.\r\n * @property {string}        tagName     The HTML tag this format will wrap the\r\n *                                       selection with.\r\n * @property {boolean}       interactive Whether format makes content interactive or not.\r\n * @property {string | null} [className] A class to match the format.\r\n * @property {string}        title       Name of the format.\r\n * @property {Function}      edit        Should return a component for the user to\r\n *                                       interact with the new registered format.\r\n */\r\n\r\n/**\r\n * Registers a new format provided a unique name and an object defining its\r\n * behavior.\r\n *\r\n * @param {string}   name     Format name.\r\n * @param {WPFormat} settings Format settings.\r\n *\r\n * @return {WPFormat|undefined} The format, if it has been successfully\r\n *                              registered; otherwise `undefined`.\r\n */\r\nexport function registerFormatType( name, settings ) {\r\n\tsettings = {\r\n\t\tname,\r\n\t\t...settings,\r\n\t};\r\n\r\n\tif ( typeof settings.name !== 'string' ) {\r\n\t\twindow.console.error( 'Format names must be strings.' );\r\n\t\treturn;\r\n\t}\r\n\r\n\tif ( ! /^[a-z][a-z0-9-]*\\/[a-z][a-z0-9-]*$/.test( settings.name ) ) {\r\n\t\twindow.console.error(\r\n\t\t\t'Format names must contain a namespace prefix, include only lowercase alphanumeric characters or dashes, and start with a letter. Example: my-plugin/my-custom-format'\r\n\t\t);\r\n\t\treturn;\r\n\t}\r\n\r\n\tif ( select( richTextStore ).getFormatType( settings.name ) ) {\r\n\t\twindow.console.error(\r\n\t\t\t'Format \"' + settings.name + '\" is already registered.'\r\n\t\t);\r\n\t\treturn;\r\n\t}\r\n\r\n\tif ( typeof settings.tagName !== 'string' || settings.tagName === '' ) {\r\n\t\twindow.console.error( 'Format tag names must be a string.' );\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (\r\n\t\t( typeof settings.className !== 'string' ||\r\n\t\t\tsettings.className === '' ) &&\r\n\t\tsettings.className !== null\r\n\t) {\r\n\t\twindow.console.error(\r\n\t\t\t'Format class names must be a string, or null to handle bare elements.'\r\n\t\t);\r\n\t\treturn;\r\n\t}\r\n\r\n\tif ( ! /^[_a-zA-Z]+[a-zA-Z0-9_-]*$/.test( settings.className ) ) {\r\n\t\twindow.console.error(\r\n\t\t\t'A class name must begin with a letter, followed by any number of hyphens, underscores, letters, or numbers.'\r\n\t\t);\r\n\t\treturn;\r\n\t}\r\n\r\n\tif ( settings.className === null ) {\r\n\t\tconst formatTypeForBareElement = select(\r\n\t\t\trichTextStore\r\n\t\t).getFormatTypeForBareElement( settings.tagName );\r\n\r\n\t\tif (\r\n\t\t\tformatTypeForBareElement &&\r\n\t\t\tformatTypeForBareElement.name !== 'core/unknown'\r\n\t\t) {\r\n\t\t\twindow.console.error(\r\n\t\t\t\t`Format \"${ formatTypeForBareElement.name }\" is already registered to handle bare tag name \"${ settings.tagName }\".`\r\n\t\t\t);\r\n\t\t\treturn;\r\n\t\t}\r\n\t} else {\r\n\t\tconst formatTypeForClassName = select(\r\n\t\t\trichTextStore\r\n\t\t).getFormatTypeForClassName( settings.className );\r\n\r\n\t\tif ( formatTypeForClassName ) {\r\n\t\t\twindow.console.error(\r\n\t\t\t\t`Format \"${ formatTypeForClassName.name }\" is already registered to handle class name \"${ settings.className }\".`\r\n\t\t\t);\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\tif ( ! ( 'title' in settings ) || settings.title === '' ) {\r\n\t\twindow.console.error(\r\n\t\t\t'The format \"' + settings.name + '\" must have a title.'\r\n\t\t);\r\n\t\treturn;\r\n\t}\r\n\r\n\tif ( 'keywords' in settings && settings.keywords.length > 3 ) {\r\n\t\twindow.console.error(\r\n\t\t\t'The format \"' +\r\n\t\t\t\tsettings.name +\r\n\t\t\t\t'\" can have a maximum of 3 keywords.'\r\n\t\t);\r\n\t\treturn;\r\n\t}\r\n\r\n\tif ( typeof settings.title !== 'string' ) {\r\n\t\twindow.console.error( 'Format titles must be strings.' );\r\n\t\treturn;\r\n\t}\r\n\r\n\tdispatch( richTextStore ).addFormatTypes( settings );\r\n\r\n\treturn settings;\r\n}\r\n"],"mappings":"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","ignoreList":[]}