{"version":3,"names":["IndexeddbPersistence","connectIndexDb","objectId","objectType","doc","roomName","provider","Promise","resolve","on","destroy"],"sources":["@wordpress/sync/src/connect-indexdb.js"],"sourcesContent":["/**\r\n * External dependencies\r\n */\r\n// @ts-ignore\r\nimport { IndexeddbPersistence } from 'y-indexeddb';\r\n\r\n/** @typedef {import('./types').ObjectType} ObjectType */\r\n/** @typedef {import('./types').ObjectID} ObjectID */\r\n/** @typedef {import('./types').CRDTDoc} CRDTDoc */\r\n/** @typedef {import('./types').ConnectDoc} ConnectDoc */\r\n/** @typedef {import('./types').SyncProvider} SyncProvider */\r\n\r\n/**\r\n * Connect function to the IndexedDB persistence provider.\r\n *\r\n * @param {ObjectID}   objectId   The object ID.\r\n * @param {ObjectType} objectType The object type.\r\n * @param {CRDTDoc}    doc        The CRDT document.\r\n *\r\n * @return {Promise<() => void>} Promise that resolves when the connection is established.\r\n */\r\nexport function connectIndexDb( objectId, objectType, doc ) {\r\n\tconst roomName = `${ objectType }-${ objectId }`;\r\n\tconst provider = new IndexeddbPersistence( roomName, doc );\r\n\r\n\treturn new Promise( ( resolve ) => {\r\n\t\tprovider.on( 'synced', () => {\r\n\t\t\tresolve( () => provider.destroy() );\r\n\t\t} );\r\n\t} );\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAASA,oBAAoB,QAAQ,aAAa;;AAElD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,cAAcA,CAAEC,QAAQ,EAAEC,UAAU,EAAEC,GAAG,EAAG;EAC3D,MAAMC,QAAQ,GAAI,GAAGF,UAAY,IAAID,QAAU,EAAC;EAChD,MAAMI,QAAQ,GAAG,IAAIN,oBAAoB,CAAEK,QAAQ,EAAED,GAAI,CAAC;EAE1D,OAAO,IAAIG,OAAO,CAAIC,OAAO,IAAM;IAClCF,QAAQ,CAACG,EAAE,CAAE,QAAQ,EAAE,MAAM;MAC5BD,OAAO,CAAE,MAAMF,QAAQ,CAACI,OAAO,CAAC,CAAE,CAAC;IACpC,CAAE,CAAC;EACJ,CAAE,CAAC;AACJ","ignoreList":[]}