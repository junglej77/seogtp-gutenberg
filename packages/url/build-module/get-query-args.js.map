{"version":3,"names":["safeDecodeURIComponent","getQueryString","setPath","object","path","value","length","lastIndex","i","key","Array","isArray","toString","includes","toUpperCase","isNextKeyArrayIndex","isNaN","Number","getQueryArgs","url","replace","split","reduce","accumulator","keyValue","filter","Boolean","map","segments","Object","create"],"sources":["@wordpress/url/src/get-query-args.js"],"sourcesContent":["/**\r\n * Internal dependencies\r\n */\r\nimport { safeDecodeURIComponent } from './safe-decode-uri-component';\r\nimport { getQueryString } from './get-query-string';\r\n\r\n/** @typedef {import('./get-query-arg').QueryArgParsed} QueryArgParsed */\r\n\r\n/**\r\n * @typedef {Record<string,QueryArgParsed>} QueryArgs\r\n */\r\n\r\n/**\r\n * Sets a value in object deeply by a given array of path segments. Mutates the\r\n * object reference.\r\n *\r\n * @param {Record<string,*>} object Object in which to assign.\r\n * @param {string[]}         path   Path segment at which to set value.\r\n * @param {*}                value  Value to set.\r\n */\r\nfunction setPath( object, path, value ) {\r\n\tconst length = path.length;\r\n\tconst lastIndex = length - 1;\r\n\tfor ( let i = 0; i < length; i++ ) {\r\n\t\tlet key = path[ i ];\r\n\r\n\t\tif ( ! key && Array.isArray( object ) ) {\r\n\t\t\t// If key is empty string and next value is array, derive key from\r\n\t\t\t// the current length of the array.\r\n\t\t\tkey = object.length.toString();\r\n\t\t}\r\n\r\n\t\tkey = [ '__proto__', 'constructor', 'prototype' ].includes( key )\r\n\t\t\t? key.toUpperCase()\r\n\t\t\t: key;\r\n\r\n\t\t// If the next key in the path is numeric (or empty string), it will be\r\n\t\t// created as an array. Otherwise, it will be created as an object.\r\n\t\tconst isNextKeyArrayIndex = ! isNaN( Number( path[ i + 1 ] ) );\r\n\r\n\t\tobject[ key ] =\r\n\t\t\ti === lastIndex\r\n\t\t\t\t? // If at end of path, assign the intended value.\r\n\t\t\t\t  value\r\n\t\t\t\t: // Otherwise, advance to the next object in the path, creating\r\n\t\t\t\t  // it if it does not yet exist.\r\n\t\t\t\t  object[ key ] || ( isNextKeyArrayIndex ? [] : {} );\r\n\r\n\t\tif ( Array.isArray( object[ key ] ) && ! isNextKeyArrayIndex ) {\r\n\t\t\t// If we current key is non-numeric, but the next value is an\r\n\t\t\t// array, coerce the value to an object.\r\n\t\t\tobject[ key ] = { ...object[ key ] };\r\n\t\t}\r\n\r\n\t\t// Update working reference object to the next in the path.\r\n\t\tobject = object[ key ];\r\n\t}\r\n}\r\n\r\n/**\r\n * Returns an object of query arguments of the given URL. If the given URL is\r\n * invalid or has no querystring, an empty object is returned.\r\n *\r\n * @param {string} url URL.\r\n *\r\n * @example\r\n * ```js\r\n * const foo = getQueryArgs( 'https://wordpress.org?foo=bar&bar=baz' );\r\n * // { \"foo\": \"bar\", \"bar\": \"baz\" }\r\n * ```\r\n *\r\n * @return {QueryArgs} Query args object.\r\n */\r\nexport function getQueryArgs( url ) {\r\n\treturn (\r\n\t\t( getQueryString( url ) || '' )\r\n\t\t\t// Normalize space encoding, accounting for PHP URL encoding\r\n\t\t\t// corresponding to `application/x-www-form-urlencoded`.\r\n\t\t\t//\r\n\t\t\t// See: https://tools.ietf.org/html/rfc1866#section-8.2.1\r\n\t\t\t.replace( /\\+/g, '%20' )\r\n\t\t\t.split( '&' )\r\n\t\t\t.reduce( ( accumulator, keyValue ) => {\r\n\t\t\t\tconst [ key, value = '' ] = keyValue\r\n\t\t\t\t\t.split( '=' )\r\n\t\t\t\t\t// Filtering avoids decoding as `undefined` for value, where\r\n\t\t\t\t\t// default is restored in destructuring assignment.\r\n\t\t\t\t\t.filter( Boolean )\r\n\t\t\t\t\t.map( safeDecodeURIComponent );\r\n\r\n\t\t\t\tif ( key ) {\r\n\t\t\t\t\tconst segments = key.replace( /\\]/g, '' ).split( '[' );\r\n\t\t\t\t\tsetPath( accumulator, segments, value );\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn accumulator;\r\n\t\t\t}, Object.create( null ) )\r\n\t);\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,sBAAsB,QAAQ,6BAA6B;AACpE,SAASC,cAAc,QAAQ,oBAAoB;;AAEnD;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASC,OAAOA,CAAEC,MAAM,EAAEC,IAAI,EAAEC,KAAK,EAAG;EACvC,MAAMC,MAAM,GAAGF,IAAI,CAACE,MAAM;EAC1B,MAAMC,SAAS,GAAGD,MAAM,GAAG,CAAC;EAC5B,KAAM,IAAIE,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGF,MAAM,EAAEE,CAAC,EAAE,EAAG;IAClC,IAAIC,GAAG,GAAGL,IAAI,CAAEI,CAAC,CAAE;IAEnB,IAAK,CAAEC,GAAG,IAAIC,KAAK,CAACC,OAAO,CAAER,MAAO,CAAC,EAAG;MACvC;MACA;MACAM,GAAG,GAAGN,MAAM,CAACG,MAAM,CAACM,QAAQ,CAAC,CAAC;IAC/B;IAEAH,GAAG,GAAG,CAAE,WAAW,EAAE,aAAa,EAAE,WAAW,CAAE,CAACI,QAAQ,CAAEJ,GAAI,CAAC,GAC9DA,GAAG,CAACK,WAAW,CAAC,CAAC,GACjBL,GAAG;;IAEN;IACA;IACA,MAAMM,mBAAmB,GAAG,CAAEC,KAAK,CAAEC,MAAM,CAAEb,IAAI,CAAEI,CAAC,GAAG,CAAC,CAAG,CAAE,CAAC;IAE9DL,MAAM,CAAEM,GAAG,CAAE,GACZD,CAAC,KAAKD,SAAS;IACZ;IACAF,KAAK;IACL;IACA;IACAF,MAAM,CAAEM,GAAG,CAAE,KAAMM,mBAAmB,GAAG,EAAE,GAAG,CAAC,CAAC,CAAE;IAEtD,IAAKL,KAAK,CAACC,OAAO,CAAER,MAAM,CAAEM,GAAG,CAAG,CAAC,IAAI,CAAEM,mBAAmB,EAAG;MAC9D;MACA;MACAZ,MAAM,CAAEM,GAAG,CAAE,GAAG;QAAE,GAAGN,MAAM,CAAEM,GAAG;MAAG,CAAC;IACrC;;IAEA;IACAN,MAAM,GAAGA,MAAM,CAAEM,GAAG,CAAE;EACvB;AACD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASS,YAAYA,CAAEC,GAAG,EAAG;EACnC,OACC,CAAElB,cAAc,CAAEkB,GAAI,CAAC,IAAI;EAC1B;EACA;EACA;EACA;EAAA,EACCC,OAAO,CAAE,KAAK,EAAE,KAAM,CAAC,CACvBC,KAAK,CAAE,GAAI,CAAC,CACZC,MAAM,CAAE,CAAEC,WAAW,EAAEC,QAAQ,KAAM;IACrC,MAAM,CAAEf,GAAG,EAAEJ,KAAK,GAAG,EAAE,CAAE,GAAGmB,QAAQ,CAClCH,KAAK,CAAE,GAAI;IACZ;IACA;IAAA,CACCI,MAAM,CAAEC,OAAQ,CAAC,CACjBC,GAAG,CAAE3B,sBAAuB,CAAC;IAE/B,IAAKS,GAAG,EAAG;MACV,MAAMmB,QAAQ,GAAGnB,GAAG,CAACW,OAAO,CAAE,KAAK,EAAE,EAAG,CAAC,CAACC,KAAK,CAAE,GAAI,CAAC;MACtDnB,OAAO,CAAEqB,WAAW,EAAEK,QAAQ,EAAEvB,KAAM,CAAC;IACxC;IAEA,OAAOkB,WAAW;EACnB,CAAC,EAAEM,MAAM,CAACC,MAAM,CAAE,IAAK,CAAE,CAAC;AAE7B","ignoreList":[]}