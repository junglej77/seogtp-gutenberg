{"version":3,"names":["debounce","dispatch","store","addDimensionsEventListener","breakpoints","operators","setIsMatching","values","Object","fromEntries","queries","map","key","query","matches","leading","operatorEntries","entries","flatMap","name","width","operator","condition","list","window","matchMedia","addEventListener","flush"],"sources":["@wordpress/viewport/src/listener.js"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { debounce } from '@wordpress/compose';\r\nimport { dispatch } from '@wordpress/data';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport { store } from './store';\r\n\r\nconst addDimensionsEventListener = ( breakpoints, operators ) => {\r\n\t/**\r\n\t * Callback invoked when media query state should be updated. Is invoked a\r\n\t * maximum of one time per call stack.\r\n\t */\r\n\tconst setIsMatching = debounce(\r\n\t\t() => {\r\n\t\t\tconst values = Object.fromEntries(\r\n\t\t\t\tqueries.map( ( [ key, query ] ) => [ key, query.matches ] )\r\n\t\t\t);\r\n\t\t\tdispatch( store ).setIsMatching( values );\r\n\t\t},\r\n\t\t0,\r\n\t\t{ leading: true }\r\n\t);\r\n\r\n\t/**\r\n\t * Hash of breakpoint names with generated MediaQueryList for corresponding\r\n\t * media query.\r\n\t *\r\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/Window/matchMedia\r\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/MediaQueryList\r\n\t *\r\n\t * @type {Object<string,MediaQueryList>}\r\n\t */\r\n\tconst operatorEntries = Object.entries( operators );\r\n\tconst queries = Object.entries( breakpoints ).flatMap(\r\n\t\t( [ name, width ] ) => {\r\n\t\t\treturn operatorEntries.map( ( [ operator, condition ] ) => {\r\n\t\t\t\tconst list = window.matchMedia(\r\n\t\t\t\t\t`(${ condition }: ${ width }px)`\r\n\t\t\t\t);\r\n\t\t\t\tlist.addEventListener( 'change', setIsMatching );\r\n\t\t\t\treturn [ `${ operator } ${ name }`, list ];\r\n\t\t\t} );\r\n\t\t}\r\n\t);\r\n\r\n\twindow.addEventListener( 'orientationchange', setIsMatching );\r\n\r\n\t// Set initial values.\r\n\tsetIsMatching();\r\n\tsetIsMatching.flush();\r\n};\r\n\r\nexport default addDimensionsEventListener;\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,QAAQ,QAAQ,oBAAoB;AAC7C,SAASC,QAAQ,QAAQ,iBAAiB;;AAE1C;AACA;AACA;AACA,SAASC,KAAK,QAAQ,SAAS;AAE/B,MAAMC,0BAA0B,GAAGA,CAAEC,WAAW,EAAEC,SAAS,KAAM;EAChE;AACD;AACA;AACA;EACC,MAAMC,aAAa,GAAGN,QAAQ,CAC7B,MAAM;IACL,MAAMO,MAAM,GAAGC,MAAM,CAACC,WAAW,CAChCC,OAAO,CAACC,GAAG,CAAE,CAAE,CAAEC,GAAG,EAAEC,KAAK,CAAE,KAAM,CAAED,GAAG,EAAEC,KAAK,CAACC,OAAO,CAAG,CAC3D,CAAC;IACDb,QAAQ,CAAEC,KAAM,CAAC,CAACI,aAAa,CAAEC,MAAO,CAAC;EAC1C,CAAC,EACD,CAAC,EACD;IAAEQ,OAAO,EAAE;EAAK,CACjB,CAAC;;EAED;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACC,MAAMC,eAAe,GAAGR,MAAM,CAACS,OAAO,CAAEZ,SAAU,CAAC;EACnD,MAAMK,OAAO,GAAGF,MAAM,CAACS,OAAO,CAAEb,WAAY,CAAC,CAACc,OAAO,CACpD,CAAE,CAAEC,IAAI,EAAEC,KAAK,CAAE,KAAM;IACtB,OAAOJ,eAAe,CAACL,GAAG,CAAE,CAAE,CAAEU,QAAQ,EAAEC,SAAS,CAAE,KAAM;MAC1D,MAAMC,IAAI,GAAGC,MAAM,CAACC,UAAU,CAC5B,IAAIH,SAAW,KAAKF,KAAO,KAC7B,CAAC;MACDG,IAAI,CAACG,gBAAgB,CAAE,QAAQ,EAAEpB,aAAc,CAAC;MAChD,OAAO,CAAG,GAAGe,QAAU,IAAIF,IAAM,EAAC,EAAEI,IAAI,CAAE;IAC3C,CAAE,CAAC;EACJ,CACD,CAAC;EAEDC,MAAM,CAACE,gBAAgB,CAAE,mBAAmB,EAAEpB,aAAc,CAAC;;EAE7D;EACAA,aAAa,CAAC,CAAC;EACfA,aAAa,CAACqB,KAAK,CAAC,CAAC;AACtB,CAAC;AAED,eAAexB,0BAA0B","ignoreList":[]}