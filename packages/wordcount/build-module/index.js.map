{"version":3,"names":["defaultSettings","stripTags","transposeAstralsToCountableChar","stripHTMLEntities","stripConnectors","stripRemovables","stripHTMLComments","stripShortcodes","stripSpaces","transposeHTMLEntitiesToCountableChars","loadSettings","type","userSettings","_settings$l10n$shortc","settings","Object","assign","shortcodes","l10n","length","shortcodesRegExp","RegExp","join","countWords","text","regex","_text$match$length","bind","reduce","result","fn","match","countCharacters","_text$match$length2","count","matchRegExp","wordsRegExp","characters_including_spacesRegExp","characters_excluding_spacesRegExp"],"sources":["@wordpress/wordcount/src/index.js"],"sourcesContent":["/**\r\n * Internal dependencies\r\n */\r\nimport { defaultSettings } from './defaultSettings';\r\nimport stripTags from './stripTags';\r\nimport transposeAstralsToCountableChar from './transposeAstralsToCountableChar';\r\nimport stripHTMLEntities from './stripHTMLEntities';\r\nimport stripConnectors from './stripConnectors';\r\nimport stripRemovables from './stripRemovables';\r\nimport stripHTMLComments from './stripHTMLComments';\r\nimport stripShortcodes from './stripShortcodes';\r\nimport stripSpaces from './stripSpaces';\r\nimport transposeHTMLEntitiesToCountableChars from './transposeHTMLEntitiesToCountableChars';\r\n\r\n/**\r\n * @typedef {import('./defaultSettings').WPWordCountDefaultSettings}  WPWordCountSettings\r\n * @typedef {import('./defaultSettings').WPWordCountUserSettings}     WPWordCountUserSettings\r\n */\r\n\r\n/**\r\n * Possible ways of counting.\r\n *\r\n * @typedef {'words'|'characters_excluding_spaces'|'characters_including_spaces'} WPWordCountStrategy\r\n */\r\n\r\n/**\r\n * Private function to manage the settings.\r\n *\r\n * @param {WPWordCountStrategy}     type         The type of count to be done.\r\n * @param {WPWordCountUserSettings} userSettings Custom settings for the count.\r\n *\r\n * @return {WPWordCountSettings} The combined settings object to be used.\r\n */\r\nfunction loadSettings( type, userSettings ) {\r\n\tconst settings = Object.assign( {}, defaultSettings, userSettings );\r\n\r\n\tsettings.shortcodes = settings.l10n?.shortcodes ?? [];\r\n\r\n\tif ( settings.shortcodes && settings.shortcodes.length ) {\r\n\t\tsettings.shortcodesRegExp = new RegExp(\r\n\t\t\t'\\\\[\\\\/?(?:' + settings.shortcodes.join( '|' ) + ')[^\\\\]]*?\\\\]',\r\n\t\t\t'g'\r\n\t\t);\r\n\t}\r\n\r\n\tsettings.type = type;\r\n\r\n\tif (\r\n\t\tsettings.type !== 'characters_excluding_spaces' &&\r\n\t\tsettings.type !== 'characters_including_spaces'\r\n\t) {\r\n\t\tsettings.type = 'words';\r\n\t}\r\n\r\n\treturn settings;\r\n}\r\n\r\n/**\r\n * Count the words in text\r\n *\r\n * @param {string}              text     The text being processed\r\n * @param {RegExp}              regex    The regular expression pattern being matched\r\n * @param {WPWordCountSettings} settings Settings object containing regular expressions for each strip function\r\n *\r\n * @return {number} Count of words.\r\n */\r\nfunction countWords( text, regex, settings ) {\r\n\ttext = [\r\n\t\tstripTags.bind( null, settings ),\r\n\t\tstripHTMLComments.bind( null, settings ),\r\n\t\tstripShortcodes.bind( null, settings ),\r\n\t\tstripSpaces.bind( null, settings ),\r\n\t\tstripHTMLEntities.bind( null, settings ),\r\n\t\tstripConnectors.bind( null, settings ),\r\n\t\tstripRemovables.bind( null, settings ),\r\n\t].reduce( ( result, fn ) => fn( result ), text );\r\n\ttext = text + '\\n';\r\n\treturn text.match( regex )?.length ?? 0;\r\n}\r\n\r\n/**\r\n * Count the characters in text\r\n *\r\n * @param {string}              text     The text being processed\r\n * @param {RegExp}              regex    The regular expression pattern being matched\r\n * @param {WPWordCountSettings} settings Settings object containing regular expressions for each strip function\r\n *\r\n * @return {number} Count of characters.\r\n */\r\nfunction countCharacters( text, regex, settings ) {\r\n\ttext = [\r\n\t\tstripTags.bind( null, settings ),\r\n\t\tstripHTMLComments.bind( null, settings ),\r\n\t\tstripShortcodes.bind( null, settings ),\r\n\t\ttransposeAstralsToCountableChar.bind( null, settings ),\r\n\t\tstripSpaces.bind( null, settings ),\r\n\t\ttransposeHTMLEntitiesToCountableChars.bind( null, settings ),\r\n\t].reduce( ( result, fn ) => fn( result ), text );\r\n\ttext = text + '\\n';\r\n\treturn text.match( regex )?.length ?? 0;\r\n}\r\n\r\n/**\r\n * Count some words.\r\n *\r\n * @param {string}                  text         The text being processed\r\n * @param {WPWordCountStrategy}     type         The type of count. Accepts 'words', 'characters_excluding_spaces', or 'characters_including_spaces'.\r\n * @param {WPWordCountUserSettings} userSettings Custom settings object.\r\n *\r\n * @example\r\n * ```js\r\n * import { count } from '@wordpress/wordcount';\r\n * const numberOfWords = count( 'Words to count', 'words', {} )\r\n * ```\r\n *\r\n * @return {number} The word or character count.\r\n */\r\nexport function count( text, type, userSettings ) {\r\n\tconst settings = loadSettings( type, userSettings );\r\n\tlet matchRegExp;\r\n\tswitch ( settings.type ) {\r\n\t\tcase 'words':\r\n\t\t\tmatchRegExp = settings.wordsRegExp;\r\n\t\t\treturn countWords( text, matchRegExp, settings );\r\n\t\tcase 'characters_including_spaces':\r\n\t\t\tmatchRegExp = settings.characters_including_spacesRegExp;\r\n\t\t\treturn countCharacters( text, matchRegExp, settings );\r\n\t\tcase 'characters_excluding_spaces':\r\n\t\t\tmatchRegExp = settings.characters_excluding_spacesRegExp;\r\n\t\t\treturn countCharacters( text, matchRegExp, settings );\r\n\t\tdefault:\r\n\t\t\treturn 0;\r\n\t}\r\n}\r\n"],"mappings":"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","ignoreList":[]}